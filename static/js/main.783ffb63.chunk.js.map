{"version":3,"sources":["types/ThemeMode.ts","store/slices/applicationSlice.ts","types/LossFunction.ts","types/Metric.ts","types/OptimizationAlgorithm.ts","types/ClassifierModelType.ts","types/ToolType.ts","types/AnnotationModeType.ts","types/AnnotationStateType.ts","store/slices/classifierSlice.ts","types/Category.ts","images/cell-painting.png","types/LanguageType.ts","types/Partition.ts","annotator/image/rle.ts","image/imageHelper.ts","types/Task.ts","store/slices/imageViewerSlice.ts","images/317832f90f02c5e916b2ac0f3bcb8da9928d8e400b747b2c68e544e56adacf6b.png","store/slices/projectSlice.ts","types/ZoomModeType.ts","store/slices/toolOptionsSlice.ts","components/OpenProjectMenuItem/OpenProjectMenuItem.tsx","components/OpenClassifierDialog/OpenClassifierDialog.tsx","hooks/useDialog/useDialog.ts","hooks/useMarchingAnts/useMarchingAnts.ts","hooks/useMenu/useMenu.ts","annotator/image/Tool/Tool/Tool.ts","annotator/image/simplify/simplify.ts","annotator/image/polygon-fill/util.ts","annotator/image/polygon-fill/slpf.ts","annotator/image/Tool/AnnotationTool/AnnotationTool/AnnotationTool.ts","annotator/image/flood.ts","annotator/image/Tool/AnnotationTool/ColorAnnotationTool/ColorAnnotationTool.ts","annotator/image/Tool/AnnotationTool/EllipticalAnnotationTool/EllipticalAnnotationTool.ts","annotator/image/Tool/AnnotationTool/LassoAnnotationTool/LassoAnnotationTool.ts","annotator/image/pathfinder/NodeHeap.ts","annotator/image/pathfinder/PathFinder.ts","data/exampleProjects/exampleProjectsEnum.ts","annotator/image/GraphHelper.ts","annotator/image/Tool/AnnotationTool/MagneticAnnotationTool/MagneticAnnotationTool.ts","annotator/image/Tool/AnnotationTool/RectangularAnnotationTool/RectangularAnnotationTool.ts","annotator/image/Tool/AnnotationTool/ObjectAnnotationTool/ObjectAnnotationTool.ts","annotator/image/Tool/AnnotationTool/PenAnnotationTool/PenAnnotationTool.ts","annotator/image/Tool/AnnotationTool/PolygonalAnnotationTool/PolygonalAnnotationTool.ts","annotator/image/Tool/AnnotationTool/QuickAnnotationTool/QuickAnnotationTool.ts","annotator/image/slic.ts","store/selectors/classifierSelector.ts","store/selectors/annotationStateSelector.ts","store/selectors/boundingClientRectSelector.ts","store/selectors/categoryCountsSelector.ts","store/selectors/categoriesSelector.ts","store/selectors/createdCategoriesSelector.ts","store/selectors/imageInstancesSelector.ts","store/selectors/imageSelector.ts","store/selectors/imageOriginalSrcSelector.ts","store/selectors/selectedCategorySelector.ts","store/selectors/selectionModeSelector.ts","store/selectors/stageHeightSelector.ts","store/selectors/stageScaleSelector.ts","store/selectors/stageWidthSelector.ts","store/selectors/toolTypeSelector.ts","store/selectors/unknownCategorySelector.ts","store/selectors/zoomToolOptionsSelector.ts","store/selectors/zoomSelectionSelector.ts","store/selectors/categorizedImagesSelector.ts","store/selectors/compiledSelector.ts","store/selectors/createdCategoriesCountSelector.ts","store/selectors/fitOptionsSelector.ts","store/selectors/trainingPercentageSelector.ts","store/selectors/compileOptionsSelector.ts","store/selectors/imagesSelector.ts","store/selectors/selectedImagesSelector.ts","store/selectors/visibleImagesSelector.ts","store/selectors/penSelectionBrushSizeSelector.ts","store/selectors/quickSelectionBrushSizeSelector.ts","store/selectors/imageSrcSelector.ts","hooks/useAnnotationTool/useAnnotationTool.ts","store/selectors/scaledImageWidthSelector.ts","store/selectors/languageSelector.ts","translations/de.ts","translations/en.ts","translations/fas.ts","translations/fi.ts","translations/gr.ts","translations/hi.ts","translations/hu.ts","translations/fr.ts","hooks/useTranslation/useTranslation.tsx","components/OpenExampleProjectMenuItem/OpenExampleProjectMenuItem.tsx","icons/CheckboxChecked.svg","data/exampleProjects/cElegansExampleProjectIcon.png","data/exampleProjects/humanU2OSCellsExampleProjectIcon.png","components/OpenExampleProjectDialog/OpenExampleProjectDialog.tsx","data/exampleProjects/mnistExampleProjectIcon.png","components/OpenMenu/OpenMenu.tsx","components/OpenListItem/OpenListItem.tsx","store/selectors/serializedProjectSelector.ts","components/SaveProjectDialog/SaveProjectDialog.tsx","store/selectors/fittedSelector.ts","store/selectors/selectedModelSelector.ts","components/SaveClassifierDialog/SaveClassifierDialog.tsx","components/SaveMenu/SaveMenu.tsx","components/SaveListItem/SaveListItem.tsx","components/FileList/FileList.tsx","components/CollapsibleList/CollapsibleList.tsx","components/CategoryListItemCheckbox/CategoryListItemCheckbox.tsx","components/HideOrShowCategoryMenuItem/HideOrShowCategoryMenuItem.tsx","components/HideOtherCategoriesMenuItem/HideOtherCategoriesMenuItem.tsx","components/CategoryMenu/CategoryMenu.tsx","store.ts","store/selectors/availableColorsSelecor.ts","components/ColorIcon/ColorIcon.tsx","components/EditCategoryDialog/EditCategoryDialog.tsx","components/DeleteCategoryDialog/DeleteCategoryDialog.tsx","components/CategoryListItem/CategoryListItem.tsx","components/CreateCategoryDialog/CreateCategoryDialog.tsx","components/CreateCategoryListItem/CreateCategoryListItem.tsx","components/CategoriesList/CategoriesList.tsx","store/selectors/trainingFlagSelector.ts","components/FitClassifierDialog/FitClassifierDialogAppBar/FitClassifierDialogAppBar.tsx","components/FitClassifierDialog/StyledFormControl.tsx","store/selectors/learningRateSelector.ts","store/selectors/optimizationAlgorithmSelector.ts","store/selectors/lossFunctionSelector.ts","components/CustomNumberTextField/CustomNumberTextField.tsx","components/FitClassifierDialog/OptimizerSettingsListItem/OptimizerSettingsGrid/OptimizerSettingsGrid.tsx","components/FitClassifierDialog/OptimizerSettingsListItem/OptimizerSettingsListItem.tsx","components/FitClassifierDialog/DatasetSettingsListItem/DatasetSettingsListItem.tsx","store/selectors/architectureOptionsSelector.ts","store/selectors/inputShapeSelector.ts","store/selectors/uploadedModelSelector.ts","components/FitClassifierDialog/ArchitectureSettingsListItem/ArchitectureSettingsGrid/ArchitectureSettingsGrid.tsx","components/FitClassifierDialog/ArchitectureSettingsListItem/ArchitectureSettingsListItem.tsx","store/selectors/rescaleOptionsSelector.ts","components/RescalingForm/RescalingForm.tsx","components/PreprocessingSettingsListItem/PreprocessingSettingsListItem.tsx","components/DialogTransition/DialogTransition.tsx","components/FitClassifierDialog/FitClassifierDialog/FitClassifierDialog.tsx","components/ClassifierListItems/FitClassifierListItem.tsx","components/ClassifierListItems/DisabledClassifierListItem.tsx","components/ClassifierListItems/EvaluateClassifierListItem.tsx","components/ClassifierListItems/PredictClassifierListItem.tsx","components/ClassifierList/ClassifierList.tsx","components/styled/AppBarOffset/AppBarOffset.tsx","store/selectors/themeModeSelector.ts","icons/Sun.svg","icons/Moon.svg","components/SettingsDialog/SettingsDialog.tsx","components/SettingsListItem/SettingsListItem.tsx","components/HelpListItem/HelpListItem.tsx","components/SendFeedbackListItem/SendFeedbackListItem.tsx","components/ApplicationList/ApplicationList.tsx","components/ApplicationDrawer/ApplicationDrawer.tsx","store/selectors/tileSizeSelector.ts","components/ImageCategoryMenu/ImageCategoryMenu.tsx","components/DeleteImagesDialog/DeleteImagesDialog.tsx","components/ImageGridAppBar/ImageGridAppBar.tsx","components/ImageGrid/ImageIconLabel.tsx","components/ImageGrid/ImageGrid.tsx","components/UploadMenu/StyledMenuItem.tsx","components/UploadMenu/DropboxMenuItem.tsx","components/UploadMenu/UploadMenu.tsx","components/UploadButton/UploadButton.tsx","components/Logo/Logo.tsx","components/ApplicationToolbar/ApplicationToolbar.tsx","components/ApplicationAppBar/ApplicationAppBar.tsx","components/MainView/MainView.tsx","components/annotator/CategoriesList/CollapsibleList/CollapsibleList.tsx","components/annotator/CategoriesList/CategoryListItemCheckbox/CategoryListItemCheckbox.tsx","components/annotator/CategoriesList/CategoryMenu/HideOrShowCategoryMenuItem/HideOrShowCategoryMenuItem.tsx","components/annotator/CategoriesList/CategoryMenu/HideOtherCategoriesMenuItem/HideOtherCategoriesMenuItem.tsx","components/annotator/CategoriesList/CategoryMenu/CategoryMenu/CategoryMenu.tsx","store/selectors/activeImageIdSelector.ts","components/annotator/CategoriesList/DeleteCategoryDialog/DeleteCategoryDialog.tsx","store/selectors/annotatorCategoriesSelector.ts","components/annotator/CategoriesList/ColorIcon/ColorIcon.tsx","components/annotator/CategoryDialog/CategoryDialog/CategoryDialog.tsx","components/annotator/CategoryDialog/EditCategoryDialog/EditCategoryDialog.tsx","store/selectors/soundEnabledSelector.ts","components/annotator/SettingsDialog/SettingsDialog.tsx","components/annotator/CategoryDialog/CreateCategoryDialog/CreateCategoryDialog.tsx","store/selectors/selectedAnnotationsIdsSelector.ts","components/annotator/CategoriesList/ImageMenu/ImageMenu.tsx","components/annotator/CategoriesList/DeleteAllAnnotationsDialog/DeleteAllAnnotationsDialog.tsx","store/selectors/allSerializedAnnotationsSelector.ts","components/annotator/CategoriesList/SaveMenu/SaveProjectFileMenuItem.tsx","components/annotator/CategoriesList/SaveMenu/ExportAnnotationsAsLabeledInstancesMenuItem.tsx","components/annotator/CategoriesList/SaveMenu/ExportAnnotationsAsMatrixMenuItem.tsx","components/annotator/CategoriesList/SaveMenu/ExportAnnotationsAsLabeledSemanticMasksMenuItem.tsx","components/annotator/CategoriesList/SaveMenu/ExportAnnotationsAsBinarySemanticMasksMenuItem.tsx","components/annotator/CategoriesList/SaveMenu/ExportAnnotationsAsBinaryInstancesMenuItem.tsx","components/annotator/CategoriesList/SaveMenu/SaveMenu.tsx","components/annotator/CategoriesList/OpenMenu/OpenImageMenuItem.tsx","components/annotator/CategoriesList/OpenMenu/OpenProjectFileMenuItem.tsx","images/malaria.png","store/selectors/annotatorImagesSelector.ts","components/annotator/CategoriesList/ExampleImageDialog/ExampleImageDialog.tsx","components/annotator/CategoriesList/OpenMenu/OpenExampleImageMenuItem.tsx","components/annotator/CategoriesList/OpenMenu/OpenMenu.tsx","components/annotator/Help/HelpDrawer/CollapsibleHelpContent.tsx","components/annotator/Help/HelpDialog/KeyboardKey.tsx","components/annotator/Help/HelpDialog/HelpWindowToolIcons.tsx","components/annotator/Help/HelpDialog/HelpWindowToolTitle.tsx","icons/CheckboxUnchecked.svg","icons/ColorAdjustment.svg","icons/ColorAnnotation.svg","icons/EllipticalAnnotation.svg","icons/Hand.svg","icons/LassoAnnotation.svg","icons/MagneticAnnotation.svg","icons/ObjectAnnotation.svg","icons/FreehandAnnotation.svg","icons/PolygonalAnnotation.svg","icons/QuickAnnotation.svg","icons/RadioChecked.svg","icons/RadioUnchecked.svg","icons/RectangularAnnotation.svg","icons/Selection.svg","icons/Zoom.svg","webpack:///./src/icons/Sun.svg?bf53","webpack:///./src/icons/Moon.svg?8d23","components/annotator/Help/HelpContent/HelpContent.tsx","components/annotator/Help/HelpDrawer/HelpDrawer.tsx","components/annotator/CategoriesList/ClearCategoryDialog/ClearCategoryDialog.tsx","icons/InvertAnnotation.svg","store/selectors/createdAnnotatorCategoriesSelector.ts","components/annotator/CategoriesList/ExitAnnotatorDialog/ExitAnnotatorDialog.tsx","components/annotator/CategoriesList/CategoriesList/CategoriesList.tsx","components/annotator/ToolOptions/AnnotationMode/AnnotationModeTooltip/AnnotationModeTooltip.tsx","components/annotator/ToolOptions/AnnotationMode/NewTooltip/NewTooltip.tsx","components/annotator/ToolOptions/AnnotationMode/AddTooltip/AddTooltip.tsx","components/annotator/ToolOptions/AnnotationMode/SubtractTooltip/SubtractTooltip.tsx","components/annotator/ToolOptions/AnnotationMode/IntersectionTooltip/IntersectionTooltip.tsx","components/annotator/ToolOptions/AnnotationMode/AnnotationMode/AnnotationMode.tsx","components/annotator/ToolOptions/InformationBox/InformationBox.tsx","store/selectors/selectedAnnotationSelector.ts","components/annotator/ToolOptions/InvertAnnotation/InvertAnnotation.tsx","components/annotator/ToolOptions/RectangularAnnotationOptions/RectangularAnnotationOptions.tsx","components/annotator/ToolOptions/EllipticalAnnotationOptions/EllipticalAnnotationOptions.tsx","components/annotator/ToolOptions/FreehandAnnotationOptions/FreehandAnnotationOptions.tsx","components/annotator/ToolOptions/LassoAnnotationOptions/LassoAnnotationOptions.tsx","components/annotator/ToolOptions/PolygonalAnnotationOptions/PolygonalAnnotationOptions.tsx","components/annotator/ToolOptions/MagneticAnnotationOptions/MagneticAnnotationOptions.tsx","components/annotator/ToolOptions/ColorAnnotationOptions/ColorAnnotationOptions.tsx","components/annotator/ToolOptions/QuickAnnotationOptions/QuickAnnotationOptions.tsx","components/annotator/ToolOptions/ObjectAnnotationOptions/ObjectAnnotationOptions.tsx","store/selectors/offsetSelector.ts","components/annotator/ToolOptions/HandToolOptions/ResetButton.tsx","components/annotator/ToolOptions/ZoomOptions/ZoomOptions.tsx","components/annotator/ToolOptions/HandToolOptions/HandToolOptions.tsx","store/selectors/intensityRangeSelector.ts","store/selectors/imageShapeSelector.ts","components/annotator/ToolOptions/ColorAdjustmentOptions/ChannelsList/ChannelsList.tsx","store/selectors/activeImagePlaneSelector.ts","store/selectors/activeImageSelector.ts","components/annotator/ToolOptions/ColorAdjustmentOptions/ZStackSlider/ZStackSlider.tsx","components/annotator/ToolOptions/ColorAdjustmentOptions/ColorAdjustmentOptions/ColorAdjustmentOptions.tsx","store/selectors/selectedAnnotationsSelector.ts","store/selectors/unselectedAnnotationsSelector.ts","components/annotator/ToolOptions/PointerSelectionOptions/PointerSelectionOptions.tsx","components/annotator/ToolOptions/ToolOptions/ToolOptions.tsx","components/annotator/Tools/Tool/ToolBarToolTitle.tsx","components/annotator/Tools/Tool/Tool.tsx","components/annotator/Tools/Tools/Tools.tsx","store/selectors/scaledImageHeightSelector.ts","components/annotator/Content/Stage/Image/Image.tsx","components/annotator/Content/Stage/Selection/EllipticalSelection/EllipticalSelection.tsx","components/annotator/Content/Stage/Selection/LassoSelection/LassoSelection.tsx","components/annotator/Content/Stage/Selection/MagneticSelection/MagneticSelection.tsx","components/annotator/Content/Stage/Selection/ObjectSelection/ObjectSelection.tsx","components/annotator/Content/Stage/Selection/PolygonalSelection/PolygonalSelection.tsx","components/annotator/Content/Stage/Selection/RectangularSelection/RectangularSelection.tsx","components/annotator/Content/Stage/Selection/ColorSelection/ColorSelection.tsx","components/annotator/Content/Stage/Selection/QuickSelection/QuickSelection.tsx","components/annotator/Content/Stage/Selection/PenSelection/PenSelection.tsx","components/annotator/Content/Stage/Selection/ZoomSelection/ZoomSelection.tsx","components/annotator/Content/Stage/Selection/Selection/Selection.tsx","components/annotator/Content/Stage/Selecting/Selecting.tsx","components/annotator/Content/Stage/ColorAnnotationToolTip/ColorAnnotationToolTip.tsx","annotator/sounds/pop-up-on.mp3","annotator/sounds/pop-up-off.mp3","components/annotator/Content/Stage/Layer/Layer.tsx","store/selectors/imageWidthSelector.ts","store/selectors/imageHeightSelector.ts","store/selectors/cursorSelector.ts","components/annotator/Content/Stage/Transformer/Transformer.tsx","components/annotator/Content/Stage/Transformers/Transformers.tsx","store/selectors/stagePositionSelector.ts","components/annotator/Content/Stage/PenAnnotationToolTip/PenAnnotationToolTip.tsx","store/selectors/visibleCategoriesSelector.ts","annotator/image/toRGBA.ts","components/annotator/Content/Stage/Annotations/ConfirmedAnnotations/Annotation/Annotation.tsx","components/annotator/Content/Stage/Annotations/ConfirmedAnnotations/ConfirmedAnnotations.tsx","components/annotator/Content/Stage/Annotations/SelectedAnnotation/SelectedAnnotation.tsx","components/annotator/Content/Stage/Annotations/SelectedAnnotations/SelectedAnnotations.tsx","components/annotator/Content/Stage/Annotations/Annotations.tsx","store/selectors/pointerSelectionSelector.ts","components/annotator/Content/Stage/Selection/PointerSelection/PointerSelection.tsx","store/selectors/currentIndexSelector.ts","hooks/usePointer/usePointer.ts","components/annotator/Content/Stage/Stage/Stage.tsx","hooks/useZoom/useZoom.ts","hooks/useWindowFocusHandler/useWindowFocusHandler.ts","hooks/useCursor/useCursor.ts","hooks/useKeyboardShortcuts/useKeyboardShortcuts.tsx","hooks/useHandTool/useHandTool.tsx","components/annotator/Content/Content/Content.tsx","hooks/useBoundingClientRect/useBoundingClientRect.ts","components/annotator/ImageViewer/ImageViewer.tsx","components/annotator/AnnotatorView/AnnotatorView.tsx","theme.ts","components/Application/Application.tsx","hooks/useTheme/usePreferredTheme.ts","store/reducer/reducer.ts","store/sagas/annotator/annotationStateChangeSaga.ts","store/sagas/annotator/watchAnnotationStateChangeSaga.ts","store/sagas/annotator/selectedCategorySaga.ts","store/sagas/annotator/watchSelectedCategorySaga.ts","store/coroutines/classifier/compile.ts","store/coroutines/classifier/fit.ts","store/coroutines/models/simpleCNN.ts","store/coroutines/models/changeInputShape.ts","store/coroutines/models/mobileNet.ts","store/coroutines/classifier/open.ts","store/coroutines/classifier/preprocess.ts","store/selectors/trainImagesSelector.ts","store/selectors/valImagesSelector.ts","store/sagas/classifier/fitSaga.ts","store/sagas/classifier/watchFitSaga.ts","store/coroutines/classifier/preprocess_predict.ts","store/coroutines/classifier/predictCategories.ts","store/selectors/testImagesSelector.ts","store/sagas/classifier/predictSaga.ts","store/sagas/classifier/watchPredictSaga.ts","store/sagas/rootSaga.ts","store/stores/productionStore.ts","index.tsx"],"names":["ThemeMode","LossFunction","Metric","OptimizationAlgorithm","ModelType","initialState","selectedImages","tileSize","themeMode","Light","applicationSlice","createSlice","name","reducers","updateTileSize","state","action","payload","newValue","selectImage","push","id","selectOneImage","selectAllImages","ids","deselectImage","filter","deselectImages","includes","clearSelectedImages","setThemeMode","mode","actions","ToolType","AnnotationModeType","AnnotationStateType","availableModels","modelName","modelType","SimpleCNN","requiredChannels","MobileNet","evaluating","inputShape","height","width","channels","planes","frames","fitOptions","epochs","batchSize","initialEpoch","shuffle","fitting","learningRate","lossFunction","CategoricalCrossEntropy","selectedModel","metrics","CategoricalAccuracy","optimizationAlgorithm","Adam","predicting","rescaleOptions","rescale","rescaleMinMax","min","max","trainingPercentage","classifierSlice","fit","predict","setClassifier","classifier","evaluations","history","predictions","updateBatchSize","updateCompiled","compiled","updateEpochs","updateFitted","fitted","status","addFitted","updateInputShape","updateLearningRate","updateLossFunction","updateMetrics","updateSelectedModel","model","uploadUserSelectedModel","modelSelection","userUploadedModel","updateOptimizationAlgorithm","updatePreprocessed","data","updateRescaleOptions","updateTrainingPercentage","UNKNOWN_CATEGORY_ID","LanguageType","Partition","decode","encoded","decoded","background","i","length","j","Uint8ClampedArray","encode","lastElement","lastSequenceSize","Task","convertFileToImage","file","a","Promise","resolve","reject","arrayBuffer","then","buffer","ImageJS","load","image","convertImageJStoImage","filename","nplanes","imageData","Array","isArray","components","toDataURL","useCanvas","shape","categoryId","uuidv4","annotations","originalSrc","partition","Inference","src","Math","floor","connectPoints","coordinates","connectedPoints","_","slice","current","next","forEach","points","drawLine","p","q","x","y","x1","y1","dx","dy","step","coords","round","abs","getIdx","nchannels","index","colorOverlayROI","encodedMask","boundingBox","imageWidth","imageHeight","color","scalingFactor","decodedData","endX","endY","boxWidth","boxHeight","croppedImage","alpha","resize","factor","colorROIImage","checkNeighbors","arr","getPixelXY","setPixelXY","Image","replaceDuplicateName","names","currentName","saveAnnotationsAsBinaryInstanceSegmentationMasks","images","categories","zip","annotation","fullLabelImage","Uint8Array","fill","mask","boundingBoxWidth","boundingBoxHeight","roiMask","blob","toBlob","category","find","folder","base64","generateAsync","type","saveAs","saveAnnotationsAsLabeledSemanticSegmentationMasks","categoryColor","hex","result","exec","r","parseInt","g","b","hexToRgb","saveAnnotationsAsLabelMatrix","random","binary","map","flat","importSerializedAnnotations","existingCategories","annotationMask","split","newCategories","annotationCategoryId","annotationCategoryColor","annotationCategoryName","visible","annotationPlane","annotation_out","annotationBoundingBoxX","annotationBoundingBoxY","annotationBoundingBoxWidth","annotationBoundingBoxHeight","annotationId","plane","initialImage","activePlane","avatar","colorImage","initialCategories","annotationState","Blank","boundingClientRect","DOMRect","brightness","range","currentIndex","cursor","contrast","exposure","hue","activeImageId","undefined","activeImagePlane","language","English","offset","penSelectionBrushSize","pointerSelection","dragging","minimum","maximum","selecting","quickSelectionBrushSize","saturation","selectedAnnotation","selectedAnnotations","selectedCategoryId","selectionMode","New","soundEnabled","stageHeight","stageScale","stageWidth","stagePosition","toolType","RectangularAnnotation","vibrance","zoomSelection","imageViewerSlice","addImages","imageNames","updatedImages","newImages","initialName","updatedName","clearCategoryAnnotations","deleteCategory","deleteImage","deleteAllInstances","deleteAllImageInstances","imageId","deleteImageInstances","updatedAnnotations","openAnnotations","loaded","imageFilename","imageChannels","imageFrames","imagePlanes","setAnnotationState","setBoundingClientRect","setBrightness","setCategories","setCategoryVisibility","setContrast","setCurrentIndex","setExposure","setHue","setActiveImage","activeImage","defaultChannels","setActiveImagePlane","setImageSrc","setImages","setChannels","setCursor","setImageInstances","instances","setLanguage","setOffset","setOperation","operation","setPenSelectionBrushSize","setPointerSelection","setQuickSelectionBrushSize","setSaturation","setSelectedCategoryId","setSelectedAnnotations","setSelectionMode","setStageHeight","setStagePosition","setStageScale","setStageWidth","setSoundEnabled","setVibrance","setZoomSelection","extraReducers","console","info","ZoomModeType","dummyImage","nuclei","task","Classify","trainFlag","projectSlice","createCategory","toString","createImage","createProject","project","deleteImages","openImages","serializedImage","imageCategoryId","imagePartition","openProject","setProjectName","updateCategory","findIndex","updateCategoryVisibility","updateOtherCategoryVisibility","updateImageCategory","updateImageCategories","Training","updateImagesCategories","idx","categoryIds","updateImagesPartition","updateTask","updateTrainFlag","colorAdjustment","blackPoint","highlights","shadows","zoom","automaticCentering","In","scale","toActualSize","toFit","toolOptionsSlice","setColorAdjustmentOptions","options","setZoomToolOptions","OpenProjectMenuItem","popupState","dispatch","useDispatch","MenuItem","component","ListItemText","primary","accept","hidden","onChange","event","close","persist","currentTarget","files","reader","FileReader","onload","target","JSON","parse","serializedImages","err","error","alert","message","readAsText","onOpenProjectFile","OpenClassifierDialog","onClose","open","React","useState","classifierModel","setClassifierModel","modelSelected","setModelSelected","setModelName","setInputShape","fileError","setFileError","fileErrorMessage","setFileErrorMessage","onClassifierFilesSelected","weightsFile","jsonFile","text","jsonFileContent","weightFileName","weightFileNameReplaceString","substring","regegPattern","RegExp","updatedJsonFileContent","replace","newJsonFile","File","tf","browserFiles","modelShape","inputs","prevShape","jsonFileName","Dialog","fullWidth","maxWidth","DialogTitle","multiple","DialogContent","Typography","gutterBottom","htmlFor","dense","ListItemIcon","Alert","severity","DialogActions","Button","onClick","UserUploaded","disabled","useDialog","setOpen","useCallback","onOpen","useMarchingAnts","dashOffset","setDashOffset","useEffect","timer","setTimeout","clearTimeout","useMenu","anchorEl","setAnchorEl","Tool","this","getSqDist","p1","p2","getSqSegDist","t","simplifyDPStep","first","last","sqTolerance","simplified","maxSqDist","sqDist","simplifyDouglasPeucker","simplify","tolerance","highestQuality","prevPoint","newPoints","point","len","simplifyRadialDist","lerp","yScan","x2","y2","getYMin","getYMax","getXofYMin","getXofYMax","moveEdges","ET","AET","pop","removeEdges","getSpans","spans","edge","drawSpans","img","fillSpan","AnnotationTool","manager","onAnnotating","onAnnotated","onDeselect","anchor","origin","_boundingBox","_mask","getRoiManager","newMaskImage","maskImage","newBoundingBox","encodedMaskData1","boundingBox1","maskData1","maskData2","boundingBox2","newBoundingBoxWidth","newBoundingBoxHeight","newMaskData","deltaX1","deltaY1","deltaX2","deltaY2","b1x","b1y","b2x","b2y","b1i","b2i","inBoundingBox","from","Annotated","anchorIndex","segment","splice","computeBoundingBoxFromContours","computeMask","crop","setAnnotated","decodedMask1","selectedMask","selectedBoundingBox","invertedBoundingBox","invertedMask","x_mask","y_mask","croppedInvertedMask","updatedBoundingBox","contour","pairs","bitDepth","edges","pointsToEdges","sort","e1","e2","cmp","slpf","getChannel","updatedMask","handler","Annotating","dirs","ColorAnnotationTool","roiContour","roiManager","overlayData","initialPosition","toleranceMap","floodMap","toleranceQueue","PriorityQueue","comparator","toolTipPosition","maxTol","seen","Set","clear","setBlank","position","tol","red","green","blue","grey","maxValue","makeFloodMap","empty","Infinity","queue","add","updateOverlay","setAnnotating","diff","ceil","hypot","fromMask","getMasks","roi","getRois","surface","minX","minY","maxX","maxY","imgMask","getBitXY","peek","currentPoint","dequeue","dir","newX","newY","has","doFlood","threshold","invert","colorOverlay","fillColor","overlay","EllipticalAnnotationTool","center","radius","convertToPoints","convertToMask","canvas","document","createElement","ctx","getContext","beginPath","ellipse","PI","roiWidth","roiHeight","imageMask","fromCanvas","croppedImageMask","centerX","centerY","foo","sqrt","LassoAnnotationTool","distance","NodeHeap","fScore","node","heapIndex","item","setNodeId","_up","top","_down","pos","compare","parent","halfLength","left","right","best","NO_PATH","cachedAStarPathSearch","graph","heuristic","fromNode","toNode","fromIdxToCoord","fromId","toId","getNode","cameFrom","to","dest","trace","openSet","distanceToSource","reconstructPath","closed","forEachLinkedNode","visitNeighbour","otherNode","parentId","Number","POSITIVE_INFINITY","tentativeDistance","updateItem","searchNode","newCoord","parentNode","oldDirection","pathDirection","newDirection","ExampleProject","log","validNeighbours","xoffsets","yoffsets","output","xoffset","yoffset","row","makeGraph","createGraph","cap","BYTES_PER_ELEMENT","startIdx","dist","addNode","pixels","pixel","addLink","createPathFinder","MagneticAnnotationTool","path","pathfinder","previous","response","source","destination","connected","sobelFilter","RectangularAnnotationTool","computeBoundingBox","ObjectAnnotationTool","prediction","tensorflow","cropped","fromPixels","getCanvas","batch","resizeBilinear","div","expandDims","squeeze","tile","sub","sign","relu","pad","toPixels","clamped","greyMask","binaryMask","algorithm","rois","thresholded","instance","optimizer","adam","compile","loss","PenAnnotationTool","brushSize","circlesData","outline","thresholdMask","bbox","arc","croppedRgbMask","computeCircleData","operator","PolygonalAnnotationTool","QuickAnnotationTool","brushsize","colorMasks","currentSuperpixels","lastSuperpixel","superpixels","superpixelsMap","currentMask","regionSize","minRegionSize","imWidth","imHeight","numRegionsX","String","numRegionsY","numRegions","numPixels","masses","currentCenters","Float32Array","newCenters","parameters","mcMap","msMap","distanceMap","xyz","gamma","pow","parseFloat","xw","yw","Yw","ix","iy","iz","lab","fx","fy","fz","gradient","k","c","d","v","u","centerx","centery","minEdgeValue","yp","xp","thisEdgeValue","iterations","segmentation","Int32Array","iteration","i1","region","cx","cy","spatial","dR","dG","dB","appearance","mc","ms","iMass","segmentSize","label","cleanedLabel","numExpanded","neighbor","cleaned","direction","count","slic","getRGBAData","flatPixelCoordinate","superpixel","setPixel","croppedGreyMask","update","classifierSelector","annotationStateSelector","imageViewer","boundingClientRectSelector","categoryCountsSelector","catDict","categoriesSelector","createdCategoriesSelector","sortBy","imageInstancesSelector","imageSelector","imageOriginalSrcSelector","selectedCategorySelector","selectionModeSelector","stageHeightSelector","stageScaleSelector","stageWidthSelector","toolTypeSelector","unknownCategorySelector","zoomToolOptionsSelector","toolOptions","zoomSelectionSelector","categorizedImagesSelector","compiledSelector","createdCategoriesCountSelector","fitOptionsSelector","trainingPercentageSelector","compileOptionsSelector","imagesSelector","selectedImagesSelector","settings","visibleCategories","visibleImagesSelector","penSelectionBrushSizeSelector","quickSelectionBrushSizeSelector","imageSrcSelector","useAnnotationTool","useSelector","setOperator","setImage","loadImage","ColorAnnotation","EllipticalAnnotation","LassoAnnotation","MagneticAnnotation","ObjectAnnotation","PenAnnotation","setup","PolygonalAnnotation","QuickAnnotation","quickSelectionOperator","scaledImageWidthSelector","languageSelector","de","translation","Cancel","Categories","Description","Edit","Help","Logo","Model","Open","Save","Settings","Unknown","en","fas","Create","Export","Intersection","Pointer","Name","Zoom","fi","gr","hi","hu","fr","useTranslation","word","Farsi","Finnish","French","German","Greek","Hindi","Hungarian","_g","OpenExampleProjectMenuItem","exampleProject","projectName","projectIcon","onClickExampleProject","Mnist","CElegans","HumanU2OSCells","exampleProjectJson","ListItem","button","ListItemAvatar","Avatar","OpenExampleClassifierDialog","props","sx","borderBottom","theme","palette","divider","margin","padding","spacing","IconButton","borderTop","MenuList","cElegansExampleProjectIcon","humanU2OSCellsExampleProjectIcon","OpenMenu","onCloseClassifierDialog","onOpenClassifierDialog","openClassifierDialog","onCloseExampleClassifierDialog","onOpenExampleClassifierDialog","openExampleClassifier","Menu","bindMenu","variant","Divider","OpenListItem","bindTrigger","serializedProjectSelector","imageChecksum","SaveProjectDialog","serializedProject","Grid","container","xs","TextField","autoFocus","value","part","version","parts","stringify","Blob","fittedSelector","selectedModelSelector","SaveClassifierDialog","classifierName","setClassifierName","noFittedModel","onSaveClassifierClick","save","helperText","SaveMenu","onSaveProjectDialogClose","onSaveProjectDialogOpen","openSaveProjectDialog","onSaveClassifierDialogClose","onSaveClassifierDialogOpen","openSaveClassifierDialog","SaveListItem","FileList","List","CollapsibleList","children","collapsed","setCollapsed","Collapse","in","timeout","unmountOnExit","disablePadding","CategoryListItemCheckbox","Checkbox","checked","checkedIcon","style","disableRipple","icon","tabIndex","HideOrShowCategoryMenuItem","onCloseCategoryMenu","HideOtherCategoriesMenuItem","CategoryMenu","anchorElCategoryMenu","openCategoryMenu","onOpenDeleteCategoryDialog","onOpenEditCategoryDialog","anchorOrigin","horizontal","vertical","transformOrigin","COLORS","availableColorsSelector","usedColors","catagory","ColorIcon","onColorChange","availableColors","colorMenuAnchorEl","setColorMenuAnchorEl","colorPopupOpen","Boolean","onCloseColorPicker","backgroundColor","Popover","Box","colors","EditCategoryDialog","onCloseDialog","openDialog","setColor","setName","DeleteCategoryDialog","CategoryListItem","onCloseDeleteCategoryDialog","openDeleteCategoryDialog","onCloseEditCategoryDialog","openEditCategoryDialog","onOpenCategoryMenu","imageCount","Fragment","primaryTypographyProps","noWrap","Chip","size","borderWidth","fontSize","ListItemSecondaryAction","CreateCategoryDialog","usedCategoryNames","sample","errorHelperText","setErrorHelperText","invalidName","setInvalidName","validateInput","categoryName","validInput","paddingLeft","CreateCategoryListItem","CategoriesList","unknownCategory","trainingFlagSelector","FitClassifierDialogAppBar","closeDialog","disableFitting","training","AppBar","boxShadow","Toolbar","Tooltip","title","placement","href","ArrowBack","flexGrow","PlayCircleOutline","stopTraining","Stop","StyledFormControl","styled","FormControl","display","flexWrap","minWidth","learningRateSelector","optimizationAlgorithmSelector","lossFunctionSelector","intRegExpr","floatRegExpr","CustomNumberTextField","dispatchCallBack","MIN_SAFE_INTEGER","MAX_SAFE_INTEGER","enableFloat","valueString","setValueString","regExp","marginRight","flexBasis","marginTop","inputString","test","arg","isNaN","autoComplete","enumKeys","obj","Object","keys","OptimizerSettingsGrid","FormHelperText","Select","displayEmpty","inputProps","OptimizerSettingsListItem","collapsedClassifierSettingsList","setCollapsedClassifierSettingsList","DatasetSettingsListItem","collapsedDatasetSettingsList","setCollapsedDatasetSettingsList","trainPercentage","architectureOptionsSelector","inputShapeSelector","uploadedModelSelector","ArchitectureSettingsGrid","architectureOptions","setSelectedModel","fixedNumberOfChannels","setFixedNumberOfChannels","fixedNumberOfChannelsHelperText","setFixedNumberOfChannelsHelperText","modelOptions","Autocomplete","disableClearable","getOptionLabel","option","renderInput","params","cols","ArchitectureSettingsListItem","StyledForm","noValidate","rescaleOptionsSelector","RescalingForm","setDisabled","StyledTextField","FormControlLabel","control","defaultValue","PreprocessingSettingsListItem","openedDialog","collapsedPreprocessingList","setCollapsedPreprocessingList","FormGroup","DialogTransition","ref","Slide","FitClassifierDialog","openedDrawer","noCategorizedImagesAlert","setNoCategorizedImagesAlert","showWarning","setShowWarning","categorizedImages","onFit","categorizedImagesIds","trainDataLength","valDataLength","trainDataIds","valDataIds","Validation","onEpochEnd","epoch","logs","disableEscapeKeyDown","fullScreen","TransitionComponent","zIndex","FitClassifierListItem","DisabledClassifierListItem","componentsProps","tooltip","arrow","EvaluateClassifierListItem","PredictClassifierListItem","onPredict","ClassifierList","setHelperText","AppBarOffset","mixins","toolbar","themeModeSelector","SettingsDialog","Container","MaterialUISwitch","Dark","Switch","transform","backgroundImage","Moon","opacity","content","backgroundRepeat","backgroundPosition","Sun","borderRadius","SettingsListItem","HelpListItem","SendFeedbackListItem","ApplicationList","ApplicationDrawer","Drawer","flexShrink","tileSizeSelector","ImageCategoryMenu","imageIds","paddingRight","DeleteImagesDialog","ImageGridAppBar","navigate","useNavigate","categoryMenuAnchorEl","setCategoryMenuAnchorEl","appear","selected","projectImage","annotatorImage","newSelected","ImageIconLabel","actionIconStyle","marginLeft","predictedLabel","ImageGrid","onDrop","useDrop","NativeTypes","FILE","drop","collect","monitor","isOver","canDrop","scaleFactor","getSize","paddingTop","transition","transitions","create","duration","enteringScreen","easing","easeOut","border","paddingBottom","ImageList","rowHeight","ImageListItem","onSelectImage","alt","objectFit","ImageListItemBar","actionIcon","actionPosition","StyledMenuItem","DropboxMenuItem","useDropboxChooser","appKey","chooserOptions","multiselect","linkType","onSelected","items","UploadMenu","onUploadFromComputerChange","PaperProps","Fade","ListSubheader","letterSpacing","fontWeight","lineHeight","textTransform","UploadButton","startIcon","breakpoints","up","ApplicationToolbar","setValue","Slider","ApplicationAppBar","MainView","onUnload","e","preventDefault","returnValue","window","addEventListener","removeEventListener","CssBaseline","translatedHide","translatedShow","cat","onOpenClearCategoryDialog","existAnnotations","activeImageIdSelector","selections","annotatorCategoriesSelector","CategoryDialog","onSubmit","onConfirm","onNameChange","DialogConfirm","DialogBody","DialogOuter","updatedCategories","soundEnabledSelector","categoryNames","selectedAnnotationsIdsSelector","ImageMenu","anchorElImageMenu","onCloseImageMenu","openImageMenu","currentImageId","keepMounted","JSZip","all","DeleteAllAnnotationsDialog","allSerializedAnnotationsSelector","columns","serializedAnnotations","join","SaveProjectFileMenuItem","handleCloseMenu","ExportAnnotationsAsLabeledInstancesMenuItem","ExportAnnotationsAsMatrixMenuItem","ExportAnnotationsAsLabeledSemanticMasksMenuItem","ExportAnnotationsAsBinarySemanticMasksMenuItem","ExportAnnotationsAsBinaryInstancesMenuItem","handleClose","OpenImageMenuItem","onOpenImage","OpenProjectFileMenuItem","annotatorImagesSelector","ExampleImageDialog","categories_in","examples","description","malaria","malariaAnnotations","cellpainting","cellpaintingAnnotations","role","example","newAnnotations","serializedAnnotation","secondary","OpenExampleImageMenuItem","CollapsibleHelpContent","KeyboardKey","letter","paddingInline","whiteSpace","borderColor","borderStyle","HelpWindowToolIcon","SvgIcon","HelpWindowToolTitle","toolName","alignItems","_excluded","_extends","assign","arguments","key","prototype","hasOwnProperty","call","apply","_objectWithoutProperties","excluded","sourceKeys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","SvgCheckboxChecked","_ref","svgRef","titleId","viewBox","xmlns","xmlnsXlink","stroke","strokeWidth","fillRule","strokeLinecap","strokeLinejoin","ForwardRef","SvgCheckboxUnchecked","SvgColorAdjustment","SvgColorAnnotation","SvgEllipticalAnnotation","SvgHand","SvgLassoAnnotation","SvgMagneticAnnotation","SvgObjectAnnotation","SvgFreehandAnnotation","SvgPolygonalAnnotation","SvgQuickAnnotation","SvgRadioChecked","SvgRadioUnchecked","SvgRectangularAnnotation","SvgSelection","SvgZoom","ManipulatingCanvasContent","OpeningImagesHelpContent","CreatingCategoriesContent","MakingNewAnnotationsHelpContent","ChangingAnnotationsHelpContent","SavingProjectHelpContent","HelpDrawer","bottom","setState","toggleDrawer","float","ClearCategoryDialog","createdAnnotatorCategoriesSelector","ExitAnnotatorDialog","createdCategories","selectedCategory","selectedAnnotationsIds","categoryCounts","annotatorImages","projectImages","currentImage","onCloseClearCategoryDialog","openClearCategoryDialog","onCloseDeleteAllAnnotationsDialog","onOpenDeleteAllAnnotationsDialog","openDeleteAllAnnotationsDialog","onCloseExitAnnotatorDialog","onOpenExitAnnotatorDialog","openExitAnnotatorDialog","imageAnchorEl","setImageAnchorEl","onCategoryClick","onCategoryMenuOpen","onCategoryMenuClose","onImageItemClick","evt","unselectedImages","updatedAnnotatorImages","onImageMenuOpen","SendFeedbackDialog","onSend","input","setInput","DialogContentText","rel","multiline","rows","url","encodeURIComponent","AnnotationModeTooltip","NewTooltip","AddTooltip","SubtractTooltip","IntersectionTooltip","AnnotationMode","annotationMode","onClickLabel","RadioGroup","subheader","ListItemButton","Radio","Add","Subtract","Intersect","InformationBox","disableGutters","SvgInvertAnnotation","selectedAnnotationSelector","InvertAnnotation","annotationTool","RectangularAnnotationOptions","EllipticalAnnotationOptions","FreehandAnnotationOptions","penSelectionBrushSizeBrushSize","changed","LassoAnnotationOptions","PolygonalAnnotationOptions","MagneticAnnotationOptions","ColorAnnotationOptions","QuickAnnotationOptions","setBrushSize","onChangeCommitted","ObjectAnnotationOptions","offsetSelector","ResetButton","ZoomOptions","onModeClick","onSliderChange","valueLabelDisplay","Out","centerOffset","HandToolOptions","channelsSelector","imageShapeSelector","ChannelsList","displayedValues","updateDisplayedValues","imageShape","visibleChannelsIndices","channel","reduce","concat","values","debounce","copiedValues","updatedChannels","onCheckboxChanged","updated","copiedChannels","colorAdjustmentSlider","displayedValue","handleSliderChange","sliders","allSliders","activeImagePlaneSelector","activeImageSelector","ZStackSlider","marks","ColorAdjustmentOptions","setDisplayedValues","generateDefaultChannels","selectedAnnotationsSelector","unselectedAnnotationsSelector","PointerSelectionOptions","unselectedAnnotations","allAnnotations","desiredAnnotations","onSelectCategory","ToolOptions","activeOperation","operations","method","ColorAdjustment","Hand","ToolBarToolTitle","TooltipCard","Card","CardActionArea","CardContent","Tools","OperationType","scaledImageHeightSelector","forwardRef","useImage","filters","setFilters","isEqual","clearCache","IntensityFilter","scaleIntensity","createIntensityFilter","cache","ReactKonva","EllipticalSelection","dash","radiusX","radiusY","LassoSelection","MagneticSelection","ObjectSelection","PolygonalSelection","RectangularSelection","ColorSelection","QuickSelection","PenSelection","lineJoin","lineCap","ZoomSelection","Selection","tool","Selecting","ColorAnnotationToolTip","setText","Layer","setPosition","imageSmoothingEnabled","imageWidthSelector","imageHeightSelector","cursorSelector","Transformer","transformPosition","transformerRef","useRef","boundBox","setBoundBox","rotation","startBox","setStartBox","setCenter","useSound","createAnnotationSoundEffect","playCreateAnnotationSoundEffect","deleteAnnotationSoundEffect","playDeleteAnnotationSoundEffect","getRelativeBox","relativePosition","updateSelectedAnnotation","updatedAnnotation","clearAnnotations","deselect","onMouseEnter","getStage","onMouseLeave","posX","posY","boundBoxFunc","oldBox","newBox","relativeNewBox","onTransform","oppositeAnchorPosition","getActiveAnchor","findOne","getOppositeAnchorPosition","scaledOppositeAnchorPosition","relativeStartBox","onTransformEnd","relativeBoundBox","scaleX","scaleY","roiX","roiY","resizedMaskROI","preserveAspectRatio","scaledOffset","el","getScaledCoordinate","resizedMask","onTransformStart","rotateEnabled","detach","getLayer","batchDraw","cornerRadius","shadowColor","shadowBlur","shadowOffset","Transformers","stagePositionSelector","PenAnnotationToolTip","annotating","currentPosition","strokewidth","visibleCategoriesSelector","toRGBA","Annotation","setImageMask","ConfirmedAnnotations","visibleAnnotations","setVisibleAnnotations","SelectedAnnotation","overlayMask","SelectedAnnotations","Annotations","pointerSelectionSelector","PointerSelection","currentIndexSelector","usePointer","overlappingAnnotationsIds","shift","setShift","useHotkeys","hotkeys","keyup","keydown","currentAnnotation","scaledCurrentPosition","getOverlappingAnnotations","nextAnnotationId","onMouseDown","onMouseUp","annotationsInBox","getAnnotationsInBox","additionalAnnotations","onMouseMove","onPointerClick","Stage","imageRef","stageRef","selectingRef","saveLabelRef","clearLabelRef","setCurrentPosition","scaledImageWidth","scaledImageHeight","zoomAndOffset","scaleBy","zoomIn","selectedWidth","onWheel","deltaY","useZoom","onZoomDeselect","onZoomMouseUp","onZoomMouseMove","onZoomMouseDown","onZoomWheel","onPointerMouseDown","onPointerMouseMove","onPointerMouseUp","useReducer","onBlur","useWindowFocusHandler","deselectAllTransformers","tr","deselectAllAnnotations","deselectAnnotation","transformerId","transformer","detachTransformer","useCursor","useMemo","annotate","registerOnAnnotatedHandler","registerOnAnnotatingHandler","registerOnDeselectHandler","line","nodes","layer","getRelativePointerPosition","getAbsoluteTransform","copy","memoizedOnMouseDown","throttled","getPointerPosition","relative","getText","rawImagePosition","func","connect","setTool","useKeyboardShortcuts","draggable","setDraggable","useHandTool","store","useStore","getParent","className","DndProvider","backend","HTML5Backend","Content","useLayoutEffect","getBoundingClientRect","useResizeObserver","entry","contentRect","useBoundingClientRect","default","ImageViewer","AnnotatorView","lightTheme","createTheme","MuiListItemIcon","styleOverrides","root","darkTheme","MuiDrawer","paperAnchorDockedLeft","borderRight","paperAnchorDockedRight","borderLeft","paper","MuiListItem","MuiSlider","rail","thumb","track","Application","prefersDarkMode","useMediaQuery","setTheme","usePreferredTheme","StyledEngineProvider","injectFirst","ThemeProvider","element","reducer","combineReducers","annotationStateChangeSaga","select","put","combinedMask","combinedBoundingBox","subtract","intersect","watchAnnotationStateChangeSaga","takeEvery","selectedCategorySaga","watchSelectedCategorySaga","opened","AbsoluteDifference","CosineDistance","Hinge","Huber","Log","MeanSquaredError","SigmoidCrossEntropy","metric","BinaryAccuracy","BinaryCrossEntropy","CosineProximity","MeanAbsoluteError","MeanAbsolutePercentageError","Precision","Recall","SparseCategoricalAccuracy","Adadelta","adadelta","Adagrad","adagrad","Adamax","adamax","RMSProp","rmsprop","StochasticGradientDescent","sgd","compiledMetrics","getElementById","tfvis","modelSummary","args","callbacks","fitCallbacks","validationData","val","fitDataset","train","createSimpleCNN","numClasses","conv2d","kernelSize","strides","activation","kernelInitializer","maxPooling2d","poolSize","flatten","units","changeInputShape","newModel","inputLayer","SerializationMap","getMap","classNameMap","layers","getClassName","cls","fromConfig","cfg","getConfig","newlayer","setWeights","getWeights","createMobileNet","input_shape","freeze","useCustomTopLayer","resource","mobilenet","layerName","backbone","l","trainable","globalAveragePooling2d","numfeat","outputShape","reshape","targetShape","dropout","rate","classes","decodeCategory","ys","decodeImage","fetch","fetched","resized","generator","preprocess","trainImages","valImages","trainData","mapAsync","bind","valData","trainImagesSelector","valImagesSelector","fitSaga","compileOptions","compiledModel","watchFitSaga","preprocess_predict","predictCategories","forEachAsync","dataSync","testImagesSelector","predictSaga","testImages","outputs","watchPredictSaga","rootSaga","classifierEffects","fork","annotaterEffects","saga","createSagaMiddleware","devTools","enhancers","Sentry","middleware","logger","thunk","preloadedState","productionStore","configureStore","run","ReactDOM","render"],"mappings":"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","file":"static/js/main.783ffb63.chunk.js","sourcesContent":["export enum ThemeMode {\n  Light = \"light\",\n  Dark = \"dark\",\n}\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { Settings } from \"../../types/Settings\";\nimport { ThemeMode } from \"types/ThemeMode\";\n\nconst initialState: Settings = {\n  selectedImages: [],\n  tileSize: 1,\n  themeMode: ThemeMode.Light,\n};\n\nexport const applicationSlice = createSlice({\n  name: \"settings\",\n  initialState: initialState,\n  reducers: {\n    updateTileSize(\n      state: Settings,\n      action: PayloadAction<{ newValue: number }>\n    ) {\n      state.tileSize = action.payload.newValue!;\n    },\n    selectImage(state: Settings, action: PayloadAction<{ id: string }>) {\n      state.selectedImages.push(action.payload.id);\n    },\n    selectOneImage(state: Settings, action: PayloadAction<{ id: string }>) {\n      state.selectedImages = [];\n\n      state.selectedImages.push(action.payload.id);\n    },\n    selectAllImages(\n      state: Settings,\n      action: PayloadAction<{ ids: Array<string> }>\n    ) {\n      state.selectedImages = [];\n\n      state.selectedImages = action.payload.ids;\n    },\n    deselectImage(state: Settings, action: PayloadAction<{ id: string }>) {\n      state.selectedImages = state.selectedImages.filter(\n        (id: string) => id !== action.payload.id\n      );\n    },\n    deselectImages(\n      state: Settings,\n      action: PayloadAction<{ ids: Array<string> }>\n    ) {\n      state.selectedImages = state.selectedImages.filter(\n        (id: string) => !action.payload.ids.includes(id)\n      );\n    },\n    clearSelectedImages(state: Settings) {\n      state.selectedImages = [];\n    },\n    setThemeMode(state: Settings, action: PayloadAction<{ mode: ThemeMode }>) {\n      state.themeMode = action.payload.mode;\n    },\n  },\n});\n\nexport const {\n  updateTileSize,\n  selectImage,\n  selectOneImage,\n  deselectImage,\n  deselectImages,\n  clearSelectedImages,\n  setThemeMode,\n} = applicationSlice.actions;\n","export enum LossFunction {\n  AbsoluteDifference = \"Absolute difference\",\n  CategoricalCrossEntropy = \"Categorical cross entropy\",\n  CosineDistance = \"Cosine distance\",\n  Hinge = \"Hinge\",\n  Huber = \"Huber\",\n  Log = \"Log\",\n  MeanSquaredError = \"Mean squared error (MSE)\",\n  SigmoidCrossEntropy = \"Sigmoid cross entropy\",\n}\n","export enum Metric {\n  BinaryAccuracy = \"Binary accuracy\",\n  BinaryCrossEntropy = \"Binary cros-sentropy\",\n  CategoricalAccuracy = \"Categorical accuracy\",\n  CategoricalCrossEntropy = \"Categorical cross-entropy\",\n  CosineProximity = \"Cosine proximity\",\n  MeanAbsoluteError = \"Mean absolute error (MAE)\",\n  MeanAbsolutePercentageError = \"Mean absolute percentage error\",\n  MeanSquaredError = \"Mean squared error\",\n  Precision = \"Precision\",\n  Recall = \"Recall\",\n  SparseCategoricalAccuracy = \"Sparse categorical accuracy\",\n}\n","export enum OptimizationAlgorithm {\n  Adadelta = \"Adadelta\",\n  Adagrad = \"Adagrad\",\n  Adam = \"Adam\",\n  Adamax = \"Adamax\",\n  Momentum = \"Momentum\",\n  RMSProp = \"RMSProp\",\n  StochasticGradientDescent = \"Stochastic gradient descent (SGD)\",\n}\n","export enum ModelType {\n  SimpleCNN,\n  MobileNet,\n  UserUploaded,\n}\n\ntype ModelProps = {\n  modelName: string;\n  requiredChannels?: number;\n  modelType: ModelType;\n};\n\ninterface UserUploadedModelProps extends ModelProps {\n  src: string;\n}\n\ninterface DefaultModelProps extends ModelProps {}\n\nexport type ClassifierModelProps = UserUploadedModelProps | DefaultModelProps;\n\nexport const availableModels: ClassifierModelProps[] = [\n  {\n    modelName: \"SimpleCNN\",\n    modelType: ModelType.SimpleCNN,\n  },\n  {\n    modelName: \"MobileNet\",\n    requiredChannels: 3,\n    modelType: ModelType.MobileNet,\n  },\n];\n","export enum ToolType {\n  ColorAdjustment,\n  ColorAnnotation,\n  EllipticalAnnotation,\n  Hand,\n  LassoAnnotation,\n  MagneticAnnotation,\n  ObjectAnnotation,\n  PenAnnotation,\n  Pointer,\n  PolygonalAnnotation,\n  QuickAnnotation,\n  RectangularAnnotation,\n  Zoom,\n}\n","export enum AnnotationModeType {\n  Add,\n  Intersect,\n  New,\n  Subtract,\n}\n","export enum AnnotationStateType {\n  Blank, // not yet annotating\n  Annotating,\n  Annotated,\n}\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { Classifier } from \"../../types/Classifier\";\nimport { LossFunction } from \"../../types/LossFunction\";\nimport { Metric } from \"../../types/Metric\";\nimport { OptimizationAlgorithm } from \"../../types/OptimizationAlgorithm\";\nimport * as tensorflow from \"@tensorflow/tfjs\";\nimport { History, LayersModel } from \"@tensorflow/tfjs\";\nimport { Shape } from \"../../types/Shape\";\nimport { RescaleOptions } from \"../../types/RescaleOptions\";\nimport {\n  availableModels,\n  ClassifierModelProps,\n} from \"../../types/ClassifierModelType\";\n\nconst initialState: Classifier = {\n  evaluating: false,\n  inputShape: {\n    height: 256,\n    width: 256,\n    channels: 3,\n    planes: 1,\n    frames: 1,\n  },\n  fitOptions: {\n    epochs: 10,\n    batchSize: 32,\n    initialEpoch: 0,\n    shuffle: true,\n  },\n  fitting: false,\n  learningRate: 0.01,\n  lossFunction: LossFunction.CategoricalCrossEntropy,\n  selectedModel: availableModels[0],\n  metrics: [Metric.CategoricalAccuracy],\n  optimizationAlgorithm: OptimizationAlgorithm.Adam,\n  predicting: false,\n  rescaleOptions: {\n    rescale: true,\n    rescaleMinMax: { min: 0, max: 1 },\n  },\n  trainingPercentage: 0.75,\n};\n\nexport const classifierSlice = createSlice({\n  name: \"classifier\",\n  initialState: initialState,\n  reducers: {\n    fit(\n      state,\n      action: PayloadAction<{\n        onEpochEnd: any;\n      }>\n    ) {\n      state.fitting = true;\n    },\n    predict(state, action: PayloadAction<{}>) {\n      state.predicting = true;\n    },\n    setClassifier(\n      state,\n      action: PayloadAction<{\n        classifier: Classifier;\n      }>\n    ) {\n      const { classifier } = action.payload;\n\n      state.fitOptions = classifier.fitOptions;\n      state.inputShape = classifier.inputShape;\n      state.learningRate = classifier.learningRate;\n      state.lossFunction = classifier.lossFunction;\n      state.metrics = classifier.metrics;\n\n      state.optimizationAlgorithm = classifier.optimizationAlgorithm;\n      state.trainingPercentage = classifier.trainingPercentage;\n\n      //initialize all others to false/undefined, since we are essentially initializing a new classifier\n      state.selectedModel = availableModels[0];\n      state.evaluating = false;\n      state.evaluations = classifier.evaluations;\n      state.fitting = false;\n      state.history = classifier.history;\n      state.predicting = false;\n      state.predictions = classifier.predictions;\n    },\n    updateBatchSize(state, action: PayloadAction<{ batchSize: number }>) {\n      const { batchSize } = action.payload;\n\n      state.fitOptions.batchSize = batchSize;\n    },\n    updateCompiled(state, action: PayloadAction<{ compiled: LayersModel }>) {\n      const { compiled } = action.payload;\n\n      state.compiled = compiled;\n    },\n    updateEpochs(state, action: PayloadAction<{ epochs: number }>) {\n      const { epochs } = action.payload;\n\n      state.fitOptions.epochs = epochs;\n    },\n    updateFitted(\n      state,\n      action: PayloadAction<{ fitted: LayersModel; status: History }>\n    ) {\n      const { fitted, status } = action.payload;\n\n      state.fitted = fitted;\n\n      state.history = status;\n\n      state.fitting = false;\n    },\n    addFitted(state, action: PayloadAction<{ fitted: LayersModel }>) {\n      const { fitted } = action.payload;\n\n      state.fitted = fitted;\n    },\n    updateInputShape(state, action: PayloadAction<{ inputShape: Shape }>) {\n      state.inputShape = action.payload.inputShape;\n    },\n    updateLearningRate(state, action: PayloadAction<{ learningRate: number }>) {\n      const { learningRate } = action.payload;\n\n      state.learningRate = learningRate;\n    },\n    updateLossFunction(\n      state,\n      action: PayloadAction<{ lossFunction: LossFunction }>\n    ) {\n      const { lossFunction } = action.payload;\n\n      state.lossFunction = lossFunction;\n    },\n    updateMetrics(state, action: PayloadAction<{ metrics: Array<Metric> }>) {\n      const { metrics } = action.payload;\n\n      state.metrics = metrics;\n    },\n    updateSelectedModel(\n      state,\n      action: PayloadAction<{ model: ClassifierModelProps }>\n    ) {\n      state.selectedModel = action.payload.model;\n    },\n    uploadUserSelectedModel(\n      state,\n      action: PayloadAction<{\n        inputShape: Shape;\n        modelSelection: ClassifierModelProps;\n        model: LayersModel;\n      }>\n    ) {\n      state.inputShape = action.payload.inputShape;\n      state.fitted = action.payload.model;\n      state.compiled = action.payload.model;\n      state.selectedModel = action.payload.modelSelection;\n      state.userUploadedModel = action.payload.modelSelection;\n    },\n    updateOptimizationAlgorithm(\n      state,\n      action: PayloadAction<{ optimizationAlgorithm: OptimizationAlgorithm }>\n    ) {\n      const { optimizationAlgorithm } = action.payload;\n\n      state.optimizationAlgorithm = optimizationAlgorithm;\n    },\n    updatePreprocessed(\n      state,\n      action: PayloadAction<{\n        data: tensorflow.data.Dataset<{\n          xs: tensorflow.Tensor;\n          ys: tensorflow.Tensor;\n        }>;\n      }>\n    ) {\n      const { data } = action.payload;\n\n      state.data = data;\n    },\n    updateRescaleOptions(\n      state,\n      action: PayloadAction<{ rescaleOptions: RescaleOptions }>\n    ) {\n      state.rescaleOptions = action.payload.rescaleOptions;\n    },\n    updateTrainingPercentage(\n      state,\n      action: PayloadAction<{ trainingPercentage: number }>\n    ) {\n      const { trainingPercentage } = action.payload;\n\n      state.trainingPercentage = trainingPercentage;\n    },\n  },\n});\n\nexport const {\n  fit,\n  updateBatchSize,\n  updateCompiled,\n  updateEpochs,\n  updateFitted,\n  updateLearningRate,\n  updateLossFunction,\n  updateMetrics,\n  updateOptimizationAlgorithm,\n  updatePreprocessed,\n  updateTrainingPercentage,\n} = classifierSlice.actions;\n","export type Category = {\n  color: string;\n  id: string;\n  name: string;\n  visible: boolean;\n};\n\nexport const UNKNOWN_CATEGORY_ID: string =\n  \"00000000-0000-0000-0000-000000000000\";\n","export default __webpack_public_path__ + \"static/media/cell-painting.f118ef08.png\";","export enum LanguageType {\n  Arabic = \"Arabic\",\n  English = \"English\",\n  Farsi = \"Farsi\",\n  Finnish = \"Finnish\",\n  French = \"French\",\n  German = \"German\",\n  Greek = \"Greek\",\n  Hindi = \"Hindi\",\n  Hungarian = \"Hungarian\",\n  Spanish = \"Spanish\",\n}\n","export const enum Partition {\n  Training = \"Training\",\n  Validation = \"Validation\",\n  Inference = \"Inference\",\n}\n","/*\n * Run-length encoding\n */\n\nexport const decode = (encoded: Array<number>): Uint8ClampedArray => {\n  let decoded = [];\n\n  let background = true;\n\n  for (let i = 0; i < encoded.length; i++) {\n    for (let j = 0; j < encoded[i]; j++) {\n      decoded.push(background ? 0 : 255);\n    }\n\n    background = !background;\n  }\n\n  return new Uint8ClampedArray(decoded);\n};\n\nexport const encode = (\n  decoded: Uint8Array | Uint8ClampedArray\n): Array<number> => {\n  let lastElement = decoded[0];\n\n  let lastSequenceSize = 1;\n\n  let encoded = [];\n\n  if (decoded[0] === 255) {\n    encoded.push(0);\n  }\n\n  for (let i = 1; i < decoded.length; i++) {\n    if (lastElement !== decoded[i]) {\n      encoded.push(lastSequenceSize);\n\n      lastElement = decoded[i];\n\n      lastSequenceSize = 1;\n    } else {\n      lastSequenceSize += 1;\n    }\n  }\n\n  encoded.push(lastSequenceSize);\n\n  return encoded;\n};\n\nexport const fromString = (s: Array<number>) => {\n  let counts = [];\n  let m = 0;\n  let p = 0;\n  let k;\n  let x;\n  let more;\n\n  while (s[p]) {\n    x = 0;\n    k = 0;\n    more = 1;\n\n    while (more) {\n      let c = s[p] - 48;\n      x = x | ((c & 0x1f) << (5 * k));\n      more = c & 0x20;\n      p += 1;\n      k += 1;\n\n      if (!more && c & 0x10) {\n        x = x | (-1 << (5 * k));\n      }\n    }\n\n    if (m > 2) {\n      x += counts[m - 2];\n    }\n\n    counts[m++] = x;\n  }\n\n  return counts;\n};\n\nexport const toImageData = (\n  decoded: Uint8ClampedArray,\n  width: number,\n  height: number\n) => {\n  let data = [];\n\n  for (let i = 0; i < decoded.length; i++) {\n    data.push(...[decoded[i], decoded[i], decoded[i], 255]);\n  }\n\n  const clamped = new Uint8ClampedArray(data);\n\n  return new ImageData(clamped, width, height);\n};\n","import * as _ from \"lodash\";\nimport * as ImageJS from \"image-js\";\nimport { AnnotationType } from \"../types/AnnotationType\";\nimport { decode } from \"../annotator/image/rle\";\nimport { Category, UNKNOWN_CATEGORY_ID } from \"../types/Category\";\nimport { SerializedAnnotationType } from \"../types/SerializedAnnotationType\";\nimport { saveAs } from \"file-saver\";\nimport { ShapeType } from \"../types/ShapeType\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { Partition } from \"../types/Partition\";\nimport { Image as ImageType } from \"../types/Image\";\n\nexport const convertFileToImage = async (file: File): Promise<ImageType> => {\n  /**\n   * Returns image to be provided to dispatch\n   * **/\n  return new Promise((resolve, reject) => {\n    return file.arrayBuffer().then((buffer) => {\n      ImageJS.Image.load(buffer).then((image: ImageJS.Image) => {\n        resolve(convertImageJStoImage(image, file.name));\n      });\n    });\n  });\n};\n\nexport const convertImageJStoImage = (\n  image: ImageJS.Image,\n  filename: string\n): ImageType => {\n  /**\n   * Given an ImageJS Image object, construct appropriate Image type. Return Image.\n   * returns: the image of Image type\n   * **/\n\n  let nplanes = 1;\n  let height: number;\n  let width: number;\n  let imageData: Array<string> = [];\n  let channels: number;\n\n  if (Array.isArray(image)) {\n    //case where user uploaded a z-stack\n    nplanes = image.length;\n    height = image[0].height;\n    width = image[0].width;\n    channels = image[0].components;\n    for (let j = 0; j < nplanes; j++) {\n      imageData.push(\n        image[j].toDataURL(\"image/png\", {\n          useCanvas: true,\n        })\n      );\n    }\n  } else {\n    imageData = [\n      image.toDataURL(\"image/png\", {\n        useCanvas: true,\n      }),\n    ];\n    height = image.height;\n    width = image.width;\n    channels = image.components;\n  }\n\n  const shape: ShapeType = {\n    channels: channels,\n    frames: 1,\n    height: height,\n    planes: nplanes,\n    width: width,\n  };\n\n  return {\n    categoryId: UNKNOWN_CATEGORY_ID,\n    id: uuidv4(),\n    annotations: [],\n    name: filename,\n    shape: shape,\n    originalSrc: imageData,\n    partition: Partition.Inference,\n    src: imageData[Math.floor(nplanes / 2)],\n  };\n};\n\nexport const connectPoints = (\n  coordinates: Array<Array<number>>,\n  image: ImageJS.Image\n) => {\n  let connectedPoints: Array<Array<number>> = [];\n\n  const foo = _.filter(\n    _.zip(coordinates.slice(0, coordinates.length - 1), coordinates.slice(1)),\n    ([current, next]) => {\n      return !_.isEqual(current, next);\n    }\n  );\n  foo.forEach(([current, next]) => {\n    const points = drawLine(current!, next!);\n    connectedPoints = _.concat(connectedPoints, points);\n  });\n  return connectedPoints;\n};\n\nexport const drawLine = (p: Array<number>, q: Array<number>) => {\n  const coords: Array<Array<number>> = [];\n\n  let x: number,\n    y: number,\n    x1: number,\n    y1: number,\n    x2: number,\n    y2: number,\n    dx: number,\n    dy: number,\n    step: number,\n    i: number;\n\n  x1 = Math.round(p[0]);\n  y1 = Math.round(p[1]);\n  x2 = Math.round(q[0]);\n  y2 = Math.round(q[1]);\n\n  dx = x2 - x1;\n  dy = y2 - y1;\n\n  step = Math.abs(dy);\n\n  if (Math.abs(dx) >= Math.abs(dy)) {\n    step = Math.abs(dx);\n  }\n\n  dx = dx / step;\n  dy = dy / step;\n  x = x1;\n  y = y1;\n  i = 1;\n\n  while (i <= step) {\n    coords.push([Math.round(x), Math.round(y)]);\n    x = x + dx;\n    y = y + dy;\n    i = i + 1;\n  }\n\n  return coords;\n};\n\nexport const getIdx = (width: number, nchannels: number) => {\n  return (x: number, y: number, index: number) => {\n    index = index || 0;\n    return Math.floor((width * y + x) * nchannels + index);\n  };\n};\n\n/*\nGiven a click at a position, return all overlapping annotations ids\n */\nexport const getOverlappingAnnotations = (\n  position: { x: number; y: number },\n  annotations: Array<AnnotationType>,\n  imageWidth: number,\n  imageHeight: number\n) => {\n  const overlappingAnnotations = annotations.filter(\n    (annotation: AnnotationType) => {\n      const boundingBox = annotation.boundingBox;\n      if (\n        position.x >= boundingBox[0] &&\n        position.x <= boundingBox[2] &&\n        position.y >= boundingBox[1] &&\n        position.y <= boundingBox[3]\n      ) {\n        const boundingBoxWidth = boundingBox[2] - boundingBox[0];\n        const boundingBoxHeight = boundingBox[3] - boundingBox[1];\n        if (boundingBoxHeight && boundingBoxWidth) {\n          //return annotation if clicked on actual selected data\n          const maskROI = new ImageJS.Image(\n            boundingBox[2] - boundingBox[0],\n            boundingBox[3] - boundingBox[1],\n            decode(annotation.mask),\n            { components: 1, alpha: 0 }\n          );\n          if (\n            maskROI.getPixelXY(\n              Math.round(position.x - boundingBox[0]),\n              Math.round(position.y - boundingBox[1])\n            )[0]\n          )\n            return true;\n        }\n      }\n      return false;\n    }\n  );\n  return overlappingAnnotations.map((annotation: AnnotationType) => {\n    return annotation.id;\n  });\n};\n\nexport const getAnnotationsInBox = (\n  minimum: { x: number; y: number },\n  maximum: { x: number; y: number },\n  annotations: Array<AnnotationType>\n) => {\n  return annotations.filter((annotation: AnnotationType) => {\n    return (\n      minimum.x <= annotation.boundingBox[0] &&\n      minimum.y <= annotation.boundingBox[1] &&\n      maximum.x >= annotation.boundingBox[2] &&\n      maximum.y >= annotation.boundingBox[3]\n    );\n  });\n};\n\n/*\n * From encoded mask data, get the decoded data and return results as an HTMLImageElement to be used by Konva.Image\n * Warning: the mask produced from the decoded data is scaled to fit the stage.\n *          when creating an image from mask, the original width/height should be scaled by the same scale factor\n */\nexport const colorOverlayROI = (\n  encodedMask: Array<number>,\n  boundingBox: [number, number, number, number],\n  imageWidth: number,\n  imageHeight: number,\n  color: Array<number>,\n  scalingFactor: number\n): HTMLImageElement | undefined => {\n  if (!encodedMask) return undefined;\n\n  const decodedData = decode(encodedMask);\n\n  const endX = Math.min(imageWidth, boundingBox[2]);\n  const endY = Math.min(imageHeight, boundingBox[3]);\n\n  //extract bounding box params\n  const boxWidth = endX - boundingBox[0];\n  const boxHeight = endY - boundingBox[1];\n\n  if (!boxWidth || !boxHeight) return undefined;\n\n  const croppedImage = new ImageJS.Image(boxWidth, boxHeight, decodedData, {\n    components: 1,\n    alpha: 0,\n  }).resize({ factor: scalingFactor });\n\n  const colorROIImage = new ImageJS.Image(boxWidth, boxHeight, {\n    components: 3,\n    alpha: 1,\n  }).resize({ factor: scalingFactor });\n\n  const checkNeighbors = (\n    arr: ImageJS.Image,\n    x: number,\n    y: number\n  ): boolean => {\n    if (x === 0 || x === croppedImage.width - 1) return true;\n    for (let [dx, dy] of [\n      [0, 1],\n      [1, 0],\n      [0, -1],\n      [-1, 0],\n    ]) {\n      if (!arr.getPixelXY(x + dx, y + dy)[0]) return true;\n    }\n    return false;\n  };\n\n  for (let i = 0; i < croppedImage.width; i++) {\n    for (let j = 0; j < croppedImage.height; j++) {\n      if (croppedImage.getPixelXY(i, j)[0] > 0) {\n        if (checkNeighbors(croppedImage, i, j)) {\n          colorROIImage.setPixelXY(i, j, [color[0], color[1], color[2], 255]);\n        } else {\n          colorROIImage.setPixelXY(i, j, [color[0], color[1], color[2], 128]);\n        }\n      } else {\n        colorROIImage.setPixelXY(i, j, [0, 0, 0, 0]);\n      }\n    }\n  }\n\n  const src = colorROIImage.toDataURL(\"image-png\", {\n    useCanvas: true,\n  });\n  const image = new Image();\n  image.src = src;\n\n  return image;\n};\n\n/*\n * Method to rename a cateogry/image if a category/image with this name already exists\n * */\nexport const replaceDuplicateName = (name: string, names: Array<string>) => {\n  let currentName = name;\n  let i = 1;\n  while (names.includes(currentName)) {\n    currentName = name + `_${i}`;\n    i += 1;\n  }\n  return currentName;\n};\n\n/*\n * from https://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb\n * */\nconst hexToRgb = (hex: string) => {\n  var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n  return result\n    ? {\n        r: parseInt(result[1], 16),\n        g: parseInt(result[2], 16),\n        b: parseInt(result[3], 16),\n      }\n    : null;\n};\n\nexport const saveAnnotationsAsBinaryInstanceSegmentationMasks = (\n  images: Array<ImageType>,\n  categories: Array<Category>,\n  zip: any\n): any => {\n  images.forEach((current: ImageType) => {\n    current.annotations.forEach((annotation: AnnotationType) => {\n      const fullLabelImage = new ImageJS.Image(\n        current.shape.width,\n        current.shape.height,\n        new Uint8Array().fill(0),\n        { components: 1, alpha: 0 }\n      );\n      const encoded = annotation.mask;\n      const decoded = decode(encoded);\n      const boundingBox = annotation.boundingBox;\n      const endX = Math.min(current.shape.width, boundingBox[2]);\n      const endY = Math.min(current.shape.height, boundingBox[3]);\n\n      //extract bounding box params\n      const boundingBoxWidth = endX - boundingBox[0];\n      const boundingBoxHeight = endY - boundingBox[1];\n\n      const roiMask = new ImageJS.Image(\n        boundingBoxWidth,\n        boundingBoxHeight,\n        decoded,\n        {\n          components: 1,\n          alpha: 0,\n        }\n      );\n      for (let i = 0; i < boundingBoxWidth; i++) {\n        for (let j = 0; j < boundingBoxHeight; j++) {\n          if (roiMask.getPixelXY(i, j)[0] > 0) {\n            fullLabelImage.setPixelXY(\n              i + annotation.boundingBox[0],\n              j + annotation.boundingBox[1],\n              [255, 255, 255]\n            );\n          }\n        }\n      }\n      const blob = fullLabelImage.toBlob(\"image/png\");\n      const category = categories.find((category: Category) => {\n        return category.id === annotation.categoryId;\n      });\n      if (category) {\n        zip.folder(`${current.name}/${category.name}`);\n        zip.file(\n          `${current.name}/${category.name}/${annotation.id}.png`,\n          blob,\n          {\n            base64: true,\n          }\n        );\n      }\n    });\n  });\n  zip.generateAsync({ type: \"blob\" }).then((blob: Blob) => {\n    saveAs(blob, \"binary_instances.zip\");\n  });\n};\n\nexport const saveAnnotationsAsLabeledSemanticSegmentationMasks = (\n  images: Array<ImageType>,\n  categories: Array<Category>,\n  zip: any\n): any => {\n  images.forEach((current: ImageType) => {\n    const fullLabelImage = new ImageJS.Image(\n      current.shape.width,\n      current.shape.height,\n      new Uint8Array().fill(0),\n      { components: 1, alpha: 0 }\n    );\n    categories.forEach((category: Category) => {\n      const categoryColor = hexToRgb(category.color);\n      if (!categoryColor) return;\n\n      for (let annotation of current.annotations) {\n        if (annotation.categoryId !== category.id) continue;\n        const encoded = annotation.mask;\n        const decoded = decode(encoded);\n        const boundingBox = annotation.boundingBox;\n        const endX = Math.min(current.shape.width, boundingBox[2]);\n        const endY = Math.min(current.shape.height, boundingBox[3]);\n\n        //extract bounding box params\n        const boundingBoxWidth = endX - boundingBox[0];\n        const boundingBoxHeight = endY - boundingBox[1];\n\n        const roiMask = new ImageJS.Image(\n          boundingBoxWidth,\n          boundingBoxHeight,\n          decoded,\n          {\n            components: 1,\n            alpha: 0,\n          }\n        );\n        for (let i = 0; i < boundingBoxWidth; i++) {\n          for (let j = 0; j < boundingBoxHeight; j++) {\n            if (roiMask.getPixelXY(i, j)[0] > 0) {\n              fullLabelImage.setPixelXY(\n                i + annotation.boundingBox[0],\n                j + annotation.boundingBox[1],\n                [categoryColor.r, categoryColor.g, categoryColor.b]\n              );\n            }\n          }\n        }\n      }\n    });\n    const blob = fullLabelImage.toBlob(\"image/png\");\n    zip.file(`${current.name}.png`, blob, {\n      base64: true,\n    });\n  });\n  zip.generateAsync({ type: \"blob\" }).then((blob: Blob) => {\n    saveAs(blob, \"labeled_semantic.zip\");\n  });\n};\n\nexport const saveAnnotationsAsLabelMatrix = (\n  images: Array<ImageType>,\n  categories: Array<Category>,\n  zip: any,\n  random: boolean = false,\n  binary: boolean = false\n): Array<Promise<unknown>> => {\n  return images\n    .map((current: ImageType) => {\n      return categories.map((category: Category) => {\n        return new Promise((resolve, reject) => {\n          const fullLabelImage = new ImageJS.Image(\n            current.shape.width,\n            current.shape.height,\n            new Uint8Array().fill(0),\n            { components: 1, alpha: 0 }\n          );\n          let r = binary ? 255 : 1;\n          let g = binary ? 255 : 1;\n          let b = binary ? 255 : 1;\n          for (let annotation of current.annotations) {\n            if (random) {\n              r = Math.round(Math.random() * 255);\n              g = Math.round(Math.random() * 255);\n              b = Math.round(Math.random() * 255);\n            } else if (!binary) {\n              r = r + 1;\n              b = b + 1;\n              g = g + 1;\n            }\n            if (annotation.categoryId !== category.id) continue;\n            const encoded = annotation.mask;\n            const decoded = decode(encoded);\n            const boundingBox = annotation.boundingBox;\n            const endX = Math.min(current.shape.width, boundingBox[2]);\n            const endY = Math.min(current.shape.height, boundingBox[3]);\n\n            //extract bounding box params\n            const boundingBoxWidth = endX - boundingBox[0];\n            const boundingBoxHeight = endY - boundingBox[1];\n\n            const roiMask = new ImageJS.Image(\n              boundingBoxWidth,\n              boundingBoxHeight,\n              decoded,\n              {\n                components: 1,\n                alpha: 0,\n              }\n            );\n            for (let i = 0; i < boundingBoxWidth; i++) {\n              for (let j = 0; j < boundingBoxHeight; j++) {\n                if (roiMask.getPixelXY(i, j)[0] > 0) {\n                  fullLabelImage.setPixelXY(\n                    i + annotation.boundingBox[0],\n                    j + annotation.boundingBox[1],\n                    [r, g, b]\n                  );\n                }\n              }\n            }\n          }\n          const blob = fullLabelImage.toBlob(\"image/png\");\n          zip.folder(`${current.name}`);\n          zip.file(`${current.name}/${category.name}.png`, blob, {\n            base64: true,\n          });\n          resolve(true);\n        });\n      });\n    })\n    .flat();\n};\n\nexport const importSerializedAnnotations = (\n  annotation: SerializedAnnotationType,\n  existingCategories: Array<Category>\n): { annotation_out: AnnotationType; categories: Array<Category> } => {\n  const mask = annotation.annotationMask\n    .split(\" \")\n    .map((x: string) => parseInt(x));\n\n  let newCategories = existingCategories;\n  //if category does not already exist in state, add it\n  if (\n    !existingCategories\n      .map((category: Category) => category.id)\n      .includes(annotation.annotationCategoryId)\n  ) {\n    const category: Category = {\n      color: annotation.annotationCategoryColor,\n      id: annotation.annotationCategoryId,\n      name: annotation.annotationCategoryName,\n      visible: true,\n    };\n    newCategories = [...newCategories, category];\n  }\n\n  let annotationPlane = annotation.annotationPlane;\n\n  if (!annotationPlane) {\n    annotationPlane = 0;\n  }\n\n  return {\n    annotation_out: {\n      boundingBox: [\n        annotation.annotationBoundingBoxX,\n        annotation.annotationBoundingBoxY,\n        annotation.annotationBoundingBoxWidth,\n        annotation.annotationBoundingBoxHeight,\n      ],\n      categoryId: annotation.annotationCategoryId,\n      id: annotation.annotationId,\n      mask: mask,\n      plane: annotationPlane,\n    },\n    categories: newCategories,\n  };\n};\n","export enum Task {\n  Classify,\n  Segment,\n  Annotate,\n}\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { Image } from \"../../types/Image\";\nimport { Category, UNKNOWN_CATEGORY_ID } from \"../../types/Category\";\nimport { ToolType } from \"../../types/ToolType\";\nimport { AnnotationType } from \"../../types/AnnotationType\";\nimport { AnnotationModeType } from \"../../types/AnnotationModeType\";\nimport { AnnotationStateType } from \"../../types/AnnotationStateType\";\nimport colorImage from \"../../images/cell-painting.png\";\nimport { LanguageType } from \"../../types/LanguageType\";\nimport * as tensorflow from \"@tensorflow/tfjs\";\nimport { ImageViewer } from \"../../types/ImageViewer\";\nimport { SerializedAnnotationType } from \"../../types/SerializedAnnotationType\";\nimport { ChannelType } from \"../../types/ChannelType\";\nimport { SerializedFileType } from \"../../types/SerializedFileType\";\nimport {\n  importSerializedAnnotations,\n  replaceDuplicateName,\n} from \"../../image/imageHelper\";\nimport * as _ from \"lodash\";\nimport { Partition } from \"../../types/Partition\";\nimport { AnnotationTool } from \"../../annotator/image/Tool\";\n\nconst initialImage =\n  process.env.NODE_ENV === \"development\" ||\n  process.env.NODE_ENV === \"production\"\n    ? {\n        activePlane: 0,\n        avatar: colorImage,\n        categoryId: UNKNOWN_CATEGORY_ID,\n        id: \"f8eecf66-8776-4e14-acd2-94b44603a1a7\",\n        annotations: [],\n        name: \"example.png\",\n        partition: Partition.Inference,\n        shape: {\n          channels: 3,\n          frames: 1,\n          height: 512,\n          planes: 1,\n          width: 512,\n        },\n        originalSrc: [colorImage],\n        src: colorImage,\n      }\n    : undefined;\n\nconst initialCategories =\n  process.env.NODE_ENV === \"development\" ||\n  process.env.NODE_ENV === \"production\"\n    ? [\n        {\n          color: \"#AAAAAA\",\n          id: UNKNOWN_CATEGORY_ID,\n          name: \"Unknown\",\n          visible: true,\n        },\n        {\n          color: \"#a08cd2\",\n          id: \"00000000-0000-0000-0000-000000000001\",\n          name: \"Cell membrane\",\n          visible: true,\n        },\n        {\n          color: \"#b8ddf3\",\n          id: \"00000000-0000-0000-0000-000000000002\",\n          name: \"Cell nucleus\",\n          visible: true,\n        },\n      ]\n    : [\n        {\n          color: \"#AAAAAA\",\n          id: UNKNOWN_CATEGORY_ID,\n          name: \"Unknown\",\n          visible: true,\n        },\n      ];\n\nconst initialState: ImageViewer = {\n  annotationState: AnnotationStateType.Blank,\n  boundingClientRect: new DOMRect(),\n  brightness: 0,\n  categories: initialCategories.length > 0 ? initialCategories : [],\n  channels: [\n    //R, G, and B channels by default\n    {\n      range: [0, 255],\n      visible: true,\n    },\n    {\n      range: [0, 255],\n      visible: true,\n    },\n    {\n      range: [0, 255],\n      visible: true,\n    },\n  ],\n  currentIndex: 0,\n  cursor: \"default\",\n  contrast: 0,\n  exposure: 0,\n  hue: 0,\n  activeImageId: initialImage ? initialImage.id : undefined,\n  activeImagePlane: 0,\n  images: initialImage ? [initialImage] : [],\n  language: LanguageType.English,\n  offset: { x: 0, y: 0 },\n  penSelectionBrushSize: 32,\n  pointerSelection: {\n    dragging: false,\n    minimum: undefined,\n    maximum: undefined,\n    selecting: false,\n  },\n  quickSelectionBrushSize: 40,\n  saturation: 0,\n  selectedAnnotation: undefined,\n  selectedAnnotations: [],\n  selectedCategoryId: UNKNOWN_CATEGORY_ID,\n  selectionMode: AnnotationModeType.New,\n  soundEnabled: true,\n  stageHeight: 1000,\n  stageScale: 1,\n  stageWidth: 1000,\n  stagePosition: { x: 0, y: 0 },\n  toolType: ToolType.RectangularAnnotation,\n  vibrance: 0,\n  zoomSelection: {\n    dragging: false,\n    minimum: undefined,\n    maximum: undefined,\n    selecting: false,\n  },\n};\n\nexport const imageViewerSlice = createSlice({\n  initialState: initialState,\n  name: \"image-viewer-application\",\n  reducers: {\n    addImages(\n      state: ImageViewer,\n      action: PayloadAction<{ newImages: Array<Image> }>\n    ) {\n      //we look for image name duplicates and append number if such duplicates are found\n      const imageNames = state.images.map((image: Image) => {\n        return image.name.split(\".\")[0];\n      });\n      const updatedImages = action.payload.newImages.map((image: Image) => {\n        const initialName = image.name.split(\".\")[0]; //get name before file extension\n        //add filename extension to updatedName\n        const updatedName =\n          replaceDuplicateName(initialName, imageNames) +\n          \".\" +\n          image.name.split(\".\")[1];\n        return { ...image, name: updatedName };\n      });\n\n      state.images.push(...updatedImages);\n    },\n    clearCategoryAnnotations(\n      state: ImageViewer,\n      action: PayloadAction<{ category: Category }>\n    ) {\n      for (let image of state.images) {\n        image.annotations = image.annotations.filter(\n          (annotation: AnnotationType) => {\n            return annotation.categoryId !== action.payload.category.id;\n          }\n        );\n      }\n    },\n    deleteCategory(\n      state: ImageViewer,\n      action: PayloadAction<{ category: Category }>\n    ) {\n      state.categories = state.categories.filter(\n        (category: Category) => category.id !== action.payload.category.id\n      );\n    },\n    deleteImage(state: ImageViewer, action: PayloadAction<{ id: string }>) {\n      state.images = state.images.filter(\n        (image: Image) => image.id !== action.payload.id\n      );\n      if (!state.images.length) state.activeImageId = undefined;\n      else if (\n        state.activeImageId === action.payload.id &&\n        state.images.length\n      ) {\n        state.activeImageId = state.images[0].id;\n      }\n    },\n    deleteAllInstances(\n      state: ImageViewer,\n      action: PayloadAction<{ id: string }>\n    ) {\n      //deletes all instances across all images\n      state.images = state.images.map((image: Image) => {\n        return { ...image, annotations: [] };\n      });\n    },\n    deleteAllImageInstances(\n      state: ImageViewer,\n      action: PayloadAction<{ imageId: string }>\n    ) {\n      //deletes all instances across a given image\n      state.images = state.images.map((image: Image) => {\n        if (image.id === action.payload.imageId) {\n          return { ...image, annotations: [] };\n        } else return image;\n      });\n    },\n    deleteImageInstances(\n      //deletes given instance on active image\n      state: ImageViewer,\n      action: PayloadAction<{ ids: Array<string> }>\n    ) {\n      if (!state.activeImageId) return;\n\n      state.images = state.images.map((image: Image) => {\n        if (image.id === state.activeImageId) {\n          const updatedAnnotations = image.annotations.filter(\n            (annotation: AnnotationType) => {\n              return !action.payload.ids.includes(annotation.id);\n            }\n          );\n          return { ...image, annotations: updatedAnnotations };\n        } else return image;\n      });\n    },\n    openAnnotations(\n      state: ImageViewer,\n      action: PayloadAction<{ file: SerializedFileType }>\n    ) {\n      /*\n       * NOTE: The correct image to annotate is found by looking at the\n       * imageFilename property in the imported annotation file. -- Alice\n       */\n      if (!state.activeImageId) return;\n\n      const annotations = action.payload.file.annotations.map(\n        (annotation: SerializedAnnotationType): AnnotationType => {\n          const { annotation_out, categories } = importSerializedAnnotations(\n            annotation,\n            state.categories\n          );\n          state.categories = categories;\n          return annotation_out;\n        }\n      );\n\n      const loaded: Image = {\n        categoryId: UNKNOWN_CATEGORY_ID,\n        id: action.payload.file.imageId,\n        src: action.payload.file.imageData[0],\n        originalSrc: action.payload.file.imageData,\n        name: action.payload.file.imageFilename,\n        annotations: annotations,\n        partition: Partition.Inference,\n        shape: {\n          channels: action.payload.file.imageChannels,\n          frames: action.payload.file.imageFrames,\n          height: action.payload.file.imageHeight,\n          planes: action.payload.file.imagePlanes,\n          width: action.payload.file.imageWidth,\n        },\n      };\n\n      state.images.push(...[loaded]);\n    },\n    setAnnotationState(\n      state: ImageViewer,\n      action: PayloadAction<{\n        annotationState: AnnotationStateType;\n        annotationTool: AnnotationTool | undefined;\n      }>\n    ) {\n      state.annotationState = action.payload.annotationState;\n    },\n    setBoundingClientRect(\n      state: ImageViewer,\n      action: PayloadAction<{ boundingClientRect: DOMRect }>\n    ) {\n      state.boundingClientRect = action.payload.boundingClientRect;\n    },\n    setBrightness(\n      state: ImageViewer,\n      action: PayloadAction<{ brightness: number }>\n    ) {\n      state.brightness = action.payload.brightness;\n    },\n    setCategories(\n      state: ImageViewer,\n      action: PayloadAction<{ categories: Array<Category> }>\n    ) {\n      state.categories = action.payload.categories;\n    },\n    setCategoryVisibility(\n      state: ImageViewer,\n      action: PayloadAction<{ category: Category; visible: boolean }>\n    ) {\n      const category = _.find(state.categories, (category) => {\n        return category.id === action.payload.category.id;\n      });\n      if (!category) return;\n      category.visible = action.payload.visible;\n      state.categories = [\n        ...state.categories.filter((category) => {\n          return category.id !== action.payload.category.id;\n        }),\n        category,\n      ];\n    },\n    setContrast(\n      state: ImageViewer,\n      action: PayloadAction<{ contrast: number }>\n    ) {\n      state.contrast = action.payload.contrast;\n    },\n    setCurrentIndex(\n      state: ImageViewer,\n      action: PayloadAction<{ currentIndex: number }>\n    ) {\n      state.currentIndex = action.payload.currentIndex;\n    },\n    setExposure(\n      state: ImageViewer,\n      action: PayloadAction<{ exposure: number }>\n    ) {\n      state.exposure = action.payload.exposure;\n    },\n    setHue(state: ImageViewer, action: PayloadAction<{ hue: number }>) {\n      state.hue = action.payload.hue;\n    },\n    setActiveImage(\n      state: ImageViewer,\n      action: PayloadAction<{ image: string }>\n    ) {\n      state.activeImageId = action.payload.image;\n      const activeImage = state.images.find((image: Image) => {\n        return image.id === action.payload.image;\n      });\n      if (!activeImage) return;\n      const defaultChannels: Array<ChannelType> = []; //number of channels depends on whether image is greyscale or RGB\n      for (let i = 0; i < activeImage.shape.channels; i++) {\n        defaultChannels.push({\n          range: [0, 255],\n          visible: true,\n        });\n      }\n      state.channels = defaultChannels;\n    },\n    setActiveImagePlane(\n      state: ImageViewer,\n      action: PayloadAction<{ activeImagePlane: number }>\n    ) {\n      state.activeImagePlane = action.payload.activeImagePlane;\n    },\n    setImageSrc(state: ImageViewer, action: PayloadAction<{ src: string }>) {\n      if (!state.activeImageId) return;\n      state.images = state.images.map((image: Image) => {\n        if (state.activeImageId !== image.id) {\n          return image;\n        } else {\n          return { ...image, src: action.payload.src };\n        }\n      });\n    },\n    setImages(\n      state: ImageViewer,\n      action: PayloadAction<{ images: Array<Image> }>\n    ) {\n      state.images = action.payload.images;\n      if (!action.payload.images.length) return;\n      state.activeImageId = action.payload.images[0].id;\n    },\n    setChannels(\n      state: ImageViewer,\n      action: PayloadAction<{\n        channels: Array<ChannelType>;\n      }>\n    ) {\n      state.channels = action.payload.channels;\n    },\n    setCursor(\n      state: ImageViewer,\n      action: PayloadAction<{\n        cursor: string;\n      }>\n    ) {\n      state.cursor = action.payload.cursor;\n    },\n    setImageInstances(\n      state: ImageViewer,\n      action: PayloadAction<{\n        instances: Array<AnnotationType>;\n        imageId: string;\n      }>\n    ) {\n      //update corresponding image object in array of Images stored in state\n      state.images = state.images.map((image: Image) => {\n        if (action.payload.imageId !== image.id) {\n          return image;\n        } else {\n          return { ...image, annotations: action.payload.instances };\n        }\n      });\n    },\n    setLanguage(\n      state: ImageViewer,\n      action: PayloadAction<{ language: LanguageType }>\n    ) {\n      state.language = action.payload.language;\n    },\n    setOffset(\n      state: ImageViewer,\n      action: PayloadAction<{ offset: { x: number; y: number } }>\n    ) {\n      state.offset = action.payload.offset;\n    },\n    setOperation(\n      state: ImageViewer,\n      action: PayloadAction<{ operation: ToolType }>\n    ) {\n      state.toolType = action.payload.operation;\n    },\n    setPenSelectionBrushSize(\n      state: ImageViewer,\n      action: PayloadAction<{ penSelectionBrushSize: number }>\n    ) {\n      state.penSelectionBrushSize = action.payload.penSelectionBrushSize;\n    },\n    setPointerSelection(\n      state: ImageViewer,\n      action: PayloadAction<{\n        pointerSelection: {\n          dragging: boolean;\n          minimum: { x: number; y: number } | undefined;\n          maximum: { x: number; y: number } | undefined;\n          selecting: boolean;\n        };\n      }>\n    ) {\n      state.pointerSelection = action.payload.pointerSelection;\n    },\n    setQuickSelectionBrushSize(\n      state: ImageViewer,\n      action: PayloadAction<{ quickSelectionBrushSize: number }>\n    ) {\n      state.quickSelectionBrushSize = action.payload.quickSelectionBrushSize;\n    },\n    setSaturation(\n      state: ImageViewer,\n      action: PayloadAction<{ saturation: number }>\n    ) {\n      state.saturation = action.payload.saturation;\n    },\n    setSelectedCategoryId(\n      state: ImageViewer,\n      action: PayloadAction<{ selectedCategoryId: string }>\n    ) {\n      state.selectedCategoryId = action.payload.selectedCategoryId;\n    },\n    setSelectedAnnotations(\n      state: ImageViewer,\n      action: PayloadAction<{\n        selectedAnnotations: Array<AnnotationType>;\n        selectedAnnotation: AnnotationType | undefined;\n      }>\n    ) {\n      state.selectedAnnotations = action.payload.selectedAnnotations;\n      state.selectedAnnotation = action.payload.selectedAnnotation;\n    },\n    setSelectionMode(\n      state: ImageViewer,\n      action: PayloadAction<{ selectionMode: AnnotationModeType }>\n    ) {\n      state.selectionMode = action.payload.selectionMode;\n    },\n    setStageHeight(\n      state: ImageViewer,\n      action: PayloadAction<{ stageHeight: number }>\n    ) {\n      state.stageHeight = action.payload.stageHeight;\n    },\n    setStagePosition(\n      state: ImageViewer,\n      action: PayloadAction<{ stagePosition: { x: number; y: number } }>\n    ) {\n      state.stagePosition = action.payload.stagePosition;\n    },\n    setStageScale(\n      state: ImageViewer,\n      action: PayloadAction<{ stageScale: number }>\n    ) {\n      state.stageScale = action.payload.stageScale;\n    },\n    setStageWidth(\n      state: ImageViewer,\n      action: PayloadAction<{ stageWidth: number }>\n    ) {\n      state.stageWidth = action.payload.stageWidth;\n    },\n    setSoundEnabled(\n      state: ImageViewer,\n      action: PayloadAction<{ soundEnabled: boolean }>\n    ) {\n      state.soundEnabled = action.payload.soundEnabled;\n    },\n    setVibrance(\n      state: ImageViewer,\n      action: PayloadAction<{ vibrance: number }>\n    ) {\n      state.vibrance = action.payload.vibrance;\n    },\n    setZoomSelection(\n      state: ImageViewer,\n      action: PayloadAction<{\n        zoomSelection: {\n          dragging: boolean;\n          minimum: { x: number; y: number } | undefined;\n          maximum: { x: number; y: number } | undefined;\n          selecting: boolean;\n        };\n      }>\n    ) {\n      state.zoomSelection = action.payload.zoomSelection;\n    },\n  },\n  extraReducers: {\n    \"thunks/loadLayersModel/fulfilled\": (\n      state: ImageViewer,\n      action: PayloadAction<tensorflow.LayersModel>\n    ) => {\n      console.info(action.payload);\n    },\n  },\n});\n\nexport const {\n  addImages,\n  deleteCategory,\n  deleteAllInstances,\n  deleteImage,\n  openAnnotations,\n  setActiveImage,\n  setAnnotationState,\n  setBoundingClientRect,\n  setBrightness,\n  setCategories,\n  setCategoryVisibility,\n  setChannels,\n  setContrast,\n  setCurrentIndex,\n  setCursor,\n  setExposure,\n  setHue,\n  setImages,\n  setLanguage,\n  setOffset,\n  setOperation,\n  setPenSelectionBrushSize,\n  setPointerSelection,\n  setQuickSelectionBrushSize,\n  setSaturation,\n  setSelectedAnnotations,\n  setSelectionMode,\n  setSelectedCategoryId,\n  setSoundEnabled,\n  setStageHeight,\n  setStagePosition,\n  setStageScale,\n  setStageWidth,\n  setVibrance,\n  setZoomSelection,\n} = imageViewerSlice.actions;\n","export default __webpack_public_path__ + \"static/media/317832f90f02c5e916b2ac0f3bcb8da9928d8e400b747b2c68e544e56adacf6b.b6972107.png\";","import { Project } from \"../../types/Project\";\nimport { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { Category, UNKNOWN_CATEGORY_ID } from \"../../types/Category\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { Image } from \"../../types/Image\";\nimport { filter, findIndex } from \"lodash\";\nimport nuclei from \"../../images/317832f90f02c5e916b2ac0f3bcb8da9928d8e400b747b2c68e544e56adacf6b.png\";\nimport { SerializedImageType } from \"../../types/SerializedImageType\";\nimport { Task } from \"../../types/Task\";\nimport { Partition } from \"../../types/Partition\";\n\nconst dummyImage: Image = {\n  id: \"a860a94c-58aa-44eb-88e7-9538cb48be29\",\n  categoryId: UNKNOWN_CATEGORY_ID,\n  annotations: [],\n  name: \"nuclei\",\n  originalSrc: [nuclei],\n  src: nuclei,\n  shape: {\n    height: 256,\n    width: 256,\n    channels: 3,\n    planes: 1,\n    frames: 1,\n  },\n  partition: Partition.Inference,\n};\n\nconst initialState: Project = {\n  categories: [\n    {\n      color: \"#AAAAAA\",\n      id: UNKNOWN_CATEGORY_ID,\n      name: \"Unknown\",\n      visible: true,\n    },\n  ],\n  images: [dummyImage],\n  name: \"Untitled project\",\n  task: Task.Classify,\n  trainFlag: 0,\n};\n\nexport const projectSlice = createSlice({\n  name: \"project\",\n  initialState: initialState,\n  reducers: {\n    createCategory(\n      state: Project,\n      action: PayloadAction<{ name: string; color: string }>\n    ) {\n      const category: Category = {\n        color: action.payload.color,\n        id: uuidv4().toString(),\n        name: action.payload.name,\n        visible: true,\n      };\n      state.categories.push(category);\n    },\n    createImage(state: Project, action: PayloadAction<{ image: Image }>) {\n      state.images.push(action.payload.image);\n    },\n    createProject(state: Project, action: PayloadAction<{ project: Project }>) {\n      state.categories = action.payload.project.categories;\n      state.name = action.payload.project.name;\n      state.images = action.payload.project.images;\n    },\n    deleteCategory(state: Project, action: PayloadAction<{ id: string }>) {\n      state.categories = filter(state.categories, (category: Category) => {\n        return category.id !== action.payload.id;\n      });\n      state.images = state.images.map((image: Image) => {\n        if (image.categoryId === action.payload.id) {\n          image.categoryId = UNKNOWN_CATEGORY_ID;\n        }\n        return image;\n      });\n    },\n    deleteImages(\n      state: Project,\n      action: PayloadAction<{ ids: Array<string> }>\n    ) {\n      state.images = filter(state.images, (image: Image) => {\n        return !action.payload.ids.includes(image.id);\n      });\n    },\n    openImages(\n      state: Project,\n      action: PayloadAction<{ images: Array<SerializedImageType> }>\n    ) {\n      const newImages: Array<Image> = [];\n\n      action.payload.images.forEach((serializedImage: SerializedImageType) => {\n        const image: Image = {\n          categoryId: serializedImage.imageCategoryId,\n          id: serializedImage.imageId,\n          annotations: serializedImage.annotations,\n          name: serializedImage.imageFilename,\n          partition: serializedImage.imagePartition,\n          shape: {\n            width: serializedImage.imageWidth,\n            height: serializedImage.imageHeight,\n            channels: serializedImage.imageChannels,\n            planes: serializedImage.imagePlanes,\n            frames: serializedImage.imageFrames,\n          },\n          originalSrc: serializedImage.imageData,\n          src: serializedImage.imageData[\n            Math.floor(serializedImage.imagePlanes / 2)\n          ],\n        };\n\n        newImages.push(image);\n      });\n\n      state.images = newImages;\n    },\n    openProject(\n      state: Project,\n      action: PayloadAction<{\n        images: Array<SerializedImageType>;\n        name: string;\n        categories: Array<Category>;\n      }>\n    ) {\n      state.categories = action.payload.categories;\n      state.name = action.payload.name;\n\n      //Open images\n      const newImages: Array<Image> = [];\n\n      action.payload.images.forEach((serializedImage: SerializedImageType) => {\n        const originalSrc = Array.isArray(serializedImage.imageData)\n          ? serializedImage.imageData\n          : [serializedImage.imageData]; //handle case where example projects's images do not correspond to array of strings\n        const image: Image = {\n          categoryId: serializedImage.imageCategoryId,\n          id: serializedImage.imageId,\n          annotations: serializedImage.annotations,\n          name: serializedImage.imageFilename,\n          partition: serializedImage.imagePartition,\n          shape: {\n            width: serializedImage.imageWidth,\n            height: serializedImage.imageHeight,\n            channels: serializedImage.imageChannels,\n            planes: serializedImage.imagePlanes,\n            frames: serializedImage.imageFrames,\n          },\n          originalSrc: serializedImage.imageData,\n          src: originalSrc[Math.floor(serializedImage.imagePlanes / 2)],\n        };\n\n        newImages.push(image);\n      });\n\n      state.images = newImages;\n    },\n    setCategories(\n      state: Project,\n      action: PayloadAction<{ categories: Array<Category> }>\n    ) {\n      state.categories = [...state.categories, ...action.payload.categories];\n    },\n    setImages(state: Project, action: PayloadAction<{ images: Array<Image> }>) {\n      state.images = action.payload.images;\n    },\n    setProjectName(state: Project, action: PayloadAction<{ name: string }>) {\n      state.name = action.payload.name;\n    },\n    updateCategory(\n      state: Project,\n      action: PayloadAction<{ id: string; name: string; color: string }>\n    ) {\n      const index = findIndex(state.categories, (category: Category) => {\n        return category.id === action.payload.id;\n      });\n      state.categories[index].name = action.payload.name;\n      state.categories[index].color = action.payload.color;\n    },\n    updateCategoryVisibility(\n      state: Project,\n      action: PayloadAction<{ id: string; visible: boolean }>\n    ) {\n      const index = findIndex(state.categories, (category: Category) => {\n        return category.id === action.payload.id;\n      });\n      state.categories[index].visible = action.payload.visible;\n    },\n    updateOtherCategoryVisibility(\n      state: Project,\n      action: PayloadAction<{ id: string }>\n    ) {\n      const categories = filter(state.categories, (category: Category) => {\n        return category.id !== action.payload.id;\n      });\n      for (let category of categories) {\n        category.visible = false;\n      }\n    },\n    updateImageCategory(\n      state: Project,\n      action: PayloadAction<{ id: string; categoryId: string }>\n    ) {\n      const index = findIndex(state.images, (image: Image) => {\n        return image.id === action.payload.id;\n      });\n      if (index >= 0) {\n        state.images[index].categoryId = action.payload.categoryId;\n      }\n    },\n    updateImageCategories(\n      state: Project,\n      action: PayloadAction<{ ids: Array<string>; categoryId: string }>\n    ) {\n      action.payload.ids.forEach((imageId) => {\n        const index = findIndex(state.images, (image: Image) => {\n          return image.id === imageId;\n        });\n        if (index >= 0) {\n          state.images[index].categoryId = action.payload.categoryId;\n          if (action.payload.categoryId === UNKNOWN_CATEGORY_ID) {\n            //If assigned category is unknown, then this image is moved to inference set, else it is assigned to training set\n            state.images[index].partition = Partition.Inference;\n          } else {\n            state.images[index].partition = Partition.Training;\n          }\n        }\n      });\n    },\n    updateImagesCategories(\n      state: Project,\n      action: PayloadAction<{ ids: Array<string>; categoryIds: Array<string> }>\n    ) {\n      action.payload.ids.forEach((imageId, idx) => {\n        const index = findIndex(state.images, (image: Image) => {\n          return image.id === imageId;\n        });\n        if (index >= 0) {\n          state.images[index].categoryId = action.payload.categoryIds[idx];\n        }\n      });\n    },\n    updateImagesPartition(\n      state: Project,\n      action: PayloadAction<{ ids: Array<string>; partition: Partition }>\n    ) {\n      action.payload.ids.forEach((imageId, idx) => {\n        const index = findIndex(state.images, (image: Image) => {\n          return image.id === imageId;\n        });\n        if (index >= 0) {\n          state.images[index].partition = action.payload.partition;\n        }\n      });\n    },\n    updateTask(state: Project, action: PayloadAction<{ task: Task }>) {\n      state.task = action.payload.task;\n    },\n    updateTrainFlag(\n      state: Project,\n      action: PayloadAction<{ trainFlag: number }>\n    ) {\n      state.trainFlag = action.payload.trainFlag;\n    },\n  },\n});\n\nexport const {\n  createCategory,\n  createImage,\n  createProject,\n  deleteCategory,\n  updateCategory,\n  updateCategoryVisibility,\n  updateImageCategories,\n  updateImageCategory,\n  updateOtherCategoryVisibility,\n} = projectSlice.actions;\n","export enum ZoomModeType {\n  In,\n  Out,\n}\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { ToolOptionsStateType } from \"../../types/ToolOptionsStateType\";\nimport { ZoomModeType } from \"../../types/ZoomModeType\";\nimport { ZoomToolOptionsType } from \"../../types/ZoomToolOptionsType\";\nimport { ColorAdjustmentOptionsType } from \"../../types/ColorAdjustmentOptionsType\";\n\nconst initialState: ToolOptionsStateType = {\n  colorAdjustment: {\n    blackPoint: 0,\n    brightness: 0,\n    contrast: 0,\n    exposure: 0,\n    highlights: 0,\n    hue: 0,\n    saturation: 0,\n    shadows: 0,\n    vibrance: 0,\n  },\n  zoom: {\n    automaticCentering: true,\n    mode: ZoomModeType.In,\n    scale: 1.0,\n    toActualSize: false,\n    toFit: false,\n  },\n};\n\nexport const toolOptionsSlice = createSlice({\n  initialState: initialState,\n  name: \"image-viewer-tool-options\",\n  reducers: {\n    setColorAdjustmentOptions(\n      state: ToolOptionsStateType,\n      action: PayloadAction<{ options: ColorAdjustmentOptionsType }>\n    ) {\n      state.colorAdjustment = action.payload.options;\n    },\n    setZoomToolOptions(\n      state: ToolOptionsStateType,\n      action: PayloadAction<{ options: ZoomToolOptionsType }>\n    ) {\n      state.zoom = action.payload.options;\n    },\n  },\n});\n\nexport const { setColorAdjustmentOptions, setZoomToolOptions } =\n  toolOptionsSlice.actions;\n","import React from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { ListItemText, MenuItem } from \"@mui/material\";\nimport { classifierSlice, projectSlice } from \"../../store/slices\";\n\ntype OpenExampleProjectMenuItemProps = {\n  popupState: any;\n};\n\nexport const OpenProjectMenuItem = ({\n  popupState,\n}: OpenExampleProjectMenuItemProps) => {\n  const dispatch = useDispatch();\n\n  const onOpenProjectFile = (\n    event: React.ChangeEvent<HTMLInputElement>,\n    close: () => void\n  ) => {\n    popupState.close();\n    event.persist();\n\n    close();\n\n    if (!event.currentTarget.files) return;\n\n    const file = event.currentTarget.files[0];\n\n    const reader = new FileReader();\n\n    reader.onload = async (event: ProgressEvent<FileReader>) => {\n      if (event.target && event.target.result) {\n        const project = JSON.parse(event.target.result as string);\n\n        try {\n          //Open project\n          dispatch(\n            projectSlice.actions.openProject({\n              images: project.project.serializedImages,\n              categories: project.project.categories,\n              name: project.project.name,\n            })\n          );\n\n          //Open Classifier options\n          dispatch(\n            classifierSlice.actions.setClassifier({\n              classifier: project.classifier,\n            })\n          );\n        } catch (err) {\n          const error: Error = err as Error;\n          alert(\n            \"Error while opening the project file: \" +\n              error.name +\n              \"\\n\" +\n              error.message\n          );\n        }\n      }\n    };\n\n    reader.readAsText(file);\n  };\n\n  return (\n    <MenuItem component=\"label\">\n      <ListItemText primary=\"Open project\" />\n      <input\n        accept=\"application/json\"\n        hidden\n        id=\"open-project-file\"\n        onChange={(event: React.ChangeEvent<HTMLInputElement>) =>\n          onOpenProjectFile(event, popupState.close)\n        }\n        type=\"file\"\n      />\n    </MenuItem>\n  );\n};\n","import React from \"react\";\nimport {\n  Alert,\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  ListItemIcon,\n  ListItemText,\n  MenuItem,\n  Typography,\n} from \"@mui/material\";\nimport { classifierSlice } from \"../../store/slices\";\nimport { Shape } from \"../../types/Shape\";\nimport * as tf from \"@tensorflow/tfjs\";\nimport { useDispatch } from \"react-redux\";\nimport FileOpenIcon from \"@mui/icons-material/FileOpen\";\nimport { LayersModel } from \"@tensorflow/tfjs\";\nimport { ModelType } from \"../../types/ClassifierModelType\";\n\ntype OpenClassifierDialogProps = {\n  onClose: any;\n  open: any;\n  popupState: any;\n};\n\nexport const OpenClassifierDialog = ({\n  onClose,\n  open,\n  popupState,\n}: OpenClassifierDialogProps) => {\n  const [classifierModel, setClassifierModel] = React.useState<LayersModel>();\n  const [modelSelected, setModelSelected] = React.useState<boolean>(false);\n  const [modelName, setModelName] = React.useState<string>(\"\");\n  const [inputShape, setInputShape] = React.useState<Shape>({\n    height: 256,\n    width: 256,\n    channels: 3,\n    planes: 1,\n    frames: 1,\n  });\n\n  const [fileError, setFileError] = React.useState<boolean>(false);\n  const [fileErrorMessage, setFileErrorMessage] = React.useState<string>(\"\");\n\n  const dispatch = useDispatch();\n\n  const dispatchModelToStore = () => {\n    dispatch(\n      classifierSlice.actions.uploadUserSelectedModel({\n        inputShape: inputShape,\n        modelSelection: {\n          modelName: modelName + \" - uploaded\",\n          modelType: ModelType.UserUploaded,\n        },\n        model: classifierModel as LayersModel,\n      })\n    );\n\n    onClose();\n    popupState.close();\n  };\n\n  const onClassifierFilesSelected = async (\n    event: React.ChangeEvent<HTMLInputElement>\n  ) => {\n    event.persist();\n\n    if (!event.currentTarget.files) {\n      return;\n    }\n\n    let weightsFile, jsonFile;\n    if (event.currentTarget.files[0].name.includes(\".bin\")) {\n      weightsFile = event.currentTarget.files[0];\n      jsonFile = event.currentTarget.files[1];\n    } else {\n      weightsFile = event.currentTarget.files[1];\n      jsonFile = event.currentTarget.files[0];\n    }\n\n    // make sure the weight file required in the json has the correct name\n    const jsonFileContent = await jsonFile.text();\n\n    const weightFileName = weightsFile.name;\n    const weightFileNameReplaceString =\n      'paths\":[\"./' +\n      weightFileName.substring(0, weightFileName.length - 4) +\n      '.bin\"]';\n\n    const regegPattern = new RegExp('paths\":\\\\[\"./(.)*weights.bin\"]');\n    const updatedJsonFileContent = jsonFileContent.replace(\n      regegPattern,\n      weightFileNameReplaceString\n    );\n\n    var newJsonFile = new File([updatedJsonFileContent], jsonFile.name, {\n      type: jsonFile.type,\n    });\n\n    try {\n      const model = await tf.loadLayersModel(\n        tf.io.browserFiles([newJsonFile, weightsFile])\n      );\n      setClassifierModel(model);\n      setModelSelected(true);\n\n      const modelShape = model.inputs[0].shape.slice(1) as number[];\n      setInputShape((prevShape) => ({\n        ...prevShape,\n        height: modelShape[0],\n        width: modelShape[1],\n        channels: modelShape[2],\n      }));\n\n      // remove the file extension from the model name\n      const jsonFileName = jsonFile.name.replace(/\\..+$/, \"\");\n      setModelName(jsonFileName);\n    } catch (err) {\n      const error: Error = err as Error;\n\n      setFileErrorMessage(\n        \"Invalid files selected:\\n\" + error.name + \"\\n\" + error.message\n      );\n      setFileError(true);\n    }\n  };\n\n  const onCancel = () => {\n    onClose();\n  };\n\n  return (\n    <Dialog fullWidth maxWidth=\"xs\" onClose={onClose} open={open}>\n      <DialogTitle>Open classifier</DialogTitle>\n\n      <input\n        accept=\"application/json|.bin\"\n        hidden\n        type=\"file\"\n        multiple\n        id=\"open-classifier-file\"\n        onChange={(event: React.ChangeEvent<HTMLInputElement>) =>\n          onClassifierFilesSelected(event)\n        }\n      />\n\n      <DialogContent>\n        <Typography gutterBottom>\n          Tensowflow requires a .json files containing the model description as\n          well as the corresponding model weights (.bin file).\n        </Typography>\n      </DialogContent>\n\n      <label htmlFor=\"open-classifier-file\">\n        <MenuItem component=\"span\" dense>\n          <ListItemIcon>\n            <FileOpenIcon />\n          </ListItemIcon>\n          <ListItemText primary=\"Select classifier files\" />\n        </MenuItem>\n      </label>\n\n      {fileError ? <Alert severity=\"error\">{fileErrorMessage}</Alert> : <></>}\n\n      <DialogActions>\n        <Button onClick={onCancel} color=\"primary\">\n          Cancel\n        </Button>\n\n        <Button\n          onClick={dispatchModelToStore}\n          color=\"primary\"\n          disabled={!modelSelected}\n        >\n          Open Classifier\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n","import { useCallback, useState } from \"react\";\n\nexport const useDialog = () => {\n  const [open, setOpen] = useState(false);\n\n  const onClose = useCallback(() => {\n    setOpen(!open);\n  }, [open]);\n\n  const onOpen = useCallback(() => {\n    setOpen(!open);\n  }, [open]);\n\n  return { onClose, onOpen, open };\n};\n","import React, { useState } from \"react\";\n\nexport const useMarchingAnts = () => {\n  const [dashOffset, setDashOffset] = useState<number>(0);\n\n  React.useEffect(() => {\n    const timer = setTimeout(() => {\n      setDashOffset(dashOffset + 1);\n\n      if (dashOffset > 32) {\n        setDashOffset(0);\n      }\n    }, 200);\n    return () => clearTimeout(timer);\n  });\n\n  return dashOffset;\n};\n","import React, { useCallback, useState } from \"react\";\n\nexport const useMenu = () => {\n  const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\n\n  const [open, setOpen] = useState<boolean>(false);\n\n  const onClose = useCallback(\n    (event: React.MouseEvent<HTMLElement, MouseEvent>) => {\n      setAnchorEl(null);\n\n      setOpen(false);\n    },\n    []\n  );\n\n  const onOpen = useCallback((event: React.MouseEvent<HTMLElement>) => {\n    setOpen(true);\n    setAnchorEl(event.currentTarget);\n  }, []);\n\n  return {\n    anchorEl,\n    onClose,\n    onOpen,\n    open,\n  };\n};\n","import * as ImageJS from \"image-js\";\n\nexport abstract class Tool {\n  image: ImageJS.Image;\n\n  constructor(image: ImageJS.Image) {\n    this.image = image;\n  }\n}\n","/*\n (c) 2017, Vladimir Agafonkin\n Simplify.js, a high-performance JS polyline simplification library\n mourner.github.io/simplify-js\n*/\n\n// (function () { 'use strict';\n\n// to suit your point format, run search/replace for '.x' and '.y';\n// for 3D version, see 3d branch (configurability would draw significant performance overhead)\n\n// square distance between 2 points\nfunction getSqDist(p1: Array<number>, p2: Array<number>) {\n  var dx = p1[0] - p2[0],\n    dy = p1[1] - p2[1];\n\n  return dx * dx + dy * dy;\n}\n\n// square distance from a point to a segment\nfunction getSqSegDist(p: Array<number>, p1: Array<number>, p2: Array<number>) {\n  var x = p1[0],\n    y = p1[1],\n    dx = p2[0] - x,\n    dy = p2[1] - y;\n\n  if (dx !== 0 || dy !== 0) {\n    var t = ((p[0] - x) * dx + (p[1] - y) * dy) / (dx * dx + dy * dy);\n\n    if (t > 1) {\n      x = p2[0];\n      y = p2[1];\n    } else if (t > 0) {\n      x += dx * t;\n      y += dy * t;\n    }\n  }\n\n  dx = p[0] - x;\n  dy = p[1] - y;\n\n  return dx * dx + dy * dy;\n}\n// rest of the code doesn't care about point format\n\n// basic distance-based simplification\nfunction simplifyRadialDist(points: Array<Array<number>>, sqTolerance: number) {\n  var prevPoint = points[0];\n  var newPoints = [prevPoint];\n  var point: Array<number> = [];\n\n  for (var i = 1, len = points.length; i < len; i++) {\n    point = points[i];\n\n    if (getSqDist(point, prevPoint) > sqTolerance) {\n      newPoints.push(point);\n      prevPoint = point;\n    }\n  }\n\n  if (prevPoint !== point) newPoints.push(point);\n\n  return newPoints;\n}\n\nfunction simplifyDPStep(\n  points: Array<Array<number>>,\n  first: number,\n  last: number,\n  sqTolerance: number,\n  simplified: Array<Array<number>>\n) {\n  let maxSqDist = sqTolerance;\n  let index: number = 0;\n\n  for (var i = first + 1; i < last; i++) {\n    var sqDist = getSqSegDist(points[i], points[first], points[last]);\n\n    if (sqDist > maxSqDist) {\n      index = i;\n      maxSqDist = sqDist;\n    }\n  }\n\n  if (maxSqDist > sqTolerance) {\n    if (index - first > 1)\n      simplifyDPStep(points, first, index, sqTolerance, simplified);\n    simplified.push(points[index]);\n    if (last - index > 1)\n      simplifyDPStep(points, index, last, sqTolerance, simplified);\n  }\n}\n\n// simplification using Ramer-Douglas-Peucker algorithm\nfunction simplifyDouglasPeucker(\n  points: Array<Array<number>>,\n  sqTolerance: number\n) {\n  var last = points.length - 1;\n\n  var simplified = [points[0]];\n  simplifyDPStep(points, 0, last, sqTolerance, simplified);\n  simplified.push(points[last]);\n\n  return simplified;\n}\n\n// both algorithms combined for awesome performance\nexport function simplify(\n  points: Array<Array<number>>,\n  tolerance: number,\n  highestQuality: boolean\n) {\n  if (points.length <= 2) return points;\n\n  var sqTolerance = tolerance !== undefined ? tolerance * tolerance : 1;\n\n  points = highestQuality ? points : simplifyRadialDist(points, sqTolerance);\n  points = simplifyDouglasPeucker(points, sqTolerance);\n\n  return points;\n}\n\n// // export as AMD module / Node module / browser or worker variable\n//     if (typeof define === 'function' && define.amd) define(function() { return simplify; });\n//     else if (typeof module !== 'undefined') {\n//         module.exports = simplify;\n//         module.exports.default = simplify;\n//     } else if (typeof self !== 'undefined') self.simplify = simplify;\n//     else window.simplify = simplify;\n\n// })();\n","// Code from: https://github.com/kamoroso94/polygon-fill-benchmark\n\n// linear interpolation\n// finds x-value from scanline intersecting edge\nexport function lerp(\n  yScan: number,\n  [[x1, y1], [x2, y2]]: Array<Array<number>>\n) {\n  return Math.floor(((yScan - y1) / (y2 - y1)) * (x2 - x1) + x1);\n}\n\n// returns minimum y-value of two points\nexport function getYMin([[, y1], [, y2]]: Array<Array<number>>) {\n  return y1 <= y2 ? y1 : y2;\n}\n\n// returns maximum y-value of two points\nexport function getYMax([[, y1], [, y2]]: Array<Array<number>>) {\n  return y1 > y2 ? y1 : y2;\n}\n\n// returns the x-value of the point with the minimum y-value\nexport function getXofYMin([[x1, y1], [x2, y2]]: Array<Array<number>>) {\n  return y1 <= y2 ? x1 : x2;\n}\n\n// returns the x-value of the point with the maximum y-value\nexport function getXofYMax([[x1, y1], [x2, y2]]: Array<Array<number>>) {\n  return y1 > y2 ? x1 : x2;\n}\n\n// converts list of points to list of non-horizontal edges\nexport function pointsToEdges(points: Array<Array<number>>) {\n  let edges = [];\n  let p1 = points[points.length - 1];\n  for (let i = 0; i < points.length; i++) {\n    const p2 = points[i];\n    // ignore horizontal edges\n    if (p1[1] !== p2[1]) edges.push([p1, p2]);\n    p1 = p2;\n  }\n  return edges;\n}\n","// Code from: https://github.com/kamoroso94/polygon-fill-benchmark\n\nimport * as ImageJS from \"image-js\";\n\nimport {\n  getXofYMax,\n  getXofYMin,\n  getYMax,\n  getYMin,\n  lerp,\n  pointsToEdges,\n} from \"./util\";\n\n// Scnaline Polygon Fill\nexport function slpf(points: Array<Array<number>>, img: ImageJS.Image) {\n  if (points.length < 3) return;\n\n  // initialize ET and AET\n  const ET: Array<Array<Array<number>>> = pointsToEdges(points).sort(\n    (e1: Array<Array<number>>, e2: Array<Array<number>>) =>\n      getYMin(e2) - getYMin(e1)\n  );\n  const AET: Array<Array<Array<number>>> = [];\n  let yScan = getYMin(ET[ET.length - 1]);\n\n  // repeat until both ET and AET are empty\n  while (ET.length > 0 || AET.length > 0) {\n    // manage AET\n    moveEdges(yScan, ET, AET);\n    removeEdges(yScan, AET);\n    AET.sort((e1, e2) => {\n      const cmp = getXofYMin(e1) - getXofYMin(e2);\n      return cmp === 0 ? getXofYMax(e1) - getXofYMax(e2) : cmp;\n    });\n    // fill spans on scanline\n    const spans = getSpans(yScan, AET);\n    drawSpans(spans, yScan, img);\n    yScan++;\n  }\n}\n\n// move active edges from ET to AET\nfunction moveEdges(\n  yScan: number,\n  ET: Array<Array<Array<number>>>,\n  AET: Array<Array<Array<number>>>\n) {\n  while (ET.length > 0 && yScan === getYMin(ET[ET.length - 1])) {\n    AET.push(ET.pop()!);\n  }\n}\n\n// remove inactive edges from AET\nfunction removeEdges(yScan: number, AET: Array<Array<Array<number>>>) {\n  for (let i = 0; i < AET.length; i++) {\n    if (yScan >= getYMax(AET[i])) {\n      const last = AET.pop();\n      if (i < AET.length && last) {\n        AET[i] = last;\n        i--;\n      }\n    }\n  }\n}\n\n// find spans along scanline\nfunction getSpans(yScan: number, AET: Array<Array<Array<number>>>) {\n  const spans = [];\n  for (const edge of AET) {\n    spans.push(lerp(yScan, edge));\n  }\n  return spans;\n}\n\nfunction drawSpans(spans: Array<number>, yScan: number, img: ImageJS.Image) {\n  for (let i = 0; i < spans.length; i += 2) {\n    fillSpan(spans[i], spans[i + 1], yScan, img);\n  }\n}\n\n// fill pixels within a span\nfunction fillSpan(x1: number, x2: number, y: number, img: ImageJS.Image) {\n  for (let x = x1; x < x2; x++) {\n    img.setPixelXY(x, y, [255, 255, 255, 255]);\n  }\n}\n","import { AnnotationType } from \"../../../../../types/AnnotationType\";\nimport * as ImageJS from \"image-js\";\nimport { Category } from \"../../../../../types/Category\";\nimport * as _ from \"lodash\";\nimport { connectPoints, drawLine } from \"../../../../../image/imageHelper\";\nimport { simplify } from \"../../../simplify/simplify\";\nimport { slpf } from \"../../../polygon-fill/slpf\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { decode, encode } from \"../../../rle\";\nimport { Tool } from \"../../Tool\";\nimport { AnnotationStateType } from \"../../../../../types/AnnotationStateType\";\n\nexport abstract class AnnotationTool extends Tool {\n  manager: ImageJS.RoiManager;\n  points?: Array<number> = [];\n  annotationState = AnnotationStateType.Blank;\n  annotation?: AnnotationType;\n  onAnnotating?: () => void;\n  onAnnotated?: () => void;\n  onDeselect?: () => void;\n\n  anchor?: { x: number; y: number } = undefined;\n  origin?: { x: number; y: number } = undefined;\n  buffer?: Array<number> = [];\n\n  protected _boundingBox?: [number, number, number, number];\n  protected _mask?: Array<number>;\n\n  constructor(image: ImageJS.Image) {\n    super(image);\n\n    this.manager = image.getRoiManager();\n  }\n\n  /*\n   * Method for add, subtract and intersect modes.\n   * Draw a ROI mask in the coordinate space of the new combined bounding box.\n   * */\n  drawMaskInNewBoundingBox(\n    newMaskImage: ImageJS.Image,\n    maskImage: ImageJS.Image,\n    boundingBox: [number, number, number, number],\n    newBoundingBox: [number, number, number, number]\n  ) {\n    for (let x = 0; x < maskImage.width; x++) {\n      for (let y = 0; y < maskImage.height; y++) {\n        const pixel = maskImage.getPixelXY(x, y)[0];\n        // if (x > boundingBox1[2] && pixel > 0) console.info(\"Not supposed to happen\")\n        if (pixel === 255) {\n          newMaskImage.setPixelXY(\n            x + boundingBox[0] - newBoundingBox[0],\n            y + boundingBox[1] - newBoundingBox[1],\n            [255]\n          );\n        }\n      }\n    }\n    return newMaskImage;\n  }\n\n  inBoundingBox(\n    x: number,\n    y: number,\n    boundingBox: [number, number, number, number]\n  ) {\n    if (x < 0 || y < 0) return false;\n    if (x >= boundingBox[2] - boundingBox[0]) return false;\n    if (y >= boundingBox[3] - boundingBox[1]) return false;\n    return true;\n  }\n  /*\n   * Adding to a Operator adds any new areas you select to your existing\n   * Operator.\n   */\n  add(\n    encodedMaskData1: Array<number>,\n    boundingBox1: [number, number, number, number]\n  ): [Array<number>, [number, number, number, number]] {\n    if (!this._mask || !this._boundingBox) return [[], [0, 0, 0, 0]];\n\n    const maskData1 = decode(encodedMaskData1);\n    const maskData2 = decode(this._mask);\n    const boundingBox2 = this._boundingBox;\n\n    const newBoundingBox = [\n      boundingBox2[0] < boundingBox1[0] ? boundingBox2[0] : boundingBox1[0],\n      boundingBox2[1] < boundingBox1[1] ? boundingBox2[1] : boundingBox1[1],\n      boundingBox2[2] > boundingBox1[2] ? boundingBox2[2] : boundingBox1[2],\n      boundingBox2[3] > boundingBox1[3] ? boundingBox2[3] : boundingBox1[3],\n    ] as [number, number, number, number];\n    //\n    const newBoundingBoxWidth = newBoundingBox[2] - newBoundingBox[0];\n    const newBoundingBoxHeight = newBoundingBox[3] - newBoundingBox[1];\n\n    const newMaskData = [];\n    const deltaX1 = boundingBox1[0] - newBoundingBox[0];\n    const deltaY1 = boundingBox1[1] - newBoundingBox[1];\n    const deltaX2 = boundingBox2[0] - newBoundingBox[0];\n    const deltaY2 = boundingBox2[1] - newBoundingBox[1];\n\n    for (let i = 0; i < newBoundingBoxWidth * newBoundingBoxHeight; i++) {\n      const x = i % newBoundingBoxWidth;\n      const y = Math.floor(i / newBoundingBoxWidth);\n      const b1x = x - deltaX1;\n      const b1y = y - deltaY1;\n      const b2x = x - deltaX2;\n      const b2y = y - deltaY2;\n\n      const b1i = b1x + b1y * (boundingBox1[2] - boundingBox1[0]);\n      const b2i = b2x + b2y * (boundingBox2[2] - boundingBox2[0]);\n      if (\n        (this.inBoundingBox(b1x, b1y, boundingBox1) &&\n          maskData1[b1i] === 255) ||\n        (this.inBoundingBox(b2x, b2y, boundingBox2) && maskData2[b2i] === 255)\n      ) {\n        newMaskData.push(255);\n      } else {\n        newMaskData.push(0);\n      }\n    }\n\n    return [encode(Uint8Array.from(newMaskData)), newBoundingBox];\n  }\n\n  connect() {\n    if (this.annotationState === AnnotationStateType.Annotated) return;\n\n    if (!this.anchor || !this.origin) return;\n\n    if (!this.buffer) return;\n\n    const anchorIndex = _.findLastIndex(this.buffer, (point) => {\n      return point === this.anchor!.x;\n    });\n\n    const segment = _.flatten(\n      drawLine([this.anchor.x, this.anchor.y], [this.origin.x, this.origin.y])\n    );\n\n    this.buffer.splice(anchorIndex, segment.length, ...segment);\n\n    this._boundingBox = this.computeBoundingBoxFromContours(this.buffer);\n\n    this.points = this.buffer;\n\n    const maskImage = this.computeMask().crop({\n      x: this._boundingBox[0],\n      y: this._boundingBox[1],\n      width: this._boundingBox[2] - this._boundingBox[0],\n      height: this._boundingBox[3] - this._boundingBox[1],\n    });\n\n    this._mask = encode(maskImage.data);\n\n    console.error(maskImage.toDataURL());\n\n    this.anchor = undefined;\n    this.origin = undefined;\n    this.buffer = [];\n\n    this.setAnnotated();\n  }\n\n  /*\n   * When using the Intersect Operator mode, any currently selected areas you\n   * select over will be kept and any currently selected areas outside your\n   * new Operator will be removed from the Operator.\n   */\n  intersect(\n    decodedMask1: Array<number>,\n    boundingBox1: [number, number, number, number]\n  ): [Array<number>, [number, number, number, number]] {\n    if (!this._mask || !this._boundingBox) return [[], [0, 0, 0, 0]];\n\n    const maskData1 = decode(decodedMask1);\n    const maskData2 = decode(this._mask);\n\n    const boundingBox2 = this._boundingBox;\n\n    const newBoundingBox = [\n      boundingBox2[0] > boundingBox1[0] ? boundingBox2[0] : boundingBox1[0],\n      boundingBox2[1] > boundingBox1[1] ? boundingBox2[1] : boundingBox1[1],\n      boundingBox2[2] < boundingBox1[2] ? boundingBox2[2] : boundingBox1[2],\n      boundingBox2[3] < boundingBox1[3] ? boundingBox2[3] : boundingBox1[3],\n    ] as [number, number, number, number];\n\n    const newBoundingBoxWidth = newBoundingBox[2] - newBoundingBox[0];\n    const newBoundingBoxHeight = newBoundingBox[3] - newBoundingBox[1];\n\n    const newMaskData = [];\n    const deltaX1 = boundingBox1[0] - newBoundingBox[0];\n    const deltaY1 = boundingBox1[1] - newBoundingBox[1];\n    const deltaX2 = boundingBox2[0] - newBoundingBox[0];\n    const deltaY2 = boundingBox2[1] - newBoundingBox[1];\n\n    for (let i = 0; i < newBoundingBoxWidth * newBoundingBoxHeight; i++) {\n      const x = i % newBoundingBoxWidth;\n      const y = Math.floor(i / newBoundingBoxWidth);\n      const b1x = x - deltaX1;\n      const b1y = y - deltaY1;\n      const b2x = x - deltaX2;\n      const b2y = y - deltaY2;\n\n      const b1i = b1x + b1y * (boundingBox1[2] - boundingBox1[0]);\n      const b2i = b2x + b2y * (boundingBox2[2] - boundingBox2[0]);\n      if (\n        this.inBoundingBox(b1x, b1y, boundingBox1) &&\n        maskData1[b1i] === 255 &&\n        this.inBoundingBox(b2x, b2y, boundingBox2) &&\n        maskData2[b2i] === 255\n      ) {\n        newMaskData.push(255);\n      } else {\n        newMaskData.push(0);\n      }\n    }\n\n    return [encode(Uint8Array.from(newMaskData)), newBoundingBox];\n  }\n\n  /*\n   * Invert selected mask and compute inverted bounding box coordinates\n   * */\n  invert(\n    selectedMask: Array<number>,\n    selectedBoundingBox: [number, number, number, number]\n  ): [Array<number>, [number, number, number, number]] {\n    const mask = decode(selectedMask);\n\n    const imageWidth = this.image.width;\n    const imageHeight = this.image.height;\n\n    //find min and max boundary points when computing the mask\n    const invertedBoundingBox: [number, number, number, number] = [\n      imageWidth,\n      imageHeight,\n      0,\n      0,\n    ];\n\n    const invertedMask = new ImageJS.Image(imageWidth, imageHeight, {\n      components: 1,\n      alpha: 0,\n    });\n    for (let x = 0; x < imageWidth; x++) {\n      for (let y = 0; y < imageHeight; y++) {\n        const x_mask = x - selectedBoundingBox[0];\n        const y_mask = y - selectedBoundingBox[1];\n        const value =\n          mask[\n            x_mask + y_mask * (selectedBoundingBox[2] - selectedBoundingBox[0])\n          ];\n        if (\n          value > 0 &&\n          this.inBoundingBox(x_mask, y_mask, selectedBoundingBox)\n        ) {\n          invertedMask.setPixelXY(x, y, [0]);\n        } else {\n          invertedMask.setPixelXY(x, y, [255]);\n          if (x < invertedBoundingBox[0]) {\n            invertedBoundingBox[0] = x;\n          } else if (x > invertedBoundingBox[2]) {\n            invertedBoundingBox[2] = x + 1;\n          }\n          if (y < invertedBoundingBox[1]) {\n            invertedBoundingBox[1] = y;\n          } else if (y > invertedBoundingBox[3]) {\n            invertedBoundingBox[3] = y + 1;\n          }\n        }\n      }\n    }\n\n    //now crop the mask using the new bounding box\n    const croppedInvertedMask = invertedMask.crop({\n      x: invertedBoundingBox[0],\n      y: invertedBoundingBox[1],\n      width: invertedBoundingBox[2] - invertedBoundingBox[0],\n      height: invertedBoundingBox[3] - invertedBoundingBox[1],\n    });\n\n    const invertedmaskData = encode(Uint8Array.from(croppedInvertedMask.data));\n\n    return [invertedmaskData, invertedBoundingBox];\n  }\n\n  /*\n   * Subtracting from a Operator deselects the areas you draw over, keeping\n   * the rest of your existing Operator.\n   */\n  subtract(\n    encodedMaskData1: Array<number>,\n    boundingBox1: [number, number, number, number]\n  ): [Array<number>, [number, number, number, number]] {\n    if (!this._mask || !this._boundingBox) return [[], [0, 0, 0, 0]];\n\n    const maskData1 = decode(encodedMaskData1);\n    const maskData2 = decode(this._mask);\n\n    const boundingBox2 = this._boundingBox;\n\n    const newBoundingBox = [\n      boundingBox2[2] > boundingBox1[0] &&\n      boundingBox2[0] < boundingBox1[0] &&\n      boundingBox2[1] < boundingBox1[1] &&\n      boundingBox2[3] > boundingBox1[3]\n        ? boundingBox2[2]\n        : boundingBox1[0],\n      boundingBox2[3] > boundingBox1[1] &&\n      boundingBox2[1] < boundingBox1[1] &&\n      boundingBox2[0] < boundingBox1[0] &&\n      boundingBox2[2] > boundingBox1[2]\n        ? boundingBox2[3]\n        : boundingBox1[1],\n      boundingBox2[0] < boundingBox1[2] &&\n      boundingBox2[2] > boundingBox1[2] &&\n      boundingBox2[1] < boundingBox1[1] &&\n      boundingBox2[3] > boundingBox1[3]\n        ? boundingBox2[0]\n        : boundingBox1[2],\n      boundingBox2[1] < boundingBox1[3] &&\n      boundingBox2[3] > boundingBox1[3] &&\n      boundingBox2[0] < boundingBox1[0] &&\n      boundingBox2[2] > boundingBox1[2]\n        ? boundingBox2[1]\n        : boundingBox1[3],\n    ] as [number, number, number, number];\n\n    const newBoundingBoxWidth = newBoundingBox[2] - newBoundingBox[0];\n    const newBoundingBoxHeight = newBoundingBox[3] - newBoundingBox[1];\n\n    const newMaskData = [];\n    const deltaX1 = boundingBox1[0] - newBoundingBox[0];\n    const deltaY1 = boundingBox1[1] - newBoundingBox[1];\n    const deltaX2 = boundingBox2[0] - newBoundingBox[0];\n    const deltaY2 = boundingBox2[1] - newBoundingBox[1];\n\n    for (let i = 0; i < newBoundingBoxWidth * newBoundingBoxHeight; i++) {\n      const x = i % newBoundingBoxWidth;\n      const y = Math.floor(i / newBoundingBoxWidth);\n      const b1x = x - deltaX1;\n      const b1y = y - deltaY1;\n      const b2x = x - deltaX2;\n      const b2y = y - deltaY2;\n\n      const b1i = b1x + b1y * (boundingBox1[2] - boundingBox1[0]);\n      const b2i = b2x + b2y * (boundingBox2[2] - boundingBox2[0]);\n      if (\n        this.inBoundingBox(b1x, b1y, boundingBox1) &&\n        maskData1[b1i] === 255 &&\n        this.inBoundingBox(b2x, b2y, boundingBox2) &&\n        maskData2[b2i] === 255\n      ) {\n        newMaskData.push(0);\n      } else {\n        newMaskData.push(maskData1[b1i]);\n      }\n    }\n\n    return [encode(Uint8Array.from(newMaskData)), newBoundingBox];\n  }\n\n  get boundingBox(): [number, number, number, number] | undefined {\n    return this._boundingBox;\n  }\n\n  set boundingBox(\n    updatedBoundingBox: [number, number, number, number] | undefined\n  ) {\n    this._boundingBox = updatedBoundingBox;\n  }\n\n  computeBoundingBoxFromContours(\n    contour: Array<number>\n  ): [number, number, number, number] {\n    const pairs = _.chunk(contour, 2);\n\n    return [\n      Math.round(_.min(_.map(pairs, _.first))!),\n      Math.round(_.min(_.map(pairs, _.last))!),\n      Math.round(_.max(_.map(pairs, _.first))!),\n      Math.round(_.max(_.map(pairs, _.last))!),\n    ];\n  }\n\n  computeMask() {\n    const maskImage = new ImageJS.Image({\n      width: this.image.width,\n      height: this.image.height,\n      bitDepth: 8,\n    });\n\n    const coords = _.chunk(this.points, 2);\n\n    const connectedPoints = connectPoints(coords, maskImage); // get coordinates of connected points and draw boundaries of mask\n    simplify(connectedPoints, 1, true);\n    slpf(connectedPoints, maskImage);\n\n    //@ts-ignore\n    return maskImage.getChannel(0);\n  }\n\n  get mask(): Array<number> | undefined {\n    return this._mask;\n  }\n\n  set mask(updatedMask: Array<number> | undefined) {\n    this._mask = updatedMask;\n  }\n\n  abstract deselect(): void;\n\n  abstract onMouseDown(position: { x: number; y: number }): void;\n\n  abstract onMouseMove(position: { x: number; y: number }): void;\n\n  abstract onMouseUp(position: { x: number; y: number }): void;\n\n  annotate(category: Category, plane: number): void {\n    if (!this.boundingBox || !this.mask) return;\n\n    this.annotation = {\n      boundingBox: this.boundingBox,\n      categoryId: category.id,\n      id: uuidv4(),\n      mask: this.mask,\n      plane: plane,\n    };\n  }\n\n  registerOnAnnotatingHandler(handler: () => void): void {\n    this.onAnnotating = handler;\n  }\n\n  registerOnAnnotatedHandler(handler: () => void): void {\n    this.onAnnotated = handler;\n  }\n\n  registerOnDeselectHandler(handler: () => void): void {\n    this.onDeselect = handler;\n  }\n\n  setAnnotating() {\n    this.annotationState = AnnotationStateType.Annotating;\n    if (this.onAnnotating) {\n      this.onAnnotating();\n    }\n  }\n\n  setAnnotated() {\n    this.annotationState = AnnotationStateType.Annotated;\n    if (this.onAnnotated) {\n      this.onAnnotated();\n    }\n  }\n\n  setBlank() {\n    this.annotationState = AnnotationStateType.Blank;\n    if (this.onDeselect) {\n      this.onDeselect();\n    }\n  }\n}\n","import * as ImageJS from \"image-js\";\nimport PriorityQueue from \"ts-priority-queue\";\n\nconst dirs = [\n  [1, 0],\n  [0, 1],\n  [-1, 0],\n  [0, -1],\n];\n\nclass Position {\n  x: number;\n  y: number;\n\n  constructor(x: number, y: number) {\n    this.x = x;\n    this.y = y;\n  }\n\n  add(that: Position) {\n    this.x += that.x;\n    this.y += that.y;\n\n    return this;\n  }\n\n  clone() {\n    return new Position(this.x, this.y);\n  }\n\n  in(maximum: Position) {\n    return this.x >= 0 && this.x <= maximum.x && this.y >= 0 && maximum.y;\n  }\n\n  overwrite(that: Position) {\n    this.x = that.x;\n    this.y = that.y;\n\n    return this;\n  }\n\n  subtract(that: Position) {\n    this.x -= that.x;\n    this.y -= that.y;\n\n    return this;\n  }\n}\n\nexport interface FloodImage extends ImageJS.Image {\n  overlay: ImageJS.Image;\n  toleranceMap: ImageJS.Image;\n  target: Position;\n  overlayTolerance: number;\n}\n\n// Generate a tolerance map and associate it with the image itself\nexport const makeFloodMap = ({\n  x,\n  y,\n  image,\n}: {\n  x: number;\n  y: number;\n  image: ImageJS.Image;\n}) => {\n  const tol: Array<number> = [];\n\n  const color = image.getPixelXY(x, y);\n\n  if (image.data.length === image.width * image.height * 3) {\n    //RGB image\n    for (let i = 0; i < image.data.length; i += 3) {\n      const red = Math.abs(image.data[i] - color[0]);\n      const green = Math.abs(image.data[i + 1] - color[1]);\n      const blue = Math.abs(image.data[i + 2] - color[2]);\n      tol.push(Math.floor((red + green + blue) / 3));\n    }\n  } else if (image.data.length === image.width * image.height * 4) {\n    //RGBA image\n    for (let i = 0; i < image.data.length; i += 4) {\n      const red = Math.abs(image.data[i] - color[0]);\n      const green = Math.abs(image.data[i + 1] - color[1]);\n      const blue = Math.abs(image.data[i + 2] - color[2]);\n      tol.push(Math.floor((red + green + blue) / 3));\n    }\n  } else if (image.data.length === image.width * image.height) {\n    //greyscale\n    for (let i = 0; i < image.data.length; i++) {\n      const grey = Math.abs(image.data[i] - color[0]);\n      tol.push(Math.floor((grey / image.maxValue) * 255));\n    }\n  }\n\n  return new ImageJS.Image(image.width, image.height, tol, {\n    alpha: 0,\n    components: 1,\n  });\n};\n\n// Expand a watershed map until the desired tolerance is reached.\nexport const doFlood = ({\n  floodMap,\n  toleranceMap,\n  queue,\n  tolerance,\n  maxTol,\n  seen,\n}: {\n  floodMap: ImageJS.Image;\n  toleranceMap: ImageJS.Image;\n  queue: PriorityQueue<Array<number>>;\n  tolerance: number;\n  maxTol: number;\n  seen: Set<number>;\n}) => {\n  while (queue.length > 0 && queue.peek()[2] <= tolerance) {\n    let currentPoint = queue.dequeue();\n    maxTol = Math.max(currentPoint[2], maxTol);\n    floodMap.setPixelXY(currentPoint[0], currentPoint[1], [maxTol]);\n    for (let dir of dirs) {\n      let newX = currentPoint[0] + dir[0];\n      let newY = currentPoint[1] + dir[1];\n      let idx = newX + newY * toleranceMap.width;\n      if (\n        !seen.has(idx) &&\n        newX >= 0 &&\n        newY >= 0 &&\n        newX < toleranceMap.width &&\n        newY < toleranceMap.height\n      ) {\n        queue.queue([newX, newY, toleranceMap.getPixelXY(newX, newY)[0]]);\n        seen.add(idx);\n      }\n    }\n  }\n};\n","import { AnnotationTool } from \"../AnnotationTool\";\nimport { doFlood, makeFloodMap } from \"../../../flood\";\nimport * as ImageJS from \"image-js\";\nimport { encode } from \"../../../rle\";\nimport PriorityQueue from \"ts-priority-queue\";\nimport { AnnotationStateType } from \"../../../../../types/AnnotationStateType\";\n\nexport class ColorAnnotationTool extends AnnotationTool {\n  roiContour?: ImageJS.Image;\n  roiMask?: ImageJS.Image;\n  roiManager?: ImageJS.RoiManager;\n  offset: { x: number; y: number } = { x: 0, y: 0 };\n  overlayData: string = \"\";\n  points: Array<number> = [];\n  initialPosition: { x: number; y: number } = { x: 0, y: 0 };\n  tolerance: number = 1;\n  toleranceMap?: ImageJS.Image;\n  floodMap?: ImageJS.Image;\n  toleranceQueue: PriorityQueue<Array<number>> = new PriorityQueue({\n    comparator: function (a: Array<number>, b: Array<number>) {\n      return a[2] - b[2];\n    },\n  });\n  toolTipPosition?: { x: number; y: number };\n  maxTol: number = 0;\n  seen: Set<number> = new Set();\n\n  deselect() {\n    this.overlayData = \"\";\n\n    this.roiManager = undefined;\n    this.roiMask = undefined;\n\n    this.points = [];\n\n    this.initialPosition = { x: 0, y: 0 };\n    this.toolTipPosition = undefined;\n\n    this.tolerance = 1;\n    this.toleranceMap = undefined;\n    this.toleranceQueue.clear();\n    this.seen.clear();\n    this.maxTol = 0;\n\n    this.setBlank();\n  }\n\n  onMouseDown(position: { x: number; y: number }) {\n    this.tolerance = 1;\n    this.maxTol = 0;\n    this.initialPosition = position;\n    this.toolTipPosition = position;\n\n    this.toleranceMap = makeFloodMap({\n      x: Math.floor(position.x),\n      y: Math.floor(position.y),\n      image: this.image!,\n    });\n\n    const empty = new Array(this.image.height * this.image.width).fill(\n      Infinity\n    );\n\n    this.floodMap = new ImageJS.Image(\n      this.image.width,\n      this.image.height,\n      empty,\n      {\n        alpha: 0,\n        components: 1,\n      }\n    );\n\n    this.toleranceQueue.clear();\n    this.seen.clear();\n    this.roiManager = this.floodMap.getRoiManager();\n\n    this.toleranceQueue.queue([\n      Math.floor(position.x),\n      Math.floor(position.y),\n      0,\n    ]);\n    const idx =\n      Math.floor(position.x) + Math.floor(position.y) * this.image.width;\n    this.seen.add(idx);\n\n    this.updateOverlay(position);\n    this.setAnnotating();\n  }\n\n  onMouseMove(position: { x: number; y: number }) {\n    if (this.annotationState === AnnotationStateType.Annotating) {\n      const diff = Math.ceil(\n        Math.hypot(\n          position.x - this.initialPosition!.x,\n          position.y - this.initialPosition!.y\n        )\n      );\n      if (diff !== this.tolerance) {\n        this.tolerance = diff;\n        this.updateOverlay(this.initialPosition);\n      }\n      this.toolTipPosition = position;\n    }\n  }\n\n  onMouseUp(position: { x: number; y: number }) {\n    if (this.annotationState !== AnnotationStateType.Annotating) return;\n    if (!this.roiManager || !this.roiMask) return;\n\n    // @ts-ignore\n    this.roiManager.fromMask(this.roiMask);\n    // @ts-ignore\n    this.roiMask = this.roiManager.getMasks()[0];\n\n    //@ts-ignore\n    const rois = this.roiManager.getRois();\n    const roi = rois.sort((a: any, b: any) => {\n      return b.surface - a.surface;\n    })[1]; // take the second roi because the first one will be of the size of the image,the second one is the actual largest roi\n    this._boundingBox = [roi.minX, roi.minY, roi.maxX + 1, roi.maxY + 1];\n\n    if (!this.roiMask || !this.boundingBox) return;\n\n    const boundingBoxWidth = this.boundingBox[2] - this.boundingBox[0];\n    const boundingBoxHeight = this.boundingBox[3] - this.boundingBox[1];\n\n    if (!boundingBoxWidth || !boundingBoxHeight) return;\n\n    //mask should be the whole image, not just the ROI\n    const imgMask = new ImageJS.Image(boundingBoxWidth, boundingBoxHeight, {\n      components: 1,\n      alpha: 0,\n    });\n\n    for (let x = 0; x < boundingBoxWidth; x++) {\n      for (let y = 0; y < boundingBoxHeight; y++) {\n        //@ts-ignore\n        if (this.roiMask.getBitXY(x, y)) {\n          imgMask.setPixelXY(x, y, [255]);\n        }\n      }\n    }\n\n    // @ts-ignore\n    this._mask = encode(imgMask.data as Uint8Array);\n\n    this.setAnnotated();\n  }\n\n  private static colorOverlay(\n    mask: ImageJS.Image,\n    offset: { x: number; y: number },\n    position: { x: number; y: number },\n    width: number,\n    height: number,\n    color: string\n  ) {\n    const r = parseInt(color.slice(1, 3), 16);\n    const g = parseInt(color.slice(3, 5), 16);\n    const b = parseInt(color.slice(5, 7), 16);\n    const fillColor = [r, g, b, 150];\n\n    let overlay = new ImageJS.Image(\n      width,\n      height,\n      new Uint8Array(width * height * 4),\n      { alpha: 1 }\n    );\n\n    // roiPaint doesn't respect alpha, so we'll paint it ourselves.\n    for (let x = 0; x < mask.width; x++) {\n      for (let y = 0; y < mask.height; y++) {\n        if (mask.getBitXY(x, y)) {\n          overlay.setPixelXY(x + offset.x, y + offset.y, fillColor);\n        }\n      }\n    }\n\n    // Set the origin point to white, for visibility.\n    overlay.setPixelXY(position.x, position.y, [255, 255, 255, 255]);\n\n    return overlay.toDataURL(\"image/png\", { useCanvas: true });\n  }\n\n  private updateOverlay(position: { x: number; y: number }) {\n    if (this.maxTol <= this.tolerance) {\n      doFlood({\n        floodMap: this.floodMap!,\n        toleranceMap: this.toleranceMap!,\n        queue: this.toleranceQueue,\n        tolerance: this.tolerance,\n        maxTol: this.maxTol,\n        seen: this.seen,\n      });\n    }\n    // Make a threshold mask\n    this.roiMask = this.floodMap!.mask({\n      threshold: this.tolerance,\n      invert: true,\n    });\n\n    if (!this.roiMask) return;\n\n    this.overlayData = ColorAnnotationTool.colorOverlay(\n      this.roiMask,\n      this.offset,\n      position,\n      this.image.width,\n      this.image.height,\n      \"red\"\n    );\n  }\n}\n","import { AnnotationTool } from \"../AnnotationTool\";\nimport * as _ from \"lodash\";\nimport * as ImageJS from \"image-js\";\nimport { encode } from \"../../../rle\";\nimport { AnnotationStateType } from \"../../../../../types/AnnotationStateType\";\n\nexport class EllipticalAnnotationTool extends AnnotationTool {\n  center?: { x: number; y: number };\n  origin?: { x: number; y: number };\n  radius?: { x: number; y: number };\n\n  deselect() {\n    this.center = undefined;\n    this.origin = undefined;\n    this.radius = undefined;\n\n    this.setBlank();\n  }\n\n  onMouseDown(position: { x: number; y: number }) {\n    if (this.annotationState === AnnotationStateType.Annotated) return;\n\n    if (!this.radius) {\n      this.origin = position;\n\n      this.setAnnotating();\n    }\n  }\n\n  onMouseMove(position: { x: number; y: number }) {\n    if (this.annotationState === AnnotationStateType.Annotated) return;\n\n    this.resize(position);\n  }\n\n  onMouseUp(position: { x: number; y: number }) {\n    if (this.annotationState !== AnnotationStateType.Annotating) return;\n\n    if (this.radius) {\n      this.points = this.convertToPoints();\n\n      this._boundingBox = this.computeBoundingBoxFromContours(this.points);\n\n      const mask = this.convertToMask();\n\n      if (!mask) return;\n\n      this._mask = encode(mask);\n\n      this.setAnnotated();\n    }\n  }\n\n  private convertToMask() {\n    if (!this.boundingBox) return;\n\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = this.image.width;\n    canvas.height = this.image.height;\n\n    const ctx = canvas.getContext(\"2d\");\n\n    if (!ctx || !this.center || !this.radius) return undefined;\n\n    ctx.beginPath();\n    ctx.ellipse(\n      this.center.x,\n      this.center.y,\n      this.radius.x,\n      this.radius.y,\n      2 * Math.PI,\n      0,\n      2 * Math.PI\n    );\n    ctx.fill();\n\n    const roiWidth = this.boundingBox[2] - this.boundingBox[0];\n    const roiHeight = this.boundingBox[3] - this.boundingBox[1];\n\n    if (!roiWidth || !roiHeight) return undefined;\n\n    //@ts-ignore\n    const imageMask = ImageJS.Image.fromCanvas(canvas).getChannel(3);\n    const croppedImageMask = new ImageJS.Image(roiWidth, roiHeight, {\n      components: 1,\n      alpha: 0,\n    });\n\n    for (let x = 0; x < roiWidth; x++) {\n      for (let y = 0; y < roiHeight; y++) {\n        if (\n          imageMask.getPixelXY(\n            x + this.boundingBox[0],\n            y + this.boundingBox[1]\n          )[0] > 1\n        ) {\n          croppedImageMask.setPixelXY(x, y, [255]);\n        } else {\n          croppedImageMask.setPixelXY(x, y, [0]);\n        }\n      }\n    }\n\n    return Uint8Array.from(croppedImageMask.data);\n  }\n\n  private convertToPoints() {\n    if (!this.radius || !this.origin || !this.center) return [];\n\n    const centerX = Math.round(this.center.x);\n    const centerY = Math.round(this.center.y);\n\n    const points: Array<number> = [];\n    const foo: Array<Array<number>> = [];\n    //first quadrant points\n    for (let y = centerY; y < centerY + this.radius.y; y += 0.5) {\n      const x =\n        this.radius.x *\n          Math.sqrt(\n            1 -\n              ((y - centerY) * (y - centerY)) / (this.radius.y * this.radius.y)\n          ) +\n        centerX;\n      points.push(Math.round(x));\n      points.push(Math.round(y));\n      foo.push([Math.round(x), Math.round(y)]);\n    }\n    // const reversedFoo = _.reverse(foo);\n    //second quadrant points\n    _.forEachRight(foo, (position: Array<number>) => {\n      let x = 2 * centerX - position[0];\n      points.push(x);\n      points.push(position[1]);\n    });\n    //third quadrant points\n    _.forEach(foo, (position: Array<number>) => {\n      let x = 2 * centerX - position[0];\n      let y = 2 * centerY - position[1];\n      points.push(x);\n      points.push(y);\n    });\n    //fourth quadant points\n    _.forEachRight(foo, (position: Array<number>) => {\n      let y = 2 * centerY - position[1];\n      points.push(position[0]);\n      points.push(y);\n    });\n\n    return points;\n  }\n\n  private resize(position: { x: number; y: number }) {\n    if (this.origin) {\n      this.center = {\n        x: (position.x - this.origin.x) / 2 + this.origin.x,\n        y: (position.y - this.origin.y) / 2 + this.origin.y,\n      };\n\n      this.radius = {\n        x: Math.abs((position.x - this.origin.x) / 2),\n        y: Math.abs((position.y - this.origin.y) / 2),\n      };\n    }\n  }\n}\n","import { AnnotationTool } from \"../AnnotationTool\";\nimport { encode } from \"../../../rle\";\nimport { AnnotationStateType } from \"../../../../../types/AnnotationStateType\";\n\nexport class LassoAnnotationTool extends AnnotationTool {\n  anchor?: { x: number; y: number };\n  buffer: Array<number> = [];\n  origin?: { x: number; y: number };\n  points: Array<number> = [];\n\n  deselect() {\n    this.annotation = undefined;\n\n    this.anchor = undefined;\n    this.buffer = [];\n    this.origin = undefined;\n    this.points = [];\n\n    this.setBlank();\n  }\n\n  onMouseDown(position: { x: number; y: number }) {\n    if (this.annotationState === AnnotationStateType.Annotated) return;\n\n    if (this.buffer && this.buffer.length === 0) {\n      if (!this.origin) {\n        this.origin = position;\n        this.buffer = [...this.buffer, position.x, position.y];\n      }\n\n      this.setAnnotating();\n    }\n  }\n\n  onMouseMove(position: { x: number; y: number }) {\n    if (this.annotationState !== AnnotationStateType.Annotating) return;\n\n    if (this.anchor) {\n      if (\n        this.buffer[this.buffer.length - 2] !== this.anchor.x ||\n        this.buffer[this.buffer.length - 1] !== this.anchor.y\n      ) {\n        this.buffer.pop();\n        this.buffer.pop();\n      }\n\n      this.buffer = [...this.buffer, position.x, position.y];\n\n      return;\n    }\n\n    if (this.origin) {\n      this.buffer = [...this.buffer, position.x, position.y];\n    }\n  }\n\n  onMouseUp(position: { x: number; y: number }) {\n    if (this.annotationState !== AnnotationStateType.Annotating || !this.origin)\n      return;\n\n    if (this.buffer.length < 3) return;\n\n    if (this.origin && this.buffer && this.buffer.length > 0) {\n      this.buffer = [\n        ...this.buffer,\n        position.x,\n        position.y,\n        this.origin.x,\n        this.origin.y,\n      ];\n\n      this.points = this.buffer;\n      this._boundingBox = this.computeBoundingBoxFromContours(this.points);\n\n      const maskImage = this.computeMask().crop({\n        x: this._boundingBox[0],\n        y: this._boundingBox[1],\n        width: this._boundingBox[2] - this._boundingBox[0],\n        height: this._boundingBox[3] - this._boundingBox[1],\n      });\n\n      this._mask = encode(maskImage.data);\n\n      this.buffer = [];\n\n      this.setAnnotated();\n    }\n\n    if (this.anchor) {\n      this.anchor = {\n        x: this.buffer[this.buffer.length - 2],\n        y: this.buffer[this.buffer.length - 1],\n      };\n\n      return;\n    }\n\n    if (this.origin && this.buffer && this.buffer.length > 0) {\n      this.anchor = {\n        x: this.buffer[this.buffer.length - 2],\n        y: this.buffer[this.buffer.length - 1],\n      };\n\n      return;\n    }\n  }\n\n  private connected(\n    position: { x: number; y: number },\n    threshold: number = 4\n  ): boolean | undefined {\n    if (!this.origin) return undefined;\n\n    const distance = Math.hypot(\n      position.x - this.origin.x,\n      position.y - this.origin.y\n    );\n\n    return distance < threshold;\n  }\n}\n","/**\n * Based on https://github.com/mourner/tinyqueue\n * Copyright (c) 2017, Vladimir Agafonkin https://github.com/mourner/tinyqueue/blob/master/LICENSE\n *\n * Adapted for PathFinding needs by @anvaka\n * Copyright (c) 2017, Andrei Kashcha\n *\n * Further adapted for Piximi\n */\nimport { PiximiNode } from \"../GraphHelper\";\n\nexport class NodeHeap {\n  public data: Array<any> = [];\n\n  public length: number = 0;\n\n  compare(a: PiximiNode, b: PiximiNode) {\n    return a.fScore - b.fScore;\n  }\n\n  setNodeId(node: PiximiNode, heapIndex: number) {\n    node.heapIndex = heapIndex;\n  }\n\n  push(item: any) {\n    this.data.push(item);\n    this.setNodeId(item, this.length);\n    this.length++;\n    this._up(this.length - 1);\n  }\n\n  pop() {\n    if (this.length === 0) return undefined;\n\n    const top = this.data[0];\n    this.length--;\n\n    if (this.length > 0) {\n      this.data[0] = this.data[this.length];\n      this.setNodeId(this.data[0], 0);\n      this._down(0);\n    }\n    this.data.pop();\n\n    return top;\n  }\n\n  updateItem(pos: number) {\n    this._down(pos);\n    this._up(pos);\n  }\n\n  _up(pos: number) {\n    const data = this.data;\n    const compare = this.compare;\n    const setNodeId = this.setNodeId;\n    const item = data[pos];\n\n    while (pos > 0) {\n      const parent = (pos - 1) >> 1;\n      const current = data[parent];\n      if (compare(item, current) >= 0) break;\n      data[pos] = current;\n\n      setNodeId(current, pos);\n      pos = parent;\n    }\n\n    data[pos] = item;\n    setNodeId(item, pos);\n  }\n\n  _down(pos: number) {\n    const data = this.data;\n    const compare = this.compare;\n    const halfLength = this.length >> 1;\n    const item = data[pos];\n    const setNodeId = this.setNodeId;\n\n    while (pos < halfLength) {\n      let left = (pos << 1) + 1;\n      const right = left + 1;\n      let best = data[left];\n\n      if (right < this.length && compare(data[right], best) < 0) {\n        left = right;\n        best = data[right];\n      }\n      if (compare(best, item) >= 0) break;\n\n      data[pos] = best;\n      setNodeId(best, pos);\n      pos = left;\n    }\n\n    data[pos] = item;\n    setNodeId(item, pos);\n  }\n}\n","import { NodeHeap } from \"./NodeHeap\";\nimport { fromIdxToCoord, PiximiGraph, PiximiNode } from \"../GraphHelper\";\nimport { Node } from \"ngraph.graph\";\n\n/**\n * Performs a uni-directional A Star search on graph.\n *\n * We will try to minimize f(n) = g(n) + h(n), where\n * g(n) is actual distance from source node to `n`, and\n * h(n) is heuristic distance from `n` to target node.\n */\n\nconst NO_PATH: never[] = [];\n\n/**\n * Creates a new instance of pathfinder. A pathfinder has just one method:\n * `find(fromId, toId)`, it may be extended in future.\n *\n * @param graph instance. See https://github.com/anvaka/ngraph.graph\n * @param {width} width of the original image\n * @param {factor} factor for scaling between image and graph\n *\n * @returns {Object} A pathfinder with single method `find()`.\n */\nexport function cachedAStarPathSearch(\n  graph: PiximiGraph,\n  width: number,\n  factor: number\n) {\n  // whether traversal should be considered over oriented graph.\n  const oriented = true;\n\n  const heuristic = (fromNode: PiximiNode, toNode: PiximiNode) => {\n    const [x1, y1] = fromIdxToCoord(fromNode.id as number, width);\n    const [x2, y2] = fromIdxToCoord(toNode.id as number, width);\n    if (x1 === x2 || y1 === y2) {\n      return 1;\n    }\n    return 1.41;\n  };\n\n  const distance = (fromNode: Node, toNode: Node) => {\n    const [x1, y1] = fromIdxToCoord(fromNode.id as number, width);\n    const [x2, y2] = fromIdxToCoord(toNode.id as number, width);\n    if (x1 === x2 || y1 === y2) {\n      return 1 * toNode.data;\n    }\n    return 1.41 * toNode.data;\n  };\n\n  return {\n    /**\n     * Finds a path between node `fromId` and `toId`.\n     * @returns {Array} of nodes between `toId` and `fromId`. Empty array is returned\n     * if no path is found.\n     */\n    find: find,\n  };\n\n  function find(fromId: number, toId: number) {\n    const from = graph.getNode(fromId) as PiximiNode;\n    if (!from) return NO_PATH;\n    const to = graph.getNode(toId) as PiximiNode;\n    if (!to) return NO_PATH;\n\n    let cameFrom: any;\n    // Maps nodeId to NodeSearchState.\n\n    const dest = graph.getNode(toId) as PiximiNode;\n    if (dest) {\n      if (dest.fromId === fromId && dest.trace.length > 0) {\n        return dest.trace;\n      }\n    }\n\n    if (graph.fromId !== fromId || graph.openSet.length === 0) {\n      graph.openSet = new NodeHeap();\n      // For the first node, fScore is completely heuristic.\n      from.fScore = heuristic(from, to);\n\n      // The cost of going from start to start is zero.\n      from.distanceToSource = 0;\n      graph.openSet.push(from);\n      from.open = 1;\n      graph.fromId = fromId;\n    }\n\n    while (graph.openSet.length > 0) {\n      cameFrom = graph.openSet.pop();\n\n      if (cameFrom.id === toId) {\n        cameFrom.trace = reconstructPath(graph, cameFrom, width, factor);\n        cameFrom.fromId = fromId;\n        return cameFrom.trace;\n      }\n\n      // no need to visit this node anymore\n      cameFrom.trace = reconstructPath(graph, cameFrom, width, factor);\n      cameFrom.fromId = fromId;\n      cameFrom.closed = true;\n      graph.forEachLinkedNode(cameFrom.id, visitNeighbour, oriented);\n    }\n\n    // If we got here, then there is no path.\n    return NO_PATH;\n\n    function visitNeighbour(otherNode: any) {\n      if (otherNode.fromId !== graph.fromId) {\n        // This is old data, reset all params\n        otherNode.fromId = graph.fromId;\n        otherNode.trace = [];\n        otherNode.parentId = null;\n        otherNode.closed = false;\n        otherNode.open = 0;\n        otherNode.distanceToSource = Number.POSITIVE_INFINITY;\n        otherNode.fScore = Number.POSITIVE_INFINITY;\n        otherNode.heapIndex = -1;\n      }\n\n      if (otherNode.closed) {\n        // Already processed this node.\n        return;\n      }\n      if (otherNode.open === 0) {\n        // Remember this node.\n        graph.openSet.push(otherNode);\n        otherNode.open = 1;\n      }\n\n      const tentativeDistance =\n        cameFrom.distanceToSource + distance(otherNode, cameFrom);\n      if (tentativeDistance >= otherNode.distanceToSource) {\n        // This would only make our path longer. Ignore this route.\n        return;\n      }\n\n      // bingo! we found shorter path:\n      otherNode.parentId = cameFrom.id;\n      otherNode.distanceToSource = tentativeDistance;\n      otherNode.fScore = tentativeDistance + heuristic(otherNode, to);\n\n      graph.openSet.updateItem(otherNode.heapIndex);\n    }\n  }\n}\n\nfunction reconstructPath(\n  graph: PiximiGraph,\n  searchNode: PiximiNode | null,\n  width: number,\n  factor: number = 1\n) {\n  if (!searchNode) return;\n\n  const [x, y] = fromIdxToCoord(searchNode.id as number, width);\n  const newCoord = [x / factor, y / factor];\n  let coords = [];\n  const fromId = graph.fromId;\n  if (searchNode!.parentId !== null) {\n    const parentNode = graph.getNode(searchNode!.parentId) as PiximiNode;\n    if (typeof parentNode !== \"undefined\" && parentNode.fromId === fromId) {\n      // Fetch a trace from the last coordinate\n      coords.push(...parentNode.trace);\n      if (coords.length > 1) {\n        const oldDirection = pathDirection(\n          coords[coords.length - 2],\n          coords[coords.length - 1]\n        );\n        const newDirection = pathDirection(coords[coords.length - 1], newCoord);\n        if (oldDirection === newDirection) {\n          coords.pop();\n        }\n      }\n    }\n  }\n  coords.push(newCoord);\n  return coords;\n}\n\nexport const pathDirection = (from: Array<number>, to: Array<number>) => {\n  // Generate a number representing the relative direction of the coordinates.\n  // Assuming TopLeft of an image is 0,0\n  const dx = to[0] - from[0];\n  const dy = to[1] - from[1];\n  if (dx === 0) {\n    if (dy < 0) {\n      return 0; // Up\n    }\n    if (dy > 0) {\n      return 4; // Down\n    }\n  }\n  if (dy === 0) {\n    if (dx > 0) {\n      return 2; // Right\n    }\n    if (dx < 0) {\n      return 6; // Left\n    }\n  }\n  if (dx > 0) {\n    if (dy < 0) {\n      return 1; // Up+Right\n    }\n    if (dy > 0) {\n      return 3; // Down+Right\n    }\n  }\n  if (dx < 0) {\n    if (dy < 0) {\n      return 7; // Up+Left\n    }\n    if (dy > 0) {\n      return 5; // Down+Left\n    }\n  }\n  console.log(\n    \"Invalid direction, this should never appear so check the code\",\n    dx,\n    dy\n  );\n};\n","export enum ExampleProject {\n  Mnist,\n  CElegans,\n  HumanU2OSCells,\n}\n","import createGraph, { Graph, Node } from \"ngraph.graph\";\nimport { getIdx } from \"../../image/imageHelper\";\nimport { DataArray } from \"image-js\";\n\nimport { cachedAStarPathSearch } from \"./pathfinder/PathFinder\";\nimport { NodeHeap } from \"./pathfinder/NodeHeap\";\n\nexport interface PiximiGraph extends Graph {\n  fromId: number;\n  openSet: NodeHeap;\n}\n\nexport interface PiximiNode extends Node {\n  fromId: number;\n  trace: Array<Array<number>>;\n\n  parentId: number | null;\n  closed: boolean;\n  open: number;\n  distanceToSource: number;\n  fScore: number;\n  heapIndex: number;\n}\n\nexport const validNeighbours = (\n  x: number,\n  y: number,\n  height: number,\n  width: number\n) => {\n  const xoffsets = [0];\n  const yoffsets = [0];\n  const output: { x: number; y: number }[] = [];\n  //David will know what to write here\n  if (x > 0) {\n    xoffsets.push(-1);\n  }\n  if (x < width - 1) {\n    xoffsets.push(1);\n  }\n  if (y > 0) {\n    yoffsets.push(-1);\n  }\n  if (y < height - 1) {\n    yoffsets.push(1);\n  }\n  for (let xoffset of xoffsets) {\n    for (let yoffset of yoffsets) {\n      if (!(xoffset === 0 && yoffset === 0)) {\n        output.push({ x: x + xoffset, y: y + yoffset });\n      }\n    }\n  }\n  return output;\n};\n\nexport const fromIdxToCoord = (idx: number, width: number) => {\n  const row = Math.floor(idx / width);\n  const col = idx - row * width;\n  return [col, row];\n};\n\nexport const makeGraph = (\n  edges: Uint8ClampedArray | DataArray,\n  height: number,\n  width: number\n) => {\n  let graph: any = createGraph();\n  graph.fromId = -1;\n  graph.openSet = new NodeHeap();\n  let cap = 255;\n  if (edges.BYTES_PER_ELEMENT === 2) {\n    cap = 65535;\n  }\n  for (let y = 0; y < height; y++) {\n    for (let x = 0; x < width; x++) {\n      const startIdx = getIdx(width, 1)(x, y, 0);\n      const dist = cap - edges[startIdx];\n\n      graph.addNode(startIdx, dist);\n\n      const pixels = validNeighbours(x, y, height, width);\n\n      for (let pixel of pixels) {\n        const idx = getIdx(width, 1)(pixel.x, pixel.y, 0);\n        graph.addLink(startIdx, idx);\n      }\n    }\n  }\n  return graph as PiximiGraph;\n};\n\nexport const createPathFinder = (\n  graph: PiximiGraph,\n  width: number,\n  factor: number\n) => {\n  return cachedAStarPathSearch(graph, width, factor);\n};\n\nexport const convertPathToCoords = (\n  foundPath: any,\n  width: number,\n  factor: number = 1\n) => {\n  const pathCoords = [];\n  for (let node of foundPath) {\n    const id = node.id as number;\n    const [x, y] = fromIdxToCoord(id, width);\n    pathCoords.push([x / factor, y / factor]);\n  }\n  return pathCoords;\n};\n","import { AnnotationTool } from \"../AnnotationTool\";\nimport { createPathFinder, makeGraph, PiximiGraph } from \"../../../GraphHelper\";\nimport { getIdx } from \"../../../../../image/imageHelper\";\nimport * as ImageJS from \"image-js\";\nimport * as _ from \"lodash\";\nimport { encode } from \"../../../rle\";\nimport { AnnotationStateType } from \"../../../../../types/AnnotationStateType\";\n\nexport class MagneticAnnotationTool extends AnnotationTool {\n  anchor?: { x: number; y: number };\n  buffer: Array<number> = [];\n  factor: number;\n  graph?: PiximiGraph;\n  origin?: { x: number; y: number };\n  path: Array<number> = [];\n  pathfinder?: { find: (fromId: number, toId: number) => any };\n  points: Array<number> = [];\n  previous: Array<number> = [];\n  response?: ImageJS.Image;\n\n  constructor(image: ImageJS.Image, factor: number = 0.5) {\n    super(image);\n\n    this.factor = factor;\n\n    this.filter();\n\n    if (!this.image || !this.response) return;\n\n    this.graph = makeGraph(\n      this.response.data,\n      this.response.height,\n      this.response.width\n    );\n\n    this.pathfinder = createPathFinder(\n      this.graph,\n      this.image.width * factor,\n      factor\n    );\n  }\n\n  deselect() {\n    this.annotation = undefined;\n\n    this.anchor = undefined;\n    this.buffer = [];\n    this.graph = undefined;\n    this.origin = undefined;\n    this.points = [];\n    this.previous = [];\n\n    this.setBlank();\n  }\n\n  onMouseDown(position: { x: number; y: number }) {\n    if (this.annotationState === AnnotationStateType.Annotated) return;\n\n    if (this.buffer && this.buffer.length === 0) {\n      if (!this.origin) {\n        this.origin = position;\n      }\n\n      this.setAnnotating();\n    }\n  }\n\n  onMouseMove(position: { x: number; y: number }) {\n    if (\n      !this.image ||\n      !this.pathfinder ||\n      this.annotationState !== AnnotationStateType.Annotating\n    )\n      return;\n\n    if (this.anchor) {\n      const source = getIdx(this.image.width * this.factor, 1)(\n        Math.floor(this.anchor.x * this.factor),\n        Math.floor(this.anchor.y * this.factor),\n        0\n      );\n\n      const destination = getIdx(this.image.width * this.factor, 1)(\n        Math.floor(position.x * this.factor),\n        Math.floor(position.y * this.factor),\n        0\n      );\n\n      this.path = _.flatten(this.pathfinder.find(source, destination));\n\n      if (\n        this.buffer[this.buffer.length - 2] !== this.anchor.x ||\n        this.buffer[this.buffer.length - 1] !== this.anchor.y\n      ) {\n        this.buffer.pop();\n        this.buffer.pop();\n      }\n\n      this.buffer = [\n        ...this.previous,\n        this.anchor.x,\n        this.anchor.y,\n        ...this.path,\n      ];\n\n      return;\n    }\n\n    if (this.origin) {\n      const source = getIdx(this.image.width * this.factor, 1)(\n        Math.floor(this.origin.x * this.factor),\n        Math.floor(this.origin.y * this.factor),\n        0\n      );\n\n      const destination = getIdx(this.image.width * this.factor, 1)(\n        Math.floor(position.x * this.factor),\n        Math.floor(position.y * this.factor),\n        0\n      );\n\n      this.path = _.flatten(this.pathfinder.find(source, destination));\n\n      this.buffer.pop();\n      this.buffer.pop();\n\n      this.buffer = [this.origin.x, this.origin.y, ...this.path];\n    }\n  }\n\n  onMouseUp(position: { x: number; y: number }) {\n    if (this.annotationState !== AnnotationStateType.Annotating) return;\n\n    if (\n      this.connected(position) &&\n      this.origin &&\n      this.buffer &&\n      this.buffer.length > 0\n    ) {\n      this.buffer = [\n        ...this.buffer,\n        position.x,\n        position.y,\n        this.origin.x,\n        this.origin.y,\n      ];\n\n      this.points = this.buffer;\n\n      this._boundingBox = this.computeBoundingBoxFromContours(this.points);\n\n      const maskImage = this.computeMask().crop({\n        x: this._boundingBox[0],\n        y: this._boundingBox[1],\n        width: this._boundingBox[2] - this._boundingBox[0],\n        height: this._boundingBox[3] - this._boundingBox[1],\n      });\n\n      this._mask = encode(maskImage.data);\n\n      this.buffer = [];\n\n      this.setAnnotated();\n\n      return;\n    }\n\n    if (this.anchor && this.image) {\n      const source = getIdx(this.image.width * this.factor, 1)(\n        Math.floor(this.anchor.x * this.factor),\n        Math.floor(this.anchor.y * this.factor),\n        0\n      );\n\n      const destination = getIdx(this.image.width * this.factor, 1)(\n        Math.floor(this.buffer[this.buffer.length - 2] * this.factor),\n        Math.floor(this.buffer[this.buffer.length - 1] * this.factor),\n        0\n      );\n\n      if (!this.pathfinder) return;\n\n      this.path = _.flatten(this.pathfinder.find(source, destination));\n\n      this.buffer.pop();\n      this.buffer.pop();\n\n      this.buffer = [...this.previous, ...this.path];\n\n      this.previous = [...this.previous, ...this.path];\n\n      this.anchor = {\n        x: this.buffer[this.buffer.length - 2],\n        y: this.buffer[this.buffer.length - 1],\n      };\n\n      return;\n    }\n\n    if (this.origin && this.buffer.length > 0) {\n      if (!this.image || !this.origin || !this.pathfinder) return;\n\n      this.anchor = {\n        x: this.buffer[this.buffer.length - 2],\n        y: this.buffer[this.buffer.length - 1],\n      };\n\n      const source = getIdx(this.image.width * this.factor, 1)(\n        Math.floor(this.origin.x * this.factor),\n        Math.floor(this.origin.y * this.factor),\n        0\n      );\n\n      const destination = getIdx(this.image.width * this.factor, 1)(\n        Math.floor(this.buffer[this.buffer.length - 2] * this.factor),\n        Math.floor(this.buffer[this.buffer.length - 1] * this.factor),\n        0\n      );\n\n      this.path = _.flatten(this.pathfinder.find(source, destination));\n\n      this.buffer = [this.origin.x, this.origin.y, ...this.path];\n\n      this.previous = [\n        ...this.previous,\n        this.origin.x,\n        this.origin.y,\n        ...this.path,\n      ];\n\n      return;\n    }\n  }\n\n  private connected(\n    position: { x: number; y: number },\n    threshold: number = 4\n  ): boolean | undefined {\n    if (!this.origin) return undefined;\n\n    const distance = Math.hypot(\n      position.x - this.origin.x,\n      position.y - this.origin.y\n    );\n\n    return distance < threshold;\n  }\n\n  private filter() {\n    if (!this.image) return;\n\n    const options = { factor: this.factor };\n\n    this.response = this.image.resize(options).grey().sobelFilter();\n  }\n}\n","import { AnnotationTool } from \"../AnnotationTool\";\nimport { encode } from \"../../../rle\";\nimport { AnnotationStateType } from \"../../../../../types/AnnotationStateType\";\n\nexport class RectangularAnnotationTool extends AnnotationTool {\n  origin?: { x: number; y: number };\n\n  width?: number;\n  height?: number;\n\n  computeBoundingBox(): [number, number, number, number] | undefined {\n    if (!this.points || !this.points.length) return undefined;\n    return [this.points[0], this.points[1], this.points[4], this.points[5]];\n  }\n\n  deselect() {\n    this.origin = undefined;\n\n    this.width = undefined;\n    this.height = undefined;\n\n    this.setBlank();\n  }\n\n  onMouseDown(position: { x: number; y: number }) {\n    if (this.annotationState === AnnotationStateType.Annotated) return;\n\n    if (!this.width) {\n      this.origin = position;\n\n      this.setAnnotating();\n    } else {\n      this.resize(position);\n\n      this.points = this.convertToPoints();\n\n      this._boundingBox = this.computeBoundingBox();\n\n      const mask = this.convertToMask();\n      if (!mask) return;\n      this._mask = encode(new Uint8Array(mask));\n\n      this.setAnnotated();\n    }\n  }\n\n  onMouseMove(position: { x: number; y: number }) {\n    if (this.annotationState !== AnnotationStateType.Annotating) return;\n\n    this.resize(position);\n  }\n\n  onMouseUp(position: { x: number; y: number }) {\n    if (this.annotationState !== AnnotationStateType.Annotating) return;\n\n    if (this.width) {\n      this.points = this.convertToPoints();\n\n      this._boundingBox = this.computeBoundingBox();\n\n      const mask = this.convertToMask();\n      if (!mask) return;\n      this._mask = encode(new Uint8Array(mask));\n\n      this.setAnnotated();\n    }\n  }\n\n  private convertToPoints() {\n    if (!this.width || !this.height || !this.origin) return [];\n\n    const points: Array<number> = [];\n\n    const origin = { x: this.origin.x, y: this.origin.y };\n    let width = this.width;\n    let height = this.height;\n\n    //negative height and width may happen if the rectangle was drawn from right to left\n    if (this.width < 0) {\n      width = Math.abs(this.width);\n      origin.x = this.origin.x - width;\n    }\n    if (this.height < 0) {\n      height = Math.abs(this.height);\n      origin.y = this.origin.y - height;\n    }\n\n    // add corners of the rectangle\n    const x1 = Math.round(origin.x);\n    const y1 = Math.round(origin.y);\n    const x2 = Math.round(origin.x + width);\n    const y2 = Math.round(origin.y + height);\n    points.push(...[x1, y1, x2, y1, x2, y2, x1, y2, x1, y1]);\n\n    return points;\n  }\n\n  private convertToMask() {\n    if (!this.points || !this.boundingBox) return;\n\n    const x1 = this.points[0];\n    const y1 = this.points[1];\n    const x2 = this.points[4];\n    const y2 = this.points[5];\n\n    return new Uint8Array((x2 - x1) * (y2 - y1)).fill(255);\n  }\n\n  private resize(position: { x: number; y: number }) {\n    if (this.origin) {\n      this.width = position.x - this.origin.x;\n      this.height = position.y - this.origin.y;\n    }\n  }\n}\n","import { RectangularAnnotationTool } from \"../RectangularAnnotationTool\";\nimport * as ImageJS from \"image-js\";\nimport * as tensorflow from \"@tensorflow/tfjs\";\nimport * as _ from \"lodash\";\nimport { encode } from \"../../../rle\";\nimport { AnnotationStateType } from \"../../../../../types/AnnotationStateType\";\n\nexport class ObjectAnnotationTool extends RectangularAnnotationTool {\n  graph?: tensorflow.LayersModel;\n  prediction?: ImageJS.Image;\n  points: Array<number> = [];\n  // @ts-ignore\n  roi?: ImageJS.Roi;\n  offset?: { x: number; y: number };\n  output?: ImageJS.Image;\n\n  deselect() {\n    this.prediction = undefined;\n    this.points = [];\n    this.roi = undefined;\n    this.offset = undefined;\n    this.output = undefined;\n\n    this.origin = undefined;\n    this.width = undefined;\n\n    this.setBlank();\n  }\n\n  async onMouseUp(position: { x: number; y: number }) {\n    if (this.annotationState !== AnnotationStateType.Annotating) return;\n\n    await this.predict();\n  }\n\n  static async compile(image: ImageJS.Image) {\n    const instance = new ObjectAnnotationTool(image);\n\n    const pathname =\n      \"https://raw.githubusercontent.com/zaidalyafeai/HostedModels/master/unet-128/model.json\";\n\n    instance.graph = await tensorflow.loadLayersModel(pathname);\n\n    const optimizer = tensorflow.train.adam();\n\n    instance.graph.compile({\n      optimizer: optimizer,\n      loss: \"categoricalCrossentropy\",\n      metrics: [\"accuracy\"],\n    });\n\n    return instance;\n  }\n\n  private async predict() {\n    if (!this.image || !this.origin || !this.width || !this.height) return;\n\n    const width = Math.round(this.width);\n    const height = Math.round(this.height);\n\n    const crop = this.image.crop({\n      x: this.origin.x,\n      y: this.origin.y,\n      width: width,\n      height: height,\n    });\n\n    const prediction = tensorflow.tidy(() => {\n      if (crop) {\n        const cropped: tensorflow.Tensor3D = tensorflow.browser.fromPixels(\n          crop.getCanvas()\n        );\n\n        const size: [number, number] = [128, 128];\n        const resized = tensorflow.image.resizeBilinear(cropped, size);\n        const standardized = resized.div(tensorflow.scalar(255));\n        const batch = standardized.expandDims(0);\n\n        if (!this.height || !this.width || !this.origin) return;\n\n        if (this.graph) {\n          const prediction = this.graph.predict(\n            batch\n          ) as tensorflow.Tensor<tensorflow.Rank>;\n\n          return prediction\n            .squeeze([0])\n            .tile([1, 1, 3])\n            .sub(0.3)\n            .sign()\n            .relu()\n            .resizeBilinear([height, width])\n            .pad([\n              [this.origin.y, this.image.height - (this.origin.y + height)],\n              [this.origin.x, this.image.width - (this.origin.x + width)],\n              [0, 0],\n            ]);\n        }\n      }\n    });\n\n    if (prediction) {\n      const clamped: Uint8ClampedArray = await tensorflow.browser.toPixels(\n        prediction as tensorflow.Tensor3D\n      );\n      // .then(async (clamped) => {\n      this.output = new ImageJS.Image({\n        width: this.image.width,\n        height: this.image.height,\n        data: clamped,\n      });\n\n      const greyMask = this.output.grey();\n\n      //compute bounding box with ROI manager\n      const roiManager = this.image.getRoiManager();\n      //@ts-ignore\n      const binaryMask = greyMask.mask({\n        algorithm: \"threshold\",\n        threshold: 1,\n      });\n      // @ts-ignore\n      roiManager.fromMask(binaryMask);\n      // @ts-ignore\n      const rois = roiManager.getRois();\n      const roi = rois.sort((a: any, b: any) => {\n        return b.surface - a.surface;\n      })[1]; // take the second roi because the first one will be of the size of the image,the second one is the actual largest roi\n      this._boundingBox = [roi.minX, roi.minY, roi.maxX, roi.maxY];\n\n      //threshold\n      const thresholded = _.map(greyMask.data, (i: number) =>\n        i > 1 ? 255 : 0\n      ); //threshold necessary because output of NN is not binary\n\n      // @ts-ignore\n      this._mask = encode(thresholded);\n\n      this.width = undefined;\n    }\n\n    this.setAnnotated();\n  }\n}\n","import { AnnotationTool } from \"../AnnotationTool\";\nimport * as ImageJS from \"image-js\";\nimport * as _ from \"lodash\";\nimport { connectPoints } from \"../../../../../image/imageHelper\";\nimport { encode } from \"../../../rle\";\nimport { AnnotationStateType } from \"../../../../../types/AnnotationStateType\";\n\nexport class PenAnnotationTool extends AnnotationTool {\n  brushSize: number = 8;\n  circlesData: Uint8ClampedArray | Uint8Array | undefined = undefined;\n  buffer: Array<number> = [];\n  outline: Array<number> = [];\n  points: Array<number> = [];\n\n  computeCircleData(): Uint8Array | Uint8ClampedArray | undefined {\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = this.image.width;\n    canvas.height = this.image.height;\n    const ctx = canvas.getContext(\"2d\");\n\n    if (!ctx) return undefined;\n\n    let connected;\n\n    if (this.points.length === 2) {\n      // handling the case in which a single point has been clicked\n      connected = _.chunk(this.points, 2);\n    } else {\n      connected = connectPoints(\n        _.chunk(this.points, 2),\n        new ImageJS.Image(this.image.width, this.image.height)\n      );\n    }\n\n    //compute bounding box coordinates\n    const bbox = this.computeBoundingBoxFromContours(_.flatten(connected));\n    this._boundingBox = [\n      Math.max(0, Math.round(bbox[0] - this.brushSize)),\n      Math.max(0, Math.round(bbox[1] - this.brushSize)),\n      Math.min(this.image.width, Math.round(bbox[2] + this.brushSize)),\n      Math.min(this.image.height, Math.round(bbox[3] + this.brushSize)),\n    ];\n\n    //compute mask by drawing circles over canvas\n    connected.forEach((position) => {\n      ctx.beginPath();\n      ctx.arc(\n        Math.round(position[0]),\n        Math.round(position[1]),\n        this.brushSize,\n        0,\n        Math.PI * 2,\n        true\n      );\n      ctx.fill();\n    });\n\n    const rgbMask = ImageJS.Image.fromCanvas(canvas);\n\n    const croppedRgbMask = rgbMask.crop({\n      x: this._boundingBox[0],\n      y: this._boundingBox[1],\n      width: this._boundingBox[2] - this._boundingBox[0],\n      height: this._boundingBox[3] - this._boundingBox[1],\n    });\n\n    // @ts-ignore\n    this.circlesData = this.thresholdMask(croppedRgbMask.getChannel(3)).data;\n  }\n\n  deselect() {\n    this.circlesData = undefined;\n    this.buffer = [];\n    this.outline = [];\n    this.points = [];\n\n    this.setBlank();\n  }\n\n  onMouseDown(position: { x: number; y: number }) {\n    if (this.annotationState === AnnotationStateType.Annotated) return;\n\n    this.buffer = [...this.buffer, position.x, position.y];\n\n    this.setAnnotating();\n  }\n\n  onMouseMove(position: { x: number; y: number }) {\n    if (this.annotationState !== AnnotationStateType.Annotating) return;\n\n    this.buffer = [...this.buffer, position.x, position.y];\n  }\n\n  onMouseUp(position: { x: number; y: number }) {\n    if (this.annotationState !== AnnotationStateType.Annotating) return;\n\n    this.points = this.buffer;\n\n    this.computeCircleData(); //this will set the bounding box as well\n\n    if (!this.circlesData) return [];\n\n    this._mask = encode(this.circlesData);\n\n    this.setAnnotated();\n  }\n\n  // TODO: Doesn't need to be async? Should be a constructor? -- Nodar\n  static async setup(image: ImageJS.Image, brushSize: number) {\n    const operator = new PenAnnotationTool(image);\n\n    operator.brushSize = brushSize;\n\n    return operator;\n  }\n\n  private thresholdMask = (mask: ImageJS.Image) => {\n    for (let x = 0; x < mask.width; x++) {\n      for (let y = 0; y < mask.height; y++) {\n        if (mask.getPixelXY(x, y)[0] > 1) {\n          mask.setPixelXY(x, y, [255]);\n        } else {\n          mask.setPixelXY(x, y, [0]);\n        }\n      }\n    }\n    return mask;\n  };\n}\n","import { AnnotationTool } from \"../AnnotationTool\";\nimport { encode } from \"../../../rle\";\nimport { AnnotationStateType } from \"../../../../../types/AnnotationStateType\";\n\nexport class PolygonalAnnotationTool extends AnnotationTool {\n  anchor?: { x: number; y: number };\n  buffer: Array<number> = [];\n  origin?: { x: number; y: number };\n  points: Array<number> = [];\n\n  deselect() {\n    this.annotation = undefined;\n\n    this.anchor = undefined;\n    this.buffer = [];\n    this.origin = undefined;\n    this.points = [];\n\n    this.setBlank();\n  }\n\n  onMouseDown(position: { x: number; y: number }) {\n    if (this.annotationState === AnnotationStateType.Annotated) return;\n\n    if (this.buffer && this.buffer.length === 0) {\n      if (!this.origin) {\n        this.origin = position;\n      }\n\n      this.setAnnotating();\n    }\n  }\n\n  onMouseMove(position: { x: number; y: number }) {\n    if (this.annotationState !== AnnotationStateType.Annotating) return;\n\n    if (this.anchor) {\n      if (\n        this.buffer[this.buffer.length - 2] !== this.anchor.x ||\n        this.buffer[this.buffer.length - 1] !== this.anchor.y\n      ) {\n        this.buffer.pop();\n        this.buffer.pop();\n      }\n\n      this.buffer = [...this.buffer, position.x, position.y];\n\n      return;\n    }\n\n    if (this.origin) {\n      this.buffer.pop();\n      this.buffer.pop();\n\n      this.buffer = [this.origin.x, this.origin.y, position.x, position.y];\n    }\n  }\n\n  onMouseUp(position: { x: number; y: number }) {\n    if (this.annotationState !== AnnotationStateType.Annotating) return;\n\n    if (\n      this.connected(position) &&\n      this.origin &&\n      this.buffer &&\n      this.buffer.length > 0\n    ) {\n      this.buffer = [\n        ...this.buffer,\n        position.x,\n        position.y,\n        this.origin.x,\n        this.origin.y,\n      ];\n\n      this.points = this.buffer;\n\n      this._boundingBox = this.computeBoundingBoxFromContours(this.points);\n\n      const maskImage = this.computeMask().crop({\n        x: this._boundingBox[0],\n        y: this._boundingBox[1],\n        width: this._boundingBox[2] - this._boundingBox[0],\n        height: this._boundingBox[3] - this._boundingBox[1],\n      });\n\n      this._mask = encode(maskImage.data);\n\n      this.buffer = [];\n\n      this.anchor = undefined;\n      this.origin = undefined;\n\n      this.setAnnotated();\n      return;\n    }\n\n    if (this.anchor) {\n      this.anchor = {\n        x: this.buffer[this.buffer.length - 2],\n        y: this.buffer[this.buffer.length - 1],\n      };\n\n      return;\n    }\n\n    if (this.origin && this.buffer.length > 0) {\n      this.anchor = {\n        x: this.buffer[this.buffer.length - 2],\n        y: this.buffer[this.buffer.length - 1],\n      };\n\n      return;\n    }\n  }\n\n  private connected(\n    position: { x: number; y: number },\n    threshold: number = 4\n  ): boolean | undefined {\n    if (!this.origin) return undefined;\n\n    const distance = Math.hypot(\n      position.x - this.origin.x,\n      position.y - this.origin.y\n    );\n\n    return distance < threshold;\n  }\n}\n","import { AnnotationTool } from \"../AnnotationTool\";\nimport { slic } from \"../../../slic\";\nimport * as ImageJS from \"image-js\";\nimport { encode } from \"../../../rle\";\nimport * as _ from \"lodash\";\nimport { AnnotationStateType } from \"../../../../../types/AnnotationStateType\";\n\nexport class QuickAnnotationTool extends AnnotationTool {\n  brushsize?: number;\n  colorMasks?: Array<string>;\n  currentSuperpixels: Set<number> = new Set<number>();\n  lastSuperpixel: number = 0;\n  superpixels?: Int32Array;\n  superpixelsMap?: { [key: number]: Array<number> };\n  currentMask?: ImageJS.Image;\n  map?: Uint8Array | Uint8ClampedArray;\n\n  flatPixelCoordinate(position: { x: number; y: number }) {\n    return Math.round(position.x) + Math.round(position.y) * this.image.width;\n  }\n\n  filter(): {\n    superpixels: Int32Array;\n  } {\n    const data = this.image.getRGBAData();\n\n    const { superpixels } = slic(\n      data,\n      this.image.width,\n      this.image.height,\n      this.brushsize\n    );\n\n    return { superpixels };\n  }\n\n  deselect() {\n    this.colorMasks = undefined;\n    this.currentSuperpixels.clear();\n    this.lastSuperpixel = 0;\n    this.currentMask = undefined;\n\n    this.setBlank();\n  }\n\n  onMouseDown(position: { x: number; y: number }) {\n    if (this.annotationState === AnnotationStateType.Annotated) return;\n\n    if (!this.currentMask) {\n      this.currentMask = new ImageJS.Image(\n        this.image.width,\n        this.image.height,\n        new Uint8Array(this.image.width * this.image.height * 4),\n        { alpha: 1 }\n      );\n    }\n\n    if (!this.superpixels) return;\n\n    this.setAnnotating();\n  }\n\n  onMouseMove(position: { x: number; y: number }) {\n    if (!this.superpixels) return;\n\n    const pixel = this.flatPixelCoordinate(position);\n\n    const superpixel = this.superpixels[pixel];\n\n    if (this.currentSuperpixels.has(superpixel)) return; // don't draw superpixel mask if already on that superpixel\n\n    this.lastSuperpixel = superpixel;\n\n    if (this.annotationState !== AnnotationStateType.Annotating) {\n      this.currentSuperpixels.clear();\n\n      this.currentMask = new ImageJS.Image(\n        this.image.width,\n        this.image.height,\n        new Uint8Array(this.image.width * this.image.height * 4),\n        { alpha: 1 }\n      );\n    }\n\n    this.currentSuperpixels.add(superpixel);\n\n    this.superpixelsMap![superpixel].forEach((index: number) => {\n      this.currentMask!.setPixel(index, [255, 0, 0, 150]);\n    });\n  }\n\n  onMouseUp(position: { x: number; y: number }) {\n    if (this.annotationState !== AnnotationStateType.Annotating) return;\n\n    if (!this.currentMask) return;\n\n    const greyMask = this.currentMask.grey();\n    //@ts-ignore\n    const binaryMask = greyMask.mask({ algorithm: \"threshold\", threshold: 1 });\n\n    //compute bounding box with ROI manager\n    const roiManager = this.image.getRoiManager();\n    // @ts-ignore\n    roiManager.fromMask(binaryMask);\n    // @ts-ignore\n    const rois = roiManager.getRois();\n    const roi = rois.sort((a: any, b: any) => {\n      return b.surface - a.surface;\n    })[1]; // take the second roi because the first one will be of the size of the image,the second one is the actual largest roi\n    this._boundingBox = [roi.minX, roi.minY, roi.maxX, roi.maxY];\n\n    const croppedGreyMask = greyMask.crop({\n      x: this._boundingBox[0],\n      y: this._boundingBox[1],\n      width: this._boundingBox[2] - this._boundingBox[0],\n      height: this._boundingBox[3] - this._boundingBox[1],\n    });\n\n    const thresholded = _.map(croppedGreyMask.data, (i: number) =>\n      i > 1 ? 255 : 0\n    );\n\n    //compute mask\n    this._mask = encode(Uint8Array.from(thresholded));\n\n    this.setAnnotated();\n  }\n\n  static setup(image: ImageJS.Image, brushsize: number) {\n    const instance = new QuickAnnotationTool(image);\n\n    instance.update(brushsize);\n\n    return instance;\n  }\n\n  update(brushsize: number) {\n    this.brushsize = Math.round(brushsize);\n\n    const { superpixels } = this.filter();\n\n    this.superpixels = superpixels;\n\n    this.superpixelsMap = {};\n\n    superpixels.forEach((pixel: number, index: number) => {\n      if (!(pixel in this.superpixelsMap!)) {\n        this.superpixelsMap![pixel] = [];\n      }\n      this.superpixelsMap![pixel].push(index);\n    });\n  }\n}\n","export const slic = (\n  data: Uint8Array | Uint8ClampedArray,\n  width: number,\n  height: number,\n  regionSize: number = 40,\n  minRegionSize?: number\n) => {\n  if (!minRegionSize) {\n    minRegionSize = (regionSize * regionSize) / 4;\n  }\n\n  const imWidth = width;\n  const imHeight = height;\n  const numRegionsX = parseInt(String(imWidth / regionSize), 10);\n  const numRegionsY = parseInt(String(imHeight / regionSize), 10);\n  const numRegions = parseInt(String(numRegionsX * numRegionsY), 10);\n  const numPixels = parseInt(String(imWidth * imHeight), 10);\n  const masses = new Array(numPixels);\n  const currentCenters = new Float32Array((2 + 3) * numRegions);\n  const newCenters = new Float32Array((2 + 3) * numRegions);\n  const parameters = new Float32Array(2 * numRegions);\n  const mcMap = new Float32Array(numPixels);\n  const msMap = new Float32Array(numPixels);\n  const distanceMap = new Float32Array(numPixels);\n\n  /*\n   * RGB to XYZ\n   */\n  const xyz = new Float32Array(3 * imWidth * imHeight);\n\n  const gamma = 2.2;\n\n  for (let i = 0; i < imWidth * imHeight; i++) {\n    const r = Math.pow(parseFloat(String(data[4 * i])) * 0.00392156862, gamma);\n\n    const g = Math.pow(\n      parseFloat(String(data[4 * i + 1])) * 0.00392156862,\n      gamma\n    );\n\n    const b = Math.pow(\n      parseFloat(String(data[4 * i + 2])) * 0.00392156862,\n      gamma\n    );\n\n    xyz[i] = r * 0.488718 + g * 0.31068 + b * 0.200602;\n    xyz[i + imWidth * imHeight] = r * 0.176204 + g * 0.812985 + b * 0.0108109;\n    xyz[i + 2 * imWidth * imHeight] = g * 0.0102048 + b * 0.989795;\n  }\n\n  /*\n   * XYZ to Lab\n   */\n  const xw = 1.0 / 3.0;\n  const yw = 1.0 / 3.0;\n  const Yw = 1.0;\n  const Xw = xw / yw;\n  const Zw = ((1 - xw - yw) / yw) * Yw;\n  const ix = 1.0 / Xw;\n  const iy = 1.0 / Yw;\n  const iz = 1.0 / Zw;\n  const lab = new Float32Array(3 * imWidth * imHeight);\n\n  for (let i = 0; i < imWidth * imHeight; i++) {\n    const fx =\n      xyz[i] * ix > 0.00856\n        ? Math.pow(xyz[i] * ix, 0.33333333)\n        : 7.78706891568 * xyz[i] * ix + 0.1379310336;\n\n    const fy =\n      xyz[imWidth * imHeight + i] * iy > 0.00856\n        ? Math.pow(xyz[imWidth * imHeight + i] * iy, 0.33333333)\n        : 7.78706891568 * xyz[imWidth * imHeight + i] * iy + 0.1379310336;\n\n    const fz =\n      xyz[2 * imWidth * imHeight + i] * iz > 0.00856\n        ? Math.pow(xyz[2 * imWidth * imHeight + i] * iz, 0.33333333)\n        : 7.78706891568 * xyz[2 * imWidth * imHeight + i] * iz + 0.1379310336;\n\n    lab[i] = 116.0 * fy - 16.0;\n    lab[i + imWidth * imHeight] = 500.0 * (fx - fy);\n    lab[i + 2 * imWidth * imHeight] = 200.0 * (fy - fz);\n  }\n\n  /*\n   * Compute gradient\n   */\n  const gradient = new Float32Array(numPixels);\n\n  for (let k = 0; k < 3; k++) {\n    for (let y = 1; y < imHeight - 1; y++) {\n      for (let x = 1; x < imWidth - 1; x++) {\n        const a = lab[k * imWidth * imHeight + y * imWidth + x - 1];\n        const b = lab[k * imWidth * imHeight + y * imWidth + x + 1];\n        const c = lab[k * imWidth * imHeight + (y + 1) * imWidth + x];\n        const d = lab[k * imWidth * imHeight + (y - 1) * imWidth + x];\n\n        gradient[y * imWidth + x] =\n          gradient[y * imWidth + x] + (a - b) * (a - b) + (c - d) * (c - d);\n      }\n    }\n  }\n\n  /*\n   * Initialize k-means centroids\n   */\n  let i = 0;\n  let j = 0;\n\n  for (let v = 0; v < numRegionsY; v++) {\n    for (let u = 0; u < numRegionsX; u++) {\n      let centerx = 0;\n      let centery = 0;\n      let minEdgeValue = Infinity;\n\n      let x = parseInt(String(Math.round(regionSize * (u + 0.5))), 10);\n      let y = parseInt(String(Math.round(regionSize * (v + 0.5))), 10);\n\n      x = Math.max(Math.min(x, imWidth - 1), 0);\n      y = Math.max(Math.min(y, imHeight - 1), 0);\n\n      for (\n        let yp = Math.max(0, y - 1);\n        yp <= Math.min(imHeight - 1, y + 1);\n        yp++\n      ) {\n        for (\n          let xp = Math.max(0, x - 1);\n          xp <= Math.min(imWidth - 1, x + 1);\n          xp++\n        ) {\n          const thisEdgeValue = gradient[yp * imWidth + xp];\n\n          if (thisEdgeValue < minEdgeValue) {\n            minEdgeValue = thisEdgeValue;\n            centerx = xp;\n            centery = yp;\n          }\n        }\n      }\n\n      currentCenters[i++] = parseFloat(String(centerx));\n      currentCenters[i++] = parseFloat(String(centery));\n\n      currentCenters[i++] = lab[centery * imWidth + centerx];\n      currentCenters[i++] =\n        lab[imWidth * imHeight + centery * imWidth + centerx];\n      currentCenters[i++] =\n        lab[2 * imWidth * imHeight + centery * imWidth + centerx];\n\n      parameters[j++] = 10 * 10;\n      parameters[j++] = regionSize * regionSize;\n    }\n  }\n\n  const iterations = 10;\n\n  const segmentation = new Int32Array(numPixels);\n\n  for (let iteration = 0; iteration < iterations; ++iteration) {\n    /*\n     * Label\n     */\n    for (let i1 = 0; i1 < distanceMap.length; ++i1) {\n      distanceMap[i1] = Infinity;\n    }\n\n    for (let region = 0; region < numRegionsX * numRegionsY; ++region) {\n      const cx = Math.round(currentCenters[region * 5]);\n      const cy = Math.round(currentCenters[region * 5 + 1]);\n\n      for (\n        let y2 = Math.max(0, cy - regionSize);\n        y2 < Math.min(imHeight, cy + regionSize);\n        ++y2\n      ) {\n        for (\n          let x2 = Math.max(0, cx - regionSize);\n          x2 < Math.min(imWidth, cx + regionSize);\n          ++x2\n        ) {\n          const spatial = (x2 - cx) * (x2 - cx) + (y2 - cy) * (y2 - cy);\n          const dR = lab[y2 * imWidth + x2] - currentCenters[5 * region + 2];\n          const dG =\n            lab[imWidth * imHeight + y2 * imWidth + x2] -\n            currentCenters[5 * region + 3];\n          const dB =\n            lab[2 * imWidth * imHeight + y2 * imWidth + x2] -\n            currentCenters[5 * region + 4];\n          const appearance = dR * dR + dG * dG + dB * dB;\n\n          const distance = Math.sqrt(\n            appearance / parameters[region * 2] +\n              spatial / parameters[region * 2 + 1]\n          );\n\n          if (distance < distanceMap[y2 * imWidth + x2]) {\n            distanceMap[y2 * imWidth + x2] = distance;\n            segmentation[y2 * imWidth + x2] = region;\n          }\n        }\n      }\n    }\n\n    for (let y2 = 0; y2 < imHeight; ++y2) {\n      for (let x2 = 0; x2 < imWidth; ++x2) {\n        if (\n          parameters[segmentation[y2 * imWidth + x2] * 2] <\n          mcMap[y2 * imWidth + x2]\n        ) {\n          parameters[segmentation[y2 * imWidth + x2] * 2] =\n            mcMap[y2 * imWidth + x2];\n        }\n\n        if (\n          parameters[segmentation[y2 * imWidth + x2] * 2 + 1] <\n          msMap[y2 * imWidth + x2]\n        ) {\n          parameters[segmentation[y2 * imWidth + x2] * 2 + 1] =\n            msMap[y2 * imWidth + x2];\n        }\n      }\n    }\n\n    /*\n     * Update parameters\n     */\n    const mc = new Float32Array(parameters.length / 2);\n    const ms = new Float32Array(parameters.length / 2);\n\n    for (let i1 = 0; i1 < segmentation.length; i1++) {\n      const region = segmentation[i1];\n\n      if (mc[region] < mcMap[region]) {\n        mc[region] = mcMap[region];\n\n        parameters[region * 2] = mcMap[region];\n      }\n\n      if (ms[region] < msMap[region]) {\n        ms[region] = msMap[region];\n\n        parameters[region * 2 + 1] = msMap[region];\n      }\n    }\n\n    for (let i = 0; i < masses.length; ++i) {\n      masses[i] = 0;\n    }\n\n    for (let i = 0; i < newCenters.length; ++i) {\n      newCenters[i] = 0;\n    }\n\n    /*\n     * Compute centroids\n     */\n    let region;\n\n    for (let y1 = 0; y1 < imHeight; y1++) {\n      for (let x1 = 0; x1 < imWidth; x1++) {\n        region = segmentation[x1 + y1 * imWidth];\n\n        masses[region]++;\n\n        newCenters[region * 5] += x1;\n        newCenters[region * 5 + 1] += y1;\n        newCenters[region * 5 + 2] += lab[y1 * imWidth + x1];\n        newCenters[region * 5 + 3] +=\n          lab[imWidth * imHeight + y1 * imWidth + x1];\n        newCenters[region * 5 + 4] +=\n          lab[2 * imWidth * imHeight + y1 * imWidth + x1];\n      }\n    }\n\n    for (region = 0; region < numRegions; region++) {\n      const iMass = 1.0 / Math.max(masses[region], 1e-8);\n\n      newCenters[region * 5] = newCenters[region * 5] * iMass;\n      newCenters[region * 5 + 1] = newCenters[region * 5 + 1] * iMass;\n      newCenters[region * 5 + 2] = newCenters[region * 5 + 2] * iMass;\n      newCenters[region * 5 + 3] = newCenters[region * 5 + 3] * iMass;\n      newCenters[region * 5 + 4] = newCenters[region * 5 + 4] * iMass;\n    }\n\n    /*\n     * Compute residual error\n     */\n    let error = 0.0;\n\n    for (let index = 0; index < currentCenters.length; ++index) {\n      const d = currentCenters[index] - newCenters[index];\n\n      error += Math.sqrt(d * d);\n    }\n\n    if (error < 1e-5) {\n      break;\n    }\n\n    for (let i = 0; i < currentCenters.length; ++i) {\n      currentCenters[i] = newCenters[i];\n    }\n  }\n\n  /*\n   * Remove small objects\n   */\n  const cleaned = new Int32Array(numPixels);\n  const segment = new Int32Array(numPixels);\n\n  const dx = [1, -1, 0, 0];\n  const dy = [0, 0, 1, -1];\n\n  let segmentSize;\n  let label;\n  let cleanedLabel;\n  let numExpanded;\n  let x1;\n  let y1;\n  let xp;\n  let yp;\n  let neighbor;\n\n  for (let pixel = 0; pixel < numPixels; pixel++) {\n    if (cleaned[pixel]) continue;\n\n    label = segmentation[pixel];\n    numExpanded = 0;\n    segmentSize = 0;\n    segment[segmentSize++] = pixel;\n\n    cleanedLabel = label + 1;\n    cleaned[pixel] = label + 1;\n    x1 = pixel % imWidth;\n    y1 = Math.floor(pixel / imWidth);\n\n    for (let direction = 0; direction < 4; direction++) {\n      xp = x1 + dx[direction];\n      yp = y1 + dy[direction];\n      neighbor = xp + yp * imWidth;\n\n      if (\n        0 <= xp &&\n        xp < imWidth &&\n        0 <= yp &&\n        yp < imHeight &&\n        cleaned[neighbor]\n      ) {\n        cleanedLabel = cleaned[neighbor];\n      }\n    }\n\n    while (numExpanded < segmentSize) {\n      const open = segment[numExpanded++];\n\n      x1 = open % imWidth;\n      y1 = Math.floor(open / imWidth);\n\n      for (let direction = 0; direction < 4; ++direction) {\n        xp = x1 + dx[direction];\n        yp = y1 + dy[direction];\n        neighbor = xp + yp * imWidth;\n\n        if (\n          0 <= xp &&\n          xp < imWidth &&\n          0 <= yp &&\n          yp < imHeight &&\n          cleaned[neighbor] === 0 &&\n          segmentation[neighbor] === label\n        ) {\n          cleaned[neighbor] = label + 1;\n          segment[segmentSize++] = neighbor;\n        }\n      }\n    }\n\n    if (segmentSize < minRegionSize) {\n      while (segmentSize > 0) {\n        cleaned[segment[--segmentSize]] = cleanedLabel;\n      }\n    }\n  }\n\n  for (let pixel = 0; pixel < numPixels; ++pixel) {\n    --cleaned[pixel];\n  }\n\n  for (let index = 0; index < numPixels; ++index) {\n    segmentation[index] = cleaned[index];\n  }\n\n  return {\n    count: 0,\n    map: data,\n    superpixels: segmentation,\n  };\n};\n","import { Classifier } from \"../../types/Classifier\";\n\nexport const classifierSelector = ({\n  classifier,\n}: {\n  classifier: Classifier;\n}): Classifier => {\n  return classifier;\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nimport { AnnotationStateType } from \"../../types/AnnotationStateType\";\n\nexport const annotationStateSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}): AnnotationStateType => {\n  return imageViewer.annotationState;\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nexport const boundingClientRectSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}) => {\n  return imageViewer.boundingClientRect;\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nexport const categoryCountsSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}) => {\n  const catDict: { [id: string]: number } = {};\n  for (let category of imageViewer.categories) {\n    catDict[category.id] = 0;\n  }\n  for (let image of imageViewer.images) {\n    for (let annotation of image.annotations) {\n      catDict[annotation.categoryId] += 1;\n    }\n  }\n  return catDict;\n};\n","import { Project } from \"../../types/Project\";\nexport const categoriesSelector = ({ project }: { project: Project }) => {\n  return project.categories;\n};\n","import { Category, UNKNOWN_CATEGORY_ID } from \"../../types/Category\";\nimport { sortBy } from \"lodash\";\nimport { Project } from \"../../types/Project\";\n\nexport const createdCategoriesSelector = ({\n  project,\n}: {\n  project: Project;\n}) => {\n  const categories = project.categories.filter((category: Category) => {\n    return category.id !== UNKNOWN_CATEGORY_ID;\n  });\n\n  return sortBy(categories, \"name\");\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nimport { Image } from \"../../types/Image\";\n\nexport const imageInstancesSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}) => {\n  if (!imageViewer.images.length) return;\n\n  const image = imageViewer.images.find((image: Image) => {\n    return image.id === imageViewer.activeImageId;\n  });\n\n  if (!image) return;\n\n  return image.annotations;\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nimport { Image } from \"../../types/Image\";\n\nexport const imageSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}) => {\n  if (!imageViewer.images.length) return;\n\n  const image = imageViewer.images.find((image: Image) => {\n    return image.id === imageViewer.activeImageId;\n  });\n\n  if (!image) return;\n\n  return image;\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nimport { Image } from \"../../types/Image\";\nimport { Project } from \"../../types/Project\";\n\nexport const imageOriginalSrcSelector = ({\n  imageViewer,\n  project,\n}: {\n  imageViewer: ImageViewer;\n  project: Project;\n}) => {\n  if (!project.images.length) return;\n\n  const image = project.images.find((image: Image) => {\n    return image.id === imageViewer.activeImageId;\n  });\n\n  if (!image) return;\n\n  return image.src;\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nimport * as _ from \"lodash\";\nimport { Category } from \"../../types/Category\";\n\nexport const selectedCategorySelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}): Category => {\n  const category = _.find(imageViewer.categories, (category: Category) => {\n    return category.id === imageViewer.selectedCategoryId;\n  });\n\n  return category!;\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nimport { AnnotationModeType } from \"../../types/AnnotationModeType\";\n\nexport const selectionModeSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}): AnnotationModeType => {\n  return imageViewer.selectionMode;\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nexport const stageHeightSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}): number => {\n  return imageViewer.stageHeight;\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nexport const stageScaleSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}): number => {\n  return imageViewer.stageScale;\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nexport const stageWidthSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}): number => {\n  return imageViewer.stageWidth;\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nimport { ToolType } from \"../../types/ToolType\";\n\nexport const toolTypeSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}): ToolType => {\n  return imageViewer.toolType;\n};\n","import { Category, UNKNOWN_CATEGORY_ID } from \"../../types/Category\";\nimport { Project } from \"../../types/Project\";\n\nexport const unknownCategorySelector = ({ project }: { project: Project }) => {\n  return project.categories.find((category: Category) => {\n    return category.id === UNKNOWN_CATEGORY_ID;\n  })!;\n};\n","import { ZoomToolOptionsType } from \"../../types/ZoomToolOptionsType\";\nimport { ToolOptionsStateType } from \"../../types/ToolOptionsStateType\";\n\nexport const zoomToolOptionsSelector = ({\n  toolOptions,\n}: {\n  toolOptions: ToolOptionsStateType;\n}): ZoomToolOptionsType => {\n  return toolOptions.zoom;\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nexport const zoomSelectionSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}): {\n  dragging: boolean;\n  minimum: { x: number; y: number } | undefined;\n  maximum: { x: number; y: number } | undefined;\n  selecting: boolean;\n} => {\n  return imageViewer.zoomSelection;\n};\n","import { Project } from \"../../types/Project\";\nimport { Image } from \"../../types/Image\";\nimport { Partition } from \"../../types/Partition\";\n\nexport const categorizedImagesSelector = ({\n  project,\n}: {\n  project: Project;\n}): Array<Image> => {\n  return project.images.filter((image: Image) => {\n    return image.partition !== Partition.Inference;\n  });\n};\n","import { Classifier } from \"../../types/Classifier\";\nimport { LayersModel } from \"@tensorflow/tfjs\";\n\nexport const compiledSelector = ({\n  classifier,\n}: {\n  classifier: Classifier;\n}): LayersModel | undefined => {\n  return classifier.compiled;\n};\n","import { Project } from \"../../types/Project\";\n\nexport const createdCategoriesCountSelector = ({\n  project,\n}: {\n  project: Project;\n}): number => {\n  return project.categories.length - 1;\n};\n","import { Classifier } from \"../../types/Classifier\";\nimport { FitOptions } from \"../../types/FitOptions\";\n\nexport const fitOptionsSelector = ({\n  classifier,\n}: {\n  classifier: Classifier;\n}): FitOptions => {\n  return classifier.fitOptions;\n};\n","import { Classifier } from \"../../types/Classifier\";\n\nexport const trainingPercentageSelector = ({\n  classifier,\n}: {\n  classifier: Classifier;\n}): number => {\n  return classifier.trainingPercentage;\n};\n","import { Classifier } from \"../../types/Classifier\";\nimport { CompileOptions } from \"../../types/CompileOptions\";\n\nexport const compileOptionsSelector = ({\n  classifier,\n}: {\n  classifier: Classifier;\n}): CompileOptions => {\n  return {\n    learningRate: classifier.learningRate,\n    lossFunction: classifier.lossFunction,\n    metrics: classifier.metrics,\n    optimizationAlgorithm: classifier.optimizationAlgorithm,\n  };\n};\n","import { Image } from \"../../types/Image\";\nimport { Project } from \"../../types/Project\";\n\nexport const imagesSelector = ({\n  project,\n}: {\n  project: Project;\n}): Array<Image> => {\n  return project.images;\n};\n","import { Settings } from \"../../types/Settings\";\nimport { Project } from \"../../types/Project\";\nimport { Image } from \"../../types/Image\";\nimport { Category } from \"../../types/Category\";\n\nexport const selectedImagesSelector = ({\n  project,\n  settings,\n}: {\n  project: Project;\n  settings: Settings;\n}): Array<string> => {\n  return Array.from(settings.selectedImages).filter((id: string) => {\n    const visibleCategories: Array<string> = project.categories\n      .filter((category: Category) => {\n        return category.visible;\n      })\n      .map((category: Category) => {\n        return category.id;\n      });\n\n    return project.images\n      .filter((image: Image) => {\n        return id === image.id;\n      })\n      .filter((image: Image) => {\n        return image.categoryId && visibleCategories.includes(image.categoryId);\n      })\n      .map((image) => {\n        return image.id;\n      });\n  });\n};\n","import { Project } from \"../../types/Project\";\nimport { Image } from \"../../types/Image\";\nimport { Category } from \"../../types/Category\";\n\nexport const visibleImagesSelector = ({\n  project,\n}: {\n  project: Project;\n}): Array<Image> => {\n  return project.images.filter((image: Image) => {\n    const category = project.categories.find((c: Category) => {\n      return c.id === image.categoryId;\n    });\n    return category ? category.visible : true;\n  });\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nexport const penSelectionBrushSizeSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}) => {\n  return imageViewer.penSelectionBrushSize;\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nexport const quickSelectionBrushSizeSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}) => {\n  return imageViewer.quickSelectionBrushSize;\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nimport { Image } from \"../../types/Image\";\n\nexport const imageSrcSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}) => {\n  if (!imageViewer.images.length) return;\n\n  const image = imageViewer.images.find((image: Image) => {\n    return image.id === imageViewer.activeImageId;\n  });\n\n  if (!image) return;\n\n  return image.src;\n};\n","import { useEffect, useState } from \"react\";\nimport * as ImageJS from \"image-js\";\nimport { ToolType } from \"../../types/ToolType\";\nimport {\n  AnnotationTool,\n  ColorAnnotationTool,\n  EllipticalAnnotationTool,\n  LassoAnnotationTool,\n  MagneticAnnotationTool,\n  ObjectAnnotationTool,\n  PenAnnotationTool,\n  PolygonalAnnotationTool,\n  QuickAnnotationTool,\n  RectangularAnnotationTool,\n} from \"../../annotator/image/Tool\";\nimport { useSelector } from \"react-redux\";\nimport { stageScaleSelector, toolTypeSelector } from \"../../store/selectors\";\nimport { penSelectionBrushSizeSelector } from \"../../store/selectors/penSelectionBrushSizeSelector\";\nimport { quickSelectionBrushSizeSelector } from \"../../store/selectors/quickSelectionBrushSizeSelector\";\nimport { imageSrcSelector } from \"../../store/selectors/imageSrcSelector\";\n\nexport const useAnnotationTool = () => {\n  const src = useSelector(imageSrcSelector);\n  const operation = useSelector(toolTypeSelector);\n  const stageScale = useSelector(stageScaleSelector);\n\n  const [operator, setOperator] = useState<AnnotationTool>();\n\n  const [image, setImage] = useState<ImageJS.Image>();\n\n  const penSelectionBrushSize = useSelector(penSelectionBrushSizeSelector);\n\n  const quickSelectionBrushSize = useSelector(quickSelectionBrushSizeSelector);\n\n  useEffect(() => {\n    if (!src) return;\n\n    const loadImage = async () => {\n      const image = await ImageJS.Image.load(src);\n      setImage(image);\n    };\n\n    loadImage();\n  }, [src]);\n\n  useEffect(() => {\n    if (!image) return;\n\n    switch (operation) {\n      case ToolType.ColorAnnotation:\n        setOperator(new ColorAnnotationTool(image));\n\n        return;\n      case ToolType.EllipticalAnnotation:\n        setOperator(new EllipticalAnnotationTool(image));\n\n        return;\n      case ToolType.LassoAnnotation:\n        setOperator(new LassoAnnotationTool(image));\n\n        return;\n      case ToolType.MagneticAnnotation:\n        setOperator(new MagneticAnnotationTool(image, 0.5));\n\n        return;\n      case ToolType.ObjectAnnotation:\n        ObjectAnnotationTool.compile(image).then(\n          (operator: ObjectAnnotationTool) => {\n            setOperator(operator);\n          }\n        );\n\n        return;\n      case ToolType.PenAnnotation:\n        PenAnnotationTool.setup(\n          image,\n          penSelectionBrushSize / (stageScale ? stageScale : 1)\n        ).then((operator: PenAnnotationTool) => {\n          setOperator(operator);\n        });\n\n        return;\n      case ToolType.PolygonalAnnotation:\n        setOperator(new PolygonalAnnotationTool(image));\n\n        return;\n      case ToolType.QuickAnnotation:\n        const quickSelectionOperator = QuickAnnotationTool.setup(\n          image,\n          quickSelectionBrushSize / Math.round(stageScale ? stageScale : 1)\n        );\n        setOperator(quickSelectionOperator);\n\n        return;\n      case ToolType.RectangularAnnotation:\n        setOperator(new RectangularAnnotationTool(image));\n\n        return;\n    }\n  }, [\n    operation,\n    image,\n    penSelectionBrushSize,\n    stageScale,\n    quickSelectionBrushSize,\n  ]);\n\n  return [operator];\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nimport { Image } from \"../../types/Image\";\n\nexport const scaledImageWidthSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}) => {\n  if (!imageViewer.images.length) return;\n\n  const image = imageViewer.images.find((image: Image) => {\n    return image.id === imageViewer.activeImageId;\n  });\n\n  if (!image) return;\n\n  return image.shape.width * imageViewer.stageScale;\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nexport const languageSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}) => {\n  return imageViewer.language;\n};\n","// prettier-ignore\nimport {language} from \"./language\";\n\nconst de: language = {\n  translation: {\n    Cancel: \"Abbrechen\",\n    Categories: \"Kategorien\",\n    \"Create category\": \"Neue Kategorie\",\n    \"Create new classifier\": \"Neuer Classifier\",\n    \"Delete category\": \"Lösche Kategorie\",\n    \"Delete images\": \"Lösche Bilder\",\n    Description: \"Beschreibung\",\n    Edit: \"Edit\",\n    \"Edit category\": \"Bearbeite Kategorie\",\n    Help: \"Hilfe\",\n    \"Hide other categories\": \"Blende andere Kategorien aus\",\n    \"Hide sidebar\": \"Blende Sidebar aus\",\n    \"Import images\": \"Bilder hinzufügen\",\n    Logo: \"Logo\",\n    Model: \"Modell\",\n    \"Open classifier\": \"Öffne Classifier\",\n    \"Open example classifier\": \"Öffne Beispiel Classifier\",\n    \"Open weights\": \"Öffne Gewichte\",\n    Open: \"Öffnen\",\n    \"Run classifier\": \"Starte Classfier\",\n    \"Save annotations and predictions\": \"Speicher Labels und Predictions\",\n    \"Save classifier\": \"Speicher Classifier\",\n    \"Save weights\": \"Speicher Gewichte\",\n    Save: \"Speichern\",\n    \"Search images\": \"Durchsuche Bilder\",\n    \"Send feedback\": \"Sende Feedback\",\n    Settings: \"Einstellungen\",\n    \"Show sidebar\": \"Blende Sidebar ein\",\n    Unknown: \"Unbekannt\",\n  },\n};\n\nexport default de;\n","import { language } from \"./language\";\n\nconst en: language = {\n  translation: {\n    Cancel: \"Cancel\",\n    Categories: \"Categories\",\n    \"Create category\": \"Create category\",\n    \"Create new classifier\": \"Create new classifier\",\n    \"Delete category\": \"Delete category\",\n    \"Delete images\": \"Delete images\",\n    Description: \"Description\",\n    Edit: \"Edit\",\n    \"Edit category\": \"Edit category\",\n    Help: \"Help\",\n    \"Hide other categories\": \"Hide other categories\",\n    \"Hide sidebar\": \"Hide sidebar\",\n    \"Import images\": \"Import images\",\n    Logo: \"Logo\",\n    Model: \"Model\",\n    \"Open classifier\": \"Open classifier\",\n    \"Open example classifier\": \"Open example classifier\",\n    \"Open weights\": \"Open weights\",\n    Open: \"Open\",\n    \"Run classifier\": \"Run classifier\",\n    \"Save annotations and predictions\": \"Save annotations and predictions\",\n    \"Save classifier\": \"Save classifier\",\n    \"Save weights\": \"Save weights\",\n    Save: \"Save\",\n    \"Search images\": \"Search images\",\n    \"Send feedback\": \"Send feedback\",\n    Settings: \"Settings\",\n    \"Show sidebar\": \"Show sidebar\",\n    Unknown: \"Unknown\",\n  },\n};\n\nexport default en;\n","import { language } from \"./language\";\n\nconst fas: language = {\n  translation: {\n    \"Actual size\": \"سایز اصلی\",\n    \"Add area\": \"ناحیه اضافه کنید\",\n    \"Annotation mode\": \"حالت گروه توضیحی\",\n    Cancel: \"لفو کردن\",\n    Categories: \"دسته بندی کردن\",\n    \"Center image automatically\":\n      \"تصویر را به طور اتوماتیک در مرکز قرار می دهد\",\n    \"Color annotation\": \"توضیح رنگ ها\",\n    \"Create category\": \"ایجاد دسته بندی\",\n    \"Create new classifier\": \"ایجاد طبقه بندی جدید\",\n    Create: \"ایجاد\",\n    \"Delete category\": \"پاک کردن دسته بندی\",\n    \"Delete images\": \"پاک کردن تصویر\",\n    Description: \"توضیحات\",\n    Edit: \"ویرایش\",\n    \"Edit category\": \"ویرایش دسته بندی\",\n    \"Elliptical annotation\": \"گروه توضیحی بیضوی\",\n    Export: \"فرستادن\",\n    \"Export annotations\": \"فرستادن گروه توضیحی\",\n    \"Freehand annotation\": \"گروه توضیحی آزاد\",\n    Help: \"کمک یابی\",\n    \"Hide category\": \"پنهان سازی طبقه بندی\",\n    \"Hide other categories\": \"پنهان سازی سایر طبقه بندی ها\",\n    \"Hide sidebar\": \"پنهان سازی منوی کناری\",\n    \"Import images\": \"آوردن تصاویر\",\n    Intersection: \"تلاقی کردن\",\n    \"Invert annotation\": \"معکوس کردن گروه توضیحی\",\n    \"Lasso annotation\": \"گروه توضیحی کمند\",\n    Logo: \"علامت\",\n    \"Magnetic annotation\": \"گروه توضیحی آهنربایی\",\n    Model: \"نمونه\",\n    \"Object annotation\": \"گروه توضیحی هدف\",\n    \"Open classifier\": \"باز کردن طبقه بندی\",\n    \"Open example classifier\": \"باز کردن طبقه بندی نمونه\",\n    \"Open image\": \"باز کردن تصویر\",\n    \"Open weights\": \"باز کردن وزن ها\",\n    Open: \"باز کردن\",\n    \"Pen annotation\": \"گروه توضیحی خودکار\",\n    Pointer: \"نشانه گر\",\n    \"Polygonal annotation\": \"گروه توضیحی چند ظلعی\",\n    Name: \"نام\",\n    \"New annotation\": \"گروه توضیحی جدید\",\n    \"Quick annotation\": \"گروه توضیحی سریع\",\n    \"Rectangular annotation\": \"گروه توضیحی مستطیلی\",\n    \"Run classifier\": \"اجرا کردن طبقه بندی\",\n    \"Save annotations and predictions\":\n      \"ذخیره کردن گروه های توضیحی و پیش بینی ها\",\n    \"Save classifier\": \"ذخیره کردن طبقه بندی\",\n    \"Save weights\": \"ذخیره کردن وزن ها\",\n    Save: \"ذخیره کردن\",\n    \"Search images\": \"جستجوی تصاویر\",\n    \"Send feedback\": \"فرستادن پیشنهادات\",\n    Settings: \"تنظیمات\",\n    \"Show category\": \"نشان دادن گروه ها\",\n    \"Show sidebar\": \"نشان دادن منوی کناری\",\n    \"Subtract area\": \"کم کردن ناحیه\",\n    Unknown: \"تعریف نشده\",\n    Zoom: \"بزرگ نمایی\",\n    \"Zoom in\": \"بزرگ نمایی کردن\",\n    \"Zoom mode\": \"حالت بزرگ نمایی\",\n    \"Zoom out\": \"کوچک نمایی کردن\",\n  },\n};\n\nexport default fas;\n","// prettier-ignore\nimport {language} from \"./language\";\n\nconst fi: language = {\n  translation: {\n    Cancel: \"Peruuta\",\n    Categories: \"Kategoriat\",\n    \"Create category\": \"Luo kategoria\",\n    \"Create new classifier\": \"Luo uusi luokittelija\",\n    \"Delete category\": \"Poista kategoria\",\n    \"Delete images\": \"Poista kuvat\",\n    Description: \"Kuvaus\",\n    Edit: \"Edit\",\n    \"Edit category\": \"Muokkaa kategoriaa\",\n    Help: \"Apua\",\n    \"Hide other categories\": \"Piilota muut kategoriat\",\n    \"Hide sidebar\": \"Piilota sivupalkki\",\n    \"Import images\": \"Tuo kuvat\",\n    Logo: \"Logo\",\n    Model: \"Malli\",\n    \"Open classifier\": \"Avaa luokittelija\",\n    \"Open example classifier\": \"Avaa esimerkkiluokittelija\",\n    \"Open weights\": \"Avaa painot\",\n    Open: \"Avaa\",\n    \"Run classifier\": \"Suorita luokittelija\",\n    \"Save annotations and predictions\":\n      \"Tallenna annotaatiot ja luokittelun tulos\",\n    \"Save classifier\": \"Tallenna luokittelija\",\n    \"Save weights\": \"Tallenna painot\",\n    Save: \"Tallenna\",\n    \"Search images\": \"Etsi kuvia\",\n    \"Send feedback\": \"Lähetä palautetta\",\n    Settings: \"Asetukset\",\n    \"Show sidebar\": \"Näytä sivupalkki\",\n    Unknown: \"Tuntematon\",\n  },\n};\n\nexport default fi;\n","// prettier-ignore\nimport {language} from \"./language\";\n\nconst gr: language = {\n  translation: {\n    Cancel: \"Άκυρο\",\n    Categories: \"Κατηγορίες\",\n    \"Create category\": \"Δημιουργία κατηγορίας\",\n    \"Create new classifier\": \"Νέος ταξινομητής\",\n    \"Delete category\": \"Διαγραφή κατηγορίας\",\n    \"Delete images\": \"Διαγραφή εικόνων\",\n    Description: \"Περιγραφή\",\n    Edit: \"Επεξεργασία\",\n    \"Edit category\": \"Επεξεργασία κατηγορίας\",\n    Help: \"Βοήθεια\",\n    \"Hide other categories\": \"Απόκρυψη άλλων κατηγοριών\",\n    \"Hide sidebar\": \"Απόκρυψη πλευρικής γραμμής\",\n    \"Import images\": \"Εισαγωγή εικόνων\",\n    Logo: \"Λογότυπο\",\n    Model: \"Mοντέλο\",\n    \"Open classifier\": \"Άνοιγμα ταξινομητή\",\n    \"Open example classifier\": \"Παράδειγμα ταξινομητή\",\n    \"Open weights\": \"Άνοιγμα παραμέτρων\",\n    Open: \"Άνοιγμα\",\n    \"Run classifier\": \"Εκτέλεση ταξινομητή\",\n    \"Save annotations and predictions\": \"Αποθήκευση ετικετών και προβλέψεων\",\n    \"Save classifier\": \"Αποθήκευση ταξινομητή\",\n    \"Save weights\": \"Αποθήκευση παραμέτρων\",\n    Save: \"Αποθήκευση\",\n    \"Search images\": \"Αναζήτηση εικόνων\",\n    \"Send feedback\": \"Eπικοινωνια\",\n    Settings: \"Ρυθμίσεις\",\n    \"Show sidebar\": \"Εμφάνιση πλευρικής γραμμής\",\n    Unknown: \"Άγνωστο\",\n  },\n};\n\nexport default gr;\n","// prettier-ignore\nimport {language} from \"./language\";\n\nconst hi: language = {\n  translation: {\n    Cancel: \"रद्द करें\",\n    Categories: \"सारे वर्ग\",\n    \"Create category\": \"वर्ग बनाएँ\",\n    \"Create new classifier\": \"नया वर्गीकर्त्ता बनाएं\", // वर्गीकर्त्ता = classifier but is rarely used; consider transliterating instead\n    \"Delete category\": \"वर्ग हटाएँ\",\n    \"Delete images\": \"चित्रों को हटाएँ\",\n    Description: \"विवरण\",\n    \"Edit category\": \"वर्ग का बदलाव करें\",\n    Help: \"सहायता\",\n    \"Hide other categories\": \"बाकि वर्गों को छिपाएं\",\n    \"Hide sidebar\": \"साइडबार छिपाएं\",\n    \"Import images\": \"चित्रों को आयात करें\",\n    Logo: \"लोगो\", // transliterated (Logo) but that's ok because it is a loanword\n    Model: \"मॉडल\", // transliterated (Model) but should figure out an appropriate abstraction and translate that\n    \"Open classifier\": \"वर्गीकर्त्ता खोलें\",\n    \"Open example classifier\": \"उदाहरण का वर्गीकर्त्ता खोलें\",\n    \"Open weights\": \"वेइट्स खोलें\",\n    Open: \"खोलें\",\n    \"Run classifier\": \"वर्गीकर्त्ता को चलाएं\",\n    \"Save annotations and predictions\": \"टिप्पणी तथा अनुमान सहेजें\", // व्याख्या is an alternative to टिप्पणी\n    \"Save classifier\": \"वर्गीकर्त्ता सहेजें\",\n    \"Save weights\": \"वेइट्स सहेजें\",\n    Save: \"सहेजें\",\n    \"Search images\": \"चित्र खोजें\",\n    \"Send feedback\": \"प्रतिक्रिया भेजें\",\n    Settings: \"सेटिंग्स\",\n    \"Show sidebar\": \"साइडबार दिखाएं\",\n    Unknown: \"अज्ञात\", // should be used as an adjective before a noun\n  },\n};\n\nexport default hi;\n","// prettier-ignore\nimport {language} from \"./language\";\n\nconst hu: language = {\n  translation: {\n    Cancel: \"Mégse\",\n    Categories: \"Osztályok\",\n    \"Create category\": \"Új osztály létrehozása\",\n    \"Create new classifier\": \"Új osztályozó létrehozása\",\n    \"Delete category\": \"Osztály törlése\",\n    \"Delete images\": \"Képek törlése\",\n    Description: \"Leírás\",\n    Edit: \"Edit\",\n    \"Edit category\": \"Kategória szerkesztése\",\n    Help: \"Súgó\",\n    \"Hide other categories\": \"Többi osztály elrejtése\",\n    \"Hide sidebar\": \"Oldalsáv elrejtése\",\n    \"Import images\": \"Képek importálása\",\n    Logo: \"Logó\",\n    Model: \"Modell\",\n    \"Open classifier\": \"Osztályozó betöltése\",\n    \"Open example classifier\": \"Példa osztályozó betöltése\",\n    \"Open weights\": \"Súlyok betöltése\",\n    Open: \"Megnyitás\",\n    \"Run classifier\": \"Osztályozó futtatása\",\n    \"Save annotations and predictions\": \"Címkék és predikciók mentése\",\n    \"Save classifier\": \"Osztályozó mentése\",\n    \"Save weights\": \"Súlyok mentése\",\n    Save: \"Mentés\",\n    \"Search images\": \"Képek keresése\",\n    \"Send feedback\": \"Visszajelzés küldése\",\n    Settings: \"Beállítások\",\n    \"Show sidebar\": \"Oldalsáv megjelenítése\",\n    Unknown: \"Ismeretlen\",\n  },\n};\n\nexport default hu;\n","import { language } from \"./language\";\n\nconst fr: language = {\n  translation: {\n    \"Actual size\": \"Taille réelle\",\n    \"Add area\": \"Ajouter région\",\n    \"Annotation mode\": \"Mode d'annotation\",\n    Cancel: \"Annuler\",\n    Categories: \"Catégories\",\n    \"Center image automatically\": \"Centrer image automatiquement\",\n    \"Color annotation\": \"Annotation couleur\",\n    \"Create category\": \"Nouvelle catégorie\",\n    \"Create new classifier\": \"Nouveau classifieur\",\n    Create: \"Ajouter\",\n    \"Delete category\": \"Supprimer catégorie\",\n    \"Delete images\": \"Supprimer images\",\n    Description: \"Description\",\n    Edit: \"Modifier\",\n    \"Edit category\": \"Modifier catégorie\",\n    \"Elliptical annotation\": \"Annotation elliptique\",\n    Export: \"Exporter\",\n    \"Export annotations\": \"Exporter annotations\",\n    \"Freehand annotation\": \"Annotation main-libres\",\n    Help: \"Aide\",\n    \"Hide category\": \"Cacher catégorie\",\n    \"Hide other categories\": \"Cacher autres catégories\",\n    \"Hide sidebar\": \"Cacher sidebar\",\n    \"Import images\": \"Importer images\",\n    Intersection: \"Intersection\",\n    \"Invert annotation\": \"Inverser annotation\",\n    \"Lasso annotation\": \"Annotation lasso\",\n    Logo: \"Logo\",\n    \"Magnetic annotation\": \"Annotation magnétique\",\n    Model: \"Modèle\",\n    \"Object annotation\": \"Annotation objet\",\n    \"Open classifier\": \"Ouvrir classifieur\",\n    \"Open example classifier\": \"Ouvrir example classifieur\",\n    \"Open image\": \"Ouvrir image\",\n    \"Open weights\": \"Ouvrir poids\",\n    Open: \"Ouvrir\",\n    \"Pen annotation\": \"Annotation pinceau\",\n    Pointer: \"Pointeur\",\n    \"Polygonal annotation\": \"Annotation polygonale\",\n    Name: \"Nom\",\n    \"New annotation\": \"Nouvelle annotation\",\n    \"Quick annotation\": \"Annotation rapide\",\n    \"Rectangular annotation\": \"Annotation rectangulaire\",\n    \"Run classifier\": \"Initier classifieur\",\n    \"Save annotations and predictions\": \"Sauver annotations et predictions\",\n    \"Save classifier\": \"Sauver classifieur\",\n    \"Save weights\": \"Sauver poids\",\n    Save: \"Sauver\",\n    \"Search images\": \"Rechercher images\",\n    \"Send feedback\": \"Envoyer feedback\",\n    Settings: \"Préférences\",\n    \"Show category\": \"Montrer catégorie\",\n    \"Show sidebar\": \"Montrer sidebar\",\n    \"Subtract area\": \"Soustraire région\",\n    Unknown: \"Inconnu\",\n    Zoom: \"Zoom\",\n    \"Zoom in\": \"Zoom intérieur\",\n    \"Zoom mode\": \"Mode zoom\",\n    \"Zoom out\": \"Zoom extérieur\",\n  },\n};\n\nexport default fr;\n","import { useSelector } from \"react-redux\";\nimport { languageSelector } from \"../../store/selectors/languageSelector\";\nimport { de, en, fas, fi, gr, hi, hu } from \"../../translations\";\nimport { LanguageType } from \"../../types/LanguageType\";\nimport fr from \"../../translations/fr\";\n\nexport const useTranslation = () => {\n  const language = useSelector(languageSelector);\n\n  const t = (word: string) => {\n    switch (language) {\n      case LanguageType.English:\n        if (!en.translation[word]) return word;\n        return en.translation[word];\n      case LanguageType.Farsi:\n        if (!fas.translation[word]) return word;\n        return fas.translation[word];\n      case LanguageType.Finnish:\n        if (!fi.translation[word]) return word;\n        return fi.translation[word];\n      case LanguageType.French:\n        if (!fr.translation[word]) return word;\n        return fr.translation[word];\n      case LanguageType.German:\n        if (!de.translation[word]) return word;\n        return de.translation[word];\n      case LanguageType.Greek:\n        if (!gr.translation[word]) return word;\n        return gr.translation[word];\n      case LanguageType.Hindi:\n        if (!hi.translation[word]) return word;\n        return hi.translation[word];\n      case LanguageType.Hungarian:\n        if (!hu.translation[word]) return word;\n        return hu.translation[word];\n      default:\n        return word;\n    }\n  };\n\n  return t;\n};\n","import { classifierSlice, projectSlice } from \"../../store/slices\";\nimport { useDispatch } from \"react-redux\";\nimport { Avatar, ListItem, ListItemAvatar, ListItemText } from \"@mui/material\";\nimport { SerializedProjectType } from \"../../types/SerializedProjectType\";\nimport { Classifier } from \"../../types/Classifier\";\nimport { ExampleProject } from \"data/exampleProjects/exampleProjectsEnum\";\n\ntype OpenExampleProjectMenuItemProps = {\n  exampleProject: ExampleProject;\n  projectName: string;\n  projectIcon: string;\n  popupState: any;\n  onClose: any;\n};\n\nexport const OpenExampleProjectMenuItem = ({\n  exampleProject,\n  projectName,\n  projectIcon,\n  popupState,\n  onClose,\n}: OpenExampleProjectMenuItemProps) => {\n  const dispatch = useDispatch();\n\n  const onClickExampleProject = async () => {\n    var exampleProjectJson: any;\n    switch (exampleProject) {\n      case ExampleProject.Mnist:\n        exampleProjectJson = await import(\n          \"data/exampleProjects/mnistExampleProject.json\"\n        );\n        break;\n      case ExampleProject.CElegans:\n        exampleProjectJson = await import(\n          \"data/exampleProjects/cElegansExampleProject.json\"\n        );\n        break;\n      case ExampleProject.HumanU2OSCells:\n        exampleProjectJson = await import(\n          \"data/exampleProjects/humanU2OSCellsExampleProject.json\"\n        );\n        break;\n      default:\n        return;\n    }\n\n    const project = exampleProjectJson.project as SerializedProjectType;\n    const classifier = exampleProjectJson.classifier as Classifier;\n\n    popupState.close();\n    onClose();\n\n    dispatch(\n      projectSlice.actions.openProject({\n        images: project.serializedImages,\n        categories: project.categories,\n        name: project.name,\n      })\n    );\n\n    dispatch(\n      classifierSlice.actions.setClassifier({\n        classifier: classifier,\n      })\n    );\n  };\n\n  return (\n    <ListItem button onClick={onClickExampleProject}>\n      <ListItemAvatar>\n        <Avatar src={projectIcon}></Avatar>\n      </ListItemAvatar>\n\n      <ListItemText primary={projectName} />\n    </ListItem>\n  );\n};\n","var _g;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgCheckboxChecked(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"CheckboxChecked\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    id: \"CheckboxChecked\",\n    stroke: \"none\",\n    strokeWidth: 1,\n    fill: \"none\",\n    fillRule: \"evenodd\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Path\",\n    transform: \"translate(-0.000000, -0.000000)\"\n  }, /*#__PURE__*/React.createElement(\"polygon\", {\n    points: \"0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M18,20 L6.00000002,20 C4.89500002,20 4.00000002,19.1050001 4.00000002,18 L4.00000002,6.00000002 C4.00000002,4.89500002 4.89500002,4.00000002 6.00000002,4.00000002 L18,4.00000002 C19.1050001,4.00000002 20,4.89500002 20,6.00000002 L20,18 C20,19.1050001 19.1050001,20 18,20 Z\",\n    stroke: \"#323232\",\n    strokeWidth: 1.5,\n    fill: \"#555555\",\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }), /*#__PURE__*/React.createElement(\"polyline\", {\n    stroke: \"#E5E5E5\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    points: \"16.0000001 10 11 15.0000001 8.00000003 12.0000001\"\n  })))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgCheckboxChecked);\nexport default __webpack_public_path__ + \"static/media/CheckboxChecked.6700c862.svg\";\nexport { ForwardRef as ReactComponent };","export default __webpack_public_path__ + \"static/media/cElegansExampleProjectIcon.ec038762.png\";","export default __webpack_public_path__ + \"static/media/humanU2OSCellsExampleProjectIcon.59ecbfc8.png\";","import {\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  IconButton,\n} from \"@mui/material\";\nimport CloseIcon from \"@mui/icons-material/Close\";\nimport { useTranslation } from \"../../hooks/useTranslation\";\nimport { MenuList } from \"@mui/material\";\nimport { OpenExampleProjectMenuItem } from \"../OpenExampleProjectMenuItem\";\nimport { ExampleProject } from \"data/exampleProjects/exampleProjectsEnum\";\n\nimport mnistExampleProjectIcon from \"data/exampleProjects/mnistExampleProjectIcon.png\";\nimport cElegansExampleProjectIcon from \"data/exampleProjects/cElegansExampleProjectIcon.png\";\nimport humanU2OSCellsExampleProjectIcon from \"data/exampleProjects/humanU2OSCellsExampleProjectIcon.png\";\n\ntype OpenExampleClassifierDialogProps = {\n  open: boolean;\n  onClose: () => void;\n  popupState: any;\n};\n\nexport const OpenExampleClassifierDialog = (\n  props: OpenExampleClassifierDialogProps\n) => {\n  const t = useTranslation();\n  const { open, onClose, popupState } = props;\n\n  const closeMenueAndDialog = () => {\n    onClose();\n  };\n\n  return (\n    // @ts-ignore\n    <Dialog fullWidth maxWidth=\"sm\" open={open}>\n      <DialogTitle\n        sx={{\n          borderBottom: (theme) => `1px solid ${theme.palette.divider}`,\n          margin: 0,\n          padding: (theme) => theme.spacing(2),\n        }}\n      >\n        {t(\"Open example project\")}\n        <IconButton\n          aria-label=\"Close\"\n          sx={(theme) => ({\n            color: theme.palette.grey[500],\n            position: \"absolute\",\n            right: theme.spacing(1),\n            top: theme.spacing(1),\n          })}\n          onClick={closeMenueAndDialog}\n        >\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <DialogContent\n        sx={{\n          borderTop: (theme) => `1px solid ${theme.palette.divider}`,\n          margin: 0,\n          padding: (theme) => theme.spacing(1),\n        }}\n      >\n        <MenuList>\n          <OpenExampleProjectMenuItem\n            exampleProject={ExampleProject.Mnist}\n            projectName={\"Open MNIST example project\"}\n            projectIcon={mnistExampleProjectIcon}\n            popupState={popupState}\n            onClose={onClose}\n          />\n          <OpenExampleProjectMenuItem\n            exampleProject={ExampleProject.CElegans}\n            projectName={\"Open C. elegans example project\"}\n            projectIcon={cElegansExampleProjectIcon}\n            popupState={popupState}\n            onClose={onClose}\n          />\n          <OpenExampleProjectMenuItem\n            exampleProject={ExampleProject.HumanU2OSCells}\n            projectName={\"Open human U2OS-cells example project\"}\n            projectIcon={humanU2OSCellsExampleProjectIcon}\n            popupState={popupState}\n            onClose={onClose}\n          />\n        </MenuList>\n      </DialogContent>\n      <DialogActions />\n    </Dialog>\n  );\n};\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAAmdJREFUSEvtlb9LamEcxh8tRNTBP0DEwEGSDMVfkyBIiSEO6mSloI0qOCiCIJYOWmur4K9BpXAzhHIIRNoaGiSktqDJ0EEnL+97r+Gly/Ucraa+cIZzDuf7eb/P+zzn5QCY4huL8wP8bLV/JP2gKI/Hw8nJCdxuN2QyGSqVCoLBIAaDASP1GUsqEolgNBpxfn4OuVwODoeD6fR3osrlMsLhMCMoI6BQKMTd3R0UCsX7FMViEc/Pz1Cr1bDb7YjH48jlcgunZARsNpvY2dmhzQg4m82i0WjQez6fj1KpBJPJBKlUislk8l/oQuDGxgb6/T6Vj+xXKBT6SzqVSoVIJIKDgwPk83kcHR2tBoxGo3Siy8tLOJ3OD81arRYsFgt9fnV1BZvNthqwUCjQ1W9tbeHh4QEajQZer5c21Wq10Ol0WFtbewfu7e2tBvR4PHSPXl9f8fb2BolEQvdtNBqBOHdWw+EQp6enyGQyqwHJFLe3tyD5m1UymaQS+3w++P1+iMViur+Hh4ef49Lt7W0QaYmspNrtNshEZBHEnQKBAOl0GmQhi2qhS+cbEMeS6+bmBolEgubv6ekJFxcXqNfri1j0PSvgfEcC2N3dxf39PQKBAHq93tcB9/f3Qf40JJupVArHx8eMYEtNyOVyad5I9oiUJDLj8fjrgC6XC9VqFS8vLzCbzXh8fGQMW2rCbrcLvV5PI0BOCbbFyjS1Wg0OhwPr6+vY3NxkbJT5RbECEieSs5Bp5v41PWOgUqmkRxMJu9VqxfX1NVs12eXQYDCg0+ng7OwMsVhsKdhSplma9OdDxpKuCpp9/wsa/u4BrNHtvwAAAABJRU5ErkJggg==\"","import { Divider, Menu, MenuItem, MenuList } from \"@mui/material\";\nimport { bindMenu } from \"material-ui-popup-state\";\nimport { OpenProjectMenuItem } from \"../OpenProjectMenuItem\";\nimport { OpenClassifierDialog } from \"../OpenClassifierDialog\";\nimport { useDialog } from \"../../hooks\";\nimport { OpenExampleClassifierDialog } from \"../OpenExampleProjectDialog/OpenExampleProjectDialog\";\n\ntype OpenMenuProps = {\n  popupState: any;\n};\n\nexport const OpenMenu = ({ popupState }: OpenMenuProps) => {\n  const {\n    onClose: onCloseClassifierDialog,\n    onOpen: onOpenClassifierDialog,\n    open: openClassifierDialog,\n  } = useDialog();\n  const {\n    onClose: onCloseExampleClassifierDialog,\n    onOpen: onOpenExampleClassifierDialog,\n    open: openExampleClassifier,\n  } = useDialog();\n\n  return (\n    <Menu {...bindMenu(popupState)}>\n      <MenuList dense variant=\"menu\">\n        <OpenProjectMenuItem popupState={popupState} />\n        <MenuItem onClick={onOpenExampleClassifierDialog}>\n          Open example project\n        </MenuItem>\n        <Divider />\n\n        <MenuItem onClick={onOpenClassifierDialog}>Open classifier</MenuItem>\n      </MenuList>\n\n      <OpenExampleClassifierDialog\n        onClose={onCloseExampleClassifierDialog}\n        open={openExampleClassifier}\n        popupState={popupState}\n      />\n\n      <OpenClassifierDialog\n        onClose={onCloseClassifierDialog}\n        open={openClassifierDialog}\n        popupState={popupState}\n      />\n    </Menu>\n  );\n};\n","import ListItem from \"@mui/material/ListItem\";\nimport ListItemIcon from \"@mui/material/ListItemIcon\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport FolderOpenIcon from \"@mui/icons-material/FolderOpen\";\nimport React from \"react\";\nimport { OpenMenu } from \"../OpenMenu\";\nimport PopupState, { bindTrigger } from \"material-ui-popup-state\";\n\nexport const OpenListItem = () => {\n  return (\n    //@ts-ignore\n    <PopupState variant=\"popover\">\n      {(popupState) => (\n        <>\n          <ListItem button {...bindTrigger(popupState)}>\n            <ListItemIcon>\n              <FolderOpenIcon />\n            </ListItemIcon>\n\n            <ListItemText primary=\"Open\" />\n          </ListItem>\n\n          <OpenMenu popupState={popupState} />\n        </>\n      )}\n    </PopupState>\n  );\n};\n","import { Project } from \"../../types/Project\";\nimport { Image } from \"../../types/Image\";\nimport { SerializedProjectType } from \"../../types/SerializedProjectType\";\nimport { UNKNOWN_CATEGORY_ID } from \"../../types/Category\";\n\nexport const serializedProjectSelector = ({\n  project,\n}: {\n  project: Project;\n}): SerializedProjectType => {\n  const serializedImages = project.images.map((image: Image) => {\n    const categoryId = image.categoryId\n      ? image.categoryId\n      : UNKNOWN_CATEGORY_ID;\n\n    return {\n      imageCategoryId: categoryId,\n      imageChannels: image.shape.channels,\n      imageChecksum: \"\",\n      imageData: image.originalSrc,\n      imageFilename: image.name,\n      imageFrames: image.shape.frames,\n      imageHeight: image.shape.height,\n      imageId: image.id,\n      imagePlanes: image.shape.planes,\n      imageWidth: image.shape.width,\n      imagePartition: image.partition,\n      annotations: image.annotations,\n    };\n  });\n\n  const categories = project.categories;\n  const name = project.name;\n\n  return {\n    serializedImages: serializedImages,\n    categories: categories,\n    name: name,\n  };\n};\n","import { ChangeEvent, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  Grid,\n  TextField,\n} from \"@mui/material\";\nimport saveAs from \"file-saver\";\nimport { classifierSelector } from \"../../store/selectors\";\nimport { serializedProjectSelector } from \"../../store/selectors/serializedProjectSelector\";\n\ntype SaveProjectDialogProps = {\n  onClose: () => void;\n  open: boolean;\n  popupState: any;\n};\n\nexport const SaveProjectDialog = ({\n  onClose,\n  open,\n  popupState,\n}: SaveProjectDialogProps) => {\n  const classifier = useSelector(classifierSelector);\n\n  const serializedProject = useSelector(serializedProjectSelector);\n\n  const [projectName, setProjectName] = useState<string>(\n    serializedProject.name\n  );\n\n  const onSaveProjectClick = () => {\n    const part = {\n      classifier: classifier,\n      project: serializedProject,\n      version: \"0.0.0\",\n    };\n\n    part.project.name = projectName;\n\n    const parts = [JSON.stringify(part)];\n\n    const data = new Blob(parts, { type: \"application/json;charset=utf-8\" });\n\n    saveAs(data, `${projectName}.json`);\n\n    onClose();\n    popupState.close();\n  };\n\n  const onCancel = () => {\n    onClose();\n  };\n\n  const onNameChange = (event: ChangeEvent<HTMLInputElement>) => {\n    setProjectName(event.target.value);\n  };\n\n  return (\n    <Dialog fullWidth maxWidth=\"xs\" onClose={onClose} open={open}>\n      <DialogTitle>Save Project</DialogTitle>\n\n      <DialogContent>\n        <Grid container spacing={1}>\n          <Grid item xs={10}>\n            <TextField\n              autoFocus\n              fullWidth\n              id=\"name\"\n              label=\"Project file name\"\n              margin=\"dense\"\n              onChange={onNameChange}\n            />\n          </Grid>\n        </Grid>\n      </DialogContent>\n\n      <DialogActions>\n        <Button onClick={onCancel} color=\"primary\">\n          Cancel\n        </Button>\n\n        <Button onClick={onSaveProjectClick} color=\"primary\">\n          Save Project\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n","import { Classifier } from \"../../types/Classifier\";\nimport { LayersModel } from \"@tensorflow/tfjs\";\n\nexport const fittedSelector = ({\n  classifier,\n}: {\n  classifier: Classifier;\n}): LayersModel => {\n  return classifier.fitted!;\n};\n","import { Classifier } from \"../../types/Classifier\";\nimport { ClassifierModelProps } from \"../../types/ClassifierModelType\";\n\nexport const selectedModelSelector = ({\n  classifier,\n}: {\n  classifier: Classifier;\n}): ClassifierModelProps => {\n  return classifier.selectedModel;\n};\n","import { ChangeEvent, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  Grid,\n  TextField,\n} from \"@mui/material\";\nimport { fittedSelector } from \"../../store/selectors/fittedSelector\";\nimport { selectedModelSelector } from \"../../store/selectors/selectedModelSelector\";\n\ntype SaveClassifierDialogProps = {\n  onClose: () => void;\n  open: boolean;\n  popupState: any;\n};\n\nexport const SaveClassifierDialog = ({\n  onClose,\n  open,\n  popupState,\n}: SaveClassifierDialogProps) => {\n  const fitted = useSelector(fittedSelector);\n\n  const selectedModel = useSelector(selectedModelSelector);\n\n  const [classifierName, setClassifierName] = useState<string>(\n    selectedModel.modelName\n  );\n\n  const noFittedModel = fitted ? false : true;\n\n  const onCancel = () => {\n    onClose();\n  };\n\n  const onSaveClassifierClick = async () => {\n    await fitted.save(`downloads://${classifierName}`);\n\n    onClose();\n    popupState.close();\n  };\n\n  const onNameChange = (event: ChangeEvent<HTMLInputElement>) => {\n    setClassifierName(event.target.value);\n  };\n\n  return (\n    <Dialog fullWidth maxWidth=\"xs\" onClose={onClose} open={open}>\n      <DialogTitle>Save Classifier</DialogTitle>\n\n      <DialogContent>\n        <Grid container spacing={1}>\n          <Grid item xs={10}>\n            <TextField\n              autoFocus\n              fullWidth\n              id=\"name\"\n              label=\"Classifier name\"\n              margin=\"dense\"\n              onChange={onNameChange}\n              helperText={\n                noFittedModel\n                  ? \"There is no trained model that could be saved.\"\n                  : \"\"\n              }\n              error={noFittedModel}\n            />\n          </Grid>\n        </Grid>\n      </DialogContent>\n\n      <DialogActions>\n        <Button onClick={onCancel} color=\"primary\">\n          Cancel\n        </Button>\n\n        <Button\n          onClick={onSaveClassifierClick}\n          color=\"primary\"\n          disabled={noFittedModel}\n        >\n          Save Classifier\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n","import { bindMenu } from \"material-ui-popup-state\";\nimport { Menu, MenuItem } from \"@mui/material\";\nimport { useDialog } from \"../../hooks\";\nimport { SaveProjectDialog } from \"../SaveProjectDialog/SaveProjectDialog\";\nimport { SaveClassifierDialog } from \"../SaveClassifierDialog/SaveClassifierDialog\";\n\ntype SaveMenuProps = {\n  popupState: any;\n};\n\nexport const SaveMenu = ({ popupState }: SaveMenuProps) => {\n  const {\n    onClose: onSaveProjectDialogClose,\n    onOpen: onSaveProjectDialogOpen,\n    open: openSaveProjectDialog,\n  } = useDialog();\n\n  const {\n    onClose: onSaveClassifierDialogClose,\n    onOpen: onSaveClassifierDialogOpen,\n    open: openSaveClassifierDialog,\n  } = useDialog();\n\n  return (\n    <Menu {...bindMenu(popupState)}>\n      <MenuItem onClick={onSaveProjectDialogOpen}>Save project</MenuItem>\n\n      <MenuItem onClick={onSaveClassifierDialogOpen}>Save classifier</MenuItem>\n\n      <SaveProjectDialog\n        onClose={onSaveProjectDialogClose}\n        open={openSaveProjectDialog}\n        popupState={popupState}\n      />\n\n      <SaveClassifierDialog\n        onClose={onSaveClassifierDialogClose}\n        open={openSaveClassifierDialog}\n        popupState={popupState}\n      />\n    </Menu>\n  );\n};\n","import ListItem from \"@mui/material/ListItem\";\nimport ListItemIcon from \"@mui/material/ListItemIcon\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport React from \"react\";\nimport { SaveMenu } from \"../SaveMenu\";\nimport PopupState, { bindTrigger } from \"material-ui-popup-state\";\nimport DownloadIcon from \"@mui/icons-material/Download\";\n\nexport const SaveListItem = () => {\n  return (\n    //@ts-ignore\n    <PopupState variant=\"popover\">\n      {(popupState) => (\n        <>\n          <ListItem button {...bindTrigger(popupState)}>\n            <ListItemIcon>\n              <DownloadIcon />\n            </ListItemIcon>\n\n            <ListItemText primary=\"Save\" />\n          </ListItem>\n\n          <SaveMenu popupState={popupState} />\n        </>\n      )}\n    </PopupState>\n  );\n};\n","import React from \"react\";\nimport { OpenListItem } from \"../OpenListItem\";\nimport { SaveListItem } from \"../SaveListItem\";\nimport { List } from \"@mui/material\";\n\nexport const FileList = () => {\n  return (\n    <List dense>\n      <OpenListItem />\n\n      <SaveListItem />\n    </List>\n  );\n};\n","import React from \"react\";\nimport List from \"@mui/material/List\";\nimport ListItem from \"@mui/material/ListItem\";\nimport ListItemIcon from \"@mui/material/ListItemIcon\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport Collapse from \"@mui/material/Collapse\";\nimport ExpandLessIcon from \"@mui/icons-material/ExpandLess\";\nimport ExpandMoreIcon from \"@mui/icons-material/ExpandMore\";\n\ntype CollapsibleListProps = {\n  children: any;\n  primary: string;\n};\n\nexport const CollapsibleList = ({\n  children,\n  primary,\n}: CollapsibleListProps) => {\n  const [collapsed, setCollapsed] = React.useState(true);\n\n  const onClick = () => {\n    setCollapsed(!collapsed);\n  };\n\n  return (\n    <List dense>\n      <ListItem button dense onClick={onClick}>\n        <ListItemIcon>\n          {collapsed ? <ExpandLessIcon /> : <ExpandMoreIcon />}\n        </ListItemIcon>\n\n        <ListItemText primary={primary} />\n      </ListItem>\n\n      <Collapse in={collapsed} timeout=\"auto\" unmountOnExit>\n        <List component=\"div\" dense disablePadding>\n          {children}\n        </List>\n      </Collapse>\n    </List>\n  );\n};\n","import React from \"react\";\nimport { Category } from \"../../types/Category\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { deselectImages, updateCategoryVisibility } from \"../../store/slices\";\nimport { visibleImagesSelector } from \"../../store/selectors\";\nimport { Image } from \"../../types/Image\";\nimport { Checkbox, ListItemIcon } from \"@mui/material\";\nimport LabelIcon from \"@mui/icons-material/Label\";\nimport LabelOutlinedIcon from \"@mui/icons-material/LabelOutlined\";\n\ntype CategoryListItemCheckboxProps = {\n  category: Category;\n};\n\nexport const CategoryListItemCheckbox = ({\n  category,\n}: CategoryListItemCheckboxProps) => {\n  const dispatch = useDispatch();\n\n  const images = useSelector(visibleImagesSelector);\n\n  const onChange = () => {\n    const payload = {\n      id: category.id,\n      visible: !category.visible,\n    };\n\n    if (category.visible) {\n      dispatch(\n        deselectImages({\n          ids: images\n            .filter((image: Image) => {\n              return image.categoryId === category.id;\n            })\n            .map((image: Image) => image.id),\n        })\n      );\n    }\n\n    dispatch(updateCategoryVisibility(payload));\n  };\n\n  return (\n    <ListItemIcon>\n      <Checkbox\n        checked={category.visible}\n        checkedIcon={<LabelIcon style={{ color: category.color }} />}\n        disableRipple\n        edge=\"start\"\n        icon={<LabelOutlinedIcon style={{ color: category.color }} />}\n        tabIndex={-1}\n        onChange={onChange}\n      />\n    </ListItemIcon>\n  );\n};\n","import React from \"react\";\nimport MenuItem from \"@mui/material/MenuItem\";\nimport Typography from \"@mui/material/Typography\";\nimport { Category } from \"../../types/Category\";\nimport { useDispatch } from \"react-redux\";\nimport { updateCategoryVisibility } from \"../../store/slices\";\n\ntype HideOrShowCategoryMenuItemProps = {\n  category: Category;\n  onCloseCategoryMenu: (\n    event: React.MouseEvent<HTMLLIElement, MouseEvent>\n  ) => void;\n};\n\nexport const HideOrShowCategoryMenuItem = ({\n  category,\n  onCloseCategoryMenu,\n}: HideOrShowCategoryMenuItemProps) => {\n  const dispatch = useDispatch();\n\n  const onClick = (event: React.MouseEvent<HTMLLIElement, MouseEvent>) => {\n    onCloseCategoryMenu(event);\n\n    const payload = { id: category.id, visible: !category.visible };\n\n    dispatch(updateCategoryVisibility(payload));\n  };\n\n  return (\n    <MenuItem onClick={onClick}>\n      <Typography variant=\"inherit\">\n        {category.visible ? \"Hide\" : \"Show\"} category\n      </Typography>\n    </MenuItem>\n  );\n};\n","import React from \"react\";\nimport MenuItem from \"@mui/material/MenuItem\";\nimport Typography from \"@mui/material/Typography\";\nimport { Category } from \"../../types/Category\";\nimport { useDispatch } from \"react-redux\";\nimport { updateOtherCategoryVisibility } from \"../../store/slices\";\n\ntype HideOtherCategoriesMenuItemProps = {\n  category: Category;\n  onCloseCategoryMenu: (\n    event: React.MouseEvent<HTMLElement, MouseEvent>\n  ) => void;\n};\n\nexport const HideOtherCategoriesMenuItem = ({\n  category,\n  onCloseCategoryMenu,\n}: HideOtherCategoriesMenuItemProps) => {\n  const dispatch = useDispatch();\n\n  const onClick = (event: React.MouseEvent<HTMLElement, MouseEvent>) => {\n    onCloseCategoryMenu(event);\n\n    dispatch(updateOtherCategoryVisibility({ id: category.id }));\n  };\n\n  return (\n    <MenuItem onClick={onClick}>\n      <Typography variant=\"inherit\">Hide other categories</Typography>\n    </MenuItem>\n  );\n};\n","import React from \"react\";\nimport { Category, UNKNOWN_CATEGORY_ID } from \"../../types/Category\";\nimport { HideOrShowCategoryMenuItem } from \"../HideOrShowCategoryMenuItem\";\nimport { HideOtherCategoriesMenuItem } from \"../HideOtherCategoriesMenuItem\";\nimport { Divider, Menu, MenuItem, MenuList, Typography } from \"@mui/material\";\n\ntype CategoryMenuProps = {\n  anchorElCategoryMenu: any;\n  category: Category;\n  onCloseCategoryMenu: (\n    event: React.MouseEvent<HTMLElement, MouseEvent>\n  ) => void;\n  onOpenCategoryMenu: (event: React.MouseEvent<HTMLButtonElement>) => void;\n  openCategoryMenu: boolean;\n  onOpenDeleteCategoryDialog: () => void;\n  onOpenEditCategoryDialog: () => void;\n};\n\nexport const CategoryMenu = ({\n  anchorElCategoryMenu,\n  category,\n  onCloseCategoryMenu,\n  openCategoryMenu,\n  onOpenDeleteCategoryDialog,\n  onOpenEditCategoryDialog,\n}: CategoryMenuProps) => {\n  const onOpenDeleteCategoryDialogClick = (\n    event: React.MouseEvent<HTMLElement, MouseEvent>\n  ) => {\n    onOpenDeleteCategoryDialog();\n    onCloseCategoryMenu(event);\n  };\n\n  const onOpenEditCategoryDialogClick = (\n    event: React.MouseEvent<HTMLElement, MouseEvent>\n  ) => {\n    onOpenEditCategoryDialog();\n    onCloseCategoryMenu(event);\n  };\n\n  return (\n    <Menu\n      anchorEl={anchorElCategoryMenu}\n      anchorOrigin={{ horizontal: \"center\", vertical: \"bottom\" }}\n      onClose={onCloseCategoryMenu}\n      open={openCategoryMenu}\n      transformOrigin={{ horizontal: \"center\", vertical: \"top\" }}\n    >\n      <MenuList dense variant=\"menu\">\n        <HideOtherCategoriesMenuItem\n          category={category}\n          onCloseCategoryMenu={onCloseCategoryMenu}\n        />\n\n        <HideOrShowCategoryMenuItem\n          category={category}\n          onCloseCategoryMenu={onCloseCategoryMenu}\n        />\n\n        {category.id !== UNKNOWN_CATEGORY_ID && (\n          <div>\n            <Divider />\n\n            <MenuItem onClick={onOpenEditCategoryDialogClick}>\n              <Typography variant=\"inherit\">Edit category</Typography>\n            </MenuItem>\n\n            <MenuItem onClick={onOpenDeleteCategoryDialogClick}>\n              <Typography variant=\"inherit\">Delete category</Typography>\n            </MenuItem>\n          </div>\n        )}\n      </MenuList>\n    </Menu>\n  );\n};\n","export const COLORS = [\n  \"#000000\",\n  \"#004949\",\n  \"#009292\",\n  \"#ff6db6\",\n  \"#ffb6db\",\n  \"#490092\",\n  \"#006ddb\",\n  \"#b66dff\",\n  \"#6db6ff\",\n  \"#b6dbff\",\n  \"#920000\",\n  \"#924900\",\n  \"#db6d00\",\n  \"#24ff24\",\n  \"#ffff6d\",\n];\n","import { Project } from \"../../types/Project\";\nimport { Category } from \"../../types/Category\";\nimport { COLORS } from \"../../store\";\n\nexport const availableColorsSelector = ({\n  project,\n}: {\n  project: Project;\n}): string[] => {\n  const usedColors = project.categories.map((catagory: Category) => {\n    return catagory.color;\n  });\n  return COLORS.filter((color: string) => !usedColors.includes(color));\n};\n","import * as React from \"react\";\nimport { CirclePicker, ColorResult } from \"react-color\";\nimport { availableColorsSelector } from \"../../store/selectors/availableColorsSelecor\";\nimport { Avatar, IconButton, Popover, Box } from \"@mui/material\";\nimport { Label } from \"@mui/icons-material\";\nimport { useSelector } from \"react-redux\";\n\ntype ColorIconButtonProps = {\n  color: string;\n  onColorChange: (color: any) => void;\n};\n\nexport const ColorIcon = ({ color, onColorChange }: ColorIconButtonProps) => {\n  const availableColors = useSelector(availableColorsSelector);\n\n  const [colorMenuAnchorEl, setColorMenuAnchorEl] =\n    React.useState<null | HTMLButtonElement>(null);\n\n  const colorPopupOpen = Boolean(colorMenuAnchorEl);\n\n  const onOpenColorPicker = (event: React.MouseEvent<HTMLButtonElement>) => {\n    setColorMenuAnchorEl(event.currentTarget);\n  };\n\n  const onCloseColorPicker = () => {\n    setColorMenuAnchorEl(null);\n  };\n\n  const onChange = (color: ColorResult) => {\n    console.info(color);\n    onColorChange(color);\n    onCloseColorPicker();\n  };\n\n  return (\n    <React.Fragment>\n      <IconButton onClick={onOpenColorPicker}>\n        <Avatar sx={{ backgroundColor: \"#F3F3F3\" }}>\n          <Label sx={{ color: color }} />\n        </Avatar>\n      </IconButton>\n      <Popover\n        id=\"color-menu\"\n        open={colorPopupOpen}\n        anchorEl={colorMenuAnchorEl}\n        onClose={onCloseColorPicker}\n        anchorOrigin={{\n          vertical: \"bottom\",\n          horizontal: \"center\",\n        }}\n        transformOrigin={{\n          vertical: \"top\",\n          horizontal: \"center\",\n        }}\n      >\n        <Box sx={{ margin: \"16px\" }}>\n          <CirclePicker colors={availableColors} onChange={onChange} />\n        </Box>\n      </Popover>\n    </React.Fragment>\n  );\n};\n","import React, { ChangeEvent, useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { ColorIcon } from \"../ColorIcon\";\nimport { Category } from \"../../types/Category\";\nimport { updateCategory } from \"../../store/slices\";\nimport {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  Grid,\n  TextField,\n} from \"@mui/material\";\n\ntype EditCategoryDialogProps = {\n  category: Category;\n  onCloseDialog: () => void;\n  openDialog: boolean;\n};\n\nexport const EditCategoryDialog = ({\n  category,\n  onCloseDialog,\n  openDialog,\n}: EditCategoryDialogProps) => {\n  const dispatch = useDispatch();\n\n  const [color, setColor] = useState<string>(category.color);\n\n  const onColorChange = (color: any) => {\n    setColor(color.hex);\n  };\n\n  const [name, setName] = useState<string>(category.name);\n\n  const onNameChange = (event: ChangeEvent<HTMLInputElement>) => {\n    setName(event.target.value);\n  };\n\n  const onEdit = () => {\n    dispatch(\n      updateCategory({\n        id: category.id,\n        name: name,\n        color: color,\n      })\n    );\n\n    onCloseDialog();\n  };\n\n  return (\n    <Dialog fullWidth onClose={onCloseDialog} open={openDialog}>\n      <DialogTitle>Edit category</DialogTitle>\n\n      <DialogContent>\n        <div>\n          <Grid container spacing={1}>\n            <Grid item xs={2}>\n              <ColorIcon color={color} onColorChange={onColorChange} />\n            </Grid>\n            <Grid item xs={10}>\n              <TextField\n                autoFocus\n                fullWidth\n                id=\"name\"\n                label=\"Name\"\n                margin=\"dense\"\n                onChange={onNameChange}\n                value={name}\n              />\n            </Grid>\n          </Grid>\n        </div>\n      </DialogContent>\n\n      <DialogActions>\n        <Button onClick={onCloseDialog} color=\"primary\">\n          Cancel\n        </Button>\n\n        <Button onClick={onEdit} color=\"primary\">\n          Update\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n","import React from \"react\";\nimport Dialog from \"@mui/material/Dialog\";\nimport DialogTitle from \"@mui/material/DialogTitle\";\nimport DialogContent from \"@mui/material/DialogContent\";\nimport DialogActions from \"@mui/material/DialogActions\";\nimport Button from \"@mui/material/Button\";\nimport { useDispatch } from \"react-redux\";\nimport { Category } from \"../../types/Category\";\nimport { deleteCategory } from \"../../store/slices\";\n\ntype DeleteCategoryDialogProps = {\n  category: Category;\n  onClose: () => void;\n  open: boolean;\n};\n\nexport const DeleteCategoryDialog = ({\n  category,\n  onClose,\n  open,\n}: DeleteCategoryDialogProps) => {\n  const dispatch = useDispatch();\n\n  const onDelete = () => {\n    dispatch(deleteCategory({ id: category.id }));\n\n    onClose();\n  };\n\n  return (\n    <Dialog fullWidth onClose={onClose} open={open}>\n      <DialogTitle>Delete \"{category.name}\" category?</DialogTitle>\n\n      <DialogContent>\n        Images categorized as \"{category.name}\" will not be deleted.\n      </DialogContent>\n\n      <DialogActions>\n        <Button onClick={onClose} color=\"primary\">\n          Cancel\n        </Button>\n\n        <Button onClick={onDelete} color=\"primary\">\n          Delete\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n","import React from \"react\";\nimport { Category } from \"../../types/Category\";\nimport { CategoryListItemCheckbox } from \"../CategoryListItemCheckbox\";\nimport { CategoryMenu } from \"../CategoryMenu\";\nimport { useDialog, useMenu } from \"../../hooks\";\nimport { useSelector } from \"react-redux\";\nimport { EditCategoryDialog } from \"../EditCategoryDialog\";\nimport { DeleteCategoryDialog } from \"../DeleteCategoryDialog\";\nimport MoreHorizIcon from \"@mui/icons-material/MoreHoriz\";\nimport { State } from \"../../types/State\";\nimport { Image } from \"../../types/Image\";\nimport {\n  Chip,\n  IconButton,\n  ListItem,\n  ListItemSecondaryAction,\n  ListItemText,\n} from \"@mui/material\";\n\ntype CategoryListItemProps = {\n  category: Category;\n  id: string;\n};\n\nexport const CategoryListItem = ({ category, id }: CategoryListItemProps) => {\n  const {\n    onClose: onCloseDeleteCategoryDialog,\n    onOpen: onOpenDeleteCategoryDialog,\n    open: openDeleteCategoryDialog,\n  } = useDialog();\n  const {\n    onClose: onCloseEditCategoryDialog,\n    onOpen: onOpenEditCategoryDialog,\n    open: openEditCategoryDialog,\n  } = useDialog();\n\n  const {\n    anchorEl: anchorElCategoryMenu,\n    onClose: onCloseCategoryMenu,\n    onOpen: onOpenCategoryMenu,\n    open: openCategoryMenu,\n  } = useMenu();\n\n  const imageCount = useSelector((state: State) => {\n    return state.project.images.filter((image: Image) => {\n      return image.categoryId === category.id;\n    }).length;\n  });\n\n  return (\n    <React.Fragment>\n      <ListItem dense key={id} id={id}>\n        <CategoryListItemCheckbox category={category} />\n\n        <ListItemText\n          id={id}\n          primary={category.name}\n          primaryTypographyProps={{ noWrap: true }}\n        />\n\n        <Chip\n          label={imageCount}\n          size=\"small\"\n          // className={classes.chip}\n          sx={{\n            height: \"20px\",\n            borderWidth: \"2px\",\n            fontSize: \"0.875rem\",\n            color: \"white\",\n            backgroundColor: category.color,\n          }}\n        />\n\n        <ListItemSecondaryAction>\n          <IconButton edge=\"end\" onClick={onOpenCategoryMenu}>\n            <MoreHorizIcon />\n          </IconButton>\n        </ListItemSecondaryAction>\n      </ListItem>\n\n      <CategoryMenu\n        anchorElCategoryMenu={anchorElCategoryMenu}\n        category={category}\n        onCloseCategoryMenu={onCloseCategoryMenu}\n        onOpenCategoryMenu={onOpenCategoryMenu}\n        onOpenDeleteCategoryDialog={onOpenDeleteCategoryDialog}\n        onOpenEditCategoryDialog={onOpenEditCategoryDialog}\n        openCategoryMenu={openCategoryMenu}\n      />\n\n      <DeleteCategoryDialog\n        category={category}\n        onClose={onCloseDeleteCategoryDialog}\n        open={openDeleteCategoryDialog}\n      />\n\n      <EditCategoryDialog\n        category={category}\n        onCloseDialog={onCloseEditCategoryDialog}\n        openDialog={openEditCategoryDialog}\n      />\n    </React.Fragment>\n  );\n};\n","import React, { ChangeEvent, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { ColorIcon } from \"../ColorIcon\";\nimport { ColorResult } from \"react-color\";\nimport { sample } from \"lodash\";\nimport { createCategory } from \"../../store/slices\";\nimport { availableColorsSelector } from \"../../store/selectors/availableColorsSelecor\";\nimport { categoriesSelector } from \"../../store/selectors/categoriesSelector\";\nimport { Category } from \"../../types/Category\";\nimport {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  Grid,\n  TextField,\n  Box,\n} from \"@mui/material\";\n\ntype CreateCategoryDialogProps = {\n  onClose: () => void;\n  open: boolean;\n};\n\nexport const CreateCategoryDialog = ({\n  onClose,\n  open,\n}: CreateCategoryDialogProps) => {\n  const dispatch = useDispatch();\n\n  const availableColors = useSelector(availableColorsSelector);\n  const usedCategoryNames = useSelector(categoriesSelector).map(\n    (category: Category) => category.name\n  );\n\n  const [color, setColor] = React.useState<string>(sample(availableColors)!);\n  const [name, setName] = useState<string>(\"\");\n  const [errorHelperText, setErrorHelperText] = useState<string>(\"\");\n  const [invalidName, setInvalidName] = useState<boolean>(false);\n\n  const onCloseDialog = () => {\n    setErrorHelperText(\"\");\n    setName(\"\");\n    setInvalidName(false);\n    setColor(sample(availableColors)!);\n\n    onClose();\n  };\n\n  const onCreate = () => {\n    if (validateInput(name)) {\n      dispatch(createCategory({ name: name, color: color }));\n\n      onCloseDialog();\n    }\n  };\n\n  const onColorChange = (color: ColorResult) => {\n    setColor(color.hex);\n  };\n\n  const onNameChange = (event: ChangeEvent<HTMLInputElement>) => {\n    setName(event.target.value);\n\n    validateInput(event.target.value);\n  };\n\n  const validateInput = (categoryName: string) => {\n    let validInput = true;\n    let helperText = \"\";\n\n    if (categoryName === \"\") {\n      helperText = \"Please type a category name.\";\n      validInput = false;\n    } else if (usedCategoryNames.includes(categoryName)) {\n      helperText =\n        \"Category names must be unique. A category with this name already exits.\";\n      validInput = false;\n    }\n\n    setErrorHelperText(helperText);\n    setInvalidName(!validInput);\n    return validInput;\n  };\n\n  return (\n    <Dialog fullWidth maxWidth=\"xs\" onClose={onClose} open={open}>\n      <DialogTitle>Create category</DialogTitle>\n\n      <DialogContent sx={{ paddingLeft: \"0 !important\" }}>\n        <Box sx={{ margin: (theme) => theme.spacing(1) }}>\n          <Grid container spacing={1}>\n            <Grid item xs={2}>\n              <ColorIcon color={color} onColorChange={onColorChange} />\n            </Grid>\n            <Grid item xs={10}>\n              <TextField\n                error={invalidName}\n                autoFocus\n                fullWidth\n                id=\"name\"\n                label=\"Name\"\n                margin=\"dense\"\n                onChange={onNameChange}\n                helperText={errorHelperText}\n              />\n            </Grid>\n          </Grid>\n        </Box>\n      </DialogContent>\n\n      <DialogActions>\n        <Button onClick={onCloseDialog} color=\"primary\">\n          Cancel\n        </Button>\n\n        <Button onClick={onCreate} color=\"primary\">\n          Create\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n","import React from \"react\";\nimport { CreateCategoryDialog } from \"../CreateCategoryDialog\";\nimport { useDialog } from \"../../hooks\";\nimport { ListItem, ListItemIcon, ListItemText } from \"@mui/material\";\nimport AddIcon from \"@mui/icons-material/Add\";\n\nexport const CreateCategoryListItem = () => {\n  const { onClose, onOpen, open } = useDialog();\n\n  return (\n    <>\n      <ListItem button onClick={onOpen}>\n        <ListItemIcon>\n          <AddIcon />\n        </ListItemIcon>\n\n        <ListItemText primary=\"Create category\" />\n      </ListItem>\n\n      <CreateCategoryDialog onClose={onClose} open={open} />\n    </>\n  );\n};\n","import { CollapsibleList } from \"../CollapsibleList\";\nimport React from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { CategoryListItem } from \"../CategoryListItem\";\nimport { Category } from \"../../types/Category\";\nimport { CreateCategoryListItem } from \"../CreateCategoryListItem\";\nimport {\n  createdCategoriesSelector,\n  unknownCategorySelector,\n} from \"../../store/selectors\";\n\nexport const CategoriesList = () => {\n  const categories = useSelector(createdCategoriesSelector);\n  const unknownCategory = useSelector(unknownCategorySelector);\n\n  return (\n    <CollapsibleList primary=\"Categories\">\n      {categories.map((category: Category) => {\n        return (\n          <CategoryListItem\n            category={category}\n            key={category.id}\n            id={category.id}\n          />\n        );\n      })}\n      <CategoryListItem\n        category={unknownCategory}\n        key={unknownCategory.id}\n        id={unknownCategory.id}\n      />\n      <CreateCategoryListItem />\n    </CollapsibleList>\n  );\n};\n","import { Classifier } from \"../../types/Classifier\";\n\nexport const trainingFlagSelector = ({\n  classifier,\n}: {\n  classifier: Classifier;\n}): boolean => {\n  return classifier.fitting;\n};\n","import * as React from \"react\";\nimport { AppBar, Box, IconButton, Toolbar, Tooltip } from \"@mui/material\";\nimport { ArrowBack, PlayCircleOutline, Stop } from \"@mui/icons-material\";\nimport { compiledSelector } from \"../../../store/selectors\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { classifierSlice } from \"../../../store/slices\";\nimport { trainingFlagSelector } from \"../../../store/selectors/trainingFlagSelector\";\n\nexport const FitClassifierDialogAppBar = (props: any) => {\n  const { closeDialog, fit, disableFitting } = props;\n\n  const dispatch = useDispatch();\n\n  const compiled = useSelector(compiledSelector);\n  const training = useSelector(trainingFlagSelector);\n\n  const onStopFitting = () => {\n    if (!compiled) return;\n    compiled.stopTraining = true;\n    dispatch(classifierSlice.actions.updateCompiled({ compiled: compiled }));\n  };\n\n  return (\n    <AppBar\n      sx={{\n        position: \"relative\",\n        backgroundColor: \"transparent\",\n        boxShadow: \"none\",\n        borderBottom: \"1px solid rgba(0, 0, 0, 0.12)\",\n      }}\n    >\n      <Toolbar>\n        <Tooltip title=\"Close Dialog\" placement=\"bottom\">\n          <IconButton\n            edge=\"start\"\n            color=\"primary\"\n            onClick={closeDialog}\n            aria-label=\"Close\"\n            href={\"\"}\n          >\n            <ArrowBack />\n          </IconButton>\n        </Tooltip>\n\n        <Box sx={{ flexGrow: 1 }} />\n\n        <Tooltip\n          title={\n            disableFitting\n              ? \"Plaese label images before fitting a model.\"\n              : \"Fit the model\"\n          }\n          placement=\"bottom\"\n        >\n          <span>\n            <IconButton onClick={fit} href={\"\"} disabled={disableFitting}>\n              <PlayCircleOutline />\n            </IconButton>\n          </span>\n        </Tooltip>\n\n        <Tooltip title=\"Stop fitting the model\" placement=\"bottom\">\n          <span>\n            <IconButton onClick={onStopFitting} href={\"\"} disabled={!training}>\n              <Stop />\n            </IconButton>\n          </span>\n        </Tooltip>\n      </Toolbar>\n    </AppBar>\n  );\n};\n","import { styled } from \"@mui/material/styles\";\nimport FormControl, { FormControlProps } from \"@mui/material/FormControl\";\n\n// type StyledFormControlProps = FormControlProps & { component: string };\n\nexport const StyledFormControl = styled(FormControl)<FormControlProps>(\n  ({ theme }) => ({\n    display: \"flex\",\n    flexWrap: \"wrap\",\n    margin: theme.spacing(1),\n    width: \"100%\",\n    minWidth: 120,\n  })\n);\n","import { Classifier } from \"../../types/Classifier\";\n\nexport const learningRateSelector = ({\n  classifier,\n}: {\n  classifier: Classifier;\n}): number => {\n  return classifier.learningRate;\n};\n","import { Classifier } from \"../../types/Classifier\";\nimport { OptimizationAlgorithm } from \"../../types/OptimizationAlgorithm\";\n\nexport const optimizationAlgorithmSelector = ({\n  classifier,\n}: {\n  classifier: Classifier;\n}): OptimizationAlgorithm => {\n  return classifier.optimizationAlgorithm;\n};\n","import { Classifier } from \"../../types/Classifier\";\nimport { LossFunction } from \"../../types/LossFunction\";\n\nexport const lossFunctionSelector = ({\n  classifier,\n}: {\n  classifier: Classifier;\n}):\n  | LossFunction\n  | Array<LossFunction>\n  | { [outputName: string]: LossFunction } => {\n  return classifier.lossFunction;\n};\n","import { TextField } from \"@mui/material\";\nimport * as React from \"react\";\n\nconst intRegExpr = new RegExp(\"^[0-9]+$\");\nconst floatRegExpr = new RegExp(\"^[0-9]+(.[0-9]*)?$\");\n\ntype CustomNumberTextFieldProps = {\n  id: string;\n  label: string;\n  value: number;\n  dispatchCallBack: (arg: number) => void;\n  min?: number;\n  max?: number;\n  enableFloat?: boolean;\n  disabled?: boolean;\n};\n\n/**\n * @param {string} id\n * @param {string} label\n * @param {number} value\n * @param {(arg: number) => void} dispatchCallBack callback to dispatch the selected value to the store\n * @param {number} [min=Number.MIN_SAFE_INTEGER]\n * @param {number} [max=Number.MIN_SAFE_INTEGER]\n * @param {boolean} [enableFloat=false] allow floating point values\n * @param {boolean} [disabled=false] disable the input field\n * @returns\n */\nexport const CustomNumberTextField = ({\n  id,\n  label,\n  value,\n  dispatchCallBack,\n  min = Number.MIN_SAFE_INTEGER,\n  max = Number.MAX_SAFE_INTEGER,\n  enableFloat = false,\n  disabled = false,\n}: CustomNumberTextFieldProps) => {\n  const [valueString, setValueString] = React.useState<string>(\n    value.toString()\n  );\n\n  const regExp = enableFloat ? floatRegExpr : intRegExpr;\n\n  const onInputChange = (event: React.FormEvent<EventTarget>) => {\n    const target = event.target as HTMLInputElement;\n    const inputString = target.value;\n\n    if (!regExp.test(target.value)) {\n      return;\n    }\n\n    const arg = Number(inputString);\n\n    if (isNaN(arg) || arg < min || arg > max) {\n      return;\n    }\n\n    setValueString(inputString);\n    dispatchCallBack(arg);\n  };\n\n  return (\n    <TextField\n      id={id}\n      label={label}\n      sx={(theme) => ({\n        marginRight: theme.spacing(1),\n        flexBasis: 300,\n        marginTop: theme.spacing(2.75),\n        width: \"100%\",\n      })}\n      value={valueString}\n      onChange={onInputChange}\n      type=\"text\"\n      margin=\"normal\"\n      autoComplete=\"off\"\n      disabled={disabled}\n    />\n  );\n};\n","import {\n  FormHelperText,\n  Grid,\n  MenuItem,\n  Select,\n  SelectChangeEvent,\n} from \"@mui/material\";\nimport { StyledFormControl } from \"../../StyledFormControl\";\nimport * as React from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { classifierSlice } from \"../../../../store/slices\";\nimport { LossFunction } from \"../../../../types/LossFunction\";\nimport { fitOptionsSelector } from \"../../../../store/selectors\";\nimport { learningRateSelector } from \"../../../../store/selectors/learningRateSelector\";\nimport { OptimizationAlgorithm } from \"../../../../types/OptimizationAlgorithm\";\nimport { optimizationAlgorithmSelector } from \"../../../../store/selectors/optimizationAlgorithmSelector\";\nimport { lossFunctionSelector } from \"../../../../store/selectors/lossFunctionSelector\";\nimport { CustomNumberTextField } from \"../../../CustomNumberTextField/CustomNumberTextField\";\n\nconst enumKeys = <O extends object, K extends keyof O = keyof O>(\n  obj: O\n): K[] => {\n  return Object.keys(obj).filter((k) => Number.isNaN(+k)) as K[];\n};\n\nexport const OptimizerSettingsGrid = () => {\n  const dispatch = useDispatch();\n\n  const fitOptions = useSelector(fitOptionsSelector);\n  const optimizationAlgorithm = useSelector(optimizationAlgorithmSelector);\n  const lossFunction = useSelector(lossFunctionSelector);\n  const learningRate = useSelector(learningRateSelector);\n\n  const dispatchBatchSize = (batchSize: number) => {\n    dispatch(classifierSlice.actions.updateBatchSize({ batchSize: batchSize }));\n  };\n\n  const dispatchLearningRate = (learningRate: number) => {\n    dispatch(\n      classifierSlice.actions.updateLearningRate({ learningRate: learningRate })\n    );\n  };\n\n  const dispatchEpochs = (arg: number) => {\n    dispatch(classifierSlice.actions.updateEpochs({ epochs: arg }));\n  };\n\n  const onOptimizationAlgorithmChange = (event: SelectChangeEvent) => {\n    const target = event.target as HTMLInputElement; //target.value is string\n    const optimizationAlgorithm = target.value as OptimizationAlgorithm;\n\n    dispatch(\n      classifierSlice.actions.updateOptimizationAlgorithm({\n        optimizationAlgorithm: optimizationAlgorithm,\n      })\n    );\n  };\n\n  const onLossFunctionChange = (event: SelectChangeEvent) => {\n    const target = event.target as HTMLInputElement; //target.value is string\n    const lossFunction = target.value as LossFunction;\n\n    dispatch(\n      classifierSlice.actions.updateLossFunction({\n        lossFunction: lossFunction,\n      })\n    );\n  };\n\n  return (\n    <>\n      <StyledFormControl>\n        <Grid container spacing={2}>\n          <Grid item xs={4}>\n            <FormHelperText>Optimization Algorithm</FormHelperText>\n            <Select\n              value={optimizationAlgorithm as string}\n              onChange={onOptimizationAlgorithmChange}\n              displayEmpty\n              inputProps={{ \"aria-label\": \"Without label\" }}\n              sx={(theme) => ({\n                flexBasis: 300,\n                width: \"100%\",\n                marginRight: theme.spacing(1),\n                marginTop: theme.spacing(0),\n              })}\n            >\n              {enumKeys(OptimizationAlgorithm).map((k) => {\n                return (\n                  <MenuItem key={k} value={OptimizationAlgorithm[k]}>\n                    {OptimizationAlgorithm[k]}\n                  </MenuItem>\n                );\n              })}\n            </Select>\n          </Grid>\n        </Grid>\n        <Grid container spacing={2}>\n          <Grid item xs={4}>\n            <CustomNumberTextField\n              id=\"learning-rate\"\n              label=\"Learning rate\"\n              value={learningRate}\n              dispatchCallBack={dispatchLearningRate}\n              min={0}\n              enableFloat={true}\n            />\n          </Grid>\n        </Grid>\n      </StyledFormControl>\n      <StyledFormControl>\n        <Grid container spacing={2}>\n          <Grid item xs={4}>\n            <FormHelperText>Loss Function</FormHelperText>\n            <Select\n              value={lossFunction as string} //TODO #130 fix so that multiple lossFunctions are shown, if we do have multiple loss functions\n              onChange={onLossFunctionChange}\n              displayEmpty\n              inputProps={{ \"aria-label\": \"Without label\" }}\n              sx={(theme) => ({\n                flexBasis: 300,\n                width: \"100%\",\n                marginRight: theme.spacing(1),\n                marginTop: theme.spacing(0),\n              })}\n            >\n              {enumKeys(LossFunction).map((k) => {\n                return (\n                  <MenuItem key={k} value={LossFunction[k]}>\n                    {LossFunction[k]}\n                  </MenuItem>\n                );\n              })}\n            </Select>\n          </Grid>\n        </Grid>\n        <Grid container direction={\"row\"} spacing={2}>\n          <Grid item xs={2}>\n            <CustomNumberTextField\n              id=\"batch-size\"\n              label=\"Batch size\"\n              value={fitOptions.batchSize}\n              dispatchCallBack={dispatchBatchSize}\n              min={1}\n            />\n          </Grid>\n\n          <Grid item xs={2}>\n            <CustomNumberTextField\n              id=\"epochs\"\n              label=\"Epochs\"\n              value={fitOptions.epochs}\n              dispatchCallBack={dispatchEpochs}\n              min={1}\n            />\n          </Grid>\n        </Grid>\n      </StyledFormControl>\n    </>\n  );\n};\n","import * as React from \"react\";\nimport { useState } from \"react\";\nimport { OptimizerSettingsGrid } from \"./OptimizerSettingsGrid/OptimizerSettingsGrid\";\nimport { Collapse, ListItem, ListItemIcon, ListItemText } from \"@mui/material\";\nimport ExpandLessIcon from \"@mui/icons-material/ExpandLess\";\nimport ExpandMoreIcon from \"@mui/icons-material/ExpandMore\";\n\nexport const OptimizerSettingsListItem = () => {\n  const [collapsedClassifierSettingsList, setCollapsedClassifierSettingsList] =\n    useState<boolean>(false);\n\n  const onClasssifierSettingsListClick = () => {\n    setCollapsedClassifierSettingsList(!collapsedClassifierSettingsList);\n  };\n\n  return (\n    <>\n      <ListItem\n        button\n        onClick={onClasssifierSettingsListClick}\n        style={{ padding: \"12px 0px\" }}\n      >\n        <ListItemIcon>\n          {collapsedClassifierSettingsList ? (\n            <ExpandLessIcon />\n          ) : (\n            <ExpandMoreIcon />\n          )}\n        </ListItemIcon>\n\n        <ListItemText\n          primary=\"Optimization Settings\"\n          style={{ fontSize: \"20px\" }}\n        />\n      </ListItem>\n      <Collapse\n        in={collapsedClassifierSettingsList}\n        timeout=\"auto\"\n        unmountOnExit\n      >\n        <OptimizerSettingsGrid />\n      </Collapse>\n    </>\n  );\n};\n","import { useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { trainingPercentageSelector } from \"../../../store/selectors\";\nimport { classifierSlice } from \"../../../store/slices\";\nimport ExpandMoreIcon from \"@mui/icons-material/ExpandMore\";\nimport ExpandLessIcon from \"@mui/icons-material/ExpandLess\";\nimport {\n  Collapse,\n  Grid,\n  ListItem,\n  ListItemIcon,\n  ListItemText,\n  Typography,\n} from \"@mui/material\";\nimport { CustomNumberTextField } from \"../../CustomNumberTextField/CustomNumberTextField\";\n\nexport const DatasetSettingsListItem = () => {\n  const dispatch = useDispatch();\n\n  const [collapsedDatasetSettingsList, setCollapsedDatasetSettingsList] =\n    useState<boolean>(false);\n\n  const onDatasetSettingsListClick = () => {\n    setCollapsedDatasetSettingsList(!collapsedDatasetSettingsList);\n  };\n\n  const trainingPercentage = useSelector(trainingPercentageSelector);\n\n  const dispatchTrainingPercentage = (trainPercentage: number) => {\n    dispatch(\n      classifierSlice.actions.updateTrainingPercentage({\n        trainingPercentage: trainPercentage,\n      })\n    );\n  };\n\n  return (\n    <>\n      <ListItem\n        button\n        onClick={onDatasetSettingsListClick}\n        style={{ padding: \"12px 0px\" }}\n      >\n        <ListItemIcon>\n          {collapsedDatasetSettingsList ? (\n            <ExpandLessIcon />\n          ) : (\n            <ExpandMoreIcon />\n          )}\n        </ListItemIcon>\n\n        <ListItemText primary=\"Dataset Settings\" style={{ fontSize: \"1em\" }} />\n      </ListItem>\n      <Collapse in={collapsedDatasetSettingsList} timeout=\"auto\" unmountOnExit>\n        <div style={{ padding: \"12px 0px\", width: \"300\" }}>\n          <Typography id=\"range-slider\" gutterBottom>\n            What fraction of the labeled images should be used for training?\n            (The rest is used for validation)\n          </Typography>\n          <Grid item xs={2}>\n            <CustomNumberTextField\n              id=\"test-split\"\n              label=\"Train percentage\"\n              value={trainingPercentage}\n              dispatchCallBack={dispatchTrainingPercentage}\n              min={0}\n              max={1}\n              enableFloat={true}\n            />\n          </Grid>\n        </div>\n      </Collapse>\n    </>\n  );\n};\n","import { Classifier } from \"../../types/Classifier\";\nimport { ArchitectureOptions } from \"../../types/ArchitectureOptions\";\n\nexport const architectureOptionsSelector = ({\n  classifier,\n}: {\n  classifier: Classifier;\n}): ArchitectureOptions => {\n  return {\n    inputShape: classifier.inputShape,\n    selectedModel: classifier.selectedModel,\n  };\n};\n","import { Classifier } from \"../../types/Classifier\";\nimport { Shape } from \"../../types/Shape\";\n\nexport const inputShapeSelector = ({\n  classifier,\n}: {\n  classifier: Classifier;\n}): Shape => {\n  return classifier.inputShape;\n};\n","import { Classifier } from \"../../types/Classifier\";\nimport { ClassifierModelProps } from \"../../types/ClassifierModelType\";\n\nexport const uploadedModelSelector = ({\n  classifier,\n}: {\n  classifier: Classifier;\n}): ClassifierModelProps | undefined => {\n  return classifier.userUploadedModel;\n};\n","import { Grid, TextField, Alert } from \"@mui/material\";\nimport { StyledFormControl } from \"../../StyledFormControl\";\nimport Autocomplete from \"@mui/material/Autocomplete\";\nimport * as React from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { classifierSlice } from \"../../../../store/slices\";\nimport { architectureOptionsSelector } from \"../../../../store/selectors/architectureOptionsSelector\";\nimport { inputShapeSelector } from \"../../../../store/selectors/inputShapeSelector\";\nimport {\n  availableModels,\n  ClassifierModelProps,\n} from \"../../../../types/ClassifierModelType\";\nimport { SyntheticEvent } from \"react\";\nimport { uploadedModelSelector } from \"../../../../store/selectors/uploadedModelSelector\";\nimport { CustomNumberTextField } from \"../../../CustomNumberTextField/CustomNumberTextField\";\n\nexport const ArchitectureSettingsGrid = () => {\n  const architectureOptions = useSelector(architectureOptionsSelector);\n  const userUploadedModel = useSelector(uploadedModelSelector);\n  const inputShape = useSelector(inputShapeSelector);\n\n  const [selectedModel, setSelectedModel] =\n    React.useState<ClassifierModelProps>(architectureOptions.selectedModel);\n\n  const [fixedNumberOfChannels, setFixedNumberOfChannels] =\n    React.useState<boolean>(false);\n  const [fixedNumberOfChannelsHelperText, setFixedNumberOfChannelsHelperText] =\n    React.useState<string>(\"\");\n\n  const dispatch = useDispatch();\n\n  const modelOptions: ClassifierModelProps[] = availableModels.slice();\n\n  if (userUploadedModel) {\n    modelOptions.push(userUploadedModel);\n  }\n\n  React.useEffect(() => {\n    if (selectedModel.requiredChannels) {\n      setFixedNumberOfChannels(true);\n      setFixedNumberOfChannelsHelperText(\n        `${selectedModel.modelName} requires ${selectedModel.requiredChannels} channels!`\n      );\n    } else {\n      setFixedNumberOfChannels(false);\n      setFixedNumberOfChannelsHelperText(\"\");\n    }\n  }, [selectedModel]);\n\n  const onSelectedModelChange = (\n    event: SyntheticEvent<Element, Event>,\n    value: ClassifierModelProps | null\n  ) => {\n    const selectedModel = value as ClassifierModelProps;\n    setSelectedModel(selectedModel);\n\n    // if the selected model requires a specific number of input channels, dispatch that number to the store\n    if (selectedModel.requiredChannels) {\n      dispatch(\n        classifierSlice.actions.updateInputShape({\n          inputShape: {\n            ...inputShape,\n            channels: selectedModel.requiredChannels,\n          },\n        })\n      );\n    }\n\n    dispatch(\n      classifierSlice.actions.updateSelectedModel({ model: selectedModel })\n    );\n  };\n\n  const dispatchRows = (height: number) => {\n    dispatch(\n      classifierSlice.actions.updateInputShape({\n        inputShape: { ...inputShape, height: height },\n      })\n    );\n  };\n\n  const dispatchCols = (cols: number) => {\n    dispatch(\n      classifierSlice.actions.updateInputShape({\n        inputShape: { ...inputShape, width: cols },\n      })\n    );\n  };\n\n  const dispatchChannels = (channels: number) => {\n    dispatch(\n      classifierSlice.actions.updateInputShape({\n        inputShape: { ...inputShape, channels: channels },\n      })\n    );\n  };\n\n  return (\n    <StyledFormControl>\n      <Grid container spacing={2}>\n        <Grid item xs={2}>\n          <Autocomplete\n            disableClearable={true}\n            options={modelOptions}\n            onChange={onSelectedModelChange}\n            getOptionLabel={(option: ClassifierModelProps) => option.modelName}\n            sx={{ width: 300 }}\n            renderInput={(params) => (\n              <TextField\n                {...params}\n                autoComplete=\"off\"\n                label=\"Model architecture\"\n              />\n            )}\n            value={selectedModel}\n          />\n        </Grid>\n      </Grid>\n      <Grid container direction={\"row\"} spacing={2}>\n        <Grid item xs={1}>\n          <CustomNumberTextField\n            id=\"shape-rows\"\n            label=\"Input rows\"\n            value={inputShape.height}\n            dispatchCallBack={dispatchRows}\n            min={1}\n          />\n        </Grid>\n        <Grid item xs={1}>\n          <CustomNumberTextField\n            id=\"shape-cols\"\n            label=\"Input cols\"\n            value={inputShape.width}\n            dispatchCallBack={dispatchCols}\n            min={1}\n          />\n        </Grid>\n        <Grid item xs={1}>\n          <CustomNumberTextField\n            id=\"shape-channels\"\n            label=\"Input channels\"\n            value={inputShape.channels}\n            dispatchCallBack={dispatchChannels}\n            min={1}\n            disabled={fixedNumberOfChannels}\n          />\n        </Grid>\n      </Grid>\n\n      <Grid container spacing={1}>\n        <Grid item xs={3} marginTop={1}>\n          {fixedNumberOfChannels ? (\n            <Alert severity=\"info\">{fixedNumberOfChannelsHelperText}</Alert>\n          ) : (\n            <></>\n          )}\n        </Grid>\n      </Grid>\n    </StyledFormControl>\n  );\n};\n","import * as React from \"react\";\nimport { useState } from \"react\";\nimport { ArchitectureSettingsGrid } from \"./ArchitectureSettingsGrid/ArchitectureSettingsGrid\";\nimport {\n  Collapse,\n  ListItem,\n  ListItemIcon,\n  ListItemText,\n  styled,\n} from \"@mui/material\";\nimport ExpandLessIcon from \"@mui/icons-material/ExpandLess\";\nimport ExpandMoreIcon from \"@mui/icons-material/ExpandMore\";\n\nexport const ArchitectureSettingsListItem = () => {\n  const [collapsedClassifierSettingsList, setCollapsedClassifierSettingsList] =\n    useState<boolean>(false);\n\n  const onClasssifierSettingsListClick = () => {\n    setCollapsedClassifierSettingsList(!collapsedClassifierSettingsList);\n  };\n\n  const StyledForm = styled(\"form\")({\n    // width: '100%',\n    display: \"flex\",\n    flexWrap: \"wrap\",\n  });\n\n  return (\n    <>\n      <ListItem\n        button\n        onClick={onClasssifierSettingsListClick}\n        style={{ padding: \"12px 0px\" }}\n      >\n        <ListItemIcon>\n          {collapsedClassifierSettingsList ? (\n            <ExpandLessIcon />\n          ) : (\n            <ExpandMoreIcon />\n          )}\n        </ListItemIcon>\n\n        <ListItemText\n          primary=\"Architecture Settings\"\n          style={{ fontSize: \"20px\" }}\n        />\n      </ListItem>\n      <Collapse\n        in={collapsedClassifierSettingsList}\n        timeout=\"auto\"\n        unmountOnExit\n      >\n        <StyledForm noValidate autoComplete=\"off\">\n          <ArchitectureSettingsGrid />\n        </StyledForm>\n      </Collapse>\n    </>\n  );\n};\n","import { Classifier } from \"../../types/Classifier\";\nimport { RescaleOptions } from \"../../types/RescaleOptions\";\n\nexport const rescaleOptionsSelector = ({\n  classifier,\n}: {\n  classifier: Classifier;\n}): RescaleOptions => {\n  return classifier.rescaleOptions;\n};\n","import * as React from \"react\";\nimport {\n  Checkbox,\n  FormControlLabel,\n  Grid,\n  TextField,\n  styled,\n} from \"@mui/material\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { classifierSlice } from \"../../store/slices\";\nimport { rescaleOptionsSelector } from \"../../store/selectors/rescaleOptionsSelector\";\n\nexport const RescalingForm = () => {\n  const rescaleOptions = useSelector(rescaleOptionsSelector);\n  const dispatch = useDispatch();\n\n  const [disabled, setDisabled] = React.useState<boolean>(\n    !rescaleOptions.rescale\n  );\n\n  const onCheckboxChange = () => {\n    setDisabled(!disabled);\n    dispatch(\n      classifierSlice.actions.updateRescaleOptions({\n        rescaleOptions: { ...rescaleOptions, rescale: !rescaleOptions.rescale },\n      })\n    );\n  };\n\n  const onMaxChange = (event: React.FormEvent<EventTarget>) => {\n    const target = event.target as HTMLInputElement;\n    var value = Number(target.value);\n    if (!value) return;\n    dispatch(\n      classifierSlice.actions.updateRescaleOptions({\n        rescaleOptions: {\n          ...rescaleOptions,\n          rescaleMinMax: { ...rescaleOptions.rescaleMinMax, max: value },\n        },\n      })\n    );\n  };\n\n  const onMinChange = (event: React.FormEvent<EventTarget>) => {\n    const target = event.target as HTMLInputElement;\n    var value = Number(target.value);\n    if (!value) return;\n    dispatch(\n      classifierSlice.actions.updateRescaleOptions({\n        rescaleOptions: {\n          ...rescaleOptions,\n          rescaleMinMax: { ...rescaleOptions.rescaleMinMax, min: value },\n        },\n      })\n    );\n  };\n\n  const StyledForm = styled(\"form\")({\n    // width: '100%',\n    display: \"flex\",\n    flexWrap: \"wrap\",\n  });\n\n  const StyledTextField = styled(TextField)(({ theme }) => ({\n    // marginLeft: theme.spacing(1),\n    marginRight: theme.spacing(1),\n    flexBasis: 300,\n    width: \"100%\",\n  }));\n\n  return (\n    <StyledForm noValidate autoComplete=\"off\">\n      <Grid container spacing={2}>\n        <Grid item xs={2}>\n          <FormControlLabel\n            control={\n              <Checkbox\n                checked={rescaleOptions.rescale}\n                onChange={onCheckboxChange}\n                name=\"rescale\"\n                color=\"primary\"\n              />\n            }\n            label=\"Rescale pixels?\"\n          />\n        </Grid>\n        <Grid item xs={2}>\n          <StyledTextField\n            id=\"minimum\"\n            label=\"Minimum pixel value\"\n            disabled={disabled}\n            value={rescaleOptions.rescaleMinMax.min}\n            onChange={onMinChange}\n            type=\"number\"\n            margin=\"normal\"\n            defaultValue=\"0\"\n          />\n        </Grid>\n\n        <Grid item xs={2}>\n          <StyledTextField\n            id=\"maximum\"\n            label=\"Maximum pixel value\"\n            disabled={disabled}\n            value={rescaleOptions.rescaleMinMax.max}\n            onChange={onMaxChange}\n            margin=\"normal\"\n            type=\"number\"\n            defaultValue=\"100\"\n          />\n        </Grid>\n      </Grid>\n    </StyledForm>\n  );\n};\n","import * as React from \"react\";\nimport { useState } from \"react\";\nimport {\n  Button,\n  Checkbox,\n  Collapse,\n  FormControlLabel,\n  FormGroup,\n  ListItem,\n  ListItemIcon,\n  ListItemText,\n  Tooltip,\n  Typography,\n} from \"@mui/material\";\nimport ExpandLessIcon from \"@mui/icons-material/ExpandLess\";\nimport ExpandMoreIcon from \"@mui/icons-material/ExpandMore\";\nimport { RescalingForm } from \"../RescalingForm/RescalingForm\";\n\ntype PreprocessingSettingsListItemProps = {\n  closeDialog: () => void;\n  openedDialog: boolean;\n};\n\nexport const PreprocessingSettingsListItem = ({\n  closeDialog,\n  openedDialog,\n}: PreprocessingSettingsListItemProps) => {\n  const [collapsedPreprocessingList, setCollapsedPreprocessingList] =\n    useState<boolean>(false);\n\n  const onPreprocessingListClick = () => {\n    // shows or hides preprocessing list in interface\n    setCollapsedPreprocessingList(!collapsedPreprocessingList);\n  };\n\n  // // Preprocessing clicks\n  // const [paddingOption1, setPaddingOption1] = React.useState<boolean>(false);\n  // const onPaddingOption1Click = () => {\n  //   setPaddingOption1(!paddingOption1);\n  // };\n  //\n  // const [paddingOption2, setPaddingOption2] = React.useState<boolean>(false);\n  // const onpaddingOption2Click = () => {\n  //   setPaddingOption2(!paddingOption2);\n  // };\n\n  // Skeleton\n  // const onPreprocessingClick = async (\n  //   lowerPercentile: number,\n  //   upperPercentile: number,\n  //   labeledData: ImageType[]\n  // ) => {\n  //   //does actual preprocessing upon clicking button\n  //\n  //   const rescaledSet = await rescaleData(\n  //     lowerPercentile,\n  //     upperPercentile,\n  //     labeledData\n  //   );\n  //   const resizedSet = await resizeData(\n  //     paddingOption1,\n  //     paddingOption2,\n  //     labeledData\n  //   );\n  //   const augmentedSet = await augmentData(dataAugmentation, labeledData);\n  // };\n  //\n  // const [dataAugmentation, setDataAugmentation] =\n  //   React.useState<boolean>(false);\n  // const onDataAugmentationClick = () => {\n  //   setDataAugmentation(!dataAugmentation);\n  // };\n\n  return (\n    <>\n      <ListItem\n        disabled\n        button\n        onClick={onPreprocessingListClick}\n        style={{ padding: \"12px 0px\" }}\n      >\n        <ListItemIcon>\n          {collapsedPreprocessingList ? <ExpandLessIcon /> : <ExpandMoreIcon />}\n        </ListItemIcon>\n\n        <ListItemText primary=\"Preprocessing\" style={{ fontSize: \"1em\" }} />\n      </ListItem>\n      <Collapse in={collapsedPreprocessingList} timeout=\"auto\" unmountOnExit>\n        <Typography id=\"rescaling\" gutterBottom>\n          Pixel Intensity Rescaling\n        </Typography>\n\n        <RescalingForm />\n\n        <Typography id=\"augmentation\" gutterBottom>\n          Data Augmentation\n        </Typography>\n\n        <FormGroup row>\n          <FormControlLabel\n            control={\n              // @ts-ignore\n              <Checkbox value=\"randomDataAugmentation\" />\n            }\n            label=\"Random Data Augmentation\"\n          ></FormControlLabel>\n        </FormGroup>\n\n        <Typography id=\"resizing\" gutterBottom>\n          Resizing\n        </Typography>\n\n        <FormGroup row>\n          <FormControlLabel\n            // @ts-ignore\n            control={<Checkbox value=\"paddingOption1\" />}\n            label=\"Padding Option 1\"\n          ></FormControlLabel>\n        </FormGroup>\n\n        <FormGroup row>\n          <FormControlLabel\n            // @ts-ignore\n            control={<Checkbox value=\"paddingOption2\" />}\n            label=\"Padding Option 2\"\n          ></FormControlLabel>\n        </FormGroup>\n        <Tooltip title=\"Apply Preprocessing Settings\" placement=\"bottom\">\n          <div>\n            <Button variant=\"contained\" color=\"primary\" onClick={() => {}}>\n              Apply preprocessing\n            </Button>\n          </div>\n        </Tooltip>\n      </Collapse>\n    </>\n  );\n};\n","import * as React from \"react\";\nimport { TransitionProps } from \"@mui/material/transitions\";\nimport { Slide } from \"@mui/material\";\n\nexport const DialogTransition = React.forwardRef<unknown, TransitionProps>(\n  function Transition(props: any, ref: any) {\n    return <Slide direction=\"right\" ref={ref} {...props} />;\n  }\n);\n","import * as React from \"react\";\nimport { FitClassifierDialogAppBar } from \"../FitClassifierDialogAppBar\";\nimport { OptimizerSettingsListItem } from \"../OptimizerSettingsListItem/OptimizerSettingsListItem\";\nimport { DatasetSettingsListItem } from \"../DatasetSettingsListItem/DatasetSettingsListItem\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { classifierSlice, projectSlice } from \"../../../store/slices\";\nimport { Alert, Dialog, DialogContent, List } from \"@mui/material\";\nimport { ArchitectureSettingsListItem } from \"../ArchitectureSettingsListItem\";\nimport { PreprocessingSettingsListItem } from \"../../PreprocessingSettingsListItem/PreprocessingSettingsListItem\";\nimport { DialogTransition } from \"../../DialogTransition\";\nimport {\n  categorizedImagesSelector,\n  trainingPercentageSelector,\n} from \"../../../store/selectors\";\nimport { Image } from \"../../../types/Image\";\nimport * as _ from \"lodash\";\nimport { Partition } from \"../../../types/Partition\";\nimport { useEffect, useState } from \"react\";\n\ntype FitClassifierDialogProps = {\n  closeDialog: () => void;\n  openedDialog: boolean;\n  openedDrawer: boolean;\n};\n\nexport const FitClassifierDialog = (props: FitClassifierDialogProps) => {\n  const { closeDialog, openedDialog, openedDrawer } = props;\n\n  const [noCategorizedImagesAlert, setNoCategorizedImagesAlert] =\n    useState<boolean>(false);\n  const [showWarning, setShowWarning] = useState<boolean>(true);\n\n  const trainingPercentage = useSelector(trainingPercentageSelector);\n  const categorizedImages = useSelector(categorizedImagesSelector);\n\n  useEffect(() => {\n    setNoCategorizedImagesAlert(categorizedImages.length === 0);\n  }, [categorizedImages]);\n\n  const dispatch = useDispatch();\n\n  const onFit = async () => {\n    //first assign train and val partition to all categorized images\n    const categorizedImagesIds = _.shuffle(categorizedImages).map(\n      (image: Image) => {\n        return image.id;\n      }\n    );\n\n    //separate ids into train and val datasets\n    const trainDataLength = Math.round(\n      trainingPercentage * categorizedImagesIds.length\n    );\n    const valDataLength = categorizedImagesIds.length - trainDataLength;\n\n    const trainDataIds = _.take(categorizedImagesIds, trainDataLength);\n    const valDataIds = _.takeRight(categorizedImagesIds, valDataLength);\n\n    dispatch(\n      projectSlice.actions.updateImagesPartition({\n        ids: trainDataIds,\n        partition: Partition.Training,\n      })\n    );\n    dispatch(\n      projectSlice.actions.updateImagesPartition({\n        ids: valDataIds,\n        partition: Partition.Validation,\n      })\n    );\n\n    dispatch(\n      classifierSlice.actions.fit({\n        onEpochEnd: (epoch: number, logs: any) => {\n          console.info(logs);\n          console.info(epoch + \":\" + logs.loss);\n        },\n      })\n    );\n  };\n\n  // specifies interface\n  return (\n    // @ts-ignore\n    <Dialog\n      disableEscapeKeyDown\n      fullScreen\n      onClose={closeDialog}\n      open={openedDialog}\n      TransitionComponent={DialogTransition}\n      style={{ zIndex: 1203 }}\n    >\n      <FitClassifierDialogAppBar\n        closeDialog={closeDialog}\n        fit={onFit}\n        openedDrawer={openedDrawer}\n        disableFitting={noCategorizedImagesAlert}\n      />\n\n      {noCategorizedImagesAlert && showWarning ? (\n        <Alert\n          onClose={() => {\n            setShowWarning(false);\n          }}\n          severity=\"info\"\n        >\n          {\"Please label images to train a model.\"}\n        </Alert>\n      ) : (\n        <></>\n      )}\n\n      <DialogContent>\n        <List dense>\n          <PreprocessingSettingsListItem\n            closeDialog={closeDialog}\n            openedDialog={openedDialog}\n          />\n\n          <ArchitectureSettingsListItem />\n\n          <OptimizerSettingsListItem />\n\n          <DatasetSettingsListItem />\n        </List>\n        <div id={\"tfvis-container\"} />\n      </DialogContent>\n    </Dialog>\n  );\n};\n","import ListItem from \"@mui/material/ListItem\";\nimport ListItemIcon from \"@mui/material/ListItemIcon\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport ScatterPlotIcon from \"@mui/icons-material/ScatterPlot\";\nimport React from \"react\";\nimport { useDialog } from \"../../hooks\";\nimport { FitClassifierDialog } from \"../FitClassifierDialog/FitClassifierDialog\";\nimport { IconButton } from \"@mui/material\";\nimport SettingsIcon from \"@mui/icons-material/Settings\";\n\nexport const FitClassifierListItem = () => {\n  const { onClose, onOpen, open } = useDialog();\n\n  const onFitClick = () => {\n    onOpen();\n  };\n\n  return (\n    <>\n      <ListItem onClick={() => {}}>\n        <ListItemIcon>\n          <ScatterPlotIcon />\n        </ListItemIcon>\n\n        <ListItemText primary=\"Fit\" />\n        <IconButton edge=\"end\" onClick={onFitClick}>\n          <SettingsIcon />\n        </IconButton>\n      </ListItem>\n      <FitClassifierDialog\n        openedDialog={open}\n        openedDrawer={true}\n        closeDialog={onClose}\n      />\n    </>\n  );\n};\n","import React from \"react\";\nimport { ListItem, Tooltip } from \"@mui/material\";\n\ntype DisabledClassifierListItemProps = {\n  disabled: boolean;\n  helperText: string;\n  children?: React.ReactNode;\n};\n\nexport const DisabledClassifierListItem = ({\n  disabled,\n  helperText,\n  children,\n}: DisabledClassifierListItemProps) => {\n  return (\n    <Tooltip\n      // can't use \"sx\" prop directly to access tooltip\n      // see: https://github.com/mui-org/material-ui/issues/28679\n      componentsProps={{\n        tooltip: {\n          sx: { backgroundColor: \"#565656\", fontSize: \"0.85rem\" },\n        },\n        arrow: { sx: { color: \"#565656\" } },\n      }}\n      title={disabled ? helperText : \"\"}\n      placement=\"right\"\n      arrow\n    >\n      <ListItem disabled={disabled}>{children}</ListItem>\n    </Tooltip>\n  );\n};\n","import { IconButton, ListItemIcon, ListItemText } from \"@mui/material\";\nimport KeyboardArrowRightIcon from \"@mui/icons-material/KeyboardArrowRight\";\nimport AssessmentIcon from \"@mui/icons-material/Assessment\";\nimport { DisabledClassifierListItem } from \"./DisabledClassifierListItem\";\n\ntype EvaluateClassifierListItemProps = {\n  disabled: boolean;\n  helperText: string;\n};\n\nexport const EvaluateClassifierListItem = (\n  props: EvaluateClassifierListItemProps\n) => {\n  const onEvaluateClick = () => {\n    alert(\"Not yet implemented\");\n  };\n\n  return (\n    <DisabledClassifierListItem {...props}>\n      <ListItemIcon>\n        <AssessmentIcon />\n      </ListItemIcon>\n      <ListItemText primary=\"Evaluate\" />\n      <IconButton\n        onClick={onEvaluateClick}\n        edge=\"end\"\n        disabled={props.disabled}\n      >\n        <KeyboardArrowRightIcon />\n      </IconButton>\n    </DisabledClassifierListItem>\n  );\n};\n","import { ListItemIcon, ListItemText } from \"@mui/material\";\nimport LabelImportantIcon from \"@mui/icons-material/LabelImportant\";\nimport IconButton from \"@mui/material/IconButton\";\nimport KeyboardArrowRightIcon from \"@mui/icons-material/KeyboardArrowRight\";\nimport { useDispatch } from \"react-redux\";\nimport { classifierSlice } from \"../../store/slices\";\nimport { DisabledClassifierListItem } from \"./DisabledClassifierListItem\";\n\ntype PredictClassifierListItemProps = {\n  disabled: boolean;\n  helperText: string;\n};\n\nexport const PredictClassifierListItem = (\n  props: PredictClassifierListItemProps\n) => {\n  const dispatch = useDispatch();\n\n  const onPredict = async () => {\n    dispatch(classifierSlice.actions.predict({}));\n  };\n\n  return (\n    <DisabledClassifierListItem {...props}>\n      <ListItemIcon>\n        <LabelImportantIcon />\n      </ListItemIcon>\n      <ListItemText primary=\"Predict\" />\n      <IconButton onClick={onPredict} edge=\"end\" disabled={props.disabled}>\n        <KeyboardArrowRightIcon />\n      </IconButton>\n    </DisabledClassifierListItem>\n  );\n};\n","import React, { useEffect } from \"react\";\nimport {\n  FitClassifierListItem,\n  PredictClassifierListItem,\n  EvaluateClassifierListItem,\n} from \"../ClassifierListItems\";\nimport {\n  Collapse,\n  List,\n  ListItem,\n  ListItemIcon,\n  ListItemText,\n} from \"@mui/material\";\nimport ExpandLessIcon from \"@mui/icons-material/ExpandLess\";\nimport ExpandMoreIcon from \"@mui/icons-material/ExpandMore\";\nimport { useSelector } from \"react-redux\";\nimport { fittedSelector } from \"../../store/selectors/fittedSelector\";\nimport { trainingFlagSelector } from \"../../store/selectors/trainingFlagSelector\";\n\nexport const ClassifierList = () => {\n  const [collapsed, setCollapsed] = React.useState(false);\n\n  const [disabled, setDisabled] = React.useState<boolean>(true);\n  const [helperText, setHelperText] = React.useState<string>(\n    \"disabled: no trained model\"\n  );\n\n  const fitted = useSelector(fittedSelector);\n  const training = useSelector(trainingFlagSelector);\n\n  useEffect(() => {\n    if (training) {\n      setDisabled(true);\n      setHelperText(\"disabled during training.\");\n    } else {\n    }\n  }, [training]);\n\n  useEffect(() => {\n    if (fitted) {\n      setDisabled(false);\n    }\n  }, [fitted]);\n\n  const onCollapseClick = () => {\n    setCollapsed(!collapsed);\n  };\n\n  return (\n    <List dense>\n      <ListItem button dense onClick={onCollapseClick}>\n        <ListItemIcon>\n          {collapsed ? <ExpandLessIcon /> : <ExpandMoreIcon />}\n        </ListItemIcon>\n\n        <ListItemText primary=\"Classifier\" />\n      </ListItem>\n\n      <Collapse in={collapsed} timeout=\"auto\" unmountOnExit>\n        <List component=\"div\" dense disablePadding>\n          <FitClassifierListItem />\n\n          <PredictClassifierListItem\n            disabled={disabled}\n            helperText={helperText}\n          />\n\n          <EvaluateClassifierListItem\n            disabled={disabled}\n            helperText={helperText}\n          />\n        </List>\n      </Collapse>\n    </List>\n  );\n};\n","import { styled } from \"@mui/material\";\n\n/*\nThis styled component is mostly for addressing fixed placement of AppBar components\nsee: https://mui.com/components/app-bar/#fixed-placement\n*/\n\nexport const AppBarOffset = styled(\"div\")(({ theme }) => theme.mixins.toolbar);\n","import { Settings } from \"../../types/Settings\";\nimport { ThemeMode } from \"types/ThemeMode\";\n\nexport const themeModeSelector = ({\n  settings,\n}: {\n  settings: Settings;\n}): ThemeMode => {\n  return settings.themeMode;\n};\n","export default __webpack_public_path__ + \"static/media/Sun.81cb4cfc.svg\";","export default __webpack_public_path__ + \"static/media/Moon.593035e9.svg\";","import React from \"react\";\nimport Dialog from \"@mui/material/Dialog\";\nimport AppBar from \"@mui/material/AppBar\";\nimport Toolbar from \"@mui/material/Toolbar\";\nimport Typography from \"@mui/material/Typography\";\nimport IconButton from \"@mui/material/IconButton\";\nimport CloseIcon from \"@mui/icons-material/Close\";\nimport {\n  Container,\n  DialogContent,\n  FormControlLabel,\n  FormGroup,\n  Switch,\n} from \"@mui/material\";\nimport { styled } from \"@mui/material/styles\";\nimport { AppBarOffset } from \"components/styled/AppBarOffset\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { themeModeSelector } from \"store/selectors/themeModeSelector\";\nimport { setThemeMode } from \"store/slices\";\nimport { ThemeMode } from \"types/ThemeMode\";\nimport Sun from \"icons/Sun.svg\";\nimport Moon from \"icons/Moon.svg\";\n\ntype SettingsDialogProps = {\n  onClose: () => void;\n  open: boolean;\n};\n\nexport const SettingsDialog = ({ onClose, open }: SettingsDialogProps) => {\n  const dispatch = useDispatch();\n  const themeMode = useSelector(themeModeSelector);\n\n  const onToggle = (mode: ThemeMode) => {\n    dispatch(setThemeMode({ mode }));\n  };\n\n  return (\n    <Dialog fullScreen onClose={onClose} open={open}>\n      <AppBar\n        sx={{\n          borderBottom: \"1px solid rgba(0, 0, 0, 0.12)\",\n          boxShadow: \"none\",\n        }}\n        color=\"inherit\"\n        position=\"fixed\"\n      >\n        <Toolbar>\n          <Typography sx={{ flexGrow: 1 }} variant=\"h6\">\n            Settings\n          </Typography>\n\n          <IconButton onClick={onClose}>\n            <CloseIcon />\n          </IconButton>\n        </Toolbar>\n      </AppBar>\n\n      <AppBarOffset />\n\n      <DialogContent sx={{ marginTop: (theme) => theme.spacing(2) }}>\n        <Container maxWidth=\"md\">\n          <FormGroup>\n            <FormControlLabel\n              control={\n                <MaterialUISwitch\n                  checked={themeMode === ThemeMode.Dark}\n                  onChange={() =>\n                    onToggle(\n                      themeMode === ThemeMode.Dark\n                        ? ThemeMode.Light\n                        : ThemeMode.Dark\n                    )\n                  }\n                />\n              }\n              label={\n                <Typography variant=\"h6\">\n                  {themeMode === ThemeMode.Dark ? \"Dark Mode\" : \"Light Mode\"}\n                </Typography>\n              }\n            />\n          </FormGroup>\n        </Container>\n      </DialogContent>\n    </Dialog>\n  );\n};\n\n// source: https://mui.com/components/switches/\nconst MaterialUISwitch = styled(Switch)(({ theme }) => ({\n  width: 62,\n  height: 34,\n  padding: 7,\n  \"& .MuiSwitch-switchBase\": {\n    margin: 1,\n    padding: 0,\n    transform: \"translateX(6px)\",\n    \"&.Mui-checked\": {\n      color: \"#fff\",\n      transform: \"translateX(22px)\",\n      \"& .MuiSwitch-thumb:before\": {\n        backgroundImage: `url(${Moon})`,\n      },\n      \"& + .MuiSwitch-track\": {\n        opacity: 1,\n        backgroundColor: theme.palette.mode === \"dark\" ? \"#8796A5\" : \"#aab4be\",\n      },\n    },\n  },\n  \"& .MuiSwitch-thumb\": {\n    backgroundColor: theme.palette.mode === \"dark\" ? \"#003892\" : \"#001e3c\",\n    width: 32,\n    height: 32,\n    \"&:before\": {\n      content: \"''\",\n      position: \"absolute\",\n      width: \"100%\",\n      height: \"100%\",\n      left: 0,\n      top: 0,\n      backgroundRepeat: \"no-repeat\",\n      backgroundPosition: \"center\",\n      backgroundImage: `url(${Sun})`,\n    },\n  },\n  \"& .MuiSwitch-track\": {\n    opacity: 1,\n    backgroundColor: theme.palette.mode === \"dark\" ? \"#8796A5\" : \"#aab4be\",\n    borderRadius: 20 / 2,\n  },\n}));\n","import React from \"react\";\nimport { SettingsDialog } from \"../SettingsDialog\";\nimport { useDialog } from \"../../hooks\";\nimport { ListItem, ListItemIcon, ListItemText } from \"@mui/material\";\nimport SettingsIcon from \"@mui/icons-material/Settings\";\n\nexport const SettingsListItem = () => {\n  const { onClose, onOpen, open } = useDialog();\n\n  return (\n    <>\n      <ListItem button onClick={onOpen}>\n        <ListItemIcon>\n          <SettingsIcon />\n        </ListItemIcon>\n\n        <ListItemText primary=\"Settings\" />\n      </ListItem>\n\n      <SettingsDialog onClose={onClose} open={open} />\n    </>\n  );\n};\n","import { ListItem, ListItemIcon, ListItemText } from \"@mui/material\";\nimport React from \"react\";\nimport HelpIcon from \"@mui/icons-material/Help\";\n\nexport const HelpListItem = () => {\n  return (\n    <ListItem button disabled>\n      <ListItemIcon>\n        <HelpIcon />\n      </ListItemIcon>\n\n      <ListItemText primary=\"Help\" />\n    </ListItem>\n  );\n};\n","import React from \"react\";\nimport { ListItem, ListItemIcon, ListItemText } from \"@mui/material\";\nimport FeedbackIcon from \"@mui/icons-material/Feedback\";\n\nexport const SendFeedbackListItem = () => {\n  return (\n    <ListItem button disabled>\n      <ListItemIcon>\n        <FeedbackIcon />\n      </ListItemIcon>\n\n      <ListItemText primary=\"Send feedback\" />\n    </ListItem>\n  );\n};\n","import React from \"react\";\nimport { SettingsListItem } from \"../SettingsListItem\";\nimport { HelpListItem } from \"../HelpListItem\";\nimport { SendFeedbackListItem } from \"../SendFeedbackListItem\";\nimport { List } from \"@mui/material\";\n\nexport const ApplicationList = () => {\n  return (\n    <List dense>\n      <SettingsListItem />\n\n      <SendFeedbackListItem />\n\n      <HelpListItem />\n    </List>\n  );\n};\n","import { FileList } from \"../FileList\";\nimport { CategoriesList } from \"../CategoriesList\";\nimport { ClassifierList } from \"../ClassifierList\";\nimport { ApplicationList } from \"../ApplicationList\";\nimport React from \"react\";\nimport { Divider, Drawer } from \"@mui/material\";\nimport { AppBarOffset } from \"components/styled/AppBarOffset\";\n\nexport const ApplicationDrawer = () => {\n  return (\n    <Drawer\n      anchor=\"left\"\n      sx={{\n        flexShrink: 0,\n        width: (theme) => theme.spacing(32),\n        \"& > \t.MuiDrawer-paper\": {\n          zIndex: 0,\n          width: (theme) => theme.spacing(32),\n        },\n      }}\n      open\n      variant=\"persistent\"\n    >\n      <AppBarOffset />\n\n      <FileList />\n\n      <Divider />\n\n      <CategoriesList />\n\n      <Divider />\n\n      <ClassifierList />\n      {/*<SegmenterList />*/}\n\n      <Divider />\n\n      <ApplicationList />\n    </Drawer>\n  );\n};\n","import { Settings } from \"../../types/Settings\";\n\nexport const tileSizeSelector = ({\n  settings,\n}: {\n  settings: Settings;\n}): number => {\n  return settings.tileSize;\n};\n","import React from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Category } from \"../../types/Category\";\nimport { categoriesSelector } from \"../../store/selectors\";\nimport { applicationSlice, updateImageCategories } from \"../../store/slices\";\nimport { Menu, MenuItem, MenuList } from \"@mui/material\";\nimport LabelIcon from \"@mui/icons-material/Label\";\n\ntype ImageCategoryMenuProps = {\n  anchorEl: HTMLElement;\n  imageIds: Array<string>;\n  onClose: () => void;\n};\n\nexport const ImageCategoryMenu = ({\n  anchorEl,\n  imageIds,\n  onClose,\n}: ImageCategoryMenuProps) => {\n  const categories = useSelector(categoriesSelector);\n\n  const dispatch = useDispatch();\n\n  const onClick = (\n    event: React.MouseEvent<HTMLLIElement>,\n    categoryId: string\n  ) => {\n    onClose();\n\n    dispatch(updateImageCategories({ ids: imageIds, categoryId: categoryId }));\n    dispatch(applicationSlice.actions.clearSelectedImages());\n  };\n\n  return (\n    <Menu\n      anchorOrigin={{\n        horizontal: \"center\",\n        vertical: \"bottom\",\n      }}\n      transformOrigin={{\n        horizontal: \"center\",\n        vertical: \"top\",\n      }}\n      anchorEl={anchorEl}\n      open={Boolean(anchorEl)}\n      onClose={onClose}\n    >\n      <MenuList dense variant=\"menu\">\n        {categories.map((category: Category) => (\n          <MenuItem\n            key={category.id}\n            onClick={(event: any) => onClick(event, category.id)}\n          >\n            <LabelIcon style={{ color: category.color, paddingRight: \"8px\" }} />\n            {category.name}\n          </MenuItem>\n        ))}\n      </MenuList>\n    </Menu>\n  );\n};\n","import {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n} from \"@mui/material\";\nimport React from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { applicationSlice, projectSlice } from \"../../store/slices\";\n\ntype DeleteImagesDialogProps = {\n  imageIds: Array<string>;\n  onClose: () => void;\n  open: boolean;\n};\n\nexport const DeleteImagesDialog = ({\n  imageIds,\n  onClose,\n  open,\n}: DeleteImagesDialogProps) => {\n  const dispatch = useDispatch();\n\n  const onDelete = () => {\n    dispatch(projectSlice.actions.deleteImages({ ids: imageIds }));\n    dispatch(applicationSlice.actions.clearSelectedImages());\n    onClose();\n  };\n\n  return (\n    <Dialog fullWidth onClose={onClose} open={open}>\n      <DialogTitle>\n        Delete {imageIds.length} image{imageIds.length > 1 && \"s\"}?\n      </DialogTitle>\n\n      <DialogContent>Images will be deleted from the project.</DialogContent>\n\n      <DialogActions>\n        <Button onClick={onClose} color=\"primary\">\n          Cancel\n        </Button>\n\n        <Button onClick={onDelete} color=\"primary\">\n          Delete\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n","import React from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { batch, useDispatch, useSelector } from \"react-redux\";\nimport { ImageCategoryMenu } from \"../ImageCategoryMenu\";\nimport {\n  selectedImagesSelector,\n  visibleImagesSelector,\n} from \"../../store/selectors\";\nimport {\n  applicationSlice,\n  imageViewerSlice,\n  setActiveImage,\n  setSelectedAnnotations,\n} from \"../../store/slices\";\nimport { useDialog } from \"../../hooks\";\nimport { DeleteImagesDialog } from \"../DeleteImagesDialog\";\nimport DeleteIcon from \"@mui/icons-material/Delete\";\nimport {\n  AppBar,\n  Chip,\n  IconButton,\n  Slide,\n  Toolbar,\n  Tooltip,\n  Typography,\n  Box,\n} from \"@mui/material\";\nimport ViewComfyIcon from \"@mui/icons-material/ViewComfy\";\nimport GestureIcon from \"@mui/icons-material/Gesture\";\nimport LabelOutlinedIcon from \"@mui/icons-material/LabelOutlined\";\nimport ClearIcon from \"@mui/icons-material/Clear\";\nimport { Image } from \"../../types/Image\";\nimport { Partition } from \"../../types/Partition\";\n\nexport const ImageGridAppBar = () => {\n  const dispatch = useDispatch();\n\n  const navigate = useNavigate();\n\n  const images = useSelector(visibleImagesSelector);\n\n  const selectedImages: Array<string> = useSelector(selectedImagesSelector);\n\n  const [categoryMenuAnchorEl, setCategoryMenuAnchorEl] =\n    React.useState<null | HTMLElement>(null);\n\n  const { onClose, onOpen, open } = useDialog();\n\n  const onOpenCategoriesMenu = (event: React.MouseEvent<HTMLDivElement>) => {\n    setCategoryMenuAnchorEl(event.currentTarget);\n  };\n\n  const onCloseCategoryMenu = () => {\n    setCategoryMenuAnchorEl(null);\n  };\n\n  const onOpenAnnotatorDialog = (event: React.MouseEvent<HTMLDivElement>) => {\n    const selected = selectedImages.map((id: string, idx: number) => {\n      const projectImage = images.find((image: Image) => {\n        return image.id === id;\n      });\n\n      const annotatorImage: Image = {\n        categoryId: projectImage!.categoryId,\n        id: projectImage!.id,\n        annotations: projectImage!.annotations,\n        name: projectImage!.name,\n        partition: Partition.Inference,\n        shape: projectImage!.shape,\n        originalSrc: projectImage!.originalSrc,\n        src: projectImage!.src,\n      };\n\n      if (idx === 0) {\n        batch(() => {\n          dispatch(\n            setActiveImage({\n              image: annotatorImage.id,\n            })\n          );\n          dispatch(\n            setSelectedAnnotations({\n              selectedAnnotations: [],\n              selectedAnnotation: undefined,\n            })\n          );\n        });\n      }\n\n      return annotatorImage;\n    });\n\n    if (!selected) return;\n\n    dispatch(imageViewerSlice.actions.setImages({ images: selected }));\n    navigate(\"/annotator\");\n  };\n\n  const selectAllImages = () => {\n    const newSelected = images.map((image) => image.id);\n    dispatch(applicationSlice.actions.selectAllImages({ ids: newSelected }));\n  };\n\n  const selectNoImages = () => {\n    dispatch(applicationSlice.actions.clearSelectedImages());\n  };\n\n  return (\n    <>\n      <Slide appear={false} direction=\"down\" in={selectedImages.length > 0}>\n        <AppBar color=\"inherit\" position=\"fixed\">\n          <Toolbar>\n            <IconButton\n              sx={{ marginRight: (theme) => theme.spacing(2) }}\n              edge=\"start\"\n              color=\"inherit\"\n              onClick={selectNoImages}\n            >\n              <ClearIcon />\n            </IconButton>\n\n            <Typography sx={{ flexGrow: 1 }}>\n              {selectedImages.length} selected images\n            </Typography>\n\n            <Box sx={{ flexGrow: 1 }} />\n\n            <Chip\n              avatar={<LabelOutlinedIcon color=\"inherit\" />}\n              label=\"Categorise\"\n              onClick={onOpenCategoriesMenu}\n              variant=\"outlined\"\n              style={{ marginRight: 15 }}\n            />\n            <Chip\n              avatar={<GestureIcon color=\"inherit\" />}\n              label=\"Annotate\"\n              onClick={onOpenAnnotatorDialog}\n              variant=\"outlined\"\n            />\n\n            <IconButton color=\"inherit\" onClick={selectAllImages}>\n              <ViewComfyIcon />\n            </IconButton>\n\n            <Tooltip title=\"Delete\">\n              <IconButton color=\"inherit\" onClick={onOpen}>\n                <DeleteIcon />\n              </IconButton>\n            </Tooltip>\n          </Toolbar>\n        </AppBar>\n      </Slide>\n\n      <ImageCategoryMenu\n        anchorEl={categoryMenuAnchorEl as HTMLElement}\n        imageIds={selectedImages}\n        onClose={onCloseCategoryMenu}\n      />\n\n      <DeleteImagesDialog\n        imageIds={selectedImages}\n        onClose={onClose}\n        open={open}\n      />\n    </>\n  );\n};\n","import { Tooltip } from \"@mui/material\";\nimport LabelImportantIcon from \"@mui/icons-material/LabelImportant\";\nimport LabelIcon from \"@mui/icons-material/Label\";\nimport { useSelector } from \"react-redux\";\nimport { Category, UNKNOWN_CATEGORY_ID } from \"../../types/Category\";\nimport { Image } from \"../../types/Image\";\nimport { Partition } from \"../../types/Partition\";\nimport { categoriesSelector } from \"../../store/selectors/categoriesSelector\";\n\ntype ImageIconLabelProps = {\n  image: Image;\n};\n\nexport const ImageIconLabel = ({ image }: ImageIconLabelProps) => {\n  const categories = useSelector(categoriesSelector);\n\n  const { color: categoryColor, name: categoryName } = categories.find(\n    (category: Category) => {\n      return category.id === image.categoryId;\n    }\n  ) ?? { color: \"undefined\", name: \"undefined\" };\n\n  const actionIconStyle = {\n    color: categoryColor,\n    marginLeft: \"8px\",\n    marginTop: \"8px\",\n  };\n\n  const predictedLabel =\n    image.partition === Partition.Inference &&\n    image.categoryId !== UNKNOWN_CATEGORY_ID;\n\n  return (\n    <Tooltip\n      title={categoryName}\n      placement=\"right\"\n      arrow\n      // can't use \"sx\" prop directly to access tooltip\n      // see: https://github.com/mui-org/material-ui/issues/28679\n      componentsProps={{\n        tooltip: {\n          sx: {\n            borderRadius: 2,\n            backgroundColor: categoryColor,\n          },\n        },\n        arrow: {\n          sx: {\n            color: categoryColor,\n          },\n        },\n      }}\n    >\n      {predictedLabel ? (\n        <LabelImportantIcon sx={actionIconStyle} />\n      ) : (\n        <LabelIcon sx={actionIconStyle} />\n      )}\n    </Tooltip>\n  );\n};\n","import { useDispatch, useSelector } from \"react-redux\";\nimport { Image } from \"../../types/Image\";\nimport {\n  selectedImagesSelector,\n  visibleImagesSelector,\n} from \"../../store/selectors\";\nimport { tileSizeSelector } from \"../../store/selectors/tileSizeSelector\";\nimport { applicationSlice } from \"../../store/slices\";\nimport { ImageGridAppBar } from \"../ImageGridAppBar\";\nimport {\n  Container,\n  ImageList,\n  ImageListItem,\n  ImageListItemBar,\n  Box,\n} from \"@mui/material\";\nimport { DropTargetMonitor, useDrop } from \"react-dnd\";\nimport { NativeTypes } from \"react-dnd-html5-backend\";\nimport { ImageIconLabel } from \"./ImageIconLabel\";\n\ntype ImageGridProps = {\n  onDrop: (item: { files: any[] }) => void;\n};\n\nexport const ImageGrid = ({ onDrop }: ImageGridProps) => {\n  const dispatch = useDispatch();\n\n  const images = useSelector(visibleImagesSelector);\n\n  const selectedImages: Array<string> = useSelector(selectedImagesSelector);\n\n  const max_images = 1000; //number of images from the project that we'll show\n\n  const [{ isOver }, drop] = useDrop(\n    () => ({\n      accept: [NativeTypes.FILE],\n      drop(item: { files: any[] }) {\n        if (onDrop) {\n          onDrop(item);\n        }\n      },\n      collect: (monitor: DropTargetMonitor) => ({\n        isOver: monitor.isOver(),\n        canDrop: monitor.canDrop(),\n      }),\n    }),\n    []\n  );\n\n  const onSelectImage = (image: Image) => {\n    if (selectedImages.includes(image.id)) {\n      dispatch(applicationSlice.actions.deselectImage({ id: image.id }));\n    } else {\n      dispatch(applicationSlice.actions.selectImage({ id: image.id }));\n    }\n  };\n\n  const scaleFactor = useSelector(tileSizeSelector);\n\n  const getSize = (scaleFactor: number) => {\n    const width = (220 * scaleFactor).toString() + \"px\";\n    const height = (220 * scaleFactor).toString() + \"px\";\n\n    return {\n      width: width,\n      height: height,\n      margin: \"2px\",\n    };\n  };\n\n  const getSelectionStatus = (imageId: string) => {\n    return selectedImages.includes(imageId)\n      ? { border: \"solid 2px blue\", borderRadius: \"3px\" }\n      : { border: \"none\" };\n  };\n\n  return (\n    <Box\n      component=\"main\"\n      ref={drop}\n      sx={(theme) => ({\n        flexGrow: 1,\n        height: \"100%\",\n        paddingTop: theme.spacing(3),\n        marginLeft: theme.spacing(32),\n        transition: theme.transitions.create(\"margin\", {\n          duration: theme.transitions.duration.enteringScreen,\n          easing: theme.transitions.easing.easeOut,\n        }),\n      })}\n      style={{\n        border: isOver ? \"5px solid blue\" : \"\",\n      }}\n    >\n      <Container\n        sx={(theme) => ({\n          paddingBottom: theme.spacing(8),\n          paddingTop: theme.spacing(8),\n          height: \"100%\",\n        })}\n        maxWidth={false}\n      >\n        <ImageList\n          sx={{ transform: \"translateZ(0)\", height: \"100%\" }}\n          cols={Math.floor(6 / scaleFactor)}\n          rowHeight={\"auto\"}\n        >\n          {images.slice(0, max_images).map((image: Image) => (\n            <ImageListItem\n              key={image.id}\n              onClick={() => onSelectImage(image)}\n              style={getSize(scaleFactor)}\n              sx={getSelectionStatus(image.id)}\n            >\n              <Box\n                component=\"img\"\n                alt=\"\"\n                src={image.src}\n                sx={{\n                  width: \"100%\",\n                  height: \"100%\",\n                  objectFit: \"contain\",\n                  top: 0,\n                  transform: \"none\",\n                }}\n              />\n\n              <ImageListItemBar\n                position=\"top\"\n                actionIcon={<ImageIconLabel image={image} />}\n                actionPosition=\"left\"\n                sx={{\n                  background: \"transparent\",\n                }}\n              />\n            </ImageListItem>\n          ))}\n        </ImageList>\n\n        <ImageGridAppBar />\n      </Container>\n    </Box>\n  );\n};\n","import { styled } from \"@mui/material/styles\";\nimport MenuItem, { MenuItemProps } from \"@mui/material/MenuItem\";\n\ntype StyledMenuItemProps = MenuItemProps & { component: string };\n\nexport const StyledMenuItem = styled(MenuItem)<StyledMenuItemProps>(() => ({\n  maxWidth: 320,\n}));\n","import React from \"react\";\nimport useDropboxChooser from \"use-dropbox-chooser\";\nimport { ListItemIcon, ListItemText } from \"@mui/material\";\nimport ComputerIcon from \"@mui/icons-material/Computer\";\nimport { StyledMenuItem } from \"./StyledMenuItem\";\n\ntype DropboxMenuItemProps = {\n  onClose: (event: React.MouseEvent<HTMLElement, MouseEvent>) => void;\n};\n\nexport const DropboxMenuItem = ({ onClose }: DropboxMenuItemProps) => {\n  // const dispatch = useDispatch();\n\n  const { open } = useDropboxChooser({\n    appKey: \"tetle78x244mpkz\",\n    chooserOptions: { multiselect: true, linkType: \"direct\" },\n    onSelected: (items: readonly Dropbox.ChooserFile[]) => {\n      //onClose();\n\n      items.forEach((item: Dropbox.ChooserFile) => {\n        //dispatch(createImage({ src: item.link as string }));\n      });\n    },\n  });\n\n  return (\n    <StyledMenuItem component=\"span\" dense onClick={open}>\n      <ListItemIcon>\n        <ComputerIcon />\n      </ListItemIcon>\n      <ListItemText primary=\"Dropbox\" />\n    </StyledMenuItem>\n  );\n};\n","import React from \"react\";\nimport { Menu } from \"@mui/material\";\nimport Fade from \"@mui/material/Fade\";\nimport ListItemIcon from \"@mui/material/ListItemIcon\";\nimport ComputerIcon from \"@mui/icons-material/Computer\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport ListSubheader from \"@mui/material/ListSubheader\";\nimport { useDispatch } from \"react-redux\";\nimport { createImage } from \"../../store/slices\";\nimport { DropboxMenuItem } from \"./DropboxMenuItem\";\nimport { convertFileToImage } from \"../../image/imageHelper\";\nimport { StyledMenuItem } from \"./StyledMenuItem\";\n\ntype UploadMenuProps = {\n  anchorEl: HTMLElement | null;\n  onClose: (event: any) => void;\n  open: boolean;\n};\n\nexport const UploadMenu = ({ anchorEl, onClose }: UploadMenuProps) => {\n  const dispatch = useDispatch();\n\n  const onUploadFromComputerChange = async (\n    event: React.ChangeEvent<HTMLInputElement>\n  ) => {\n    onClose(event);\n    event.persist();\n\n    if (!event.currentTarget.files) return;\n\n    const files = event.currentTarget.files;\n\n    for (let i = 0; i < files.length; i++) {\n      const file = files[i];\n\n      const image = await convertFileToImage(file);\n\n      //if length of images is > 1, then the user selected a z-stack --> only show center image\n      dispatch(createImage({ image: image }));\n    }\n  };\n\n  return (\n    <>\n      <input\n        accept=\"image/*\"\n        hidden\n        type=\"file\"\n        multiple\n        id=\"upload-images\"\n        onChange={onUploadFromComputerChange}\n      />\n      <Menu\n        PaperProps={{ style: { width: 320 } }}\n        TransitionComponent={Fade}\n        anchorEl={anchorEl}\n        anchorOrigin={{ vertical: \"top\", horizontal: \"right\" }}\n        onClose={onClose}\n        open={Boolean(anchorEl)}\n        transformOrigin={{ vertical: \"top\", horizontal: \"center\" }}\n      >\n        <ListSubheader\n          sx={{\n            color: \"#80868b\",\n            margin: \"16px\",\n            letterSpacing: \".07272727em\",\n            fontSize: \".6875rem\",\n            fontWeight: 500,\n            lineHeight: \"1rem\",\n            textTransform: \"uppercase\",\n            maxWidth: 320,\n          }}\n        >\n          Upload from\n        </ListSubheader>\n\n        <label htmlFor=\"upload-images\">\n          <StyledMenuItem component=\"span\" dense onClick={onClose}>\n            <ListItemIcon>\n              <ComputerIcon />\n            </ListItemIcon>\n            <ListItemText primary=\"Computer\" />\n          </StyledMenuItem>\n        </label>\n\n        <DropboxMenuItem onClose={onClose} />\n      </Menu>\n    </>\n  );\n};\n","import React from \"react\";\nimport { useMenu } from \"../../hooks\";\nimport { UploadMenu } from \"../UploadMenu\";\nimport { Button, Tooltip } from \"@mui/material\";\nimport CloudUploadIcon from \"@mui/icons-material/CloudUpload\";\n\nexport const UploadButton = () => {\n  const { anchorEl, onClose, onOpen, open } = useMenu();\n\n  return (\n    <>\n      <Tooltip title=\"Open image\">\n        <Button\n          sx={{\n            margin: (theme) => theme.spacing(1),\n            textTransform: \"none\",\n          }}\n          onClick={onOpen}\n          startIcon={<CloudUploadIcon />}\n        >\n          Open image\n        </Button>\n      </Tooltip>\n\n      <UploadMenu anchorEl={anchorEl} onClose={onClose} open={open} />\n    </>\n  );\n};\n","import React from \"react\";\nimport { Typography } from \"@mui/material\";\n\nexport const Logo = () => {\n  return (\n    <Typography\n      sx={(theme) => ({\n        display: \"none\",\n        [theme.breakpoints.up(\"sm\")]: {\n          display: \"block\",\n        },\n      })}\n      color=\"inherit\"\n      noWrap\n      variant=\"h6\"\n    >\n      Piximi\n    </Typography>\n  );\n};\n","import React from \"react\";\nimport { UploadButton } from \"../UploadButton\";\nimport { Logo } from \"../Logo\";\nimport { applicationSlice } from \"../../store/slices\";\nimport { useDispatch } from \"react-redux\";\nimport { Slider, Toolbar, Box } from \"@mui/material\";\nimport ZoomOutIcon from \"@mui/icons-material/ZoomOut\";\nimport ZoomInIcon from \"@mui/icons-material/ZoomIn\";\n\nexport const ApplicationToolbar = () => {\n  const dispatch = useDispatch();\n  const [value, setValue] = React.useState<number>(1);\n  const onChange = (event: Event, newValue: number | number[]) => {\n    setValue(newValue as number);\n    dispatch(\n      applicationSlice.actions.updateTileSize({\n        newValue: newValue as number,\n      })\n    );\n  };\n  // const onChangeCommitted = (\n  //   event: React.ChangeEvent<{}>,\n  //   newValue: number | number[]\n  // ) => {\n  //   dispatch(\n  //     applicationSlice.actions.updateTileSize({\n  //       newValue: newValue as number,\n  //     })\n  //   );\n  // };\n  return (\n    <Toolbar>\n      <Logo />\n      {/*<TaskSelect />*/}\n      <Box sx={{ flexGrow: 1 }} />\n      <ZoomOutIcon\n        sx={(theme) => ({\n          marginLeft: theme.spacing(1),\n          marginRight: theme.spacing(1),\n        })}\n      />\n      <Slider\n        value={value}\n        min={0.6}\n        max={4}\n        step={0.1}\n        onChange={onChange}\n        sx={{ width: \"10%\" }}\n      />\n      <ZoomInIcon\n        sx={(theme) => ({\n          marginLeft: theme.spacing(1),\n          marginRight: theme.spacing(1),\n        })}\n      />\n      {/*<SearchInput />*/}\n      <UploadButton />\n    </Toolbar>\n  );\n};\n","import React from \"react\";\nimport { ApplicationToolbar } from \"../ApplicationToolbar\";\nimport { AppBar, Box } from \"@mui/material\";\n\nexport const ApplicationAppBar = () => {\n  return (\n    <Box>\n      <AppBar\n        sx={{\n          borderBottom: \"1px solid rgba(0, 0, 0, 0.12)\",\n          boxShadow: \"none\",\n        }}\n        color=\"inherit\"\n        position=\"fixed\"\n      >\n        <ApplicationToolbar />\n      </AppBar>\n    </Box>\n  );\n};\n","import React, { useCallback } from \"react\";\nimport { ApplicationDrawer } from \"../ApplicationDrawer\";\nimport { ImageGrid } from \"../ImageGrid\";\nimport { ApplicationAppBar } from \"../ApplicationAppBar\";\nimport { Box, CssBaseline } from \"@mui/material\";\nimport { createImage } from \"../../store/slices\";\nimport { useDispatch } from \"react-redux\";\nimport { convertFileToImage } from \"../../image/imageHelper\";\n\nexport const MainView = () => {\n  const dispatch = useDispatch();\n\n  const onUnload = (e: any) => {\n    if (process.env.NODE_ENV === \"development\") {\n      return;\n    } else {\n      e.preventDefault();\n      return (e.returnValue = \"Are you sure you want to exit?\");\n    }\n  };\n\n  React.useEffect(() => {\n    window.addEventListener(\"beforeunload\", onUnload);\n    return () => {\n      window.removeEventListener(\"beforeunload\", onUnload);\n    };\n  }, []);\n\n  const onDrop = useCallback(\n    async (item) => {\n      if (item) {\n        for (let i = 0; i < item.files.length; i++) {\n          const image = await convertFileToImage(item.files[i]);\n          dispatch(createImage({ image: image }));\n        }\n      }\n    },\n    [dispatch]\n  );\n\n  return (\n    <Box sx={{ height: \"100vh\" }}>\n      <CssBaseline />\n\n      <ApplicationAppBar />\n\n      <ApplicationDrawer />\n\n      <ImageGrid onDrop={onDrop} />\n    </Box>\n  );\n};\n","import React from \"react\";\nimport List from \"@mui/material/List\";\nimport ListItem from \"@mui/material/ListItem\";\nimport ListItemIcon from \"@mui/material/ListItemIcon\";\nimport ExpandLessIcon from \"@mui/icons-material/ExpandLess\";\nimport ExpandMoreIcon from \"@mui/icons-material/ExpandMore\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport Collapse from \"@mui/material/Collapse\";\n\ntype CollapsibleListProps = {\n  children: any;\n  dense: boolean;\n  primary: string;\n  closed?: boolean;\n};\n\nexport const CollapsibleList = ({\n  children,\n  dense,\n  closed,\n  primary,\n}: CollapsibleListProps) => {\n  const [collapsed, setCollapsed] = React.useState(closed);\n\n  const onClick = () => {\n    setCollapsed(!collapsed);\n  };\n\n  return (\n    <List dense={dense}>\n      <ListItem button onClick={onClick}>\n        <ListItemIcon>\n          {collapsed ? <ExpandLessIcon /> : <ExpandMoreIcon />}\n        </ListItemIcon>\n\n        <ListItemText primary={primary} />\n      </ListItem>\n\n      <Collapse in={collapsed} timeout=\"auto\" unmountOnExit>\n        <List component=\"div\" dense={dense} disablePadding>\n          {children}\n        </List>\n      </Collapse>\n    </List>\n  );\n};\n","import React from \"react\";\nimport ListItemIcon from \"@mui/material/ListItemIcon\";\nimport Checkbox from \"@mui/material/Checkbox\";\nimport LabelIcon from \"@mui/icons-material/Label\";\nimport LabelOutlinedIcon from \"@mui/icons-material/LabelOutlined\";\nimport { Category } from \"../../../../types/Category\";\nimport { useDispatch } from \"react-redux\";\nimport { imageViewerSlice } from \"../../../../store/slices\";\n\ntype CategoryListItemCheckboxProps = {\n  category: Category;\n};\n\nexport const CategoryListItemCheckbox = ({\n  category,\n}: CategoryListItemCheckboxProps) => {\n  const dispatch = useDispatch();\n\n  const onCheckboxClick = () => {\n    dispatch(\n      imageViewerSlice.actions.setCategoryVisibility({\n        category: category,\n        visible: !category.visible,\n      })\n    );\n  };\n\n  return (\n    <ListItemIcon>\n      <Checkbox\n        checked={category.visible}\n        checkedIcon={<LabelIcon style={{ color: category.color }} />}\n        disableRipple\n        edge=\"start\"\n        icon={<LabelOutlinedIcon style={{ color: category.color }} />}\n        onClick={onCheckboxClick}\n        tabIndex={-1}\n      />\n    </ListItemIcon>\n  );\n};\n","import React from \"react\";\nimport MenuItem from \"@mui/material/MenuItem\";\nimport Typography from \"@mui/material/Typography\";\nimport { Category } from \"../../../../../types/Category\";\nimport { useTranslation } from \"../../../../../hooks/useTranslation\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { selectedCategorySelector } from \"../../../../../store/selectors\";\nimport { imageViewerSlice } from \"../../../../../store/slices\";\n\ntype HideOrShowCategoryMenuItemProps = {\n  category: Category;\n  onCloseCategoryMenu: (\n    event: React.MouseEvent<HTMLLIElement, MouseEvent>\n  ) => void;\n};\n\nexport const HideOrShowCategoryMenuItem = ({\n  onCloseCategoryMenu,\n}: HideOrShowCategoryMenuItemProps) => {\n  const dispatch = useDispatch();\n\n  const category = useSelector(selectedCategorySelector);\n\n  const onClick = (event: React.MouseEvent<HTMLLIElement, MouseEvent>) => {\n    dispatch(\n      imageViewerSlice.actions.setCategoryVisibility({\n        category: category,\n        visible: !category.visible,\n      })\n    );\n\n    onCloseCategoryMenu(event);\n  };\n\n  const t = useTranslation();\n\n  const translatedHide = t(\"Hide category\");\n  const translatedShow = t(\"Show category\");\n\n  return (\n    <MenuItem onClick={onClick}>\n      <Typography variant=\"inherit\">\n        {category.visible ? translatedHide : translatedShow}\n      </Typography>\n    </MenuItem>\n  );\n};\n","import React from \"react\";\nimport MenuItem from \"@mui/material/MenuItem\";\nimport Typography from \"@mui/material/Typography\";\nimport { useTranslation } from \"../../../../../hooks/useTranslation\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport {\n  categoriesSelector,\n  selectedCategorySelector,\n} from \"../../../../../store/selectors\";\nimport { imageViewerSlice } from \"../../../../../store/slices\";\n\ntype HideOtherCategoriesMenuItemProps = {\n  onCloseCategoryMenu: (\n    event: React.MouseEvent<HTMLElement, MouseEvent>\n  ) => void;\n};\n\nexport const HideOtherCategoriesMenuItem = ({\n  onCloseCategoryMenu,\n}: HideOtherCategoriesMenuItemProps) => {\n  const categories = useSelector(categoriesSelector);\n\n  const category = useSelector(selectedCategorySelector);\n\n  const dispatch = useDispatch();\n\n  const onClick = (event: React.MouseEvent<HTMLElement, MouseEvent>) => {\n    for (let cat of categories) {\n      if (category.id !== cat.id) {\n        dispatch(\n          imageViewerSlice.actions.setCategoryVisibility({\n            category: cat,\n            visible: false,\n          })\n        );\n      }\n    }\n    onCloseCategoryMenu(event);\n  };\n\n  const t = useTranslation();\n\n  return (\n    <MenuItem onClick={onClick}>\n      <Typography variant=\"inherit\">{t(\"Hide other categories\")}</Typography>\n    </MenuItem>\n  );\n};\n","import React from \"react\";\nimport Menu from \"@mui/material/Menu\";\nimport MenuList from \"@mui/material/MenuList\";\nimport Divider from \"@mui/material/Divider\";\nimport { HideOrShowCategoryMenuItem } from \"../HideOrShowCategoryMenuItem\";\nimport { HideOtherCategoriesMenuItem } from \"../HideOtherCategoriesMenuItem\";\nimport MenuItem from \"@mui/material/MenuItem\";\nimport Typography from \"@mui/material/Typography\";\nimport { useTranslation } from \"../../../../../hooks/useTranslation\";\nimport { batch, useDispatch, useSelector } from \"react-redux\";\nimport { imagesSelector } from \"../../../../../store/selectors/imagesSelector\";\nimport { selectedCategorySelector } from \"../../../../../store/selectors\";\nimport { imageViewerSlice } from \"../../../../../store/slices\";\nimport { UNKNOWN_CATEGORY_ID } from \"../../../../../types/Category\";\n\ntype CategoryMenuProps = {\n  anchorElCategoryMenu: any;\n  onCloseCategoryMenu: (\n    event: React.MouseEvent<HTMLElement, MouseEvent>\n  ) => void;\n  onOpenCategoryMenu: (event: React.MouseEvent<HTMLButtonElement>) => void;\n  openCategoryMenu: boolean;\n  onOpenDeleteCategoryDialog: () => void;\n  onOpenEditCategoryDialog: () => void;\n  onOpenClearCategoryDialog: () => void;\n};\n\nexport const CategoryMenu = ({\n  anchorElCategoryMenu,\n  onCloseCategoryMenu,\n  openCategoryMenu,\n  onOpenDeleteCategoryDialog,\n  onOpenEditCategoryDialog,\n  onOpenClearCategoryDialog,\n}: CategoryMenuProps) => {\n  const images = useSelector(imagesSelector);\n\n  const dispatch = useDispatch();\n\n  const category = useSelector(selectedCategorySelector);\n\n  const onOpenDeleteCategoryDialogClick = (\n    event: React.MouseEvent<HTMLElement, MouseEvent>\n  ) => {\n    //cycle through the annotations to determine if annotations of that category exist\n    // show a warning dialog box is they do exist\n    let existAnnotations = false;\n    for (let i = 0; i < images.length; i++) {\n      if (!existAnnotations) {\n        for (let j = 0; j < images[i].annotations.length; j++) {\n          if (images[i].annotations[j].categoryId === category.id) {\n            existAnnotations = true;\n          }\n        }\n      }\n    }\n    if (existAnnotations) {\n      onOpenDeleteCategoryDialog();\n    } //warn user that these annotations will be relabeled as unknown\n    else {\n      batch(() => {\n        dispatch(\n          imageViewerSlice.actions.setSelectedCategoryId({\n            selectedCategoryId: UNKNOWN_CATEGORY_ID,\n          })\n        );\n\n        dispatch(\n          imageViewerSlice.actions.deleteCategory({ category: category })\n        );\n      });\n    }\n    onCloseCategoryMenu(event);\n  };\n\n  const onOpenEditCategoryDialogClick = (\n    event: React.MouseEvent<HTMLElement, MouseEvent>\n  ) => {\n    onOpenEditCategoryDialog();\n    onCloseCategoryMenu(event);\n  };\n\n  const onOpenClearCategoryDialogClick = (\n    event: React.MouseEvent<HTMLElement, MouseEvent>\n  ) => {\n    onOpenClearCategoryDialog();\n    onCloseCategoryMenu(event);\n  };\n\n  const t = useTranslation();\n\n  return (\n    <Menu\n      anchorEl={anchorElCategoryMenu}\n      anchorOrigin={{ horizontal: \"center\", vertical: \"bottom\" }}\n      onClose={onCloseCategoryMenu}\n      open={openCategoryMenu}\n      transformOrigin={{ horizontal: \"center\", vertical: \"top\" }}\n    >\n      <MenuList dense variant=\"menu\">\n        <HideOtherCategoriesMenuItem\n          onCloseCategoryMenu={onCloseCategoryMenu}\n        />\n\n        <HideOrShowCategoryMenuItem\n          category={category}\n          onCloseCategoryMenu={onCloseCategoryMenu}\n        />\n\n        <div>\n          <Divider />\n\n          <MenuItem onClick={onOpenEditCategoryDialogClick}>\n            <Typography variant=\"inherit\">{t(\"Edit category\")}</Typography>\n          </MenuItem>\n        </div>\n        <MenuItem onClick={onOpenClearCategoryDialogClick}>\n          <Typography variant=\"inherit\">{t(\"Clear Annotations\")}</Typography>\n        </MenuItem>\n\n        {category.id !== UNKNOWN_CATEGORY_ID && (\n          <MenuItem onClick={onOpenDeleteCategoryDialogClick}>\n            <Typography variant=\"inherit\">{t(\"Delete category\")}</Typography>\n          </MenuItem>\n        )}\n      </MenuList>\n    </Menu>\n  );\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\n\nexport const activeImageIdSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}): string | undefined => {\n  return imageViewer.activeImageId;\n};\n","import React from \"react\";\nimport Dialog from \"@mui/material/Dialog\";\nimport DialogTitle from \"@mui/material/DialogTitle\";\nimport DialogContent from \"@mui/material/DialogContent\";\nimport DialogActions from \"@mui/material/DialogActions\";\nimport Button from \"@mui/material/Button\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { AnnotationType } from \"../../../../types/AnnotationType\";\nimport { imageViewerSlice } from \"../../../../store/slices\";\nimport {\n  imageInstancesSelector,\n  selectedCategorySelector,\n  unknownCategorySelector,\n} from \"../../../../store/selectors\";\nimport { activeImageIdSelector } from \"../../../../store/selectors/activeImageIdSelector\";\nimport { UNKNOWN_CATEGORY_ID } from \"../../../../types/Category\";\n\ntype DeleteCategoryDialogProps = {\n  onClose: () => void;\n  open: boolean;\n};\n\nexport const DeleteCategoryDialog = ({\n  onClose,\n  open,\n}: DeleteCategoryDialogProps) => {\n  const dispatch = useDispatch();\n\n  const category = useSelector(selectedCategorySelector);\n\n  const selections = useSelector(imageInstancesSelector);\n\n  const unknownCategory = useSelector(unknownCategorySelector);\n\n  const activeImageId = useSelector(activeImageIdSelector);\n\n  const onDelete = () => {\n    dispatch(\n      imageViewerSlice.actions.setSelectedCategoryId({\n        selectedCategoryId: UNKNOWN_CATEGORY_ID,\n      })\n    );\n\n    const instances = selections?.map((instance: AnnotationType) => {\n      if (instance.categoryId === category.id) {\n        return {\n          ...instance,\n          categoryId: UNKNOWN_CATEGORY_ID,\n        };\n      } else {\n        return instance;\n      }\n    });\n\n    if (!activeImageId) return;\n\n    dispatch(\n      imageViewerSlice.actions.setImageInstances({\n        instances: instances as Array<AnnotationType>,\n        imageId: activeImageId,\n      })\n    );\n\n    dispatch(imageViewerSlice.actions.deleteCategory({ category: category }));\n\n    onClose();\n  };\n\n  return (\n    <Dialog fullWidth onClose={onClose} open={open}>\n      <DialogTitle>Delete \"{category.name}\" category?</DialogTitle>\n\n      <DialogContent>\n        Annotations categorized as \"{category.name}\" will not be deleted and\n        instead will be labeled as \"{unknownCategory.name}\".\n      </DialogContent>\n\n      <DialogActions>\n        <Button onClick={onClose} color=\"primary\">\n          Cancel\n        </Button>\n\n        <Button onClick={onDelete} color=\"primary\">\n          Delete\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nexport const annotatorCategoriesSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}) => {\n  return imageViewer.categories;\n};\n","import { Label } from \"@mui/icons-material\";\nimport * as React from \"react\";\nimport { Avatar, IconButton, Box } from \"@mui/material\";\nimport Popover from \"@mui/material/Popover\";\nimport { CirclePicker, ColorResult } from \"react-color\";\n\nexport const COLORS = [\n  \"#000000\",\n  \"#004949\",\n  \"#009292\",\n  \"#ff6db6\",\n  \"#ffb6db\",\n  \"#490092\",\n  \"#006ddb\",\n  \"#b66dff\",\n  \"#6db6ff\",\n  \"#b6dbff\",\n  \"#920000\",\n  \"#924900\",\n  \"#db6d00\",\n  \"#24ff24\",\n  \"#ffff6d\",\n];\n\ntype ColorIconButtonProps = {\n  color: string;\n  onColorChange: (color: any) => void;\n};\n\nexport const ColorIcon = ({ color, onColorChange }: ColorIconButtonProps) => {\n  const [colorMenuAnchorEl, setColorMenuAnchorEl] =\n    React.useState<null | HTMLButtonElement>(null);\n\n  const colorPopupOpen = Boolean(colorMenuAnchorEl);\n\n  const onOpenColorPicker = (event: React.MouseEvent<HTMLButtonElement>) => {\n    setColorMenuAnchorEl(event.currentTarget);\n  };\n\n  const onCloseColorPicker = () => {\n    setColorMenuAnchorEl(null);\n  };\n\n  const onChange = (color: ColorResult) => {\n    onColorChange(color);\n    onCloseColorPicker();\n  };\n\n  return (\n    <>\n      <IconButton onClick={onOpenColorPicker}>\n        <Avatar sx={{ backgroundColor: \"#F3F3F3\" }}>\n          <Label sx={{ color: color }} />\n        </Avatar>\n      </IconButton>\n      <Popover\n        id=\"color-menu\"\n        open={colorPopupOpen}\n        anchorEl={colorMenuAnchorEl}\n        onClose={onCloseColorPicker}\n        anchorOrigin={{\n          vertical: \"bottom\",\n          horizontal: \"center\",\n        }}\n        transformOrigin={{\n          vertical: \"top\",\n          horizontal: \"center\",\n        }}\n      >\n        <Box sx={{ margin: \"16px\" }}>\n          <CirclePicker colors={COLORS} onChange={onChange} />\n        </Box>\n      </Popover>\n    </>\n  );\n};\n","import React, { ChangeEvent } from \"react\";\nimport {\n  Box,\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  Grid,\n  TextField,\n} from \"@mui/material\";\nimport { ColorIcon } from \"../../CategoriesList/ColorIcon\";\nimport { useTranslation } from \"hooks/useTranslation\";\n\ntype CategoryDialogProps = {\n  onCloseDialog: () => void;\n  openDialog: boolean;\n  onSubmit?: (event: React.FormEvent<HTMLFormElement>) => void;\n  title: string;\n  color: string;\n  setColor: React.Dispatch<React.SetStateAction<string>>;\n  name: string;\n  setName: React.Dispatch<React.SetStateAction<string>>;\n  action: string;\n  onConfirm: () => void;\n};\n\nexport const CategoryDialog = ({\n  onCloseDialog,\n  openDialog,\n  onSubmit,\n  title,\n  color,\n  setColor,\n  name,\n  setName,\n  action,\n  onConfirm,\n}: CategoryDialogProps) => {\n  const onColorChange = (color: any) => {\n    setColor(color.hex);\n  };\n\n  const onNameChange = (event: ChangeEvent<HTMLInputElement>) => {\n    setName(event.target.value);\n  };\n\n  const t = useTranslation();\n\n  const DialogConfirm = () => {\n    return onSubmit ? (\n      <Button onClick={onConfirm} color=\"primary\" type=\"submit\">\n        {t(action)}\n      </Button>\n    ) : (\n      <Button onClick={onConfirm} color=\"primary\">\n        {t(action)}\n      </Button>\n    );\n  };\n\n  const DialogBody = () => {\n    return (\n      <>\n        <DialogTitle>{t(title)}</DialogTitle>\n\n        <DialogContent sx={{ paddingLeft: \"0 !important\" }}>\n          <Box sx={{ margin: (theme) => theme.spacing(1) }}>\n            <Grid container spacing={1}>\n              <Grid item xs={2}>\n                <ColorIcon color={color} onColorChange={onColorChange} />\n              </Grid>\n              <Grid item xs={10}>\n                <TextField\n                  autoFocus\n                  fullWidth\n                  id=\"name\"\n                  label={t(\"Name\")}\n                  margin=\"dense\"\n                  onChange={onNameChange}\n                  value={name}\n                />\n              </Grid>\n            </Grid>\n          </Box>\n        </DialogContent>\n\n        <DialogActions>\n          <Button onClick={onCloseDialog} color=\"primary\">\n            {t(\"Cancel\")}\n          </Button>\n\n          <DialogConfirm />\n        </DialogActions>\n      </>\n    );\n  };\n\n  const DialogOuter = () => {\n    return onSubmit ? (\n      <form onSubmit={(event) => onSubmit(event)}>\n        <DialogBody />\n      </form>\n    ) : (\n      <DialogBody />\n    );\n  };\n\n  return (\n    <Dialog fullWidth onClose={onCloseDialog} open={openDialog}>\n      <DialogOuter />\n    </Dialog>\n  );\n};\n","import React, { useEffect, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Category } from \"../../../../types/Category\";\nimport { imageViewerSlice } from \"../../../../store/slices\";\nimport { selectedCategorySelector } from \"../../../../store/selectors\";\nimport { annotatorCategoriesSelector } from \"../../../../store/selectors/annotatorCategoriesSelector\";\nimport { CategoryDialog } from \"../CategoryDialog\";\n\ntype EditCategoryDialogProps = {\n  onCloseDialog: () => void;\n  openDialog: boolean;\n};\n\nexport const EditCategoryDialog = ({\n  onCloseDialog,\n  openDialog,\n}: EditCategoryDialogProps) => {\n  const dispatch = useDispatch();\n\n  const category = useSelector(selectedCategorySelector);\n\n  const [color, setColor] = useState<string>(category.color);\n\n  useEffect(() => {\n    setName(category.name);\n    setColor(category.color);\n  }, [category]);\n\n  const [name, setName] = useState<string>(category.name);\n\n  const categories = useSelector(annotatorCategoriesSelector);\n\n  const onEdit = () => {\n    const updatedCategories = categories?.map((v: Category) => {\n      if (v.id === category.id) {\n        return {\n          ...category,\n          color: color,\n          name: name,\n        };\n      } else {\n        return v;\n      }\n    });\n    dispatch(\n      imageViewerSlice.actions.setCategories({ categories: updatedCategories })\n    );\n\n    onCloseDialog();\n  };\n\n  return (\n    <CategoryDialog\n      onCloseDialog={onCloseDialog}\n      openDialog={openDialog}\n      title={\"Edit category\"}\n      color={color}\n      setColor={setColor}\n      name={name}\n      setName={setName}\n      action={\"Update\"}\n      onConfirm={onEdit}\n    />\n  );\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nexport const soundEnabledSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}) => {\n  return imageViewer.soundEnabled;\n};\n","import React from \"react\";\nimport {\n  AppBar,\n  Dialog,\n  FormControlLabel,\n  Select,\n  SelectChangeEvent,\n  FormHelperText,\n} from \"@mui/material\";\nimport DialogContent from \"@mui/material/DialogContent\";\nimport FormControl from \"@mui/material/FormControl\";\nimport MenuItem from \"@mui/material/MenuItem\";\nimport Typography from \"@mui/material/Typography\";\nimport FormGroup from \"@mui/material/FormGroup\";\nimport Switch from \"@mui/material/Switch\";\nimport Grid from \"@mui/material/Grid\";\nimport Divider from \"@mui/material/Divider\";\nimport { LanguageType } from \"../../../types/LanguageType\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { imageViewerSlice } from \"../../../store/slices\";\nimport { languageSelector } from \"../../../store/selectors/languageSelector\";\nimport { soundEnabledSelector } from \"../../../store/selectors/soundEnabledSelector\";\nimport Toolbar from \"@mui/material/Toolbar\";\nimport CloseIcon from \"@mui/icons-material/Close\";\nimport IconButton from \"@mui/material/IconButton\";\nimport _ from \"lodash\";\nimport { AppBarOffset } from \"components/styled/AppBarOffset\";\n\ntype SettingsDialogProps = {\n  onClose: () => void;\n  open: boolean;\n};\n\n// TODO: #133 Move (language) settings from Annotator to Classifier view\nexport const SettingsDialog = ({ onClose, open }: SettingsDialogProps) => {\n  const dispatch = useDispatch();\n\n  const language = useSelector(languageSelector);\n  const soundEnabled = useSelector(soundEnabledSelector);\n\n  const onLanguageChange = (event: SelectChangeEvent) => {\n    dispatch(\n      imageViewerSlice.actions.setLanguage({\n        language: event.target.value as LanguageType,\n      })\n    );\n  };\n\n  const onSoundEffectsChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    dispatch(\n      imageViewerSlice.actions.setSoundEnabled({\n        soundEnabled: event.target.checked,\n      })\n    );\n  };\n\n  // @ts-ignore\n  // @ts-ignore\n  return (\n    <Dialog fullScreen onClose={onClose} open={open}>\n      <AppBar\n        sx={{\n          flexGrow: 1,\n          borderBottom: \"1px solid rgba(0, 0, 0, 0.12)\",\n          boxShadow: \"none\",\n        }}\n        color=\"inherit\"\n        position=\"fixed\"\n      >\n        <Toolbar>\n          <Typography sx={{ flexGrow: 1 }} variant=\"h6\">\n            Settings\n          </Typography>\n\n          <IconButton aria-label=\"close\" onClick={onClose}>\n            <CloseIcon />\n          </IconButton>\n        </Toolbar>\n      </AppBar>\n\n      <AppBarOffset />\n\n      <DialogContent sx={{ marginTop: (theme) => theme.spacing(2) }}>\n        <Grid container spacing={2}>\n          <Grid item xs={3} />\n\n          <Grid item xs={6}>\n            <Grid container>\n              <Grid item xs={12}>\n                <Grid container item xs={4}>\n                  <FormControl color=\"primary\" fullWidth>\n                    <FormHelperText>Language</FormHelperText>\n                    <Select\n                      onChange={onLanguageChange}\n                      value={language}\n                      inputProps={{ \"aria-label\": \"Without label\" }}\n                    >\n                      {_.map(LanguageType, (v, k) => {\n                        return (\n                          <MenuItem dense key={k} value={v}>\n                            {v}\n                          </MenuItem>\n                        );\n                      })}\n                    </Select>\n                  </FormControl>\n                </Grid>\n              </Grid>\n\n              <Grid item style={{ padding: \"32px 0\" }} xs={12}>\n                <Divider />\n              </Grid>\n\n              <Grid item xs={12}>\n                <FormControl component=\"fieldset\">\n                  <FormGroup aria-label=\"position\" row>\n                    <FormControlLabel\n                      control={\n                        <Switch\n                          color=\"default\"\n                          checked={soundEnabled}\n                          onChange={onSoundEffectsChange}\n                          name=\"soundEnabled\"\n                        />\n                      }\n                      label=\"Sound effects\"\n                    />\n                  </FormGroup>\n                </FormControl>\n              </Grid>\n            </Grid>\n          </Grid>\n        </Grid>\n      </DialogContent>\n    </Dialog>\n  );\n};\n","import React, { FormEvent, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { sample } from \"lodash\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { Category } from \"../../../../types/Category\";\nimport { replaceDuplicateName } from \"../../../../image/imageHelper\";\nimport { imageViewerSlice } from \"../../../../store/slices\";\nimport { annotatorCategoriesSelector } from \"../../../../store/selectors/annotatorCategoriesSelector\";\nimport { CategoryDialog } from \"../CategoryDialog\";\n\nexport const COLORS = [\n  \"#000000\",\n  \"#004949\",\n  \"#009292\",\n  \"#ff6db6\",\n  \"#ffb6db\",\n  \"#490092\",\n  \"#006ddb\",\n  \"#b66dff\",\n  \"#6db6ff\",\n  \"#b6dbff\",\n  \"#920000\",\n  \"#924900\",\n  \"#db6d00\",\n  \"#24ff24\",\n  \"#ffff6d\",\n];\n\ntype CreateCategoryDialogProps = {\n  onClose: () => void;\n  open: boolean;\n};\n\nexport const CreateCategoryDialog = ({\n  onClose,\n  open,\n}: CreateCategoryDialogProps) => {\n  const dispatch = useDispatch();\n\n  const categories = useSelector(annotatorCategoriesSelector);\n\n  const [color, setColor] = React.useState<string>(sample(COLORS)!);\n\n  const [name, setName] = useState<string>(\"\");\n\n  const onCreate = () => {\n    const initialName = name ? name : \"Unnamed\";\n    const categoryNames = categories.map((category: Category) => {\n      return category.name;\n    });\n    const updatedName = replaceDuplicateName(initialName, categoryNames);\n\n    const category: Category = {\n      color: color,\n      id: uuidv4().toString(),\n      name: updatedName,\n      visible: true,\n    };\n\n    dispatch(\n      imageViewerSlice.actions.setCategories({\n        categories: [...categories, category],\n      })\n    );\n\n    dispatch(\n      imageViewerSlice.actions.setSelectedCategoryId({\n        selectedCategoryId: category.id,\n      })\n    );\n\n    setName(\"\");\n\n    onClose();\n\n    setColor(sample(COLORS)!);\n  };\n\n  const onSubmit = (event: FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n  };\n\n  return (\n    <CategoryDialog\n      onCloseDialog={onClose}\n      openDialog={open}\n      onSubmit={onSubmit}\n      title={\"Create category\"}\n      color={color}\n      setColor={setColor}\n      name={name}\n      setName={setName}\n      action={\"Create\"}\n      onConfirm={onCreate}\n    />\n  );\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nimport { AnnotationType } from \"../../types/AnnotationType\";\n\nexport const selectedAnnotationsIdsSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}): Array<string> => {\n  return imageViewer.selectedAnnotations.map((annotation: AnnotationType) => {\n    return annotation.id;\n  });\n};\n","import React from \"react\";\nimport Menu from \"@mui/material/Menu\";\nimport MenuList from \"@mui/material/MenuList\";\nimport MenuItem from \"@mui/material/MenuItem\";\nimport Typography from \"@mui/material/Typography\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { imageViewerSlice } from \"../../../../store/slices\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\nimport { activeImageIdSelector } from \"../../../../store/selectors/activeImageIdSelector\";\nimport {\n  saveAnnotationsAsLabelMatrix,\n  saveAnnotationsAsLabeledSemanticSegmentationMasks,\n  saveAnnotationsAsBinaryInstanceSegmentationMasks,\n} from \"../../../../image/imageHelper\";\nimport { saveAs } from \"file-saver\";\nimport JSZip from \"jszip\";\nimport { categoriesSelector } from \"../../../../store/selectors\";\nimport { imagesSelector } from \"../../../../store/selectors/imagesSelector\";\nimport { Divider } from \"@mui/material\";\nimport { Image } from \"../../../../types/Image\";\n\ntype ImageMenuProps = {\n  anchorElImageMenu: any;\n  onCloseImageMenu: (event: React.MouseEvent<HTMLElement, MouseEvent>) => void;\n  openImageMenu: boolean;\n};\n\nexport const ImageMenu = ({\n  anchorElImageMenu,\n  onCloseImageMenu,\n  openImageMenu,\n}: ImageMenuProps) => {\n  const dispatch = useDispatch();\n  const currentImageId = useSelector(activeImageIdSelector);\n  const categories = useSelector(categoriesSelector);\n  const images = useSelector(imagesSelector);\n\n  const onClearAnnotationsClick = (\n    event: React.MouseEvent<HTMLElement, MouseEvent>\n  ) => {\n    if (!currentImageId) return;\n    dispatch(\n      imageViewerSlice.actions.deleteAllImageInstances({\n        imageId: currentImageId,\n      })\n    );\n    onCloseImageMenu(event);\n  };\n\n  const onDeleteImage = (event: React.MouseEvent<HTMLElement, MouseEvent>) => {\n    if (!currentImageId) return;\n    dispatch(imageViewerSlice.actions.deleteImage({ id: currentImageId }));\n    onCloseImageMenu(event);\n  };\n\n  const onExportLabeledInstanceMasks = (\n    event: React.MouseEvent<HTMLElement, MouseEvent>\n  ) => {\n    setAnchorEl(null);\n    onCloseImageMenu(event);\n\n    let zip = new JSZip();\n\n    const activeImage = images.find((image: Image) => {\n      return image.id === currentImageId;\n    });\n\n    if (!activeImage) return;\n\n    Promise.all(\n      saveAnnotationsAsLabelMatrix([activeImage], categories, zip, true)\n    ).then(() => {\n      zip.generateAsync({ type: \"blob\" }).then((blob) => {\n        saveAs(blob, \"labeled_instances.zip\");\n      });\n    });\n  };\n\n  const onExportBinaryInstanceMasks = (\n    event: React.MouseEvent<HTMLElement, MouseEvent>\n  ) => {\n    setAnchorEl(null);\n    onCloseImageMenu(event);\n\n    let zip = new JSZip();\n\n    const activeImage = images.find((image: Image) => {\n      return image.id === currentImageId;\n    });\n\n    if (!activeImage) return;\n\n    saveAnnotationsAsBinaryInstanceSegmentationMasks(\n      [activeImage],\n      categories,\n      zip\n    );\n  };\n\n  const onExportLabels = (event: React.MouseEvent<HTMLElement, MouseEvent>) => {\n    setAnchorEl(null);\n    onCloseImageMenu(event);\n\n    let zip = new JSZip();\n\n    const activeImage = images.find((image: Image) => {\n      return image.id === currentImageId;\n    });\n\n    if (!activeImage) return;\n\n    Promise.all(\n      saveAnnotationsAsLabelMatrix([activeImage], categories, zip)\n    ).then(() => {\n      zip.generateAsync({ type: \"blob\" }).then((blob) => {\n        saveAs(blob, \"labels.zip\");\n      });\n    });\n  };\n\n  const onExportLabeledSemanticMasks = (\n    event: React.MouseEvent<HTMLElement, MouseEvent>\n  ) => {\n    setAnchorEl(null);\n    onCloseImageMenu(event);\n\n    let zip = new JSZip();\n\n    const activeImage = images.find((image: Image) => {\n      return image.id === currentImageId;\n    });\n\n    if (!activeImage) return;\n\n    saveAnnotationsAsLabeledSemanticSegmentationMasks(\n      [activeImage],\n      categories,\n      zip\n    );\n  };\n\n  const onExportBinarySemanticMasks = (\n    event: React.MouseEvent<HTMLElement, MouseEvent>\n  ) => {\n    setAnchorEl(null);\n    onCloseImageMenu(event);\n\n    let zip = new JSZip();\n\n    const activeImage = images.find((image: Image) => {\n      return image.id === currentImageId;\n    });\n\n    if (!activeImage) return;\n\n    Promise.all(\n      saveAnnotationsAsLabelMatrix(images, categories, zip, false, true)\n    ).then(() => {\n      zip.generateAsync({ type: \"blob\" }).then((blob) => {\n        saveAs(blob, \"binary_semantic.zip\");\n      });\n    });\n  };\n\n  const t = useTranslation();\n\n  const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\n\n  const handleClick = (event: React.MouseEvent<HTMLLIElement>) => {\n    setAnchorEl(event.currentTarget);\n  };\n\n  const handleClose = () => {\n    setAnchorEl(null);\n  };\n\n  return (\n    <Menu\n      anchorEl={anchorElImageMenu}\n      anchorOrigin={{ horizontal: \"center\", vertical: \"bottom\" }}\n      // getContentAnchorEl={null}\n      onClose={onCloseImageMenu}\n      open={openImageMenu}\n      transformOrigin={{ horizontal: \"center\", vertical: \"top\" }}\n    >\n      <MenuList dense variant=\"menu\">\n        <div>\n          <MenuItem onClick={handleClick}>Export annotations as</MenuItem>\n          <Menu\n            id=\"save-annotations-as-menu\"\n            anchorEl={anchorEl}\n            keepMounted\n            open={Boolean(anchorEl)}\n            onClose={handleClose}\n          >\n            <MenuList dense variant=\"menu\">\n              <div>\n                <MenuItem onClick={onExportLabeledInstanceMasks}>\n                  <Typography variant=\"inherit\">\n                    {t(\"Labeled instance masks\")}\n                  </Typography>\n                </MenuItem>\n                <MenuItem onClick={onExportBinaryInstanceMasks}>\n                  <Typography variant=\"inherit\">\n                    {t(\"Binary instance masks\")}\n                  </Typography>\n                </MenuItem>\n                <MenuItem onClick={onExportLabeledSemanticMasks}>\n                  <Typography variant=\"inherit\">\n                    {t(\"Labeled semantic masks\")}\n                  </Typography>\n                </MenuItem>\n                <MenuItem onClick={onExportBinarySemanticMasks}>\n                  <Typography variant=\"inherit\">\n                    {t(\"Binary semantic masks\")}\n                  </Typography>\n                </MenuItem>\n                <MenuItem onClick={onExportLabels}>\n                  <Typography variant=\"inherit\">\n                    {t(\"Label matrices\")}\n                  </Typography>\n                </MenuItem>\n              </div>\n            </MenuList>\n          </Menu>\n          <Divider />\n          <MenuItem onClick={onClearAnnotationsClick}>\n            <Typography variant=\"inherit\">{t(\"Clear Annotations\")}</Typography>\n          </MenuItem>\n          <MenuItem onClick={onDeleteImage}>\n            <Typography variant=\"inherit\">{t(\"Delete Image\")}</Typography>\n          </MenuItem>\n        </div>\n      </MenuList>\n    </Menu>\n  );\n};\n","import React from \"react\";\nimport Dialog from \"@mui/material/Dialog\";\nimport DialogTitle from \"@mui/material/DialogTitle\";\nimport DialogContent from \"@mui/material/DialogContent\";\nimport DialogActions from \"@mui/material/DialogActions\";\nimport Button from \"@mui/material/Button\";\nimport { batch, useDispatch } from \"react-redux\";\nimport { imageViewerSlice } from \"../../../../store/slices\";\nimport { UNKNOWN_CATEGORY_ID } from \"../../../../types/Category\";\n\ntype DeleteAllAnnotationsDialogProps = {\n  onClose: () => void;\n  open: boolean;\n};\n\nexport const DeleteAllAnnotationsDialog = ({\n  onClose,\n  open,\n}: DeleteAllAnnotationsDialogProps) => {\n  const dispatch = useDispatch();\n\n  const onDelete = () => {\n    batch(() => {\n      dispatch(imageViewerSlice.actions.deleteAllInstances({ id: \"\" }));\n      dispatch(\n        imageViewerSlice.actions.setSelectedCategoryId({\n          selectedCategoryId: UNKNOWN_CATEGORY_ID,\n        })\n      );\n    });\n\n    onClose();\n  };\n\n  return (\n    <Dialog fullWidth onClose={onClose} open={open}>\n      <DialogTitle>Delete all annotations?</DialogTitle>\n\n      <DialogContent>\n        All annotations across all images will be permanently deleted.\"\n      </DialogContent>\n\n      <DialogActions>\n        <Button onClick={onClose} color=\"primary\">\n          Cancel\n        </Button>\n\n        <Button onClick={onDelete} color=\"primary\">\n          Delete\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n","import { AnnotationType } from \"../../types/AnnotationType\";\nimport { Category } from \"../../types/Category\";\nimport { Image } from \"../../types/Image\";\nimport { SerializedFileType } from \"../../types/SerializedFileType\";\nimport { ImageViewer } from \"../../types/ImageViewer\";\n\nexport const allSerializedAnnotationsSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}): Array<SerializedFileType> => {\n  if (!imageViewer.images.length) return [];\n\n  return imageViewer.images.map((image: Image) => {\n    const columns = {\n      imageChannels: image.shape.channels,\n      imageChecksum: \"\",\n      imageData: image.originalSrc,\n      imageFilename: image.name,\n      imageFrames: image.shape.frames,\n      imageHeight: image.shape.height,\n      imageId: image.id,\n      imagePlanes: image.shape.planes,\n      imageWidth: image.shape.width,\n    };\n\n    const serializedAnnotations = image.annotations.map(\n      (annotation: AnnotationType) => {\n        const index = imageViewer.categories.findIndex((category: Category) => {\n          return category.id === annotation.categoryId;\n        });\n\n        const category = imageViewer.categories[index];\n\n        return {\n          annotationBoundingBoxHeight: annotation.boundingBox[3],\n          annotationBoundingBoxWidth: annotation.boundingBox[2],\n          annotationBoundingBoxX: annotation.boundingBox[0],\n          annotationBoundingBoxY: annotation.boundingBox[1],\n          annotationCategoryColor: category.color,\n          annotationCategoryId: category.id,\n          annotationCategoryName: category.name,\n          annotationId: annotation.id,\n          annotationMask: annotation.mask.join(\" \"),\n          annotationPlane: annotation.plane,\n        };\n      }\n    );\n\n    return { ...columns, annotations: serializedAnnotations };\n  });\n};\n","import { useSelector } from \"react-redux\";\nimport { allSerializedAnnotationsSelector } from \"../../../../store/selectors/allSerializedAnnotationsSelector\";\nimport { saveAs } from \"file-saver\";\nimport { MenuItem } from \"@mui/material\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport React from \"react\";\n\ntype SaveAnnotationsMenuItemProps = {\n  popupState: any;\n  handleCloseMenu: () => void;\n};\n\nexport const SaveProjectFileMenuItem = ({\n  popupState,\n  handleCloseMenu,\n}: SaveAnnotationsMenuItemProps) => {\n  const serializedProject = useSelector(allSerializedAnnotationsSelector);\n\n  const onSaveAllAnnotations = () => {\n    const blob = new Blob([JSON.stringify(serializedProject)]);\n\n    saveAs(blob, \"project.json\");\n\n    popupState.close();\n    handleCloseMenu();\n  };\n  return (\n    <MenuItem onClick={onSaveAllAnnotations}>\n      <ListItemText primary=\"Save project file\" />\n    </MenuItem>\n  );\n};\n","import React from \"react\";\nimport { MenuItem } from \"@mui/material\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport { useSelector } from \"react-redux\";\nimport {\n  categoriesSelector,\n  imageInstancesSelector,\n} from \"../../../../store/selectors\";\nimport { imagesSelector } from \"../../../../store/selectors/imagesSelector\";\nimport JSZip from \"jszip\";\nimport { saveAnnotationsAsLabelMatrix } from \"../../../../image/imageHelper\";\nimport { saveAs } from \"file-saver\";\n\ntype SaveAnnotationsMenuItemProps = {\n  popupState: any;\n  handleCloseMenu: () => void;\n};\n\nexport const ExportAnnotationsAsLabeledInstancesMenuItem = ({\n  popupState,\n  handleCloseMenu,\n}: SaveAnnotationsMenuItemProps) => {\n  const annotations = useSelector(imageInstancesSelector);\n  const images = useSelector(imagesSelector);\n  const categories = useSelector(categoriesSelector);\n\n  const onExport = () => {\n    popupState.close();\n    handleCloseMenu();\n\n    if (!annotations) return;\n\n    let zip = new JSZip();\n\n    Promise.all(\n      saveAnnotationsAsLabelMatrix(images, categories, zip, true)\n    ).then(() => {\n      zip.generateAsync({ type: \"blob\" }).then((blob) => {\n        saveAs(blob, \"labeled_instances.zip\");\n      });\n    });\n  };\n\n  return (\n    <MenuItem onClick={onExport}>\n      <ListItemText primary=\"Labeled instance masks\" />\n    </MenuItem>\n  );\n};\n","import React from \"react\";\nimport { MenuItem } from \"@mui/material\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport { useSelector } from \"react-redux\";\nimport {\n  categoriesSelector,\n  imageInstancesSelector,\n} from \"../../../../store/selectors\";\nimport { imagesSelector } from \"../../../../store/selectors/imagesSelector\";\nimport JSZip from \"jszip\";\nimport { saveAs } from \"file-saver\";\nimport { saveAnnotationsAsLabelMatrix } from \"../../../../image/imageHelper\";\n\ntype SaveAnnotationsMenuItemProps = {\n  popupState: any;\n  handleCloseMenu: () => void;\n};\n\nexport const ExportAnnotationsAsMatrixMenuItem = ({\n  popupState,\n  handleCloseMenu,\n}: SaveAnnotationsMenuItemProps) => {\n  const annotations = useSelector(imageInstancesSelector);\n  const images = useSelector(imagesSelector);\n  const categories = useSelector(categoriesSelector);\n\n  const onExport = () => {\n    popupState.close();\n    handleCloseMenu();\n\n    if (!annotations) return;\n\n    let zip = new JSZip();\n\n    Promise.all(saveAnnotationsAsLabelMatrix(images, categories, zip)).then(\n      () => {\n        zip.generateAsync({ type: \"blob\" }).then((blob) => {\n          saveAs(blob, \"labels.zip\");\n        });\n      }\n    );\n  };\n\n  return (\n    <MenuItem onClick={onExport}>\n      <ListItemText primary=\"Label matrices\" />\n    </MenuItem>\n  );\n};\n","import React from \"react\";\nimport { MenuItem } from \"@mui/material\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport { useSelector } from \"react-redux\";\nimport {\n  categoriesSelector,\n  imageInstancesSelector,\n} from \"../../../../store/selectors\";\nimport { imagesSelector } from \"../../../../store/selectors/imagesSelector\";\nimport JSZip from \"jszip\";\nimport { saveAnnotationsAsLabeledSemanticSegmentationMasks } from \"../../../../image/imageHelper\";\n\ntype SaveAnnotationsMenuItemProps = {\n  popupState: any;\n  handleCloseMenu: () => void;\n};\n\nexport const ExportAnnotationsAsLabeledSemanticMasksMenuItem = ({\n  popupState,\n  handleCloseMenu,\n}: SaveAnnotationsMenuItemProps) => {\n  const annotations = useSelector(imageInstancesSelector);\n  const images = useSelector(imagesSelector);\n  const categories = useSelector(categoriesSelector);\n\n  const onExport = () => {\n    popupState.close();\n    handleCloseMenu();\n\n    if (!annotations) return;\n\n    let zip = new JSZip();\n\n    saveAnnotationsAsLabeledSemanticSegmentationMasks(images, categories, zip);\n  };\n\n  return (\n    <MenuItem onClick={onExport}>\n      <ListItemText primary=\"Labeled semantic masks\" />\n    </MenuItem>\n  );\n};\n","import React from \"react\";\nimport { MenuItem } from \"@mui/material\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport { useSelector } from \"react-redux\";\nimport {\n  categoriesSelector,\n  imageInstancesSelector,\n} from \"../../../../store/selectors\";\nimport { imagesSelector } from \"../../../../store/selectors/imagesSelector\";\nimport JSZip from \"jszip\";\nimport { saveAnnotationsAsLabelMatrix } from \"../../../../image/imageHelper\";\nimport { saveAs } from \"file-saver\";\n\ntype SaveAnnotationsMenuItemProps = {\n  popupState: any;\n  handleCloseMenu: () => void;\n};\n\nexport const ExportAnnotationsAsBinarySemanticMasksMenuItem = ({\n  popupState,\n  handleCloseMenu,\n}: SaveAnnotationsMenuItemProps) => {\n  const annotations = useSelector(imageInstancesSelector);\n  const images = useSelector(imagesSelector);\n  const categories = useSelector(categoriesSelector);\n\n  const onExport = () => {\n    popupState.close();\n    handleCloseMenu();\n\n    if (!annotations) return;\n\n    let zip = new JSZip();\n    Promise.all(\n      saveAnnotationsAsLabelMatrix(images, categories, zip, false, true)\n    ).then(() => {\n      zip.generateAsync({ type: \"blob\" }).then((blob) => {\n        saveAs(blob, \"binary_semantics.zip\");\n      });\n    });\n  };\n\n  return (\n    <MenuItem onClick={onExport}>\n      <ListItemText primary=\"Binary semantic masks\" />\n    </MenuItem>\n  );\n};\n","import React from \"react\";\nimport { MenuItem } from \"@mui/material\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport { useSelector } from \"react-redux\";\nimport {\n  categoriesSelector,\n  imageInstancesSelector,\n} from \"../../../../store/selectors\";\nimport { imagesSelector } from \"../../../../store/selectors/imagesSelector\";\nimport JSZip from \"jszip\";\nimport { saveAnnotationsAsBinaryInstanceSegmentationMasks } from \"../../../../image/imageHelper\";\n\ntype SaveAnnotationsMenuItemProps = {\n  popupState: any;\n  handleCloseMenu: () => void;\n};\n\nexport const ExportAnnotationsAsBinaryInstancesMenuItem = ({\n  popupState,\n  handleCloseMenu,\n}: SaveAnnotationsMenuItemProps) => {\n  const annotations = useSelector(imageInstancesSelector);\n  const images = useSelector(imagesSelector);\n  const categories = useSelector(categoriesSelector);\n\n  const onExport = () => {\n    popupState.close();\n    handleCloseMenu();\n\n    if (!annotations) return;\n\n    let zip = new JSZip();\n\n    saveAnnotationsAsBinaryInstanceSegmentationMasks(images, categories, zip);\n  };\n\n  return (\n    <MenuItem onClick={onExport}>\n      <ListItemText primary=\"Binary instance masks\" />\n    </MenuItem>\n  );\n};\n","import { Menu } from \"@mui/material\";\nimport { bindMenu } from \"material-ui-popup-state\";\nimport React from \"react\";\nimport { SaveProjectFileMenuItem } from \"./SaveProjectFileMenuItem\";\nimport { ExportAnnotationsAsLabeledInstancesMenuItem } from \"./ExportAnnotationsAsLabeledInstancesMenuItem\";\nimport { ExportAnnotationsAsMatrixMenuItem } from \"./ExportAnnotationsAsMatrixMenuItem\";\nimport { ExportAnnotationsAsLabeledSemanticMasksMenuItem } from \"./ExportAnnotationsAsLabeledSemanticMasksMenuItem\";\nimport MenuItem from \"@mui/material/MenuItem\";\nimport { ExportAnnotationsAsBinarySemanticMasksMenuItem } from \"./ExportAnnotationsAsBinarySemanticMasksMenuItem\";\nimport { ExportAnnotationsAsBinaryInstancesMenuItem } from \"./ExportAnnotationsAsBinaryInstancesMenuItem\";\n\ntype SaveMenuProps = {\n  popupState: any;\n};\n\nexport const SaveMenu = ({ popupState }: SaveMenuProps) => {\n  const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\n\n  const handleClick = (event: React.MouseEvent<HTMLLIElement>) => {\n    setAnchorEl(event.currentTarget);\n  };\n\n  const handleClose = () => {\n    setAnchorEl(null);\n  };\n\n  return (\n    <Menu {...bindMenu(popupState)}>\n      <MenuItem onClick={handleClick}>Export annotations as</MenuItem>\n      <Menu\n        id=\"save-annotations-as-menu\"\n        anchorEl={anchorEl}\n        keepMounted\n        open={Boolean(anchorEl)}\n        onClose={handleClose}\n      >\n        <ExportAnnotationsAsLabeledInstancesMenuItem\n          popupState={popupState}\n          handleCloseMenu={handleClose}\n        />\n        <ExportAnnotationsAsBinaryInstancesMenuItem\n          popupState={popupState}\n          handleCloseMenu={handleClose}\n        />\n        <ExportAnnotationsAsLabeledSemanticMasksMenuItem\n          popupState={popupState}\n          handleCloseMenu={handleClose}\n        />\n        <ExportAnnotationsAsBinarySemanticMasksMenuItem\n          popupState={popupState}\n          handleCloseMenu={handleClose}\n        />\n        <ExportAnnotationsAsMatrixMenuItem\n          popupState={popupState}\n          handleCloseMenu={handleClose}\n        />\n      </Menu>\n      <SaveProjectFileMenuItem\n        popupState={popupState}\n        handleCloseMenu={handleClose}\n      />\n    </Menu>\n  );\n};\n","import { batch, useDispatch } from \"react-redux\";\nimport React, { ChangeEvent } from \"react\";\nimport { MenuItem } from \"@mui/material\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport {\n  addImages,\n  setActiveImage,\n  setSelectedAnnotations,\n} from \"../../../../store/slices\";\nimport { convertFileToImage } from \"../../../../image/imageHelper\";\n\ntype OpenImageMenuItemProps = {\n  popupState: any;\n};\n\nexport const OpenImageMenuItem = ({ popupState }: OpenImageMenuItemProps) => {\n  const dispatch = useDispatch();\n\n  const onOpenImage = async (\n    event: React.ChangeEvent<HTMLInputElement>,\n    onClose: () => void\n  ) => {\n    onClose();\n    event.persist();\n\n    if (!event.currentTarget.files) return;\n\n    const files = event.currentTarget.files;\n\n    for (let i = 0; i < files.length; i++) {\n      if (i === 0) {\n        dispatch(\n          setSelectedAnnotations({\n            selectedAnnotations: [],\n            selectedAnnotation: undefined,\n          })\n        );\n      }\n      const image = await convertFileToImage(files[i]);\n      batch(() => {\n        dispatch(addImages({ newImages: [image] }));\n        if (i === 0) dispatch(setActiveImage({ image: image.id }));\n      });\n    }\n  };\n\n  return (\n    <MenuItem component=\"label\">\n      <ListItemText primary=\"Open new image\" />\n      <input\n        accept=\"image/*\"\n        hidden\n        multiple\n        id=\"open-image\"\n        onChange={(event: ChangeEvent<HTMLInputElement>) =>\n          onOpenImage(event, popupState.close)\n        }\n        type=\"file\"\n      />\n    </MenuItem>\n  );\n};\n","import { useDispatch } from \"react-redux\";\nimport React from \"react\";\nimport { MenuItem } from \"@mui/material\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport { SerializedFileType } from \"../../../../types/SerializedFileType\";\nimport { ToolType } from \"../../../../types/ToolType\";\nimport {\n  imageViewerSlice,\n  setActiveImage,\n  setOperation,\n  setSelectedAnnotations,\n} from \"../../../../store/slices\";\n\ntype OpenAnnotationsMenuItemProps = {\n  popupState: any;\n};\n\nexport const OpenProjectFileMenuItem = ({\n  popupState,\n}: OpenAnnotationsMenuItemProps) => {\n  const dispatch = useDispatch();\n\n  const onOpenProjectFile = (\n    event: React.ChangeEvent<HTMLInputElement>,\n    onClose: () => void\n  ) => {\n    onClose();\n\n    event.persist();\n\n    if (!event.currentTarget.files) return;\n\n    const file = event.currentTarget.files[0];\n\n    const reader = new FileReader();\n\n    reader.onload = async (event: ProgressEvent<FileReader>) => {\n      if (event.target && event.target.result) {\n        const project = JSON.parse(event.target.result as string);\n\n        //clear all images\n        dispatch(imageViewerSlice.actions.setImages({ images: [] }));\n\n        project.forEach(\n          (serializedImage: SerializedFileType, index: number) => {\n            if (index === 0) {\n              dispatch(\n                setActiveImage({\n                  image: serializedImage.imageId,\n                })\n              );\n\n              dispatch(\n                setSelectedAnnotations({\n                  selectedAnnotations: [],\n                  selectedAnnotation: undefined,\n                })\n              );\n\n              dispatch(\n                setOperation({ operation: ToolType.RectangularAnnotation })\n              );\n            }\n            dispatch(\n              imageViewerSlice.actions.openAnnotations({\n                file: serializedImage,\n              })\n            );\n          }\n        );\n      }\n    };\n\n    reader.readAsText(file);\n  };\n\n  return (\n    <MenuItem component=\"label\">\n      <ListItemText primary=\"Open project file\" />\n      <input\n        accept=\"application/json\"\n        hidden\n        id=\"open-project-file\"\n        onChange={(event: React.ChangeEvent<HTMLInputElement>) =>\n          onOpenProjectFile(event, popupState.close)\n        }\n        type=\"file\"\n      />\n    </MenuItem>\n  );\n};\n","export default __webpack_public_path__ + \"static/media/malaria.5b73ad75.png\";","import { Image } from \"../../types/Image\";\nimport { ImageViewer } from \"../../types/ImageViewer\";\n\nexport const annotatorImagesSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}): Array<Image> => {\n  return imageViewer.images;\n};\n","import Dialog from \"@mui/material/Dialog\";\nimport React from \"react\";\nimport { ShapeType } from \"../../../../types/ShapeType\";\nimport { batch, useDispatch, useSelector } from \"react-redux\";\nimport List from \"@mui/material/List\";\nimport ListItem from \"@mui/material/ListItem\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport malaria from \"../../../../images/malaria.png\";\nimport cellpainting from \"../../../../images/cell-painting.png\";\nimport { ChannelType } from \"../../../../types/ChannelType\";\nimport { ToolType } from \"../../../../types/ToolType\";\n// import { ImageViewerImage } from \"../../../../types/ImageViewerImage\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport * as malariaAnnotations from \"../../../../images/malaria.json\";\nimport * as cellpaintingAnnotations from \"../../../../images/cellpainting.json\";\nimport { AnnotationType } from \"../../../../types/AnnotationType\";\nimport { SerializedAnnotationType } from \"../../../../types/SerializedAnnotationType\";\nimport { Category, UNKNOWN_CATEGORY_ID } from \"../../../../types/Category\";\nimport { categoriesSelector } from \"../../../../store/selectors\";\nimport { importSerializedAnnotations } from \"../../../../image/imageHelper\";\nimport {\n  imageViewerSlice,\n  setActiveImage,\n  setChannels,\n  setImages,\n  setOperation,\n  setSelectedAnnotations,\n} from \"../../../../store/slices\";\nimport { Image } from \"../../../../types/Image\";\nimport { Partition } from \"../../../../types/Partition\";\nimport { annotatorImagesSelector } from \"../../../../store/selectors/annotatorImagesSelector\";\n\ntype ExampleImageDialogProps = {\n  onClose: () => void;\n  open: boolean;\n};\n\nexport const ExampleImageDialog = ({\n  onClose,\n  open,\n}: ExampleImageDialogProps) => {\n  const dispatch = useDispatch();\n\n  const images = useSelector(annotatorImagesSelector);\n\n  const categories_in = useSelector(categoriesSelector);\n\n  const examples = [\n    {\n      name: \"malaria.png\",\n      description:\n        \"Blood cells infected by malaria and stained with Giemsa reagent. Image from the Broad Bioimage Benchmark Collection, image set BBBC041v1.\",\n      data: malaria,\n      project: (malariaAnnotations as any).default,\n      shape: {\n        channels: 3,\n        frames: 1,\n        height: 1200,\n        planes: 1,\n        width: 1600,\n      },\n    },\n    {\n      name: \"cell-painting.png\",\n      description:\n        \"U2OS cells treated with an RNAi reagent (https://iwww.broadinstitute.org/rnai/db/clone/details?cloneId=TRCN0000195467) and stained for a \" +\n        \"cell-painting experiment (Merged; red: Actin, Golgi, and Plasma membrane stained via phalloidin and wheat germ agglutinin; \" +\n        \"blue: DNA stained via Hoechst; green: mitochondria stained via MitoTracker).\",\n      data: cellpainting,\n      project: (cellpaintingAnnotations as any).default,\n      shape: {\n        channels: 3,\n        frames: 1,\n        height: 512,\n        planes: 1,\n        width: 512,\n      },\n    },\n  ];\n\n  const onClick = ({\n    data,\n    description,\n    name,\n    shape,\n    project,\n  }: {\n    data: any;\n    description: string;\n    name: string;\n    project: any;\n    shape: ShapeType;\n  }) => {\n    onClose();\n\n    let channels: Array<ChannelType> = [];\n    for (let i = 0; i < shape.channels; i++) {\n      channels.push({ visible: true, range: [0, 255] });\n    }\n\n    const newAnnotations: Array<AnnotationType> = [];\n\n    let updatedCategories: Array<Category> = categories_in;\n\n    project[0].annotations.forEach(\n      (serializedAnnotation: SerializedAnnotationType) => {\n        const { annotation_out, categories } = importSerializedAnnotations(\n          serializedAnnotation,\n          updatedCategories\n        );\n\n        updatedCategories = categories;\n\n        newAnnotations.push(annotation_out);\n      }\n    );\n\n    const example: Image = {\n      categoryId: UNKNOWN_CATEGORY_ID,\n      id: uuidv4(),\n      annotations: newAnnotations,\n      name: name,\n      shape: shape,\n      originalSrc: [data as string],\n      partition: Partition.Inference,\n      src: data as string,\n    };\n\n    batch(() => {\n      dispatch(setImages({ images: [...images, example] }));\n\n      dispatch(\n        setActiveImage({\n          image: example.id,\n        })\n      );\n\n      dispatch(setChannels({ channels }));\n\n      dispatch(setOperation({ operation: ToolType.RectangularAnnotation }));\n\n      dispatch(\n        setSelectedAnnotations({\n          selectedAnnotations: [],\n          selectedAnnotation: undefined,\n        })\n      );\n\n      dispatch(\n        imageViewerSlice.actions.setCategories({\n          categories: updatedCategories,\n        })\n      );\n    });\n  };\n\n  return (\n    <Dialog open={open} onClose={onClose}>\n      <List component=\"div\" role=\"list\">\n        {examples.map((example, index) => {\n          return (\n            <ListItem\n              button\n              divider\n              key={index}\n              role=\"listitem\"\n              onClick={() => onClick(example)}\n            >\n              <ListItemText\n                primary={example.name}\n                secondary={example.description}\n              />\n            </ListItem>\n          );\n        })}\n      </List>\n    </Dialog>\n  );\n};\n","import { MenuItem } from \"@mui/material\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport { ExampleImageDialog } from \"../ExampleImageDialog\";\nimport React from \"react\";\nimport { useDialog } from \"../../../../hooks\";\n\ntype OpenExampleImageMenuItemProps = {\n  popupState: any;\n};\n\nexport const OpenExampleImageMenuItem = ({\n  popupState,\n}: OpenExampleImageMenuItemProps) => {\n  const { onClose, onOpen, open } = useDialog();\n\n  return (\n    <MenuItem onClick={onOpen}>\n      <ListItemText primary=\"Open example image\" />\n      <ExampleImageDialog\n        onClose={() => {\n          onClose();\n\n          popupState.close();\n        }}\n        open={open}\n      />\n    </MenuItem>\n  );\n};\n","import { Divider, Menu } from \"@mui/material\";\nimport { bindMenu } from \"material-ui-popup-state\";\nimport React from \"react\";\nimport { OpenImageMenuItem } from \"./OpenImageMenuItem\";\nimport { OpenProjectFileMenuItem } from \"./OpenProjectFileMenuItem\";\nimport { OpenExampleImageMenuItem } from \"./OpenExampleImageMenuItem\";\n\ntype OpenMenuProps = {\n  popupState: any;\n};\n\nexport const OpenMenu = ({ popupState }: OpenMenuProps) => {\n  return (\n    <Menu {...bindMenu(popupState)}>\n      <OpenImageMenuItem popupState={popupState} />\n\n      <OpenProjectFileMenuItem popupState={popupState} />\n\n      <Divider />\n\n      <OpenExampleImageMenuItem popupState={popupState} />\n    </Menu>\n  );\n};\n","import React from \"react\";\nimport List from \"@mui/material/List\";\nimport ListItem from \"@mui/material/ListItem\";\nimport ListItemIcon from \"@mui/material/ListItemIcon\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport Collapse from \"@mui/material/Collapse\";\nimport DescriptionIcon from \"@mui/icons-material/Description\";\nimport { Typography } from \"@mui/material\";\n\ntype CollapsibleHelpContentProps = {\n  children: any;\n  dense: boolean;\n  primary: string;\n  closed?: boolean;\n};\n\nexport const CollapsibleHelpContent = ({\n  children,\n  dense,\n  closed,\n  primary,\n}: CollapsibleHelpContentProps) => {\n  const [collapsed, setCollapsed] = React.useState(closed);\n\n  const onClick = () => {\n    setCollapsed(!collapsed);\n  };\n\n  return (\n    <List dense={dense}>\n      <ListItem button onClick={onClick}>\n        <ListItemIcon>\n          <DescriptionIcon />\n        </ListItemIcon>\n        <ListItemText primary={<Typography>{primary}</Typography>} />\n      </ListItem>\n\n      <Collapse in={collapsed} timeout=\"auto\" unmountOnExit>\n        <List component=\"div\" dense={dense} disablePadding>\n          {children}\n        </List>\n      </Collapse>\n    </List>\n  );\n};\n","import React from \"react\";\nimport { Box } from \"@mui/material\";\n\ntype KeyboardKeyProps = {\n  letter: string;\n};\nexport const KeyboardKey = ({ letter }: KeyboardKeyProps) => {\n  return (\n    <Box\n      sx={{\n        backgroundColor: \"rgba(237, 242, 247, 1)\",\n        borderWidth: \"1px 1px 3px\",\n        borderRadius: \"6px\",\n        fontSize: \"0.8em\",\n        paddingInline: \"0.4em\",\n        whiteSpace: \"nowrap\",\n        fontWeight: 700,\n        borderColor: \"rgba(184, 186, 189, 1)\",\n        borderStyle: \"solid\",\n        color: \"rgba(45, 55, 72, 1)\",\n        width: \"fit-content\",\n        lineHeight: \"revert\",\n        marginLeft: \"5px\",\n        marginRight: \"5px\",\n      }}\n    >\n      {letter}\n    </Box>\n  );\n};\n","import React from \"react\";\nimport SvgIcon from \"@mui/material/SvgIcon\";\n\ntype ToolProps = {\n  children: React.ReactNode;\n};\nexport const HelpWindowToolIcon = ({ children }: ToolProps) => {\n  return (\n    <SvgIcon sx={{ marginRight: \"8px \" }} fontSize=\"small\">\n      {children}\n    </SvgIcon>\n  );\n};\n","import Typography from \"@mui/material/Typography\";\nimport { KeyboardKey } from \"./KeyboardKey\";\nimport React from \"react\";\nimport { HelpWindowToolIcon } from \"./HelpWindowToolIcons\";\nimport { Box } from \"@mui/material\";\n\ntype ToolTitleProps = {\n  toolName: string;\n  letter: string;\n  children: React.ReactNode;\n};\nexport const HelpWindowToolTitle = ({\n  children,\n  toolName,\n  letter,\n}: ToolTitleProps) => {\n  return (\n    <Box sx={{ display: \"flex\", alignItems: \"center\" }}>\n      <HelpWindowToolIcon>{children}</HelpWindowToolIcon>\n      <Typography>\n        <Box fontWeight=\"fontWeightBold\">{toolName}</Box>\n      </Typography>\n      <Typography style={{ marginLeft: \"5px\" }}>(</Typography>\n      <KeyboardKey letter=\"shift\" />\n      <Typography>+</Typography>\n      <KeyboardKey letter={letter} />\n      <Typography>)</Typography>\n    </Box>\n  );\n};\n","var _g;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgCheckboxUnchecked(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"CheckboxUnchecked\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    id: \"CheckboxUnchecked\",\n    stroke: \"none\",\n    strokeWidth: 1,\n    fill: \"none\",\n    fillRule: \"evenodd\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Path\",\n    transform: \"translate(-0.000000, -0.000000)\"\n  }, /*#__PURE__*/React.createElement(\"polygon\", {\n    points: \"0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M18,20 L6.00000002,20 C4.89500002,20 4.00000002,19.1050001 4.00000002,18 L4.00000002,6.00000002 C4.00000002,4.89500002 4.89500002,4.00000002 6.00000002,4.00000002 L18,4.00000002 C19.1050001,4.00000002 20,4.89500002 20,6.00000002 L20,18 C20,19.1050001 19.1050001,20 18,20 Z\",\n    stroke: \"#323232\",\n    strokeWidth: 1.5,\n    fill: \"#555555\",\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgCheckboxUnchecked);\nexport default __webpack_public_path__ + \"static/media/CheckboxUnchecked.1714692b.svg\";\nexport { ForwardRef as ReactComponent };","var _g;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgColorAdjustment(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Color adjustment\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Color-adjustment\",\n    stroke: \"none\",\n    strokeWidth: 1,\n    fill: \"none\",\n    fillRule: \"evenodd\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Path\",\n    transform: \"translate(-0.000000, -0.000000)\"\n  }, /*#__PURE__*/React.createElement(\"polygon\", {\n    points: \"0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8.25100003,21.5020001 C4.80400002,21.5020001 2.00000001,18.6980001 2.00000001,15.2510001 C2.00000001,11.804 4.80400002,9.00000004 8.25100003,9.00000004 C11.698,9.00000004 14.5020001,11.804 14.5020001,15.2510001 C14.5020001,18.6980001 11.698,21.5020001 8.25100003,21.5020001 Z\",\n    stroke: \"#BABABA\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M15.7490001,21.5020001 C12.3020001,21.5020001 9.49800004,18.6980001 9.49800004,15.2510001 C9.49800004,11.804 12.3020001,9.00000004 15.7490001,9.00000004 C19.1960001,9.00000004 22.0000001,11.804 22.0000001,15.2510001 C22.0000001,18.6980001 19.1960001,21.5020001 15.7490001,21.5020001 Z\",\n    stroke: \"#BABABA\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M12.0100001,15.0000001 C8.56300004,15.0000001 5.75900002,12.1960001 5.75900002,8.74900004 C5.75900002,5.30200002 8.56300004,2.49800001 12.0100001,2.49800001 C15.4570001,2.49800001 18.2610001,5.30200002 18.2610001,8.74900004 C18.2610001,12.1960001 15.4570001,15.0000001 12.0100001,15.0000001 Z\",\n    stroke: \"#BABABA\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgColorAdjustment);\nexport default __webpack_public_path__ + \"static/media/ColorAdjustment.b6d05bdf.svg\";\nexport { ForwardRef as ReactComponent };","var _g;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgColorAnnotation(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Color selection\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Color-selection\",\n    stroke: \"none\",\n    strokeWidth: 1,\n    fill: \"none\",\n    fillRule: \"evenodd\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Group\",\n    transform: \"translate(-0.000000, -0.000000)\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    transform: \"translate(2.000000, 2.000000)\",\n    id: \"Path\",\n    stroke: \"#BABABA\",\n    strokeWidth: 1.5\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M5.25800002,14.4180001 L1.51600001,10.676 C0.689000003,9.84900004 0.689000003,8.50900004 1.51600001,7.68200003 L7.15000003,2.04800001 L13.8860001,8.78400004 L8.25200003,14.4180001 C7.42500003,15.2440001 6.08400003,15.2440001 5.25800002,14.4180001 Z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16.8830001,11.774 C16.8830001,11.774 14.7660001,14.0710001 14.7660001,15.4790001 C14.7660001,16.6430001 15.7190001,17.5960001 16.8830001,17.5960001 C18.0470001,17.5960001 19.0000001,16.6430001 19.0000001,15.4780001 C19.0000001,14.0710001 16.8830001,11.774 16.8830001,11.774 L16.8830001,11.774 Z\"\n  }), /*#__PURE__*/React.createElement(\"line\", {\n    x1: 7.15000003,\n    y1: 2.05000001,\n    x2: 6.06000003,\n    y2: 0.940000004\n  }), /*#__PURE__*/React.createElement(\"line\", {\n    x1: 13.8900001,\n    y1: 8.78000004,\n    x2: 0.930000004,\n    y2: 8.78000004\n  }), /*#__PURE__*/React.createElement(\"line\", {\n    x1: 1.42000001,\n    y1: 19.4400001,\n    x2: 10,\n    y2: 19.4400001\n  })), /*#__PURE__*/React.createElement(\"polygon\", {\n    id: \"Path\",\n    points: \"0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001\"\n  })))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgColorAnnotation);\nexport default __webpack_public_path__ + \"static/media/ColorAnnotation.7f12326e.svg\";\nexport { ForwardRef as ReactComponent };","var _g;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgEllipticalAnnotation(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Elliptical selection\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Elliptical-selection\",\n    stroke: \"none\",\n    strokeWidth: 1,\n    fill: \"none\",\n    fillRule: \"evenodd\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Group\",\n    transform: \"translate(-0.000000, -0.000000)\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M18.3640001,5.63604002 C21.8787201,9.15076004 21.8787201,14.8492401 18.3640001,18.3639401 C14.8492801,21.8786601 9.15080004,21.8786601 5.63610002,18.3639401 C2.12138001,14.8492201 2.12138001,9.15074004 5.63610002,5.63604002 C9.15082004,2.12132001 14.8493001,2.12132001 18.3640001,5.63604002\",\n    id: \"Path\",\n    stroke: \"#BABABA\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }), /*#__PURE__*/React.createElement(\"polygon\", {\n    id: \"Path\",\n    points: \"0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001\"\n  })))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgEllipticalAnnotation);\nexport default __webpack_public_path__ + \"static/media/EllipticalAnnotation.18552cf6.svg\";\nexport { ForwardRef as ReactComponent };","var _g;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgHand(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Hand\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Hand\",\n    stroke: \"none\",\n    strokeWidth: 1,\n    fill: \"none\",\n    fillRule: \"evenodd\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Group\",\n    transform: \"translate(-0.005000, -0.005000)\"\n  }, /*#__PURE__*/React.createElement(\"polygon\", {\n    id: \"Path\",\n    points: \"0 0 24.01 0 24.01 24.01 0 24.01\"\n  }), /*#__PURE__*/React.createElement(\"g\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    transform: \"translate(3.005000, 3.005000)\",\n    id: \"Path\",\n    stroke: \"#BABABA\",\n    strokeWidth: 1.5\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M0.876688223,7.82337055 C1.82416266,7.02907695 3.20659866,7.09971911 4.07146412,7.98533063 L5.53482321,9.47915396 L5.53482321,3.45217126 C5.53482321,1.10030408 7.78886826,-0.560648269 9.97210561,0.183678925 L14.6976765,1.79294189 C16.0750548,2.26159234 17.0039844,3.57967175 17.0039844,5.06143422 L17.0039844,12.1222047 C17.0039844,15.4044809 14.3992726,18.0664844 11.1876378,18.0664844 L8.44636831,18.0664844 C6.61379765,18.0664844 4.88912444,17.1843188 3.78991922,15.6853265 L0.478816396,11.165951 C-0.284895203,10.1218254 -0.109561856,8.64867779 0.876688223,7.82337055 L0.876688223,7.82337055 Z\"\n  }))))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgHand);\nexport default __webpack_public_path__ + \"static/media/Hand.57521d91.svg\";\nexport { ForwardRef as ReactComponent };","var _g;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgLassoAnnotation(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Lasso selection\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Lasso-selection\",\n    stroke: \"none\",\n    strokeWidth: 1,\n    fill: \"none\",\n    fillRule: \"evenodd\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Group\",\n    transform: \"translate(-0.000000, -0.000000)\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    id: \"Path\",\n    stroke: \"#BABABA\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M18.9200215,5.20050274 C22.7422808,7.79423331 22.7422808,11.9995035 18.9200215,14.593244 C15.0977622,17.1869746 8.90062147,17.1869746 5.07841219,14.593244 C1.25615292,11.9995135 1.25615292,7.79424331 5.07841219,5.20050274 C8.90067146,2.60677217 15.0978122,2.60677217 18.9200215,5.20050274\",\n    strokeWidth: 1.49992515,\n    transform: \"translate(11.999217, 9.896873) rotate(-14.928464) translate(-11.999217, -9.896873) \"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M13.7110001,16.3150001 C9.54400004,17.4260001 4.30200002,16.4030001 4.30200002,12.9560001\",\n    strokeWidth: 1.5\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10.048,14.1050001 C10.048,16.3230001 8.89900004,19.8510001 4.30200002,21.0000001\",\n    strokeWidth: 1.5\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.30200002,12.9560001 C4.30200002,9.50900004 10.048,9.50900004 10.048,14.1050001\",\n    strokeWidth: 1.5\n  })), /*#__PURE__*/React.createElement(\"polygon\", {\n    id: \"Path\",\n    points: \"0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001\"\n  })))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgLassoAnnotation);\nexport default __webpack_public_path__ + \"static/media/LassoAnnotation.c53651de.svg\";\nexport { ForwardRef as ReactComponent };","var _g;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgMagneticAnnotation(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Magnetic selection\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Magnetic-selection\",\n    stroke: \"none\",\n    strokeWidth: 1,\n    fill: \"none\",\n    fillRule: \"evenodd\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Group\",\n    transform: \"translate(2.995000, 2.995000)\",\n    stroke: \"#BABABA\",\n    strokeWidth: 1.5\n  }, /*#__PURE__*/React.createElement(\"line\", {\n    x1: 15.1525604,\n    y1: 13.35081,\n    x2: 11.8391804,\n    y2: 10.0364296,\n    id: \"Path\"\n  }), /*#__PURE__*/React.createElement(\"line\", {\n    x1: 7.97357042,\n    y1: 6.17081958,\n    x2: 4.65919,\n    y2: 2.85743958,\n    id: \"Path\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8.75389542,0.324384583 L10.505625,2.07611417 C10.9368635,2.50774241 10.9368635,3.20713676 10.505625,3.638765 L5.487535,8.65585458 C4.41981785,9.72359699 4.41981785,11.4547226 5.487535,12.522465 C6.55527738,13.5901821 8.28640301,13.5901821 9.35414542,12.522465 L14.371235,7.504375 C14.8028633,7.07313649 15.5022576,7.07313649 15.9338858,7.504375 L17.6856154,9.25610458 C17.8936381,9.46269483 18.0106252,9.74375249 18.0106252,10.0369298 C18.0106252,10.3301071 17.8936381,10.6111648 17.6856154,10.817755 L12.6675254,15.835845 C9.76959655,18.7328702 5.07208391,18.7328702 2.174155,15.835845 C-0.722870151,12.9379161 -0.722870151,8.24040345 2.174155,5.34247458 L7.192245,0.324384583 C7.39883524,0.116361933 7.6798929,-0.000625150988 7.97307021,-0.000625150988 C8.26624751,-0.000625150988 8.54730517,0.116361933 8.75389542,0.324384583 Z\",\n    id: \"Path\"\n  })), /*#__PURE__*/React.createElement(\"polygon\", {\n    id: \"Path\",\n    points: \"-0.005 -0.005 24.005 -0.005 24.005 24.005 -0.005 24.005\"\n  }))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgMagneticAnnotation);\nexport default __webpack_public_path__ + \"static/media/MagneticAnnotation.eaf31360.svg\";\nexport { ForwardRef as ReactComponent };","var _g;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgObjectAnnotation(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Object selection\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Object-selection\",\n    stroke: \"none\",\n    strokeWidth: 1,\n    fill: \"none\",\n    fillRule: \"evenodd\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Group\",\n    transform: \"translate(-0.000000, -0.000000)\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    transform: \"translate(2.000000, 3.000000)\",\n    id: \"Path\",\n    stroke: \"#BABABA\",\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    strokeWidth: 1.5\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16.1970001,12.9320001 L16.1970001,12.9320001 L18.1730001,14.9080001 C18.6090001,15.3440001 18.6090001,16.0520001 18.1730001,16.4880001 L16.9870001,17.6740001 C16.5510001,18.1100001 15.8430001,18.1100001 15.4070001,17.6740001 L13.4310001,15.6980001 L11.9420001,17.1870001 C11.6480001,17.4810001 11.1480001,17.3630001 11.0170001,16.9690001 L8.14500004,8.35200005 C7.99900004,7.91500005 8.41500004,7.50000004 8.85200005,7.64500004 L17.4690001,10.5170001 C17.8630001,10.6480001 17.9810001,11.1480001 17.6870001,11.4420001 L16.1970001,12.9320001\"\n  }), /*#__PURE__*/React.createElement(\"line\", {\n    x1: 2.78000002,\n    y1: 7.93000005,\n    x2: 0.50000001,\n    y2: 7.93000005\n  }), /*#__PURE__*/React.createElement(\"line\", {\n    x1: 4.44000003,\n    y1: 3.94000003,\n    x2: 2.82000002,\n    y2: 2.32000002\n  }), /*#__PURE__*/React.createElement(\"line\", {\n    x1: 4.40000003,\n    y1: 11.9600001,\n    x2: 2.78000002,\n    y2: 13.5800001\n  }), /*#__PURE__*/React.createElement(\"line\", {\n    x1: 8.43000004,\n    y1: 2.28000002,\n    x2: 8.43000004,\n    y2: 1.25000099e-8\n  }), /*#__PURE__*/React.createElement(\"line\", {\n    x1: 12.4600001,\n    y1: 3.90000003,\n    x2: 14.0800001,\n    y2: 2.28000002\n  })), /*#__PURE__*/React.createElement(\"polygon\", {\n    id: \"Path\",\n    points: \"0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001\"\n  })))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgObjectAnnotation);\nexport default __webpack_public_path__ + \"static/media/ObjectAnnotation.64bf20e5.svg\";\nexport { ForwardRef as ReactComponent };","var _g;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgFreehandAnnotation(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Pen selection\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Pen-selection\",\n    stroke: \"none\",\n    strokeWidth: 1,\n    fill: \"none\",\n    fillRule: \"evenodd\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Group\",\n    transform: \"translate(-0.000000, -0.000000)\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    transform: \"translate(3.000000, 3.000000)\",\n    id: \"Path\",\n    stroke: \"#BABABA\",\n    strokeWidth: 1.5\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M14.3500001,1.196 L6.31300003,8.22800003 C5.44200002,8.99000004 5.39800002,10.329 6.21600003,11.147 L7.36500003,12.2960001 C8.18300003,13.1140001 9.52300004,13.0690001 10.284,12.1990001 L17.3160001,4.16200002 C18.0450001,3.33000001 18.0030001,2.07500001 17.2210001,1.29200001 C16.4380001,0.509000002 15.1830001,0.468000002 14.3500001,1.196 Z\"\n  }), /*#__PURE__*/React.createElement(\"line\", {\n    x1: 7.87000003,\n    y1: 6.87000003,\n    x2: 11.65,\n    y2: 10.65\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M0.599000002,17.3230001 L4.30200002,17.3230001 C7.28700003,17.3230001 8.78200004,13.7140001 6.67100003,11.603 C5.11900002,10.051 2.48300001,10.622 1.71300001,12.6770001 L0.191000001,16.7350001 C0.0850000004,17.0200001 0.295000001,17.3230001 0.599000002,17.3230001 Z\"\n  })), /*#__PURE__*/React.createElement(\"polygon\", {\n    id: \"Path\",\n    points: \"0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001\"\n  })))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgFreehandAnnotation);\nexport default __webpack_public_path__ + \"static/media/FreehandAnnotation.ce15dd27.svg\";\nexport { ForwardRef as ReactComponent };","var _g;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgPolygonalAnnotation(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Polygonal selection\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Polygonal-selection\",\n    stroke: \"none\",\n    strokeWidth: 1,\n    fill: \"none\",\n    fillRule: \"evenodd\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Group\",\n    transform: \"translate(-0.000000, -0.000000)\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10.922,3.63000002 L3.68100002,8.89100004 C3.03800001,9.35800004 2.77000001,10.185 3.01500001,10.941 L5.78100002,19.4540001 C6.02600003,20.2090001 6.73000003,20.7210001 7.52500003,20.7210001 L16.4760001,20.7210001 C17.2700001,20.7210001 17.9740001,20.2100001 18.2200001,19.4540001 L20.9860001,10.941 C21.2310001,10.186 20.9630001,9.35800004 20.3200001,8.89100004 L13.0780001,3.63000002 C12.4350001,3.16300001 11.565,3.16300001 10.922,3.63000002 L10.922,3.63000002 Z\",\n    id: \"Path\",\n    stroke: \"#BABABA\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }), /*#__PURE__*/React.createElement(\"polygon\", {\n    id: \"Path\",\n    points: \"0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001\"\n  })))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgPolygonalAnnotation);\nexport default __webpack_public_path__ + \"static/media/PolygonalAnnotation.a42ec225.svg\";\nexport { ForwardRef as ReactComponent };","var _g;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgQuickAnnotation(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Quick selection\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Quick-selection\",\n    stroke: \"none\",\n    strokeWidth: 1,\n    fill: \"none\",\n    fillRule: \"evenodd\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Group\",\n    transform: \"translate(-0.000000, -0.000000)\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    transform: \"translate(3.000000, 3.000000)\",\n    id: \"Path\",\n    stroke: \"#BABABA\",\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    strokeWidth: 1.5\n  }, /*#__PURE__*/React.createElement(\"polyline\", {\n    points: \"2.54200002 13.2190001 0.225000013 15.5370001 1.58200002 17.1480001 4.22900003 17.1480001 5.36900003 16.0500001\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8.00300005,14.8300001 L7.29600004,15.5370001 C6.51500004,16.3180001 5.24900003,16.3180001 4.46800003,15.5370001 L3.05400003,14.1230001 C2.27300002,13.3420001 2.27300002,12.0760001 3.05400003,11.2950001 L3.76100003,10.5880001\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M17.9940001,3.60700003 L14.9830001,0.596000015 C14.2380001,-0.148999988 13.0440001,-0.187999988 12.2520001,0.505000015 L3.95500003,7.76500004 C3.08400003,8.52700005 3.04000003,9.86600005 3.85800003,10.6840001 L7.90600005,14.7320001 C8.72400005,15.5500001 10.0640001,15.5050001 10.8250001,14.6350001 L18.0850001,6.33800004 C18.7780001,5.54600004 18.7380001,4.35200003 17.9940001,3.60700003 Z\"\n  })), /*#__PURE__*/React.createElement(\"polygon\", {\n    id: \"Path\",\n    points: \"0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001\"\n  })))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgQuickAnnotation);\nexport default __webpack_public_path__ + \"static/media/QuickAnnotation.92a60ac4.svg\";\nexport { ForwardRef as ReactComponent };","var _g;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgRadioChecked(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Radio checked\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Radio-checked\",\n    stroke: \"none\",\n    strokeWidth: 1,\n    fill: \"none\",\n    fillRule: \"evenodd\",\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Path\",\n    transform: \"translate(-0.000000, -0.000000)\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M18.3640001,18.3639401 C14.8492801,21.8786601 9.15080004,21.8786601 5.63610002,18.3639401 C2.12138001,14.8492201 2.12138001,9.15074004 5.63610002,5.63604002 C9.15082004,2.12132001 14.8493001,2.12132001 18.3640001,5.63604002 C21.8787201,9.15076004 21.8787201,14.8492401 18.3640001,18.3639401 Z\",\n    stroke: \"#323232\",\n    fill: \"#555555\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M14.8284001,14.8284201 C13.2663001,16.3905201 10.73364,16.3905201 9.17155004,14.8284201 C7.60945003,13.2663201 7.60945003,10.73366 9.17155004,9.17157004 C10.73365,7.60947003 13.2663101,7.60947003 14.8284001,9.17157004 C16.3905001,10.73367 16.3905001,13.2663301 14.8284001,14.8284201 Z\",\n    stroke: \"#B7B7B7\",\n    fill: \"#E5E5E5\"\n  })))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgRadioChecked);\nexport default __webpack_public_path__ + \"static/media/RadioChecked.247674a9.svg\";\nexport { ForwardRef as ReactComponent };","var _g;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgRadioUnchecked(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Radio unchecked\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Radio-unchecked\",\n    stroke: \"none\",\n    strokeWidth: 1,\n    fill: \"none\",\n    fillRule: \"evenodd\",\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Path\",\n    transform: \"translate(-0.000000, -0.000000)\",\n    fill: \"#555555\",\n    stroke: \"#323232\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M18.3640001,5.63604002 C21.8787201,9.15076004 21.8787201,14.8492401 18.3640001,18.3639401 C14.8492801,21.8786601 9.15080004,21.8786601 5.63610002,18.3639401 C2.12138001,14.8492201 2.12138001,9.15074004 5.63610002,5.63604002 C9.15082004,2.12132001 14.8493001,2.12132001 18.3640001,5.63604002\"\n  })))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgRadioUnchecked);\nexport default __webpack_public_path__ + \"static/media/RadioUnchecked.d9a75d6a.svg\";\nexport { ForwardRef as ReactComponent };","var _g;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgRectangularAnnotation(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Rectangular selection\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Rectangular-selection\",\n    stroke: \"none\",\n    strokeWidth: 1,\n    fill: \"none\",\n    fillRule: \"evenodd\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Group\",\n    transform: \"translate(-0.000000, -0.000000)\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M18.4170001,20.25 L5.58300002,20.25 C4.57000002,20.25 3.75000002,19.4290001 3.75000002,18.4170001 L3.75000002,5.58300002 C3.75000002,4.57000002 4.57100002,3.75000002 5.58300002,3.75000002 L18.4160001,3.75000002 C19.4290001,3.75000002 20.249001,4.57100002 20.249001,5.58300002 L20.249001,18.4160001 C20.25,19.4290001 19.4290001,20.25 18.4170001,20.25 Z\",\n    id: \"Path\",\n    stroke: \"#BABABA\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }), /*#__PURE__*/React.createElement(\"polygon\", {\n    id: \"Path\",\n    points: \"0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001\"\n  })))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgRectangularAnnotation);\nexport default __webpack_public_path__ + \"static/media/RectangularAnnotation.3cca93c1.svg\";\nexport { ForwardRef as ReactComponent };","var _g;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgSelection(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Pointer\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Pointer\",\n    stroke: \"none\",\n    strokeWidth: 1,\n    fill: \"none\",\n    fillRule: \"evenodd\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Path\",\n    transform: \"translate(-0.000000, -0.000000)\"\n  }, /*#__PURE__*/React.createElement(\"polygon\", {\n    points: \"0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M19.7110001,15.5010001 C20.1020001,15.8920001 20.1020001,16.5250001 19.7110001,16.9150001 L16.9160001,19.7100001 C16.5250001,20.1010001 15.8920001,20.1010001 15.5020001,19.7100001 L12.0000001,16.2080001 L9.90400004,18.3040001 C9.37800004,18.8300001 8.48300004,18.6180001 8.24800003,17.9130001 L4.04800002,5.31200002 C3.78700002,4.53100002 4.53100002,3.78700002 5.31300002,4.04800002 L17.9140001,8.24800003 C18.6190001,8.48300004 18.8310001,9.37800004 18.3050001,9.90400004 L16.2090001,11.999 L19.7110001,15.5010001 Z\",\n    stroke: \"#BABABA\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgSelection);\nexport default __webpack_public_path__ + \"static/media/Selection.4e4701f2.svg\";\nexport { ForwardRef as ReactComponent };","var _g;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgZoom(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Zoom\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Zoom\",\n    stroke: \"none\",\n    strokeWidth: 1,\n    fill: \"none\",\n    fillRule: \"evenodd\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Path\",\n    transform: \"translate(-0.000000, -0.000000)\"\n  }, /*#__PURE__*/React.createElement(\"polygon\", {\n    points: \"0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M14.1931001,5.58187002 C16.5249201,7.91369003 16.5249201,11.69432 14.1931001,14.0261401 C11.86128,16.3579601 8.08065003,16.3579601 5.74883002,14.0261401 C3.41701001,11.69432 3.41701001,7.91369003 5.74883002,5.58187002 C8.08065003,3.25005001 11.86128,3.25005001 14.1931001,5.58187002\",\n    stroke: \"#BABABA\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }), /*#__PURE__*/React.createElement(\"line\", {\n    x1: 14.1500001,\n    y1: 14.0600001,\n    x2: 20.0000001,\n    y2: 19.9900001,\n    stroke: \"#BABABA\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgZoom);\nexport default __webpack_public_path__ + \"static/media/Zoom.58f47de7.svg\";\nexport { ForwardRef as ReactComponent };","var _path;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgSun(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    height: 20,\n    width: 20,\n    viewBox: \"0 0 20 20\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"#fff\",\n    d: \"M9.305 1.667V3.75h1.389V1.667h-1.39zm-4.707 1.95l-.982.982L5.09 6.072l.982-.982-1.473-1.473zm10.802 0L13.927 5.09l.982.982 1.473-1.473-.982-.982zM10 5.139a4.872 4.872 0 00-4.862 4.86A4.872 4.872 0 0010 14.862 4.872 4.872 0 0014.86 10 4.872 4.872 0 0010 5.139zm0 1.389A3.462 3.462 0 0113.471 10a3.462 3.462 0 01-3.473 3.472A3.462 3.462 0 016.527 10 3.462 3.462 0 0110 6.528zM1.665 9.305v1.39h2.083v-1.39H1.666zm14.583 0v1.39h2.084v-1.39h-2.084zM5.09 13.928L3.616 15.4l.982.982 1.473-1.473-.982-.982zm9.82 0l-.982.982 1.473 1.473.982-.982-1.473-1.473zM9.305 16.25v2.083h1.389V16.25h-1.39z\"\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgSun);\nexport default __webpack_public_path__ + \"static/media/Sun.81cb4cfc.svg\";\nexport { ForwardRef as ReactComponent };","var _path;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgMoon(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    height: 20,\n    width: 20,\n    viewBox: \"0 0 20 20\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"#fff\",\n    d: \"M4.2 2.5l-.7 1.8-1.8.7 1.8.7.7 1.8.6-1.8L6.7 5l-1.9-.7-.6-1.8zm15 8.3a6.7 6.7 0 11-6.6-6.6 5.8 5.8 0 006.6 6.6z\"\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgMoon);\nexport default __webpack_public_path__ + \"static/media/Moon.593035e9.svg\";\nexport { ForwardRef as ReactComponent };","import { HelpWindowToolTitle } from \"../HelpDialog/HelpWindowToolTitle\";\nimport {\n  ColorAdjustmentIcon,\n  ColorSelectionIcon,\n  EllipticalSelectionIcon,\n  HandIcon,\n  LassoSelectionIcon,\n  MagneticSelectionIcon,\n  PenSelectionIcon,\n  PolygonalSelectionIcon,\n  QuickSelectionIcon,\n  RectangularSelectionIcon,\n  SelectionIcon,\n  ZoomIcon,\n} from \"../../../../icons\";\nimport Typography from \"@mui/material/Typography\";\nimport { Box } from \"@mui/material\";\nimport React from \"react\";\nimport Divider from \"@mui/material/Divider\";\n\nexport const ManipulatingCanvasContent = () => {\n  return (\n    <>\n      <br />\n      <HelpWindowToolTitle toolName={\"Hand tool\"} letter={\"H\"}>\n        <HandIcon />\n      </HelpWindowToolTitle>\n      <Typography>\n        Hold and drag to pan the image in the canvas. Click on \"Reset position\"\n        to center the image back onto the canvas.\n      </Typography>\n      <br />\n      <Divider />\n      <br />\n      <HelpWindowToolTitle toolName={\"Zoom tool\"} letter={\"Z\"}>\n        <ZoomIcon />\n      </HelpWindowToolTitle>\n      <Typography>\n        Use the zoom slider or your mouse wheel to zoom in or out of the image.\n        Alternatively, click on the image to zoom in or out (select the desired\n        zooming mode first).\n      </Typography>\n      <br />\n      <Typography>\n        To zoom in a particular region of the image, use your mouse to select\n        the rectangular region in which you would like to zoom in. Release the\n        mouse to zoom in the selected region.\n      </Typography>\n      <br />\n      <Divider />\n      <br />\n      <HelpWindowToolTitle toolName={\"Color adjustment\"} letter={\"I\"}>\n        <ColorAdjustmentIcon />\n      </HelpWindowToolTitle>\n      <Typography>\n        Filter each color channel by setting new minimum and maximum for each\n        color channel. Untoggle a channel box to disable the channel. Click on\n        \"Reset\" to reset the intensities to their original values.\n      </Typography>\n      <br />\n    </>\n  );\n};\n\nexport const OpeningImagesHelpContent = () => {\n  return (\n    <>\n      <br />\n      <Typography>\n        <Box fontWeight=\"fontWeightBold\">{\"Opening images\"}</Box>\n      </Typography>\n      <Typography>\n        In the left menu, select \"Open new image\" to select one or multiple\n        image files to open.\n      </Typography>\n      <br />\n      <Typography>\n        Alternatively, drag and drop the desired image files directly onto the\n        canvas.\n      </Typography>\n      <br />\n      <Typography>\n        Note that we currently only support 1-channel (grayscale) or 3-channel\n        2D images. We do not support multi-dimensional images.\n      </Typography>\n      <br />\n      <Divider />\n      <br />\n      <Typography>\n        <Box fontWeight=\"fontWeightBold\">{\"Deleting images\"}</Box>\n      </Typography>\n      <Typography>\n        Images can be deleted from the workspace at any time by selecting\n        \"Delete image\" on the menu options next to the image thumbnail.\n      </Typography>\n      <br />\n      <Divider />\n      <br />\n      <Typography>\n        <Box fontWeight=\"fontWeightBold\">{\"Example pre-annotated images\"}</Box>\n      </Typography>\n      <Typography>\n        Take a look at our pre-annotated images by clicking \"Open example image\"\n        and selecting the image of choice!\n      </Typography>\n      <br />\n    </>\n  );\n};\n\nexport const CreatingCategoriesContent = () => {\n  return (\n    <>\n      <br />\n      <Typography>\n        <Box fontWeight=\"fontWeightBold\">{\" Creating a new category\"}</Box>\n      </Typography>\n      <Typography>\n        Create a new category by clicking on the \"Create category\" button. Once\n        a category is created, its name and color can be changed at any time by\n        selecting its \"Edit category\" menu on theego right of the catry icon.\n      </Typography>\n      <br />\n      <Divider />\n      <br />\n      <Typography>\n        <Box fontWeight=\"fontWeightBold\">\n          {\" Changing the category of an annotation\"}\n        </Box>\n      </Typography>\n      <Typography>\n        To change the category of an annotation, first select the annotation(s)\n        to be changed and click on the desired new category button in the left\n        toolbar. If the desired category does not exist, click \"Create category\"\n        to make a new category.\n      </Typography>\n      <br />\n      <Typography>\n        Make sure to press the \"Enter\" key to save the selected annotations with\n        the new category assigned.\n      </Typography>\n    </>\n  );\n};\n\nexport const MakingNewAnnotationsHelpContent = () => {\n  return (\n    <>\n      <br />\n      <Typography>\n        All annotation tools are accessed from the toolbar to the right of the\n        canvas or by using their keyboard key shortcut.\n      </Typography>\n      <br />\n      <Typography>\n        Once you an annotation is completed, press \"Enter\" on your keyboard or\n        click on \"confirm\".\n      </Typography>\n      <br />\n      <div>\n        <Typography>\n          To undo an unconfirmed annotation, press \"Escape\" on your keyboard or\n          click on \"cancel\".\n        </Typography>\n      </div>\n      <br />\n      <Divider />\n      <br />\n      <HelpWindowToolTitle toolName={\"Rectangular annotation\"} letter={\"R\"}>\n        <RectangularSelectionIcon />\n      </HelpWindowToolTitle>\n      <Typography>\n        Click and drag to start drawing a rectangular annotation (bounding box).\n        Release to close the annotation.\n      </Typography>\n      <br />\n      <Divider />\n      <br />\n      <HelpWindowToolTitle toolName={\"Elliptical annotation\"} letter={\"E\"}>\n        <EllipticalSelectionIcon />\n      </HelpWindowToolTitle>\n      <Typography>\n        Click and drag to start drawing an elliptical annotation. Release to\n        close the annotation.\n      </Typography>\n      <br />\n      <Divider />\n      <br />\n      <HelpWindowToolTitle toolName={\"Pen annotation\"} letter={\"D\"}>\n        <PenSelectionIcon />\n      </HelpWindowToolTitle>\n      <Typography>\n        Select desired brush size using the brush size slider. Draw over pixels\n        by clicking and dragging over the desired area. Release to close the\n        annotation.\n      </Typography>\n      <br />\n      <Divider />\n      <br />\n      <HelpWindowToolTitle toolName={\"Lasso annotation\"} letter={\"L\"}>\n        <LassoSelectionIcon />\n      </HelpWindowToolTitle>\n      <Typography>\n        Click and drag cursor around the desired region. Release to\n        automatically close the lasso annotation.\n      </Typography>\n      <br />\n      <Divider />\n      <br />\n      <HelpWindowToolTitle toolName={\"Polygonal annotation\"} letter={\"P\"}>\n        <PolygonalSelectionIcon />\n      </HelpWindowToolTitle>\n      <Typography>\n        Click and release to create new anchor points. Close the polygonal\n        annotation either by clicking on its origin point or by hitting enter on\n        your keyboard.\n      </Typography>\n      <br />\n      <Divider />\n      <br />\n      <HelpWindowToolTitle toolName={\"Magnetic annotation\"} letter={\"M\"}>\n        <MagneticSelectionIcon />\n      </HelpWindowToolTitle>\n      <Typography>\n        Click and release to create new anchor points. The tool will\n        automatically snap onto the edges of an object. Close the magnetic\n        annotation by clicking on its origin point.\n      </Typography>\n      <br />\n      <Divider />\n      <br />\n      <HelpWindowToolTitle toolName={\"Color annotation\"} letter={\"C\"}>\n        <ColorSelectionIcon />\n      </HelpWindowToolTitle>\n      <Typography>\n        Click on a pixel with the color of interest, hold and drag outwards to\n        select a region of similar color intensities near the point. Release to\n        finish the annotation.\n      </Typography>\n      <br />\n      <Divider />\n      <br />\n      <HelpWindowToolTitle toolName={\"Quick annotation\"} letter={\"Q\"}>\n        <QuickSelectionIcon />\n      </HelpWindowToolTitle>\n      <Typography>\n        Click and drag to select a region of superpixels. Release to finish the\n        annotation.\n      </Typography>\n      <br />\n    </>\n  );\n};\n\nexport const ChangingAnnotationsHelpContent = () => {\n  return (\n    <>\n      <br />\n      <HelpWindowToolTitle toolName={\"Select tool\"} letter={\"S\"}>\n        <SelectionIcon />\n      </HelpWindowToolTitle>\n      <Typography>\n        Use the Select tool to select annotations. Click on a desired annotation\n        to select it, and hold shift while clicking other annotations to select\n        multiple annotations. Alternatively, draw a rectangular box around\n        multiple annotations to select multiple annotations at once.\n      </Typography>\n      <br />\n      <Typography>\n        Click on \"Select all\" in the Selection tool menu to select all existing\n        annotations. To select/unselect annotations of a specific category,\n        toggle/untoggle the corresponding category in the Selection tool menu.\n      </Typography>\n      <br />\n      <Typography>\n        In the case of overlapping annotations, repeatedly click on the\n        intersecting region of the overlapping annotations until the desired\n        annotation is selected.\n      </Typography>\n      <br />\n      <Typography>\n        Press the \"Escape\" key to undo changes or to unselect annotations.\n      </Typography>\n      <br />\n\n      <Typography>\n        Press the \"Enter\" key to confirm changes to a selected annotation.\n      </Typography>\n      <br />\n      <Divider />\n      <br />\n      <Typography>\n        <Box fontWeight=\"fontWeightBold\">{\"Resizing an annotation\"}</Box>\n      </Typography>\n      <Typography>\n        Once an annotation is selected, use the anchor points of the bouding box\n        to resize it.\n      </Typography>\n      <br />\n      <Divider />\n      <br />\n      <Typography>\n        <Box fontWeight=\"fontWeightBold\">{\"Adding area to an annotation\"}</Box>\n      </Typography>\n      <Typography>\n        Select the annotation tool to use to add an area and select the \"add\n        area\" selection mode. Draw on the selected annotation with the\n        annotation tool to combine areas together.\n      </Typography>\n      <br />\n      <Divider />\n      <br />\n      <Typography>\n        <Box fontWeight=\"fontWeightBold\">\n          {\"Subtracting an area from an annotation\"}\n        </Box>\n      </Typography>\n      <Typography>\n        Select the annotation tool to use to subtract an area and select the\n        \"subtract area\" selection mode. Draw on the selected annotation with the\n        annotation tool to subtract an area from the selected annotation.\n      </Typography>\n      <br />\n      <Divider />\n      <br />\n      <Typography>\n        <Box fontWeight=\"fontWeightBold\">\n          {\"Intersection of two annotations\"}\n        </Box>\n      </Typography>\n      <Typography>\n        Select the annotation tool to use to use for the intersection operation\n        and select the \"intersect\" selection mode. Draw on the selected\n        annotation with the annotation tool and release to obtain the\n        intersection of the two annotations.\n      </Typography>\n      <br />\n      <Divider />\n      <br />\n      <Typography>\n        <Box fontWeight=\"fontWeightBold\">{\"Deleting selected annotations\"}</Box>\n      </Typography>\n      <Typography>\n        First, use the Select tool to select annotations. To delete one or more\n        selected annotations, press the Delete key or click on \"Clear selected\n        annotations\" in the left toolbar.\n      </Typography>\n      <br />\n      <Divider />\n      <br />\n      <Typography>\n        <Box fontWeight=\"fontWeightBold\">\n          {\"  Deleting all annotations for a single image\"}\n        </Box>\n      </Typography>\n      <Typography>\n        To clear annotations of a particular image, click on the menu to the\n        right of the image thumbnail and select \"Clear annotations.\"\n      </Typography>\n      <br />\n      <Divider />\n      <br />\n      <Typography>\n        <Box fontWeight=\"fontWeightBold\">{\"Deleting all annotations\"}</Box>\n      </Typography>\n      <Typography>\n        Delete all annotations by clicking \"Clear all annotations\" in the left\n        toolbar. WARNING: This will delete all annotations across all images\n        loaded, not just the active image.\n      </Typography>\n      <br />\n    </>\n  );\n};\n\nexport const SavingProjectHelpContent = () => {\n  return (\n    <>\n      <br />\n      <Typography>\n        <Box fontWeight=\"fontWeightBold\">{\"Saving a project\"}</Box>\n      </Typography>\n      <Typography>\n        Save all images and their annotations by clicking on \"Save project file\"\n        in the Save menu on the left toolbar. This will download a .json file\n        that encodes the image data and their annotations.\n      </Typography>\n      <br />\n      <Divider />\n      <br />\n      <Typography>\n        <Box fontWeight=\"fontWeightBold\">{\"Opening a saved project\"}</Box>\n      </Typography>\n      <Typography>\n        To open a saved project and make new annotations or change annotations,\n        Click \"Open project file\" in the Open menu on the left toolbar. Select\n        the .json file that was downloaded when saving an earlier project.\n      </Typography>\n      <br />\n      <Divider />\n      <br />\n      <Typography>\n        <Box fontWeight=\"fontWeightBold\">{\"Exporting annotations\"}</Box>\n      </Typography>\n      <Typography>\n        To export all annotations simultaneously across all images, use the Save\n        menu on the left toolbar. Otherwise, to export annotations of a single\n        image, click on the corresponding image's submenu to export its\n        annotations.\n      </Typography>\n      <br />\n      <Typography>\n        Annotations can be exported as color-labeled instance segmentation masks\n        (a single image contains all instances labeled by different colors),\n        binary instance segmentation masks (a single image contains a single\n        instance), color-labeled semantic segmentation masks (a single image\n        contains all categories labeled by different colors), binary semantic\n        segmentation masks (a single image contains a single category with its\n        corresponding instances), or label matrices (a single image contains all\n        instances labeled by an integer).\n      </Typography>\n    </>\n  );\n};\n","import React from \"react\";\nimport Drawer from \"@mui/material/Drawer\";\nimport CloseIcon from \"@mui/icons-material/Close\";\n\nimport { CollapsibleHelpContent } from \"./CollapsibleHelpContent\";\nimport { IconButton } from \"@mui/material\";\nimport {\n  ChangingAnnotationsHelpContent,\n  CreatingCategoriesContent,\n  MakingNewAnnotationsHelpContent,\n  ManipulatingCanvasContent,\n  OpeningImagesHelpContent,\n  SavingProjectHelpContent,\n} from \"../HelpContent/HelpContent\";\nimport Container from \"@mui/material/Container\";\nimport ListItem from \"@mui/material/ListItem\";\nimport ListItemIcon from \"@mui/material/ListItemIcon\";\nimport HelpIcon from \"@mui/icons-material/Help\";\nimport ListItemText from \"@mui/material/ListItemText\";\n\nexport default function HelpDrawer() {\n  const [state, setState] = React.useState({\n    top: false,\n    left: false,\n    bottom: false,\n    right: false,\n  });\n\n  const toggleDrawer =\n    (anchor: string, open: boolean) =>\n    (event: React.KeyboardEvent | React.MouseEvent) => {\n      if (\n        event.type === \"keydown\" &&\n        ((event as React.KeyboardEvent).key === \"Tab\" ||\n          (event as React.KeyboardEvent).key === \"Shift\")\n      ) {\n        return;\n      }\n\n      setState({ ...state, [anchor]: open });\n    };\n\n  return (\n    <div key={\"left\"}>\n      <ListItem button onClick={toggleDrawer(\"left\", true)}>\n        <ListItemIcon>\n          <HelpIcon />\n        </ListItemIcon>\n\n        <ListItemText primary=\"Help\" />\n      </ListItem>\n\n      <Drawer\n        variant={\"persistent\"}\n        anchor={\"left\"}\n        sx={(theme) => ({\n          width: theme.spacing(35),\n          flexShrink: 0,\n          \"& > .MuiDrawer-paper\": {\n            width: theme.spacing(35),\n          },\n        })}\n        open={state[\"left\"]}\n        onClose={toggleDrawer(\"left\", false)}\n      >\n        <div tabIndex={1} role=\"button\">\n          <IconButton\n            style={{ float: \"right\", marginRight: \"20px\" }}\n            onClick={toggleDrawer(\"left\", false)}\n          >\n            <CloseIcon />\n          </IconButton>\n        </div>\n        <CollapsibleHelpContent\n          primary={\"Opening images\"}\n          closed={false}\n          dense={true}\n        >\n          <Container>\n            <OpeningImagesHelpContent />\n          </Container>\n        </CollapsibleHelpContent>\n        <CollapsibleHelpContent\n          primary={\"Manipulating the canvas\"}\n          closed={false}\n          dense={true}\n        >\n          <Container>\n            <ManipulatingCanvasContent />\n          </Container>\n        </CollapsibleHelpContent>\n        <CollapsibleHelpContent\n          primary={\"Creating categories\"}\n          closed={false}\n          dense={true}\n        >\n          <Container>\n            <CreatingCategoriesContent />\n          </Container>\n        </CollapsibleHelpContent>\n        <CollapsibleHelpContent\n          primary={\"Making new annotations\"}\n          closed={false}\n          dense={true}\n        >\n          <Container>\n            <MakingNewAnnotationsHelpContent />\n          </Container>\n        </CollapsibleHelpContent>\n        <CollapsibleHelpContent\n          primary={\"Changing existing annotations\"}\n          closed={false}\n          dense={true}\n        >\n          <Container>\n            <ChangingAnnotationsHelpContent />\n          </Container>\n        </CollapsibleHelpContent>\n        <CollapsibleHelpContent\n          primary={\"Saving project and exporting annotations\"}\n          closed={false}\n          dense={true}\n        >\n          <Container>\n            <SavingProjectHelpContent />\n          </Container>\n        </CollapsibleHelpContent>\n      </Drawer>\n    </div>\n  );\n}\n","import React from \"react\";\nimport Dialog from \"@mui/material/Dialog\";\nimport DialogTitle from \"@mui/material/DialogTitle\";\nimport DialogContent from \"@mui/material/DialogContent\";\nimport DialogActions from \"@mui/material/DialogActions\";\nimport Button from \"@mui/material/Button\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { imageViewerSlice } from \"../../../../store/slices\";\nimport { selectedCategorySelector } from \"../../../../store/selectors\";\n\ntype ClearCategoryDialogProps = {\n  onClose: () => void;\n  open: boolean;\n};\n\nexport const ClearCategoryDialog = ({\n  onClose,\n  open,\n}: ClearCategoryDialogProps) => {\n  const dispatch = useDispatch();\n\n  const category = useSelector(selectedCategorySelector);\n\n  const onClear = () => {\n    dispatch(\n      imageViewerSlice.actions.clearCategoryAnnotations({ category: category })\n    );\n\n    onClose();\n  };\n\n  return (\n    <Dialog fullWidth onClose={onClose} open={open}>\n      <DialogTitle>Clear \"{category.name}\" annotations?</DialogTitle>\n\n      <DialogContent>\n        Annotations categorized as \"{category.name}\" will be deleted\".\n      </DialogContent>\n\n      <DialogActions>\n        <Button onClick={onClose} color=\"primary\">\n          Cancel\n        </Button>\n\n        <Button onClick={onClear} color=\"primary\">\n          Delete\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n","var _g;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgInvertAnnotation(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Invert\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Invert\",\n    stroke: \"none\",\n    strokeWidth: 1,\n    fill: \"none\",\n    fillRule: \"evenodd\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"InvertAnnotation\"\n  }, /*#__PURE__*/React.createElement(\"polygon\", {\n    id: \"Path\",\n    points: \"0 0 24 0 24 24 0 24\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M15,21 L4,21 C3.448,21 3,20.552 3,20 L3,9 C3,8.448 3.448,8 4,8 L15,8 C15.552,8 16,8.448 16,9 L16,20 C16,20.552 15.552,21 15,21 Z\",\n    id: \"Path\",\n    stroke: \"#BABABA\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M21,5 L21,4 C21,3.448 20.552,3 20,3 L19,3\",\n    id: \"Path\",\n    stroke: \"#BABABA\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M21,15 L21,16 C21,16.552 20.552,17 20,17 L19,17\",\n    id: \"Path\",\n    stroke: \"#BABABA\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M7,5 L7,4 C7,3.448 7.448,3 8,3 L9,3\",\n    id: \"Path\",\n    stroke: \"#BABABA\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }), /*#__PURE__*/React.createElement(\"line\", {\n    x1: 13,\n    y1: 3,\n    x2: 15,\n    y2: 3,\n    id: \"Path\",\n    stroke: \"#BABABA\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }), /*#__PURE__*/React.createElement(\"polygon\", {\n    id: \"Path\",\n    stroke: \"#BABABA\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    points: \"21 11 21 9 21 9 21 9\"\n  })))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgInvertAnnotation);\nexport default __webpack_public_path__ + \"static/media/InvertAnnotation.ec8719eb.svg\";\nexport { ForwardRef as ReactComponent };","import { Category } from \"../../types/Category\";\nimport { sortBy } from \"lodash\";\nimport { ImageViewer } from \"../../types/ImageViewer\";\n\nexport const createdAnnotatorCategoriesSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}) => {\n  const categories = imageViewer.categories.filter((category: Category) => {\n    return category.id !== \"00000000-0000-0000-0000-000000000000\";\n  });\n\n  return sortBy(categories, \"name\");\n};\n","import React from \"react\";\nimport Dialog from \"@mui/material/Dialog\";\nimport DialogTitle from \"@mui/material/DialogTitle\";\nimport DialogContent from \"@mui/material/DialogContent\";\nimport DialogActions from \"@mui/material/DialogActions\";\nimport Button from \"@mui/material/Button\";\n\ntype ExitAnnotatorDialogProps = {\n  onConfirm: () => void;\n  onClose: () => void;\n  open: boolean;\n};\n\nexport const ExitAnnotatorDialog = ({\n  onConfirm,\n  onClose,\n  open,\n}: ExitAnnotatorDialogProps) => {\n  return (\n    <Dialog fullWidth onClose={onClose} open={open}>\n      <DialogTitle>Save annotations?</DialogTitle>\n\n      <DialogContent>\n        Would you like to save these annotations and return to the project page?\n        These annotations will be used for training.\n      </DialogContent>\n\n      <DialogActions>\n        <Button onClick={onClose} color=\"primary\">\n          Stay on this page\n        </Button>\n\n        <Button onClick={onConfirm} color=\"primary\">\n          Save annotations and return to project\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n","import Drawer from \"@mui/material/Drawer\";\nimport ListItem from \"@mui/material/ListItem\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport React, { useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { Category, UNKNOWN_CATEGORY_ID } from \"../../../../types/Category\";\nimport {\n  categoryCountsSelector,\n  imageSelector,\n  selectedCategorySelector,\n  selectedImagesSelector,\n  unknownCategorySelector,\n} from \"../../../../store/selectors\";\nimport { batch, useDispatch, useSelector } from \"react-redux\";\nimport { CollapsibleList } from \"../CollapsibleList\";\nimport { CategoryListItemCheckbox } from \"../CategoryListItemCheckbox\";\nimport ListItemSecondaryAction from \"@mui/material/ListItemSecondaryAction\";\nimport IconButton from \"@mui/material/IconButton\";\nimport MoreHorizIcon from \"@mui/icons-material/MoreHoriz\";\nimport { CategoryMenu } from \"../CategoryMenu\";\nimport { DeleteCategoryDialog } from \"../DeleteCategoryDialog\";\nimport { EditCategoryDialog } from \"../../CategoryDialog/EditCategoryDialog\";\nimport { useDialog } from \"../../../../hooks\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\nimport {\n  Chip,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  Divider,\n  TextField,\n  Tooltip,\n} from \"@mui/material\";\nimport List from \"@mui/material/List\";\nimport DeleteIcon from \"@mui/icons-material/Delete\";\nimport ListItemIcon from \"@mui/material/ListItemIcon\";\nimport FolderOpenIcon from \"@mui/icons-material/FolderOpen\";\nimport SaveIcon from \"@mui/icons-material/Save\";\nimport Typography from \"@mui/material/Typography\";\nimport Toolbar from \"@mui/material/Toolbar\";\nimport Button from \"@mui/material/Button\";\nimport AppBar from \"@mui/material/AppBar\";\nimport PopupState, { bindTrigger } from \"material-ui-popup-state\";\nimport SettingsIcon from \"@mui/icons-material/Settings\";\nimport FeedbackIcon from \"@mui/icons-material/Feedback\";\nimport { SettingsDialog } from \"../../SettingsDialog\";\nimport AddIcon from \"@mui/icons-material/Add\";\nimport { CreateCategoryDialog } from \"../../CategoryDialog/CreateCategoryDialog\";\nimport { selectedAnnotationsIdsSelector } from \"../../../../store/selectors/selectedAnnotationsIdsSelector\";\nimport ListItemAvatar from \"@mui/material/ListItemAvatar\";\nimport Avatar from \"@mui/material/Avatar\";\nimport { imagesSelector } from \"../../../../store/selectors/imagesSelector\";\nimport { ImageMenu } from \"../ImageMenu\";\nimport { DeleteAllAnnotationsDialog } from \"../DeleteAllAnnotationsDialog\";\nimport { SaveMenu } from \"../SaveMenu/SaveMenu\";\nimport { OpenMenu } from \"../OpenMenu/OpenMenu\";\nimport HelpDrawer from \"../../Help/HelpDrawer/HelpDrawer\";\nimport { ClearCategoryDialog } from \"../ClearCategoryDialog\";\nimport {\n  imageViewerSlice,\n  projectSlice,\n  setActiveImage,\n} from \"../../../../store/slices\";\nimport { Image } from \"../../../../types/Image\";\nimport { ArrowBack } from \"@mui/icons-material\";\nimport { annotatorImagesSelector } from \"../../../../store/selectors/annotatorImagesSelector\";\nimport { createdAnnotatorCategoriesSelector } from \"../../../../store/selectors/createdAnnotatorCategoriesSelector\";\nimport { Partition } from \"../../../../types/Partition\";\nimport { ExitAnnotatorDialog } from \"../ExitAnnotatorDialog\";\nimport { AppBarOffset } from \"components/styled/AppBarOffset\";\n\nexport const CategoriesList = () => {\n  const createdCategories = useSelector(createdAnnotatorCategoriesSelector);\n  const selectedCategory = useSelector(selectedCategorySelector);\n  const unknownCategory = useSelector(unknownCategorySelector);\n\n  const selectedAnnotationsIds = useSelector(selectedAnnotationsIdsSelector);\n\n  const categoryCounts = useSelector(categoryCountsSelector);\n\n  const annotatorImages = useSelector(annotatorImagesSelector);\n  const projectImages = useSelector(imagesSelector);\n  const selectedImages = useSelector(selectedImagesSelector);\n\n  const currentImage = useSelector(imageSelector);\n\n  const dispatch = useDispatch();\n\n  const navigate = useNavigate();\n\n  const {\n    onClose: onCloseDeleteCategoryDialog,\n    onOpen: onOpenDeleteCategoryDialog,\n    open: openDeleteCategoryDialog,\n  } = useDialog();\n\n  const {\n    onClose: onCloseEditCategoryDialog,\n    onOpen: onOpenEditCategoryDialog,\n    open: openEditCategoryDialog,\n  } = useDialog();\n\n  const {\n    onClose: onCloseClearCategoryDialog,\n    onOpen: onOpenClearCategoryDialog,\n    open: openClearCategoryDialog,\n  } = useDialog();\n\n  const {\n    onClose: onCloseDeleteAllAnnotationsDialog,\n    onOpen: onOpenDeleteAllAnnotationsDialog,\n    open: openDeleteAllAnnotationsDialog,\n  } = useDialog();\n\n  const {\n    onClose: onCloseExitAnnotatorDialog,\n    onOpen: onOpenExitAnnotatorDialog,\n    open: openExitAnnotatorDialog,\n  } = useDialog();\n\n  const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\n\n  const [imageAnchorEl, setImageAnchorEl] = React.useState<null | HTMLElement>(\n    null\n  );\n\n  /*\n  When going back to project, replace images with those that have updated annotations\n   */\n  const onCloseDialog = () => {\n    const unselectedImages = projectImages.filter((image: Image) => {\n      return !selectedImages.includes(image.id);\n    });\n\n    //We update partition to TRAINING for the annotated images\n    const updatedAnnotatorImages = annotatorImages.map((image: Image) => {\n      let partition: Partition;\n      if (image.annotations.length > 0) {\n        //only update if image actually has annotations\n        partition = Partition.Training;\n      } else {\n        partition = Partition.Inference;\n      }\n      return { ...image, partition: partition };\n    });\n\n    dispatch(\n      projectSlice.actions.setImages({\n        images: [...updatedAnnotatorImages, ...unselectedImages],\n      })\n    );\n\n    onCloseExitAnnotatorDialog();\n    navigate(\"/\");\n  };\n\n  const onCategoryClick = (\n    event: React.MouseEvent<HTMLDivElement>,\n    category: Category\n  ) => {\n    dispatch(\n      imageViewerSlice.actions.setSelectedCategoryId({\n        selectedCategoryId: category.id,\n      })\n    );\n  };\n\n  const onCategoryMenuOpen = (\n    event: React.MouseEvent<HTMLButtonElement>,\n    category: Category\n  ) => {\n    dispatch(\n      imageViewerSlice.actions.setSelectedCategoryId({\n        selectedCategoryId: category.id,\n      })\n    );\n    setAnchorEl(event.currentTarget);\n  };\n\n  const onCategoryMenuClose = () => {\n    setAnchorEl(null);\n  };\n\n  const onImageMenuOpen = (\n    event: React.MouseEvent<HTMLButtonElement>,\n    image: Image\n  ) => {\n    onImageItemClick(event, image);\n    setImageAnchorEl(event.currentTarget);\n  };\n\n  const onImageMenuClose = () => {\n    setImageAnchorEl(null);\n  };\n\n  const onClearAllAnnotations = () => {\n    const existingAnnotations = annotatorImages\n      .map((image: Image) => {\n        return [...image.annotations];\n      })\n      .flat();\n    if (existingAnnotations.length) {\n      onOpenDeleteAllAnnotationsDialog();\n    }\n  };\n\n  const onClearSelectedAnnotations = () => {\n    if (!selectedAnnotationsIds) return;\n    batch(() => {\n      dispatch(\n        imageViewerSlice.actions.deleteImageInstances({\n          ids: selectedAnnotationsIds,\n        })\n      );\n      dispatch(\n        imageViewerSlice.actions.setSelectedCategoryId({\n          selectedCategoryId: UNKNOWN_CATEGORY_ID,\n        })\n      );\n      dispatch(\n        imageViewerSlice.actions.setSelectedAnnotations({\n          selectedAnnotations: [],\n          selectedAnnotation: undefined,\n        })\n      );\n    });\n  };\n\n  const onImageItemClick = (\n    evt: React.MouseEvent<HTMLDivElement | HTMLButtonElement, MouseEvent>,\n    image: Image\n  ) => {\n    batch(() => {\n      dispatch(setActiveImage({ image: image.id }));\n\n      dispatch(\n        imageViewerSlice.actions.setSelectedAnnotations({\n          selectedAnnotations: [],\n          selectedAnnotation: undefined,\n        })\n      );\n    });\n  };\n\n  const t = useTranslation();\n\n  return (\n    <Drawer\n      anchor=\"left\"\n      sx={{\n        flexShrink: 0,\n        width: (theme) => theme.spacing(32),\n        \"& > .MuiDrawer-paper\": {\n          width: (theme) => theme.spacing(32),\n          zIndex: 0,\n        },\n      }}\n      open\n      variant=\"persistent\"\n    >\n      <AppBar\n        color=\"default\"\n        sx={{\n          backgroundColor: \"rgba(0, 0, 0, 0)\",\n          // borderBottom: \"1px solid rgba(0, 0, 0, 0.12)\",\n          boxShadow: \"none\",\n          position: \"absolute\",\n        }}\n      >\n        <Toolbar>\n          <Tooltip title=\"Save and return to project\" placement=\"bottom\">\n            <IconButton\n              edge=\"start\"\n              onClick={onOpenExitAnnotatorDialog}\n              aria-label=\"Exit Annotator\"\n              href={\"\"}\n            >\n              <ArrowBack />\n            </IconButton>\n          </Tooltip>\n          <Typography variant=\"h6\" color=\"inherit\">\n            Piximi Annotator\n          </Typography>\n        </Toolbar>\n      </AppBar>\n\n      <AppBarOffset />\n\n      <ExitAnnotatorDialog\n        onConfirm={onCloseDialog}\n        onClose={onCloseExitAnnotatorDialog}\n        open={openExitAnnotatorDialog}\n      />\n\n      <Divider />\n\n      <List dense>\n        <OpenListItem />\n        <SaveListItem />\n      </List>\n\n      <Divider />\n\n      <CollapsibleList closed dense primary={t(\"Images\")}>\n        {annotatorImages.map((image: Image) => {\n          return (\n            <div key={image.id}>\n              <ListItem\n                button\n                id={image.id}\n                onClick={(evt: React.MouseEvent<HTMLDivElement, MouseEvent>) =>\n                  onImageItemClick(evt, image)\n                }\n                selected={image.id === currentImage?.id}\n              >\n                <ListItemAvatar>\n                  <Avatar\n                    alt={image.name}\n                    src={image.originalSrc[Math.floor(image.shape.planes / 2)]}\n                    variant={\"square\"}\n                  />\n                </ListItemAvatar>\n                <ListItemText\n                  id={image.id}\n                  primary={image.name}\n                  primaryTypographyProps={{ noWrap: true }}\n                />\n                {image.annotations.length !== 0 && (\n                  <Chip label={image.annotations.length} size=\"small\" />\n                )}\n                <ListItemSecondaryAction>\n                  <IconButton\n                    edge=\"end\"\n                    onClick={(event) => onImageMenuOpen(event, image)}\n                  >\n                    <MoreHorizIcon />\n                  </IconButton>\n                </ListItemSecondaryAction>\n              </ListItem>\n            </div>\n          );\n        })}\n        <ImageMenu\n          anchorElImageMenu={imageAnchorEl}\n          onCloseImageMenu={onImageMenuClose}\n          openImageMenu={Boolean(imageAnchorEl)}\n        />\n      </CollapsibleList>\n\n      <Divider />\n\n      <CollapsibleList closed dense primary={t(\"Categories\")}>\n        {createdCategories.map((category: Category) => {\n          return (\n            <div key={category.id}>\n              <ListItem\n                button\n                id={category.id}\n                onClick={(event) => onCategoryClick(event, category)}\n                selected={category.id === selectedCategory.id}\n              >\n                <CategoryListItemCheckbox category={category} />\n\n                <ListItemText\n                  id={category.id}\n                  primary={category.name}\n                  primaryTypographyProps={{ noWrap: true }}\n                />\n                {categoryCounts[category.id] !== 0 && (\n                  <Chip label={categoryCounts[category.id]} size=\"small\" />\n                )}\n\n                <ListItemSecondaryAction>\n                  <IconButton\n                    edge=\"end\"\n                    onClick={(event) => onCategoryMenuOpen(event, category)}\n                  >\n                    <MoreHorizIcon />\n                  </IconButton>\n                </ListItemSecondaryAction>\n              </ListItem>\n\n              <CategoryMenu\n                anchorElCategoryMenu={anchorEl}\n                onCloseCategoryMenu={onCategoryMenuClose}\n                onOpenCategoryMenu={(event) =>\n                  onCategoryMenuOpen(event, category)\n                }\n                onOpenDeleteCategoryDialog={onOpenDeleteCategoryDialog}\n                onOpenEditCategoryDialog={onOpenEditCategoryDialog}\n                onOpenClearCategoryDialog={onOpenClearCategoryDialog}\n                openCategoryMenu={Boolean(anchorEl)}\n              />\n            </div>\n          );\n        })}\n        {unknownCategory && (\n          <div key={unknownCategory.id}>\n            <ListItem\n              button\n              id={unknownCategory.id}\n              onClick={(event) => onCategoryClick(event, unknownCategory)}\n              selected={unknownCategory.id === selectedCategory.id}\n            >\n              <CategoryListItemCheckbox category={unknownCategory} />\n\n              <ListItemText\n                id={unknownCategory.id}\n                primary={t(unknownCategory.name)}\n                primaryTypographyProps={{ noWrap: true }}\n              />\n              {categoryCounts[unknownCategory.id] !== 0 && (\n                <Chip label={categoryCounts[unknownCategory.id]} size=\"small\" />\n              )}\n              <ListItemSecondaryAction>\n                <IconButton\n                  edge=\"end\"\n                  onClick={(event) =>\n                    onCategoryMenuOpen(event, unknownCategory)\n                  }\n                >\n                  <MoreHorizIcon />\n                </IconButton>\n              </ListItemSecondaryAction>\n            </ListItem>\n\n            <CategoryMenu\n              anchorElCategoryMenu={anchorEl}\n              onCloseCategoryMenu={onCategoryMenuClose}\n              onOpenCategoryMenu={(event) =>\n                onCategoryMenuOpen(event, unknownCategory)\n              }\n              onOpenDeleteCategoryDialog={onOpenDeleteCategoryDialog}\n              onOpenEditCategoryDialog={onOpenEditCategoryDialog}\n              openCategoryMenu={Boolean(anchorEl)}\n              onOpenClearCategoryDialog={onOpenClearCategoryDialog}\n            />\n          </div>\n        )}\n\n        <DeleteCategoryDialog\n          onClose={onCloseDeleteCategoryDialog}\n          open={openDeleteCategoryDialog}\n        />\n\n        <EditCategoryDialog\n          onCloseDialog={onCloseEditCategoryDialog}\n          openDialog={openEditCategoryDialog}\n        />\n\n        <ClearCategoryDialog\n          onClose={onCloseClearCategoryDialog}\n          open={openClearCategoryDialog}\n        />\n\n        <CreateCategoryListItem />\n      </CollapsibleList>\n\n      <Divider />\n\n      <List dense>\n        <ListItem button onClick={onClearAllAnnotations}>\n          <ListItemIcon>\n            <DeleteIcon color=\"disabled\" />\n          </ListItemIcon>\n          <ListItemText primary={t(\"Clear all annotations\")} />\n        </ListItem>\n\n        <DeleteAllAnnotationsDialog\n          onClose={onCloseDeleteAllAnnotationsDialog}\n          open={openDeleteAllAnnotationsDialog}\n        />\n\n        <ListItem button onClick={onClearSelectedAnnotations}>\n          <ListItemIcon>\n            <DeleteIcon color=\"disabled\" />\n          </ListItemIcon>\n          <ListItemText primary={t(\"Clear selected annotations\")} />\n        </ListItem>\n      </List>\n\n      <Divider />\n\n      <List dense>\n        <HelpDrawer />\n        <SettingsListItem />\n        <SendFeedbackListItem />\n      </List>\n    </Drawer>\n  );\n};\n\ntype SendFeedbackDialogProps = {\n  onClose: () => void;\n  open: boolean;\n  onSend: (text: string) => void;\n};\n\nconst CreateCategoryListItem = () => {\n  const { onClose, onOpen, open } = useDialog();\n\n  const t = useTranslation();\n\n  return (\n    <>\n      <ListItem button onClick={onOpen}>\n        <ListItemIcon>\n          <AddIcon />\n        </ListItemIcon>\n\n        <ListItemText primary={t(\"Create category\")} />\n      </ListItem>\n      <CreateCategoryDialog onClose={onClose} open={open} />\n    </>\n  );\n};\n\n/*\n * WARNING: This list item and its dialog box is not used anymore as it is been replaced with the HelpDrawer component.\n * */\n//\n// const HelpListItem = () => {\n//   const { onClose, onOpen, open } = useDialog();\n//\n//   const {\n//     onClose: onCloseOpenImagesHelpDialog,\n//     onOpen: onOpenOpenImagesHelpDialog,\n//     open: openOpenImagesHelpDialog,\n//   } = useDialog();\n//\n//   const {\n//     onClose: onCloseManipulatingCanvasHelpDialog,\n//     onOpen: onOpenManipulatingCanvasHelpDialog,\n//     open: openManipulatingCanvasHelpDialog,\n//   } = useDialog();\n//\n//   const {\n//     onClose: onCloseMakeAnnotationsHelpDialog,\n//     onOpen: onOpenMakeAnnotationsHelpDialog,\n//     open: openMakeAnnotationsHelpDialog,\n//   } = useDialog();\n//\n//   const {\n//     onClose: onCloseChangingAnnotationsHelpDialog,\n//     onOpen: onOpenChangingAnnotationsHelpDialog,\n//     open: openChangingAnnotationsHelpDialog,\n//   } = useDialog();\n//\n//   const {\n//     onClose: onCloseSavingProjectHelpDialog,\n//     onOpen: onOpenSavingProjectHelpDialog,\n//     open: openSavingProjectHelpDialog,\n//   } = useDialog();\n//\n//   return (\n//     <>\n//       <ListItem button onClick={onOpen}>\n//         <ListItemIcon>\n//           <HelpIcon />\n//         </ListItemIcon>\n//\n//         <ListItemText primary=\"Help\" />\n//       </ListItem>\n//\n//       <HelpDrawer />\n//\n//       {/*<HelpDialog*/}\n//       {/*  onClose={onClose}*/}\n//       {/*  open={open}*/}\n//       {/*  onOpenOpenImagesHelpDialog={onOpenOpenImagesHelpDialog}*/}\n//       {/*  onOpenMakeAnnotationsHelpDialog={onOpenMakeAnnotationsHelpDialog}*/}\n//       {/*  onOpenManipulatingCanvasHelpDialog={onOpenManipulatingCanvasHelpDialog}*/}\n//       {/*  onOpenChangingAnnotationsHelpDialog={*/}\n//       {/*    onOpenChangingAnnotationsHelpDialog*/}\n//       {/*  }*/}\n//       {/*  onOpenSavingProjectHelpDialog={onOpenSavingProjectHelpDialog}*/}\n//       {/*/>*/}\n//       {/*<OpenImageHelpDialog*/}\n//       {/*  onClose={onCloseOpenImagesHelpDialog}*/}\n//       {/*  open={openOpenImagesHelpDialog}*/}\n//       {/*/>*/}\n//       {/*<MakeAnnotationsHelpDialog*/}\n//       {/*  onClose={onCloseMakeAnnotationsHelpDialog}*/}\n//       {/*  open={openMakeAnnotationsHelpDialog}*/}\n//       {/*/>*/}\n//       {/*<ManipulateCanvasHelpDialog*/}\n//       {/*  onClose={onCloseManipulatingCanvasHelpDialog}*/}\n//       {/*  open={openManipulatingCanvasHelpDialog}*/}\n//       {/*/>*/}\n//       {/*<ChangingAnnotationsHelpDialog*/}\n//       {/*  onClose={onCloseChangingAnnotationsHelpDialog}*/}\n//       {/*  open={openChangingAnnotationsHelpDialog}*/}\n//       {/*/>*/}\n//       {/*<SavingProjectHelpDialog*/}\n//       {/*  onClose={onCloseSavingProjectHelpDialog}*/}\n//       {/*  open={openSavingProjectHelpDialog}*/}\n//       {/*/>*/}\n//     </>\n//   );\n// };\n\nconst OpenListItem = () => {\n  return (\n    <PopupState variant=\"popover\">\n      {(popupState) => (\n        <>\n          <ListItem button {...bindTrigger(popupState)}>\n            <ListItemIcon>\n              <FolderOpenIcon />\n            </ListItemIcon>\n\n            <ListItemText primary=\"Open\" />\n          </ListItem>\n\n          <OpenMenu popupState={popupState} />\n        </>\n      )}\n    </PopupState>\n  );\n};\n\nconst SaveListItem = () => {\n  const t = useTranslation();\n\n  return (\n    <>\n      <PopupState variant=\"popover\">\n        {(popupState) => (\n          <>\n            <ListItem button {...bindTrigger(popupState)}>\n              <ListItemIcon>\n                <SaveIcon />\n              </ListItemIcon>\n\n              <ListItemText primary={t(\"Save\")} />\n            </ListItem>\n            <SaveMenu popupState={popupState} />\n          </>\n        )}\n      </PopupState>\n    </>\n  );\n};\n\nconst SendFeedbackDialog = ({\n  onClose,\n  open,\n  onSend,\n}: SendFeedbackDialogProps) => {\n  const t = useTranslation();\n\n  const [input, setInput] = useState(\"\");\n\n  const send = () => {\n    onSend(input);\n    onClose();\n  };\n\n  return (\n    <Dialog onClose={onClose} open={open}>\n      <DialogTitle>{t(\"Send feedback\")}</DialogTitle>\n\n      <DialogContent>\n        <DialogContentText\n          sx={{\n            \"& a\": { color: \"deepskyblue\" },\n          }}\n        >\n          {t(\n            \"Use this form to report issues with Piximi via our GitHub page, or visit\"\n          )}{\" \"}\n          <a\n            href=\"https://forum.image.sc/tag/piximi\"\n            target=\"_blank\"\n            rel=\"noreferrer\"\n          >\n            forum.image.sc/tag/piximi\n          </a>\n          .\n        </DialogContentText>\n\n        <TextField\n          autoFocus\n          margin=\"dense\"\n          id=\"feedback\"\n          onChange={(e) => setInput(e.target.value)}\n          multiline\n          rows={12}\n          fullWidth\n          variant=\"filled\"\n        />\n      </DialogContent>\n\n      <DialogActions>\n        <Button onClick={onClose} color=\"primary\">\n          Cancel\n        </Button>\n\n        <Button onClick={send} color=\"primary\">\n          Send feedback\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nconst SendFeedbackListItem = () => {\n  const { onClose, onOpen, open } = useDialog();\n\n  const onSend = (text: string) => {\n    const url =\n      \"https://github.com/piximi/annotator/issues/new?title=Bug%20Report&labels=bug&body=\" +\n      encodeURIComponent(text);\n    window.open(url);\n  };\n\n  const t = useTranslation();\n\n  return (\n    <>\n      <ListItem button onClick={onOpen}>\n        <ListItemIcon>\n          <FeedbackIcon />\n        </ListItemIcon>\n\n        <ListItemText primary={t(\"Send feedback\")} />\n      </ListItem>\n      <SendFeedbackDialog onClose={onClose} open={open} onSend={onSend} />\n    </>\n  );\n};\n\nconst SettingsListItem = () => {\n  const { onClose, onOpen, open } = useDialog();\n\n  const t = useTranslation();\n\n  return (\n    <>\n      <ListItem button onClick={onOpen}>\n        <ListItemIcon>\n          <SettingsIcon />\n        </ListItemIcon>\n\n        <ListItemText primary={t(\"Settings\")} />\n      </ListItem>\n      <SettingsDialog onClose={onClose} open={open} />\n    </>\n  );\n};\n","import React from \"react\";\nimport Tooltip from \"@mui/material/Tooltip\";\nimport { Box } from \"@mui/material\";\n\ntype AnnotationModeTooltipProps = {\n  children: React.ReactElement;\n  content: React.ReactElement;\n};\n\nexport const AnnotationModeTooltip = ({\n  children,\n  content,\n}: AnnotationModeTooltipProps) => {\n  return (\n    <Tooltip title={<Box>{content}</Box>} placement=\"bottom\">\n      {children}\n    </Tooltip>\n  );\n};\n","import React from \"react\";\nimport { AnnotationModeTooltip } from \"../AnnotationModeTooltip\";\n\ntype NewTooltipProps = {\n  children: React.ReactElement;\n};\n\nexport const NewTooltip = ({ children }: NewTooltipProps) => {\n  return (\n    <AnnotationModeTooltip content={<p>Create a new annotation.</p>}>\n      {children}\n    </AnnotationModeTooltip>\n  );\n};\n","import React from \"react\";\nimport { AnnotationModeTooltip } from \"../AnnotationModeTooltip\";\n\ntype AddTooltipProps = {\n  children: React.ReactElement;\n};\n\nexport const AddTooltip = ({ children }: AddTooltipProps) => {\n  const content = (\n    <p>\n      Adding to an annotation adds any new areas you annotate to an existing\n      annotation.\n    </p>\n  );\n\n  return (\n    <AnnotationModeTooltip content={content}>{children}</AnnotationModeTooltip>\n  );\n};\n","import React from \"react\";\nimport { AnnotationModeTooltip } from \"../AnnotationModeTooltip\";\n\ntype SubtractTooltipProps = {\n  children: React.ReactElement;\n};\n\nexport const SubtractTooltip = ({ children }: SubtractTooltipProps) => {\n  const content = (\n    <p>\n      Subtracting an area removes the area you label from an existing\n      annotation.\n    </p>\n  );\n\n  return (\n    <AnnotationModeTooltip content={content}>{children}</AnnotationModeTooltip>\n  );\n};\n","import React from \"react\";\nimport { AnnotationModeTooltip } from \"../AnnotationModeTooltip\";\n\ntype IntersectionTooltipProps = {\n  children: React.ReactElement;\n};\n\nexport const IntersectionTooltip = ({ children }: IntersectionTooltipProps) => {\n  return (\n    <AnnotationModeTooltip\n      content={\n        <p>\n          Constrain the boundary of the new annotation to the selected\n          annotation.\n        </p>\n      }\n    >\n      {children}\n    </AnnotationModeTooltip>\n  );\n};\n","import List from \"@mui/material/List\";\nimport ListItemButton from \"@mui/material/ListItemButton\";\nimport ListItemIcon from \"@mui/material/ListItemIcon\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport Radio from \"@mui/material/Radio\";\nimport React from \"react\";\nimport RadioGroup from \"@mui/material/RadioGroup\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport {\n  annotationStateSelector,\n  selectionModeSelector,\n} from \"../../../../../store/selectors\";\nimport { AnnotationModeType } from \"../../../../../types/AnnotationModeType\";\nimport ListSubheader from \"@mui/material/ListSubheader\";\nimport { NewTooltip } from \"../NewTooltip\";\nimport { AddTooltip } from \"../AddTooltip\";\nimport { SubtractTooltip } from \"../SubtractTooltip\";\nimport { IntersectionTooltip } from \"../IntersectionTooltip\";\nimport { RadioCheckedIcon, RadioUncheckedIcon } from \"../../../../../icons\";\nimport { useTranslation } from \"../../../../../hooks/useTranslation\";\nimport { imageViewerSlice } from \"../../../../../store/slices\";\nimport { AnnotationStateType } from \"../../../../../types/AnnotationStateType\";\n\nexport const AnnotationMode = () => {\n  const dispatch = useDispatch();\n\n  const annotationMode = useSelector(selectionModeSelector);\n\n  const annotationState = useSelector(annotationStateSelector);\n\n  const onChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const payload = {\n      selectionMode: parseInt((event.target as HTMLInputElement).value),\n    };\n    dispatch(imageViewerSlice.actions.setSelectionMode(payload));\n  };\n\n  const onClickLabel = (event: any, mode: AnnotationModeType) => {\n    const payload = {\n      selectionMode: mode,\n    };\n    dispatch(imageViewerSlice.actions.setSelectionMode(payload));\n  };\n\n  const t = useTranslation();\n\n  return (\n    <RadioGroup\n      aria-label=\"annotation mode\"\n      name=\"annotation-mode\"\n      onChange={onChange}\n      value={annotationMode}\n    >\n      <List\n        component=\"nav\"\n        subheader={\n          <ListSubheader component=\"div\">{t(\"Annotation mode\")}</ListSubheader>\n        }\n      >\n        <NewTooltip>\n          <ListItemButton\n            dense\n            onClick={(event) => onClickLabel(event, AnnotationModeType.New)}\n          >\n            <ListItemIcon>\n              <Radio\n                disableRipple\n                edge=\"start\"\n                icon={<RadioUncheckedIcon />}\n                checkedIcon={<RadioCheckedIcon />}\n                tabIndex={-1}\n                value={AnnotationModeType.New}\n              />\n            </ListItemIcon>\n\n            <ListItemText primary={t(\"New annotation\")} />\n          </ListItemButton>\n        </NewTooltip>\n\n        <AddTooltip>\n          <ListItemButton\n            dense\n            onClick={(event) => onClickLabel(event, AnnotationModeType.Add)}\n            disabled={annotationState === AnnotationStateType.Blank}\n          >\n            <ListItemIcon>\n              <Radio\n                disableRipple\n                edge=\"start\"\n                icon={<RadioUncheckedIcon />}\n                checkedIcon={<RadioCheckedIcon />}\n                tabIndex={-1}\n                value={AnnotationModeType.Add}\n              />\n            </ListItemIcon>\n\n            <ListItemText primary={t(\"Add area\")} />\n          </ListItemButton>\n        </AddTooltip>\n\n        <SubtractTooltip>\n          <ListItemButton\n            dense\n            onClick={(event) =>\n              onClickLabel(event, AnnotationModeType.Subtract)\n            }\n            disabled={annotationState === AnnotationStateType.Blank}\n          >\n            <ListItemIcon>\n              <Radio\n                disableRipple\n                edge=\"start\"\n                icon={<RadioUncheckedIcon />}\n                checkedIcon={<RadioCheckedIcon />}\n                tabIndex={-1}\n                value={AnnotationModeType.Subtract}\n              />\n            </ListItemIcon>\n\n            <ListItemText primary={t(\"Subtract area\")} />\n          </ListItemButton>\n        </SubtractTooltip>\n\n        <IntersectionTooltip>\n          <ListItemButton\n            dense\n            onClick={(event) =>\n              onClickLabel(event, AnnotationModeType.Intersect)\n            }\n            disabled={annotationState === AnnotationStateType.Blank}\n          >\n            <ListItemIcon>\n              <Radio\n                disableRipple\n                edge=\"start\"\n                icon={<RadioUncheckedIcon />}\n                checkedIcon={<RadioCheckedIcon />}\n                tabIndex={-1}\n                value={AnnotationModeType.Intersect}\n              />\n            </ListItemIcon>\n\n            <ListItemText primary={t(\"Intersection\")} />\n          </ListItemButton>\n        </IntersectionTooltip>\n      </List>\n    </RadioGroup>\n  );\n};\n","import React from \"react\";\nimport { Typography } from \"@mui/material\";\nimport AppBar from \"@mui/material/AppBar\";\nimport Toolbar from \"@mui/material/Toolbar\";\n\ntype InformationBoxProps = {\n  description: string;\n  name: string;\n};\n\nexport const InformationBox = ({ description, name }: InformationBoxProps) => {\n  return (\n    <AppBar\n      sx={{\n        backgroundColor: \"rgba(0, 0, 0, 0)\",\n        // borderBottom: \"1px solid rgba(0, 0, 0, 0.12)\",\n        boxShadow: \"none\",\n        position: \"absolute\",\n      }}\n      color=\"default\"\n    >\n      <Toolbar disableGutters={true}>\n        <Typography variant=\"h6\" color=\"inherit\">\n          &nbsp;\n        </Typography>\n        <Typography style={{ marginLeft: 12 }}>{name}</Typography>\n      </Toolbar>\n    </AppBar>\n  );\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nimport { AnnotationType } from \"../../types/AnnotationType\";\n\nexport const selectedAnnotationSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}): AnnotationType | undefined => {\n  return imageViewer.selectedAnnotation;\n};\n","import React from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\nimport List from \"@mui/material/List\";\nimport ListItem from \"@mui/material/ListItem\";\nimport ListItemIcon from \"@mui/material/ListItemIcon\";\nimport SvgIcon from \"@mui/material/SvgIcon\";\nimport { ReactComponent as InvertSelectionIcon } from \"../../../../icons/InvertAnnotation.svg\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport { imageViewerSlice } from \"../../../../store/slices\";\nimport { useAnnotationTool } from \"../../../../hooks\";\nimport { selectedAnnotationSelector } from \"../../../../store/selectors/selectedAnnotationSelector\";\n\nexport const InvertAnnotation = () => {\n  const dispatch = useDispatch();\n\n  const [annotationTool] = useAnnotationTool();\n  const selectedAnnotation = useSelector(selectedAnnotationSelector);\n\n  const onInvertClick = () => {\n    if (!annotationTool) return;\n\n    if (!selectedAnnotation || !selectedAnnotation.mask) return;\n\n    const [invertedMask, invertedBoundingBox] = annotationTool.invert(\n      selectedAnnotation.mask,\n      selectedAnnotation.boundingBox\n    );\n\n    dispatch(\n      imageViewerSlice.actions.setSelectedAnnotations({\n        selectedAnnotations: [\n          {\n            ...selectedAnnotation,\n            boundingBox: invertedBoundingBox,\n            mask: invertedMask,\n          },\n        ],\n        selectedAnnotation: {\n          ...selectedAnnotation,\n          boundingBox: invertedBoundingBox,\n          mask: invertedMask,\n        },\n      })\n    );\n  };\n\n  const t = useTranslation();\n\n  return (\n    <List>\n      <ListItem button onClick={onInvertClick} dense>\n        <ListItemIcon>\n          <SvgIcon>\n            <>\n              <InvertSelectionIcon />\n            </>\n          </SvgIcon>\n        </ListItemIcon>\n\n        <ListItemText primary={t(\"Invert annotation\")} />\n      </ListItem>\n    </List>\n  );\n};\n","import Divider from \"@mui/material/Divider\";\nimport React from \"react\";\nimport { AnnotationMode } from \"../AnnotationMode\";\nimport { InformationBox } from \"../InformationBox\";\nimport { InvertAnnotation } from \"../InvertAnnotation\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\n\nexport const RectangularAnnotationOptions = () => {\n  const t = useTranslation();\n  return (\n    <>\n      <InformationBox\n        description=\"Click and drag to create a rectangular annotation.\"\n        name={t(\"Rectangular annotation\")}\n      />\n\n      <Divider />\n\n      <AnnotationMode />\n\n      <Divider />\n\n      <InvertAnnotation />\n    </>\n  );\n};\n","import Divider from \"@mui/material/Divider\";\nimport React from \"react\";\nimport { AnnotationMode } from \"../AnnotationMode\";\nimport { InformationBox } from \"../InformationBox\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\nimport { InvertAnnotation } from \"../InvertAnnotation\";\n\nexport const EllipticalAnnotationOptions = () => {\n  const t = useTranslation();\n  return (\n    <>\n      <InformationBox\n        description=\"Click and drag to create an elliptical annotation.\"\n        name={t(\"Elliptical annotation\")}\n      />\n\n      <Divider />\n\n      <AnnotationMode />\n\n      <Divider />\n\n      <InvertAnnotation />\n    </>\n  );\n};\n","import Divider from \"@mui/material/Divider\";\nimport React from \"react\";\nimport { AnnotationMode } from \"../AnnotationMode\";\nimport { InformationBox } from \"../InformationBox\";\nimport { InvertAnnotation } from \"../InvertAnnotation\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\nimport List from \"@mui/material/List\";\nimport ListItem from \"@mui/material/ListItem\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport Slider from \"@mui/material/Slider\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { penSelectionBrushSizeSelector } from \"../../../../store/selectors/penSelectionBrushSizeSelector\";\nimport { imageViewerSlice } from \"../../../../store/slices\";\n\nexport const FreehandAnnotationOptions = () => {\n  const dispatch = useDispatch();\n\n  const penSelectionBrushSizeBrushSize = useSelector(\n    penSelectionBrushSizeSelector\n  );\n\n  const onChange = (event: any, changed: number | number[]) => {\n    const payload = { penSelectionBrushSize: changed as number };\n\n    dispatch(imageViewerSlice.actions.setPenSelectionBrushSize(payload));\n  };\n  const t = useTranslation();\n  return (\n    <>\n      <InformationBox description=\"…\" name={t(\"Freehand annotation\")} />\n\n      <Divider />\n\n      <AnnotationMode />\n\n      <Divider />\n\n      <List>\n        <ListItem dense>\n          <ListItemText\n            primary={\"Brush size\"}\n            secondary={\n              <Slider\n                aria-labelledby=\"pen-selection-brush-size\"\n                min={2}\n                onChange={onChange}\n                value={penSelectionBrushSizeBrushSize}\n              />\n            }\n          />\n        </ListItem>\n      </List>\n\n      <Divider />\n\n      <InvertAnnotation />\n    </>\n  );\n};\n","import Divider from \"@mui/material/Divider\";\nimport React from \"react\";\nimport { AnnotationMode } from \"../AnnotationMode\";\nimport { InformationBox } from \"../InformationBox\";\nimport { InvertAnnotation } from \"../InvertAnnotation\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\n\nexport const LassoAnnotationOptions = () => {\n  const t = useTranslation();\n\n  return (\n    <>\n      <InformationBox description=\"…\" name={t(\"Lasso annotation\")} />\n\n      <Divider />\n\n      <AnnotationMode />\n\n      <Divider />\n\n      <InvertAnnotation />\n    </>\n  );\n};\n","import Divider from \"@mui/material/Divider\";\nimport React from \"react\";\nimport { AnnotationMode } from \"../AnnotationMode\";\nimport { InformationBox } from \"../InformationBox\";\nimport { InvertAnnotation } from \"../InvertAnnotation\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\n\nexport const PolygonalAnnotationOptions = () => {\n  const t = useTranslation();\n\n  return (\n    <>\n      <InformationBox description=\"…\" name={t(\"Polygonal annotation\")} />\n\n      <Divider />\n\n      <AnnotationMode />\n\n      <Divider />\n\n      <InvertAnnotation />\n    </>\n  );\n};\n","import Divider from \"@mui/material/Divider\";\nimport React from \"react\";\nimport { AnnotationMode } from \"../AnnotationMode\";\nimport { InformationBox } from \"../InformationBox\";\nimport { InvertAnnotation } from \"../InvertAnnotation\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\n\nexport const MagneticAnnotationOptions = () => {\n  const t = useTranslation();\n\n  return (\n    <>\n      <InformationBox description=\"…\" name={t(\"Magnetic annotation\")} />\n\n      <Divider />\n\n      <AnnotationMode />\n\n      <Divider />\n\n      <InvertAnnotation />\n\n      {/*<Divider />*/}\n\n      {/*<SampleList />*/}\n    </>\n  );\n};\n","import Divider from \"@mui/material/Divider\";\nimport React from \"react\";\nimport { AnnotationMode } from \"../AnnotationMode\";\nimport { InformationBox } from \"../InformationBox\";\nimport { InvertAnnotation } from \"../InvertAnnotation\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\n\nexport const ColorAnnotationOptions = () => {\n  const t = useTranslation();\n\n  return (\n    <>\n      <InformationBox description=\"…\" name={t(\"Color annotation\")} />\n\n      <Divider />\n\n      <AnnotationMode />\n\n      <Divider />\n\n      <InvertAnnotation />\n\n      {/*<Divider />*/}\n\n      {/*<SampleList />*/}\n    </>\n  );\n};\n","import Divider from \"@mui/material/Divider\";\nimport React, { useState } from \"react\";\nimport { AnnotationMode } from \"../AnnotationMode\";\nimport { InformationBox } from \"../InformationBox\";\nimport { InvertAnnotation } from \"../InvertAnnotation\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\nimport List from \"@mui/material/List\";\nimport ListItem from \"@mui/material/ListItem\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport Slider from \"@mui/material/Slider\";\nimport { quickSelectionBrushSizeSelector } from \"../../../../store/selectors/quickSelectionBrushSizeSelector\";\nimport { imageViewerSlice } from \"../../../../store/slices\";\nimport { useDispatch, useSelector } from \"react-redux\";\n\nexport const QuickAnnotationOptions = () => {\n  const t = useTranslation();\n\n  const quickSelectionBrushSize = useSelector(quickSelectionBrushSizeSelector);\n\n  const [brushSize, setBrushSize] = useState<number>(quickSelectionBrushSize);\n\n  const dispatch = useDispatch();\n\n  const onChange = (event: any, changed: number | number[]) => {\n    setBrushSize(changed as number);\n  };\n\n  const onChangeCommitted = (event: any, changed: number | number[]) => {\n    const payload = { quickSelectionBrushSize: changed as number };\n    dispatch(imageViewerSlice.actions.setQuickSelectionBrushSize(payload));\n  };\n\n  return (\n    <>\n      <InformationBox description=\"…\" name={t(\"Quick annotation\")} />\n\n      <Divider />\n\n      <AnnotationMode />\n\n      <Divider />\n\n      <List>\n        <ListItem dense>\n          <ListItemText\n            primary={\"Brush size\"}\n            secondary={\n              <Slider\n                aria-labelledby=\"quick-selection-brush-size\"\n                min={2}\n                onChange={onChange}\n                onChangeCommitted={onChangeCommitted}\n                value={brushSize}\n              />\n            }\n          />\n        </ListItem>\n      </List>\n\n      <Divider />\n\n      <InvertAnnotation />\n\n      {/*<Divider />*/}\n\n      {/*<SampleList />*/}\n    </>\n  );\n};\n","import Divider from \"@mui/material/Divider\";\nimport React from \"react\";\nimport { AnnotationMode } from \"../AnnotationMode\";\nimport { InformationBox } from \"../InformationBox\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\n\nexport const ObjectAnnotationOptions = () => {\n  const t = useTranslation();\n\n  return (\n    <>\n      <InformationBox description=\"…\" name={t(\"Object annotation\")} />\n\n      <Divider />\n\n      <AnnotationMode />\n\n      <Divider />\n\n      {/*<Divider />*/}\n\n      {/*<SampleList />*/}\n    </>\n  );\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nexport const offsetSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}) => {\n  return imageViewer.offset;\n};\n","import ListItem from \"@mui/material/ListItem\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport React from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\nimport { imageViewerSlice } from \"../../../../store/slices\";\n\nexport const ResetButton = () => {\n  const dispatch = useDispatch();\n  const t = useTranslation();\n\n  const onResetClick = () => {\n    dispatch(\n      imageViewerSlice.actions.setStagePosition({\n        stagePosition: { x: 0, y: 0 },\n      })\n    );\n  };\n  return (\n    <ListItem button onClick={onResetClick}>\n      <ListItemText>{t(\"Reset position\")}</ListItemText>\n    </ListItem>\n  );\n};\n","import Radio from \"@mui/material/Radio\";\nimport React from \"react\";\nimport { RadioGroup } from \"@mui/material\";\nimport List from \"@mui/material/List\";\nimport ListItem from \"@mui/material/ListItem\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport { batch, useDispatch, useSelector } from \"react-redux\";\nimport { ZoomModeType } from \"../../../../types/ZoomModeType\";\nimport Checkbox from \"@mui/material/Checkbox\";\nimport {\n  imageSelector,\n  stageHeightSelector,\n  stageScaleSelector,\n  stageWidthSelector,\n  zoomToolOptionsSelector,\n} from \"../../../../store/selectors\";\nimport ListSubheader from \"@mui/material/ListSubheader\";\nimport ListItemIcon from \"@mui/material/ListItemIcon\";\nimport {\n  CheckboxUncheckedIcon,\n  RadioCheckedIcon,\n  RadioUncheckedIcon,\n} from \"../../../../icons\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\nimport Divider from \"@mui/material/Divider\";\nimport { InformationBox } from \"../InformationBox\";\nimport Slider from \"@mui/material/Slider\";\nimport Grid from \"@mui/material/Grid\";\nimport ZoomInIcon from \"@mui/icons-material/ZoomIn\";\nimport ZoomOutIcon from \"@mui/icons-material/ZoomOut\";\nimport { offsetSelector } from \"../../../../store/selectors/offsetSelector\";\nimport { ResetButton } from \"../HandToolOptions/ResetButton\";\nimport { setOffset, setStageScale } from \"../../../../store/slices\";\nimport { setZoomToolOptions } from \"../../../../store/slices/toolOptionsSlice\";\n\nexport const ZoomOptions = () => {\n  const dispatch = useDispatch();\n\n  const options = useSelector(zoomToolOptionsSelector);\n\n  const stageWidth = useSelector(stageWidthSelector);\n  const stageHeight = useSelector(stageHeightSelector);\n\n  const t = useTranslation();\n\n  const scale = useSelector(stageScaleSelector);\n  const image = useSelector(imageSelector);\n  const offset = useSelector(offsetSelector);\n\n  const onAutomaticCenteringChange = () => {\n    const payload = {\n      options: {\n        ...options,\n        automaticCentering: !options.automaticCentering,\n      },\n    };\n\n    const centerOffset = {\n      x:\n        offset.x !== 0\n          ? 0\n          : ((image && image.shape ? image.shape.width : 512) * scale) / 2 -\n            offset.x,\n      y:\n        offset.y !== 0\n          ? 0\n          : ((image && image.shape ? image.shape.height : 512) * scale) / 2 -\n            offset.y,\n    }; // FIXME #134 hardcoded heights and widths before merging with master branch!;\n\n    batch(() => {\n      dispatch(setZoomToolOptions(payload));\n      dispatch(setOffset({ offset: centerOffset }));\n    });\n  };\n\n  const onToActualSizeClick = () => {\n    const payload = {\n      options: {\n        ...options,\n        automaticCentering: true,\n        toActualSize: !options.toActualSize,\n      },\n    };\n\n    batch(() => {\n      dispatch(setZoomToolOptions(payload));\n      dispatch(setStageScale({ stageScale: 1 }));\n      dispatch(setOffset({ offset: { x: 0, y: 0 } }));\n    });\n  };\n\n  const onToFullSizeClick = () => {\n    const payload = {\n      options: {\n        ...options,\n        automaticCentering: true,\n        toFit: !options.toFit,\n      },\n    };\n\n    if (!image || !image.shape) return;\n\n    // FIXME #136 it seems like we are not currently getting the current stageHeight. It currently stays fixes to the initial state in the redux store.\n    const imageWidth = image && image.shape ? image.shape.width : 512;\n    const imageHeight = image && image.shape ? image.shape.height : 512;\n    if (imageHeight / stageHeight > imageWidth / stageWidth) {\n      dispatch(\n        setStageScale({\n          stageScale: stageHeight / imageHeight,\n        })\n      );\n    } else {\n      dispatch(\n        setStageScale({\n          stageScale: stageWidth / imageWidth,\n        })\n      );\n    }\n    batch(() => {\n      dispatch(setZoomToolOptions(payload));\n\n      dispatch(setOffset({ offset: { x: 0, y: 0 } }));\n    });\n  };\n\n  const onToFitClick = () => {\n    const payload = {\n      options: {\n        ...options,\n        automaticCentering: true,\n        toFit: !options.toFit,\n      },\n    };\n\n    if (!image || !image.shape) return;\n\n    // FIXME #136 it seems like we are not currently getting the current stageHeight. It currently stays fixes to the initial state in the redux store.\n    const imageWidth = image && image.shape ? image.shape.width : 512;\n    const imageHeight = image && image.shape ? image.shape.height : 512;\n    if (imageHeight / stageHeight > imageWidth / stageWidth) {\n      dispatch(\n        setStageScale({\n          stageScale: (0.95 * stageHeight) / imageHeight,\n        })\n      );\n    } else {\n      dispatch(\n        setStageScale({\n          stageScale: (0.95 * stageWidth) / imageWidth,\n        })\n      );\n    }\n\n    batch(() => {\n      dispatch(setZoomToolOptions(payload));\n\n      dispatch(setOffset({ offset: { x: 0, y: 0 } }));\n    });\n  };\n\n  const onModeChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const value = parseInt((event.target as HTMLInputElement).value);\n\n    const payload = {\n      options: {\n        ...options,\n        mode: value as ZoomModeType,\n      },\n    };\n\n    dispatch(setZoomToolOptions(payload));\n  };\n\n  const onModeClick = (event: any, mode: ZoomModeType) => {\n    const payload = {\n      options: {\n        ...options,\n        mode: mode,\n      },\n    };\n\n    dispatch(setZoomToolOptions(payload));\n  };\n\n  const onSliderChange = (value: number) => {\n    dispatch(setStageScale({ stageScale: value }));\n  };\n\n  // @ts-ignore\n  return (\n    <>\n      <InformationBox description=\"…\" name={t(\"Zoom\")} />\n\n      <Divider />\n\n      <List\n        component=\"nav\"\n        subheader={\n          <ListSubheader component=\"div\">{t(\"Zoom scale\")}</ListSubheader>\n        }\n      >\n        <ListItem>\n          <Grid container spacing={2}>\n            <Grid item>\n              <ZoomOutIcon />\n            </Grid>\n            <Grid item xs>\n              <Slider\n                defaultValue={1}\n                onChange={(event: any, value: number | number[]) =>\n                  onSliderChange(value as number)\n                }\n                valueLabelDisplay=\"auto\"\n                value={scale}\n                min={0.01}\n                max={10}\n                step={0.01}\n              />\n            </Grid>\n            <Grid item>\n              <ZoomInIcon />\n            </Grid>\n          </Grid>\n        </ListItem>\n      </List>\n\n      <Divider />\n\n      <List dense>\n        <RadioGroup\n          defaultValue={ZoomModeType.In}\n          aria-label=\"annotation mode\"\n          name=\"annotation-mode\"\n          onChange={onModeChange}\n          value={options.mode}\n        >\n          <List\n            component=\"nav\"\n            subheader={\n              <ListSubheader component=\"div\">{t(\"Zoom mode\")}</ListSubheader>\n            }\n          >\n            <ListItem\n              button\n              dense\n              onClick={(event) => onModeClick(event, ZoomModeType.In)}\n            >\n              <ListItemIcon>\n                <Radio\n                  disableRipple\n                  edge=\"start\"\n                  icon={<RadioUncheckedIcon />}\n                  checkedIcon={<RadioCheckedIcon />}\n                  tabIndex={-1}\n                  value={ZoomModeType.In}\n                />\n              </ListItemIcon>\n\n              <ListItemText primary={t(\"Zoom in\")} />\n            </ListItem>\n\n            <ListItem\n              button\n              dense\n              onClick={(event) => onModeClick(event, ZoomModeType.Out)}\n            >\n              <ListItemIcon>\n                <Radio\n                  disableRipple\n                  edge=\"start\"\n                  icon={<RadioUncheckedIcon />}\n                  checkedIcon={<RadioCheckedIcon />}\n                  tabIndex={-1}\n                  value={ZoomModeType.Out}\n                />\n              </ListItemIcon>\n\n              <ListItemText primary={t(\"Zoom out\")} />\n            </ListItem>\n          </List>\n        </RadioGroup>\n      </List>\n\n      <Divider />\n\n      <ListItem button dense onClick={onAutomaticCenteringChange}>\n        <ListItemIcon>\n          <Checkbox\n            checked={options.automaticCentering}\n            disableRipple\n            edge=\"start\"\n            icon={<CheckboxUncheckedIcon />}\n            checkedIcon={<RadioCheckedIcon />}\n            tabIndex={-1}\n          />\n        </ListItemIcon>\n\n        <ListItemText primary={t(\"Automatically zoom towards the center\")} />\n      </ListItem>\n\n      <Divider />\n\n      <List dense>\n        <ListItem button onClick={onToActualSizeClick}>\n          <ListItemText>{t(\"Actual size\")}</ListItemText>\n        </ListItem>\n\n        <ListItem button onClick={onToFullSizeClick}>\n          <ListItemText>{t(\"Full size\")}</ListItemText>\n        </ListItem>\n\n        <ListItem button onClick={onToFitClick}>\n          <ListItemText>{t(\"Fit to canvas\")}</ListItemText>\n        </ListItem>\n\n        <ResetButton />\n      </List>\n    </>\n  );\n};\n","import React from \"react\";\nimport { InformationBox } from \"../InformationBox\";\nimport Divider from \"@mui/material/Divider\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\nimport List from \"@mui/material/List\";\nimport { ResetButton } from \"./ResetButton\";\n\nexport const HandToolOptions = () => {\n  const t = useTranslation();\n\n  return (\n    <>\n      <InformationBox description=\"…\" name={t(\"Hand tool\")} />\n\n      <Divider />\n\n      <List dense>\n        <ResetButton />\n      </List>\n    </>\n  );\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nimport { ChannelType } from \"../../types/ChannelType\";\n\nexport const channelsSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}): Array<ChannelType> => {\n  return imageViewer.channels;\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nimport { Image } from \"../../types/Image\";\n\nexport const imageShapeSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}) => {\n  if (!imageViewer.images.length) return;\n\n  const image = imageViewer.images.find((image: Image) => {\n    return image.id === imageViewer.activeImageId;\n  });\n\n  if (!image) return;\n\n  return image.shape;\n};\n","import { ListItem } from \"@mui/material\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport React, { useCallback } from \"react\";\nimport Slider from \"@mui/material/Slider\";\nimport ListItemIcon from \"@mui/material/ListItemIcon\";\nimport Checkbox from \"@mui/material/Checkbox\";\nimport {\n  CheckboxCheckedIcon,\n  CheckboxUncheckedIcon,\n} from \"../../../../../icons\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { channelsSelector } from \"../../../../../store/selectors/intensityRangeSelector\";\nimport { ChannelType } from \"../../../../../types/ChannelType\";\nimport { debounce } from \"lodash\";\nimport { imageShapeSelector } from \"../../../../../store/selectors/imageShapeSelector\";\nimport { CollapsibleList } from \"../../../CategoriesList/CollapsibleList\";\nimport { imageViewerSlice } from \"../../../../../store/slices\";\n\ntype ColorAdjustmentSlidersProp = {\n  updateDisplayedValues: (values: Array<Array<number>>) => void;\n  displayedValues: Array<Array<number>>;\n};\n\nexport const ChannelsList = ({\n  displayedValues,\n  updateDisplayedValues,\n}: ColorAdjustmentSlidersProp) => {\n  const dispatch = useDispatch();\n\n  const channels = useSelector(channelsSelector);\n\n  const imageShape = useSelector(imageShapeSelector);\n\n  const visibleChannelsIndices = channels\n    .map((channel: ChannelType, idx) => channel.visible)\n    .reduce((c: Array<number>, v, i) => (v ? c.concat(i) : c), []);\n\n  const handleSliderChange = (\n    idx: number,\n    event: any,\n    newValue: number | number[]\n  ) => {\n    const copiedValues = [...displayedValues].map((range: Array<number>) => {\n      return [...range];\n    });\n    copiedValues[idx] = newValue as Array<number>;\n    updateDisplayedValues(copiedValues);\n    handler(copiedValues);\n  };\n\n  const handler = useCallback(\n    (values: Array<Array<number>>) => {\n      const updateIntensityRanges = () => {\n        const copiedValues = [...values].map((range: Array<number>) => {\n          return [...range];\n        });\n\n        const updatedChannels = channels.map(\n          (channel: ChannelType, index: number) => {\n            return { ...channel, range: copiedValues[index] };\n          }\n        );\n\n        dispatch(\n          imageViewerSlice.actions.setChannels({\n            channels: updatedChannels,\n          })\n        );\n      };\n      return debounce(updateIntensityRanges, 100);\n    },\n    [channels, dispatch]\n  );\n\n  const onCheckboxChanged = (index: number) => () => {\n    const current = visibleChannelsIndices.indexOf(index);\n\n    const updated = [...visibleChannelsIndices];\n\n    const copiedChannels = [...channels];\n\n    if (current === -1) {\n      updated.push(index);\n      copiedChannels[index] = { ...copiedChannels[index], visible: true };\n    } else {\n      updated.splice(current, 1);\n      copiedChannels[index] = { ...copiedChannels[index], visible: false };\n    }\n    dispatch(\n      imageViewerSlice.actions.setChannels({\n        channels: copiedChannels,\n      })\n    );\n  };\n\n  const colorAdjustmentSlider = (\n    index: number,\n    name: string,\n    displayedValue: Array<number>\n  ) => {\n    return (\n      <ListItem dense key={index}>\n        <ListItemIcon>\n          <Checkbox\n            onClick={onCheckboxChanged(index)}\n            checked={visibleChannelsIndices.indexOf(index) !== -1}\n            disableRipple\n            edge=\"start\"\n            icon={\n              <>\n                <CheckboxUncheckedIcon />\n              </>\n            }\n            checkedIcon={\n              <>\n                <CheckboxCheckedIcon />\n              </>\n            }\n            tabIndex={-1}\n          />\n        </ListItemIcon>\n        <ListItemText primary={name} />\n        <Slider\n          key={index}\n          disabled={!(visibleChannelsIndices.indexOf(index) !== -1)} //TODO #142 style slider when disabled mode\n          style={{ width: \"60%\" }}\n          value={displayedValue}\n          max={255}\n          onChange={(event, value: number | number[]) =>\n            handleSliderChange(index, event, value)\n          }\n          valueLabelDisplay=\"auto\"\n          aria-labelledby=\"range-slider\"\n        />\n      </ListItem>\n    );\n  };\n\n  const allSliders = (displayedValues: Array<Array<number>>) => {\n    if (!imageShape) return;\n    const sliders = [];\n\n    const names =\n      imageShape.channels === 1 ? [\"Grey\"] : [\"Red\", \"Green\", \"Blue\"];\n    for (let i = 0; i < imageShape.channels; i++) {\n      sliders.push(colorAdjustmentSlider(i, names[i], displayedValues[i]));\n    }\n    return sliders;\n  };\n\n  return (\n    <CollapsibleList closed dense primary=\"Channels\">\n      {allSliders(displayedValues)}\n    </CollapsibleList>\n  );\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\n\nexport const activeImagePlaneSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}): number => {\n  return imageViewer.activeImagePlane;\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nimport { Image } from \"../../types/Image\";\n\nexport const activeImageSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}): Image | undefined => {\n  const activeImage = imageViewer.images.find((image: Image) => {\n    return imageViewer.activeImageId === image.id;\n  });\n\n  return activeImage;\n};\n","import { List, ListItem, ListItemText, Slider } from \"@mui/material\";\nimport React, { useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { activeImagePlaneSelector } from \"../../../../../store/selectors/activeImagePlaneSelector\";\nimport { activeImageSelector } from \"../../../../../store/selectors/activeImageSelector\";\nimport { imageViewerSlice } from \"../../../../../store/slices\";\n\nexport const ZStackSlider = () => {\n  const activeImagePlane = useSelector(activeImagePlaneSelector);\n  const activeImage = useSelector(activeImageSelector);\n  const dispatch = useDispatch();\n\n  const [value, setValue] = useState(activeImagePlane);\n\n  if (!activeImage || activeImage!.shape.planes === 1)\n    return <React.Fragment />;\n\n  const handleChange = (event: Event, newValue: number | number[]) => {\n    if (typeof newValue === \"number\") {\n      setValue(newValue);\n      const src = activeImage.originalSrc[newValue];\n      dispatch(imageViewerSlice.actions.setImageSrc({ src: src }));\n      dispatch(\n        imageViewerSlice.actions.setActiveImagePlane({\n          activeImagePlane: newValue,\n        })\n      );\n    }\n  };\n\n  return (\n    <React.Fragment>\n      <List dense>\n        <ListItem>\n          <ListItemText>Z plane: {value}</ListItemText>\n        </ListItem>\n\n        <ListItem>\n          <Slider\n            aria-label=\"z-plane\"\n            onChange={handleChange}\n            value={value}\n            valueLabelDisplay=\"auto\"\n            step={1}\n            marks\n            min={0}\n            max={activeImage!.shape.planes - 1}\n          />\n        </ListItem>\n      </List>\n    </React.Fragment>\n  );\n};\n","import React, { useEffect, useState } from \"react\";\nimport { InformationBox } from \"../../InformationBox\";\nimport Divider from \"@mui/material/Divider\";\nimport { useTranslation } from \"../../../../../hooks/useTranslation\";\nimport List from \"@mui/material/List\";\nimport ListItem from \"@mui/material/ListItem\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { imageOriginalSrcSelector } from \"../../../../../store/selectors\";\nimport { ChannelsList } from \"../ChannelsList\";\nimport { channelsSelector } from \"../../../../../store/selectors/intensityRangeSelector\";\nimport { ChannelType } from \"../../../../../types/ChannelType\";\nimport { imageShapeSelector } from \"../../../../../store/selectors/imageShapeSelector\";\nimport { imageViewerSlice } from \"../../../../../store/slices\";\nimport { ZStackSlider } from \"../ZStackSlider\";\n\nexport function createIntensityFilter(channels: ChannelType[]) {\n  return function (imageData: { data: any }) {\n    let data = imageData.data;\n    const scaleIntensity = (channel: ChannelType, pixel: number) => {\n      if (!channel.visible) return 0;\n      if (pixel < channel.range[0]) return 0;\n      if (pixel >= channel.range[1]) return 255;\n      return (\n        255 *\n        ((pixel - channel.range[0]) / (channel.range[1] - channel.range[0]))\n      );\n    };\n\n    for (let i = 0; i < data.length; i += 4) {\n      // red\n      data[i] = scaleIntensity(channels[0], data[i]);\n      // green\n      data[i + 1] = scaleIntensity(channels[1], data[i + 1]);\n      // blue\n      data[i + 2] = scaleIntensity(channels[2], data[i + 2]);\n    }\n    return data;\n  };\n}\n\nexport const ColorAdjustmentOptions = () => {\n  const t = useTranslation();\n\n  const dispatch = useDispatch();\n\n  const originalSrc = useSelector(imageOriginalSrcSelector);\n\n  const imageShape = useSelector(imageShapeSelector);\n\n  const channels = useSelector(channelsSelector);\n\n  const [displayedValues, setDisplayedValues] = useState<Array<Array<number>>>(\n    channels.map((channel: ChannelType) => [...channel.range])\n  ); //we keep that state variable here and pass it to slider so that visible slider ranges can change accordingly\n\n  const generateDefaultChannels = (components: number) => {\n    const defaultChannels: Array<ChannelType> = []; //number of channels depends on whether image is greyscale or RGB\n    for (let i = 0; i < components; i++) {\n      defaultChannels.push({\n        range: [0, 255],\n        visible: true,\n      });\n    }\n    return defaultChannels;\n  };\n\n  useEffect(() => {\n    if (!originalSrc) return;\n\n    if (!imageShape) return;\n\n    setDisplayedValues(\n      channels.map((channel: ChannelType) => [...channel.range])\n    );\n  }, [originalSrc, imageShape, channels]);\n\n  const onResetChannelsClick = () => {\n    if (!imageShape) return;\n    const defaultChannels = generateDefaultChannels(imageShape.channels);\n    dispatch(\n      imageViewerSlice.actions.setChannels({\n        channels: defaultChannels,\n      })\n    );\n    setDisplayedValues(\n      defaultChannels.map((channel: ChannelType) => [...channel.range])\n    );\n  };\n\n  const updateDisplayedValues = (values: Array<Array<number>>) => {\n    setDisplayedValues(values);\n  };\n\n  return (\n    <>\n      <InformationBox description=\"…\" name={t(\"Color adjustment\")} />\n\n      <Divider />\n\n      <ZStackSlider />\n\n      <Divider />\n\n      <ChannelsList\n        displayedValues={displayedValues}\n        updateDisplayedValues={updateDisplayedValues}\n      />\n\n      <Divider />\n\n      <List dense>\n        <ListItem button onClick={onResetChannelsClick}>\n          <ListItemText>{t(\"Reset\")}</ListItemText>\n        </ListItem>\n      </List>\n    </>\n  );\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nimport { AnnotationType } from \"../../types/AnnotationType\";\n\nexport const selectedAnnotationsSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}): Array<AnnotationType> => {\n  return imageViewer.selectedAnnotations;\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nimport { AnnotationType } from \"../../types/AnnotationType\";\nimport { Image } from \"../../types/Image\";\n\nexport const unselectedAnnotationsSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}): Array<AnnotationType> => {\n  if (!imageViewer.images.length) return [];\n\n  const image = imageViewer.images.find((image: Image) => {\n    return image.id === imageViewer.activeImageId;\n  });\n\n  if (!image) return [];\n\n  const ids = imageViewer.selectedAnnotations.map(\n    (annotation: AnnotationType) => {\n      return annotation.id;\n    }\n  );\n\n  return image.annotations.filter((annotation: AnnotationType) => {\n    return !ids.includes(annotation.id);\n  });\n};\n","import Divider from \"@mui/material/Divider\";\nimport React from \"react\";\nimport { InformationBox } from \"../InformationBox\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\nimport List from \"@mui/material/List\";\nimport ListItem from \"@mui/material/ListItem\";\nimport ListItemIcon from \"@mui/material/ListItemIcon\";\nimport SvgIcon from \"@mui/material/SvgIcon\";\nimport { ReactComponent as InvertSelectionIcon } from \"../../../../icons/InvertAnnotation.svg\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport { imageViewerSlice } from \"../../../../store/slices\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { selectedAnnotationsSelector } from \"../../../../store/selectors/selectedAnnotationsSelector\";\nimport { unselectedAnnotationsSelector } from \"../../../../store/selectors/unselectedAnnotationsSelector\";\nimport { Category } from \"../../../../types/Category\";\nimport { CollapsibleList } from \"../../CategoriesList/CollapsibleList\";\nimport { categoriesSelector } from \"../../../../store/selectors\";\nimport LabelIcon from \"@mui/icons-material/Label\";\n\nexport const PointerSelectionOptions = () => {\n  const t = useTranslation();\n\n  const dispatch = useDispatch();\n\n  const selectedAnnotations = useSelector(selectedAnnotationsSelector);\n  const unselectedAnnotations = useSelector(unselectedAnnotationsSelector);\n  const categories = useSelector(categoriesSelector);\n\n  const onSelectAll = () => {\n    const allAnnotations = [...selectedAnnotations, ...unselectedAnnotations];\n    dispatch(\n      imageViewerSlice.actions.setSelectedAnnotations({\n        selectedAnnotations: allAnnotations,\n        selectedAnnotation: allAnnotations[0],\n      })\n    );\n  };\n\n  const onSelectNone = () => {\n    dispatch(\n      imageViewerSlice.actions.setSelectedAnnotations({\n        selectedAnnotations: [],\n        selectedAnnotation: undefined,\n      })\n    );\n  };\n\n  const onSelectCategory = (\n    event:\n      | React.MouseEvent<HTMLLIElement>\n      | React.MouseEvent<HTMLAnchorElement>\n      | React.MouseEvent<HTMLDivElement>,\n    category: Category\n  ) => {\n    const allAnnotations = [...selectedAnnotations, ...unselectedAnnotations];\n    const desiredAnnotations = allAnnotations.filter((annotation) => {\n      return annotation.categoryId === category.id;\n    });\n    dispatch(\n      imageViewerSlice.actions.setSelectedAnnotations({\n        selectedAnnotations: desiredAnnotations,\n        selectedAnnotation: desiredAnnotations[0],\n      })\n    );\n  };\n\n  return (\n    <>\n      <InformationBox description=\"…\" name={t(\"Select annotations\")} />\n\n      <Divider />\n\n      <List>\n        <ListItem button onClick={onSelectAll} dense>\n          <ListItemIcon>\n            <SvgIcon>\n              <InvertSelectionIcon />\n            </SvgIcon>\n          </ListItemIcon>\n\n          <ListItemText primary={t(\"Select all\")} />\n        </ListItem>\n        <ListItem button onClick={onSelectNone} dense>\n          <ListItemIcon>\n            <SvgIcon>\n              <InvertSelectionIcon />\n            </SvgIcon>\n          </ListItemIcon>\n\n          <ListItemText primary={t(\"Select none\")} />\n        </ListItem>\n      </List>\n\n      <Divider />\n      <CollapsibleList closed dense primary={t(\"Select Category\")}>\n        {categories.map((category: Category) => {\n          return (\n            <ListItem\n              button\n              id={category.id}\n              onClick={(event) => onSelectCategory(event, category)}\n            >\n              <ListItemIcon>\n                <LabelIcon style={{ color: category.color }} />\n              </ListItemIcon>\n              <ListItemText primary={category.name} />\n            </ListItem>\n          );\n        })}\n      </CollapsibleList>\n    </>\n  );\n};\n","import Drawer from \"@mui/material/Drawer\";\nimport React from \"react\";\nimport {\n  ColorAdjustmentIcon,\n  ColorSelectionIcon,\n  EllipticalSelectionIcon,\n  HandIcon,\n  LassoSelectionIcon,\n  MagneticSelectionIcon,\n  ObjectSelectionIcon,\n  PenSelectionIcon,\n  PolygonalSelectionIcon,\n  QuickSelectionIcon,\n  RectangularSelectionIcon,\n  ZoomIcon,\n} from \"../../../../icons\";\nimport { ToolType } from \"../../../../types/ToolType\";\nimport { RectangularAnnotationOptions } from \"../RectangularAnnotationOptions\";\nimport { EllipticalAnnotationOptions } from \"../EllipticalAnnotationOptions\";\nimport { FreehandAnnotationOptions } from \"../FreehandAnnotationOptions\";\nimport { LassoAnnotationOptions } from \"../LassoAnnotationOptions\";\nimport { PolygonalAnnotationOptions } from \"../PolygonalAnnotationOptions\";\nimport { MagneticAnnotationOptions } from \"../MagneticAnnotationOptions\";\nimport { ColorAnnotationOptions } from \"../ColorAnnotationOptions\";\nimport { QuickAnnotationOptions } from \"../QuickAnnotationOptions\";\nimport { ObjectAnnotationOptions } from \"../ObjectAnnotationOptions\";\nimport { ZoomOptions } from \"../ZoomOptions\";\nimport { useSelector } from \"react-redux\";\nimport { toolTypeSelector } from \"../../../../store/selectors\";\nimport { useTranslation } from \"react-i18next\";\nimport { HandToolOptions } from \"../HandToolOptions/HandToolOptions\";\nimport { ColorAdjustmentOptions } from \"../ColorAdjustmentOptions/ColorAdjustmentOptions/ColorAdjustmentOptions\";\nimport { PointerSelectionOptions } from \"../PointerSelectionOptions\";\nimport { AppBarOffset } from \"components/styled/AppBarOffset\";\n\nexport const ToolOptions = () => {\n  const { t } = useTranslation();\n\n  const activeOperation = useSelector(toolTypeSelector);\n\n  // @ts-ignore\n  const operations = [\n    {\n      description: \"Nam a facilisis velit, sit amet interdum ante. In sodales.\",\n      icon: <ColorAdjustmentIcon />,\n      method: ToolType.ColorAdjustment,\n      name: t(\"Color adjustment\"),\n      options: <ColorAdjustmentOptions />,\n    },\n    {\n      description: \"Nam a facilisis velit, sit amet interdum ante. In sodales.\",\n      icon: <RectangularSelectionIcon />,\n      method: ToolType.RectangularAnnotation,\n      name: \"Rectangular selection\",\n      options: <RectangularAnnotationOptions />,\n    },\n    {\n      description: \"Nam a facilisis velit, sit amet interdum ante. In sodales.\",\n      icon: <EllipticalSelectionIcon />,\n      method: ToolType.EllipticalAnnotation,\n      name: \"Elliptical selection\",\n      options: <EllipticalAnnotationOptions />,\n    },\n    {\n      description: \"Nam a facilisis velit, sit amet interdum ante. In sodales.\",\n      icon: <PenSelectionIcon />,\n      method: ToolType.PenAnnotation,\n      name: \"Pen selection\",\n      options: <FreehandAnnotationOptions />,\n    },\n    {\n      description: \"Nam a facilisis velit, sit amet interdum ante. In sodales.\",\n      icon: <LassoSelectionIcon />,\n      method: ToolType.LassoAnnotation,\n      name: \"Lasso selection\",\n      options: <LassoAnnotationOptions />,\n    },\n    {\n      description: \"Nam a facilisis velit, sit amet interdum ante. In sodales.\",\n      icon: <PolygonalSelectionIcon />,\n      method: ToolType.PolygonalAnnotation,\n      name: \"Polygonal selection\",\n      options: <PolygonalAnnotationOptions />,\n    },\n    {\n      description: \"Nam a facilisis velit, sit amet interdum ante. In sodales.\",\n      icon: <MagneticSelectionIcon />,\n      method: ToolType.MagneticAnnotation,\n      name: \"Magnetic selection\",\n      options: <MagneticAnnotationOptions />,\n    },\n    {\n      description: \"Nam a facilisis velit, sit amet interdum ante. In sodales.\",\n      icon: <ColorSelectionIcon />,\n      method: ToolType.ColorAnnotation,\n      name: \"Color selection\",\n      options: <ColorAnnotationOptions />,\n    },\n    {\n      description: \"Nam a facilisis velit, sit amet interdum ante. In sodales.\",\n      icon: <QuickSelectionIcon />,\n      method: ToolType.QuickAnnotation,\n      name: \"Quick selection\",\n      options: <QuickAnnotationOptions />,\n    },\n    {\n      description: \"Nam a facilisis velit, sit amet interdum ante. In sodales.\",\n      icon: <ObjectSelectionIcon />,\n      method: ToolType.ObjectAnnotation,\n      name: \"Object selection\",\n      options: <ObjectAnnotationOptions />,\n    },\n    {\n      description: \"Nam a facilisis velit, sit amet interdum ante. In sodales.\",\n      icon: <HandIcon />,\n      method: ToolType.Hand,\n      name: \"Hand\",\n      options: <HandToolOptions />,\n    },\n    {\n      description: \"Description of zoom here.\",\n      icon: <ZoomIcon />,\n      method: ToolType.Zoom,\n      name: \"Zoom\",\n      options: (\n        <>\n          <ZoomOptions />\n        </>\n      ),\n    },\n    {\n      description: \"Description of pointer here.\",\n      icon: (\n        <>\n          <ObjectSelectionIcon />\n        </>\n      ),\n      method: ToolType.Pointer,\n      name: \"Pointer\",\n      options: (\n        <>\n          <PointerSelectionOptions />\n        </>\n      ),\n    },\n  ];\n\n  return (\n    <Drawer\n      anchor=\"right\"\n      sx={{\n        width: 240,\n        flexShrink: 0,\n        \"& .MuiDrawer-paper\": {\n          width: 240,\n          right: 56,\n        },\n      }}\n      variant=\"permanent\"\n    >\n      <AppBarOffset />\n\n      {\n        operations[\n          operations.findIndex(\n            (operation) => operation.method === activeOperation\n          )\n        ].options\n      }\n    </Drawer>\n  );\n};\n","import Typography from \"@mui/material/Typography\";\nimport React from \"react\";\nimport { KeyboardKey } from \"../../Help/HelpDialog/KeyboardKey\";\nimport { Box } from \"@mui/material\";\n\ntype ToolTitleProps = {\n  toolName: string;\n  letter: string;\n};\nexport const ToolBarToolTitle = ({ toolName, letter }: ToolTitleProps) => {\n  return (\n    <Box sx={{ display: \"flex\", alignItems: \"center\" }}>\n      <Typography>{toolName}</Typography>\n      <Typography style={{ marginLeft: \"5px\" }}>(</Typography>\n      <KeyboardKey letter=\"shift\" />\n      <Typography>+</Typography>\n      <KeyboardKey letter={letter} />\n      <Typography>)</Typography>\n    </Box>\n  );\n};\n","import ListItem from \"@mui/material/ListItem\";\nimport ListItemIcon from \"@mui/material/ListItemIcon\";\nimport React, { ReactElement, useState } from \"react\";\nimport SvgIcon from \"@mui/material/SvgIcon\";\nimport Typography from \"@mui/material/Typography\";\nimport { Card, CardActionArea, CardContent, Tooltip } from \"@mui/material\";\nimport { ToolBarToolTitle } from \"./ToolBarToolTitle\";\n\ntype TooltipCardProps = {\n  name: string;\n  onClose: () => void;\n};\n\ntype ToolProps = {\n  children: React.ReactNode;\n  name: string;\n  onClick: () => void;\n  selected: boolean;\n};\n\nexport const TooltipCard = ({ name, onClose }: TooltipCardProps) => {\n  let description: string | ReactElement;\n\n  switch (name) {\n    case \"Pointer\":\n      description = (\n        <ToolBarToolTitle toolName={\"Select annotations\"} letter={\"S\"} />\n      );\n      break;\n    case \"Rectangular annotation\":\n      description = (\n        <ToolBarToolTitle toolName={\"Rectangular annotation\"} letter={\"R\"} />\n      );\n      break;\n    case \"Elliptical annotation\":\n      description = (\n        <ToolBarToolTitle toolName={\"Elliptical annotation\"} letter={\"E\"} />\n      );\n      break;\n    case \"Freehand annotation\":\n      description = (\n        <ToolBarToolTitle toolName={\"Pen annotation\"} letter={\"D\"} />\n      );\n      break;\n    case \"Lasso annotation (L)\":\n      description = (\n        <ToolBarToolTitle toolName={\"Lasso annotation\"} letter={\"L\"} />\n      );\n      break;\n    case \"Polygonal annotation\":\n      description = (\n        <ToolBarToolTitle toolName={\"Polygonal annotation\"} letter={\"P\"} />\n      );\n      break;\n    case \"Magnetic annotation\":\n      description = (\n        <ToolBarToolTitle toolName={\"Magnetic annotation\"} letter={\"M\"} />\n      );\n      break;\n    case \"Color annotation\":\n      description = (\n        <ToolBarToolTitle toolName={\"Color annotation\"} letter={\"C\"} />\n      );\n      break;\n    case \"Quick annotation\":\n      description = (\n        <ToolBarToolTitle toolName={\"Quick annotation\"} letter={\"Q\"} />\n      );\n      break;\n    case \"Object annotation\":\n      description =\n        \"Select a rectangular annotation around a desired object to automatically generate its boundaries.\";\n      break;\n    case \"Hand\":\n      description = <ToolBarToolTitle toolName={\"Hand tool\"} letter={\"H\"} />;\n      break;\n    case \"Zoom\":\n      description = <ToolBarToolTitle toolName={\"Zoom tool\"} letter={\"Z\"} />;\n      break;\n    case \"Color Adjustment\":\n      description = (\n        <ToolBarToolTitle toolName={\"Color adjustment\"} letter={\"I\"} />\n      );\n      break;\n    default:\n      description = \"\";\n  }\n\n  return (\n    <Card sx={{ width: 210 }} variant=\"outlined\">\n      <CardActionArea>\n        <CardContent>\n          <Typography variant=\"body2\" color=\"textSecondary\" component=\"p\">\n            {description}\n          </Typography>\n        </CardContent>\n      </CardActionArea>\n    </Card>\n  );\n};\n\nexport const Tool = ({ children, name, onClick, selected }: ToolProps) => {\n  const [open, setOpen] = useState<boolean>(false);\n\n  const onClose = () => {\n    setOpen(false);\n  };\n\n  const onOpen = () => {\n    setOpen(true);\n  };\n\n  return (\n    <Tooltip\n      // can't use \"sx\" prop directly to access tooltip\n      // see: https://github.com/mui-org/material-ui/issues/28679\n      componentsProps={{\n        tooltip: {\n          sx: { backgroundColor: \"transparent\", maxWidth: \"none\" },\n        },\n      }}\n      onClose={onClose}\n      onOpen={onOpen}\n      open={open}\n      placement=\"left\"\n      title={<TooltipCard name={name} onClose={onClose} />}\n    >\n      <ListItem button onClick={onClick} selected={selected}>\n        <ListItemIcon>\n          <SvgIcon fontSize=\"small\">{children}</SvgIcon>\n        </ListItemIcon>\n      </ListItem>\n    </Tooltip>\n  );\n};\n","import Drawer from \"@mui/material/Drawer\";\nimport React from \"react\";\nimport { ToolType as OperationType } from \"../../../../types/ToolType\";\nimport { Tool } from \"../Tool\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { toolTypeSelector } from \"../../../../store/selectors\";\nimport { imageViewerSlice } from \"../../../../store/slices\";\nimport {\n  ColorAdjustmentIcon,\n  ColorSelectionIcon,\n  EllipticalSelectionIcon,\n  HandIcon,\n  LassoSelectionIcon,\n  MagneticSelectionIcon,\n  PenSelectionIcon,\n  PolygonalSelectionIcon,\n  QuickSelectionIcon,\n  RectangularSelectionIcon,\n  SelectionIcon,\n  ZoomIcon,\n} from \"../../../../icons\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\n\nexport const Tools = () => {\n  const dispatch = useDispatch();\n\n  const activeOperation = useSelector(toolTypeSelector);\n\n  const t = useTranslation();\n\n  return (\n    <Drawer\n      anchor=\"right\"\n      sx={{\n        flexShrink: 0,\n        whiteSpace: \"nowrap\",\n        width: 56,\n        \"& > .MuiDrawer-paper\": {\n          width: 56,\n        },\n      }}\n      variant=\"permanent\"\n    >\n      <br />\n      <Tool\n        name={t(\"Hand\")}\n        onClick={() => {\n          dispatch(\n            imageViewerSlice.actions.setOperation({\n              operation: OperationType.Hand,\n            })\n          );\n        }}\n        selected={activeOperation === OperationType.Hand}\n      >\n        <HandIcon />\n      </Tool>\n\n      <Tool\n        name={t(\"Zoom\")}\n        onClick={() => {\n          dispatch(\n            imageViewerSlice.actions.setOperation({\n              operation: OperationType.Zoom,\n            })\n          );\n        }}\n        selected={activeOperation === OperationType.Zoom}\n      >\n        <ZoomIcon />\n      </Tool>\n\n      <Tool\n        name={t(\"Color Adjustment\")}\n        onClick={() => {\n          dispatch(\n            imageViewerSlice.actions.setOperation({\n              operation: OperationType.ColorAdjustment,\n            })\n          );\n        }}\n        selected={activeOperation === OperationType.ColorAdjustment}\n      >\n        <ColorAdjustmentIcon />\n      </Tool>\n\n      <br />\n\n      <Tool\n        name={t(\"Pointer\")}\n        onClick={() => {\n          dispatch(\n            imageViewerSlice.actions.setOperation({\n              operation: OperationType.Pointer,\n            })\n          );\n        }}\n        selected={activeOperation === OperationType.Pointer}\n      >\n        <SelectionIcon />\n      </Tool>\n\n      <br />\n      <Tool\n        name={t(\"Rectangular annotation\")}\n        onClick={() => {\n          dispatch(\n            imageViewerSlice.actions.setOperation({\n              operation: OperationType.RectangularAnnotation,\n            })\n          );\n        }}\n        selected={activeOperation === OperationType.RectangularAnnotation}\n      >\n        <RectangularSelectionIcon />\n      </Tool>\n\n      <Tool\n        name={t(\"Elliptical annotation\")}\n        onClick={() => {\n          dispatch(\n            imageViewerSlice.actions.setOperation({\n              operation: OperationType.EllipticalAnnotation,\n            })\n          );\n        }}\n        selected={activeOperation === OperationType.EllipticalAnnotation}\n      >\n        <EllipticalSelectionIcon />\n      </Tool>\n\n      <Tool\n        name={t(\"Polygonal annotation\")}\n        onClick={() => {\n          dispatch(\n            imageViewerSlice.actions.setOperation({\n              operation: OperationType.PolygonalAnnotation,\n            })\n          );\n        }}\n        selected={activeOperation === OperationType.PolygonalAnnotation}\n      >\n        <PolygonalSelectionIcon />\n      </Tool>\n\n      <br />\n\n      <Tool\n        name={t(\"Freehand annotation\")}\n        onClick={() => {\n          dispatch(\n            imageViewerSlice.actions.setOperation({\n              operation: OperationType.PenAnnotation,\n            })\n          );\n        }}\n        selected={activeOperation === OperationType.PenAnnotation}\n      >\n        <PenSelectionIcon />\n      </Tool>\n\n      <br />\n\n      <Tool\n        name={t(\"Lasso annotation (L)\")}\n        onClick={() => {\n          dispatch(\n            imageViewerSlice.actions.setOperation({\n              operation: OperationType.LassoAnnotation,\n            })\n          );\n        }}\n        selected={activeOperation === OperationType.LassoAnnotation}\n      >\n        <LassoSelectionIcon />\n      </Tool>\n\n      <Tool\n        name={t(\"Magnetic annotation\")}\n        onClick={() => {\n          dispatch(\n            imageViewerSlice.actions.setOperation({\n              operation: OperationType.MagneticAnnotation,\n            })\n          );\n        }}\n        selected={activeOperation === OperationType.MagneticAnnotation}\n      >\n        <MagneticSelectionIcon />\n      </Tool>\n\n      <br />\n\n      <Tool\n        name={t(\"Color annotation\")}\n        onClick={() => {\n          dispatch(\n            imageViewerSlice.actions.setOperation({\n              operation: OperationType.ColorAnnotation,\n            })\n          );\n        }}\n        selected={activeOperation === OperationType.ColorAnnotation}\n      >\n        <ColorSelectionIcon />\n      </Tool>\n\n      <Tool\n        name={t(\"Quick annotation\")}\n        onClick={() => {\n          dispatch(\n            imageViewerSlice.actions.setOperation({\n              operation: OperationType.QuickAnnotation,\n            })\n          );\n        }}\n        selected={activeOperation === OperationType.QuickAnnotation}\n      >\n        <QuickSelectionIcon />\n      </Tool>\n\n      {/*<Tool*/}\n      {/*  name={t(\"Object annotation\")}*/}\n      {/*  onClick={() => {*/}\n      {/*    dispatch(*/}\n      {/*      applicationSlice.actions.setOperation({*/}\n      {/*        operation: OperationType.ObjectAnnotation,*/}\n      {/*      })*/}\n      {/*    );*/}\n      {/*  }}*/}\n      {/*  selected={activeOperation === OperationType.ObjectAnnotation}*/}\n      {/*>*/}\n      {/*  <ObjectSelectionIcon />*/}\n      {/*</Tool>*/}\n      <br />\n    </Drawer>\n  );\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nimport { Image } from \"../../types/Image\";\n\nexport const scaledImageHeightSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}) => {\n  if (!imageViewer.images.length) return;\n\n  const image = imageViewer.images.filter((image: Image) => {\n    return image.id === imageViewer.activeImageId;\n  })[0];\n\n  if (!image) return;\n\n  return image.shape.height * imageViewer.stageScale;\n};\n","import * as ReactKonva from \"react-konva\";\nimport React, { useEffect, useState } from \"react\";\nimport useImage from \"use-image\";\nimport Konva from \"konva\";\nimport { useSelector } from \"react-redux\";\nimport {\n  boundingClientRectSelector,\n  stageScaleSelector,\n} from \"../../../../../store/selectors\";\nimport { scaledImageWidthSelector } from \"../../../../../store/selectors/scaledImageWidthSelector\";\nimport { scaledImageHeightSelector } from \"../../../../../store/selectors/scaledImageHeightSelector\";\nimport { imageSrcSelector } from \"../../../../../store/selectors/imageSrcSelector\";\nimport { channelsSelector } from \"../../../../../store/selectors/intensityRangeSelector\";\nimport { createIntensityFilter } from \"../../../ToolOptions/ColorAdjustmentOptions/ColorAdjustmentOptions/ColorAdjustmentOptions\";\nimport { ChannelType } from \"../../../../../types/ChannelType\";\nimport { isEqual } from \"lodash\";\n\nexport const Image = React.forwardRef<Konva.Image>((_, ref) => {\n  const src = useSelector(imageSrcSelector);\n\n  const width = useSelector(scaledImageWidthSelector);\n\n  const height = useSelector(scaledImageHeightSelector);\n\n  const [image] = useImage(src ? src : \"\", \"anonymous\");\n\n  const [filters, setFilters] = useState<Array<any>>();\n\n  const channels = useSelector(channelsSelector);\n\n  const boundingClientRect = useSelector(boundingClientRectSelector);\n\n  const stageScale = useSelector(stageScaleSelector);\n\n  const normalizeFont = 1300;\n\n  useEffect(() => {\n    console.info(width, height);\n  }, [width, height]);\n\n  useEffect(() => {\n    // @ts-ignore\n    if (!ref || !ref.current) return;\n    const defaultChannels: Array<ChannelType> = []; //number of channels depends on whether image is greyscale or RGB\n    for (let i = 0; i < channels.length; i++) {\n      defaultChannels.push({\n        range: [0, 255],\n        visible: true,\n      });\n    }\n    if (isEqual(channels, defaultChannels)) {\n      setFilters([]);\n      // @ts-ignore\n      ref?.current.clearCache();\n    } else {\n      const IntensityFilter = createIntensityFilter(channels);\n      setFilters([IntensityFilter]);\n      // @ts-ignore\n      ref?.current.cache();\n    }\n  }, [channels, stageScale, ref]);\n\n  useEffect(() => {\n    // @ts-ignore\n    if (!ref || !ref.current) return;\n    setFilters([]);\n    // @ts-ignore\n    ref?.current.clearCache();\n  }, [image, ref]);\n\n  if (!src) {\n    return (\n      <>\n        <ReactKonva.Text\n          x={\n            boundingClientRect.x +\n            (80 * boundingClientRect.width) / normalizeFont\n          } //center depending on window width\n          y={0.4 * boundingClientRect.height}\n          text={\n            'To start annotating, drag and drop an image onto the canvas or click on \"Open Image\".'\n          }\n          fill={\"white\"}\n          fontSize={(30 * boundingClientRect.width) / normalizeFont} //scale font depending on window width\n        />\n      </>\n    );\n  }\n\n  return (\n    <>\n      <ReactKonva.Image\n        height={height}\n        image={image}\n        ref={ref}\n        width={width}\n        filters={filters}\n      />\n    </>\n  );\n});\n","import { EllipticalAnnotationTool } from \"../../../../../../annotator/image/Tool\";\nimport * as ReactKonva from \"react-konva\";\nimport React from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { stageScaleSelector } from \"../../../../../../store/selectors\";\nimport { useMarchingAnts } from \"../../../../../../hooks\";\n\ntype EllipticalSelectionProps = {\n  operator: EllipticalAnnotationTool;\n};\n\nexport const EllipticalSelection = ({ operator }: EllipticalSelectionProps) => {\n  const dashOffset = useMarchingAnts();\n\n  const stageScale = useSelector(stageScaleSelector);\n\n  if (!operator.center || !operator.radius) return null;\n\n  const x = operator.center.x * stageScale;\n  const y = operator.center.y * stageScale;\n\n  return (\n    <>\n      <ReactKonva.Group>\n        <ReactKonva.Ellipse\n          dash={[4, 2]}\n          dashOffset={-dashOffset}\n          radiusX={operator.radius.x}\n          radiusY={operator.radius.y}\n          scale={{ x: stageScale, y: stageScale }}\n          stroke=\"black\"\n          strokeWidth={1 / stageScale}\n          x={x}\n          y={y}\n        />\n        <ReactKonva.Ellipse\n          dash={[4 / stageScale, 2 / stageScale]}\n          dashOffset={-dashOffset}\n          radiusX={operator.radius.x}\n          radiusY={operator.radius.y}\n          scale={{ x: stageScale, y: stageScale }}\n          stroke=\"white\"\n          strokeWidth={1 / stageScale}\n          x={x}\n          y={y}\n        />\n      </ReactKonva.Group>\n    </>\n  );\n};\n","import * as ReactKonva from \"react-konva\";\nimport React from \"react\";\nimport { LassoAnnotationTool } from \"../../../../../../annotator/image/Tool\";\nimport { useMarchingAnts } from \"../../../../../../hooks\";\nimport { useSelector } from \"react-redux\";\nimport { stageScaleSelector } from \"../../../../../../store/selectors\";\n\ntype LassoSelectionProps = {\n  operator: LassoAnnotationTool;\n};\n\nexport const LassoSelection = ({ operator }: LassoSelectionProps) => {\n  const dashOffset = useMarchingAnts();\n\n  const stageScale = useSelector(stageScaleSelector);\n\n  if (!operator.origin) return <></>;\n\n  return (\n    <>\n      <ReactKonva.Group>\n        <ReactKonva.Circle\n          fill=\"white\"\n          radius={3}\n          stroke=\"black\"\n          strokeWidth={1}\n          x={operator.origin.x * stageScale}\n          y={operator.origin.y * stageScale}\n        />\n\n        {operator.anchor && (\n          <>\n            <ReactKonva.Circle\n              fill=\"black\"\n              radius={3}\n              stroke=\"white\"\n              strokeWidth={1}\n              x={operator.anchor.x * stageScale}\n              y={operator.anchor.y * stageScale}\n            />\n          </>\n        )}\n        <ReactKonva.Line\n          points={operator.buffer}\n          scale={{ x: stageScale, y: stageScale }}\n          stroke=\"black\"\n          strokeWidth={1 / stageScale}\n        />\n        <ReactKonva.Line\n          dash={[4 / stageScale, 2 / stageScale]}\n          dashOffset={-dashOffset}\n          scale={{ x: stageScale, y: stageScale }}\n          stroke=\"white\"\n          points={operator.buffer}\n          strokeWidth={1 / stageScale}\n        />\n      </ReactKonva.Group>\n    </>\n  );\n};\n","import * as ReactKonva from \"react-konva\";\nimport React from \"react\";\nimport { MagneticAnnotationTool } from \"../../../../../../annotator/image/Tool\";\nimport { useMarchingAnts } from \"../../../../../../hooks\";\nimport { useSelector } from \"react-redux\";\nimport { stageScaleSelector } from \"../../../../../../store/selectors\";\n\ntype MagneticSelectionProps = {\n  operator: MagneticAnnotationTool;\n};\n\nexport const MagneticSelection = ({ operator }: MagneticSelectionProps) => {\n  const dashOffset = useMarchingAnts();\n\n  const stageScale = useSelector(stageScaleSelector);\n\n  if (!operator.origin) return <></>;\n\n  return (\n    <>\n      <ReactKonva.Group>\n        <ReactKonva.Circle\n          fill=\"white\"\n          radius={3}\n          stroke=\"black\"\n          strokeWidth={1}\n          x={operator.origin.x * stageScale}\n          y={operator.origin.y * stageScale}\n        />\n        {operator.anchor && (\n          <>\n            <ReactKonva.Circle\n              fill=\"black\"\n              radius={3}\n              stroke=\"white\"\n              strokeWidth={1}\n              x={operator.anchor.x * stageScale}\n              y={operator.anchor.y * stageScale}\n            />\n          </>\n        )}\n        <ReactKonva.Line\n          points={operator.buffer}\n          scale={{ x: stageScale, y: stageScale }}\n          stroke=\"black\"\n          strokeWidth={1 / stageScale}\n        />\n        <ReactKonva.Line\n          dash={[4 / stageScale, 2 / stageScale]}\n          scale={{ x: stageScale, y: stageScale }}\n          dashOffset={-dashOffset}\n          stroke=\"white\"\n          points={operator.buffer}\n          strokeWidth={1 / stageScale}\n        />\n      </ReactKonva.Group>\n    </>\n  );\n};\n","import { ObjectAnnotationTool } from \"../../../../../../annotator/image/Tool\";\nimport * as ReactKonva from \"react-konva\";\nimport React from \"react\";\nimport { useMarchingAnts } from \"../../../../../../hooks\";\nimport { useSelector } from \"react-redux\";\nimport { stageScaleSelector } from \"../../../../../../store/selectors\";\n\ntype ObjectSelectionProps = {\n  operator: ObjectAnnotationTool;\n};\n\nexport const ObjectSelection = ({ operator }: ObjectSelectionProps) => {\n  const dashOffset = useMarchingAnts();\n\n  const stageScale = useSelector(stageScaleSelector);\n\n  if (!operator.origin || !operator.width || !operator.height) return null;\n\n  if (!operator.origin) return null;\n\n  const x = operator.origin.x * stageScale;\n  const y = operator.origin.y * stageScale;\n\n  return (\n    <>\n      <ReactKonva.Group>\n        <ReactKonva.Rect\n          dash={[4 / stageScale, 2 / stageScale]}\n          dashOffset={-dashOffset}\n          scale={{ x: stageScale, y: stageScale }}\n          height={operator.height}\n          stroke=\"black\"\n          strokeWidth={1 / stageScale}\n          width={operator.width}\n          x={x}\n          y={y}\n        />\n        <ReactKonva.Rect\n          dash={[4 / stageScale, 2 / stageScale]}\n          dashOffset={-dashOffset}\n          height={operator.height}\n          scale={{ x: stageScale, y: stageScale }}\n          stroke=\"white\"\n          strokeWidth={1 / stageScale}\n          width={operator.width}\n          x={x}\n          y={y}\n        />\n        <ReactKonva.Line\n          scale={{ x: stageScale, y: stageScale }}\n          stroke=\"white\"\n          points={operator.points}\n          strokeWidth={1}\n        />\n      </ReactKonva.Group>\n    </>\n  );\n};\n","import * as ReactKonva from \"react-konva\";\nimport React from \"react\";\nimport { PolygonalAnnotationTool } from \"../../../../../../annotator/image/Tool\";\nimport { useMarchingAnts } from \"../../../../../../hooks\";\nimport { useSelector } from \"react-redux\";\nimport { stageScaleSelector } from \"../../../../../../store/selectors\";\n\ntype PolygonalSelectionProps = {\n  operator: PolygonalAnnotationTool;\n};\n\nexport const PolygonalSelection = ({ operator }: PolygonalSelectionProps) => {\n  const dashOffset = useMarchingAnts();\n\n  const stageScale = useSelector(stageScaleSelector);\n\n  if (!operator.origin) return <></>;\n\n  return (\n    <>\n      <ReactKonva.Group>\n        <ReactKonva.Circle\n          fill=\"white\"\n          radius={3}\n          stroke=\"black\"\n          strokeWidth={1}\n          x={operator.origin.x * stageScale}\n          y={operator.origin.y * stageScale}\n        />\n\n        {operator.anchor && (\n          <>\n            <ReactKonva.Circle\n              fill=\"black\"\n              radius={3}\n              stroke=\"white\"\n              strokeWidth={1}\n              x={operator.anchor.x * stageScale}\n              y={operator.anchor.y * stageScale}\n            />\n          </>\n        )}\n        <ReactKonva.Line\n          points={operator.buffer}\n          scale={{ x: stageScale, y: stageScale }}\n          stroke=\"black\"\n          strokeWidth={1 / stageScale}\n        />\n        <ReactKonva.Line\n          dash={[4 / stageScale, 2 / stageScale]}\n          dashOffset={-dashOffset}\n          scale={{ x: stageScale, y: stageScale }}\n          stroke=\"white\"\n          points={operator.buffer}\n          strokeWidth={1 / stageScale}\n        />\n      </ReactKonva.Group>\n    </>\n  );\n};\n","import { RectangularAnnotationTool } from \"../../../../../../annotator/image/Tool\";\nimport * as ReactKonva from \"react-konva\";\nimport React from \"react\";\nimport { useMarchingAnts } from \"../../../../../../hooks\";\nimport { useSelector } from \"react-redux\";\nimport { stageScaleSelector } from \"../../../../../../store/selectors\";\n\ntype RectangularSelectionProps = {\n  operator: RectangularAnnotationTool;\n};\n\nexport const RectangularSelection = ({\n  operator,\n}: RectangularSelectionProps) => {\n  const dashOffset = useMarchingAnts();\n\n  const stageScale = useSelector(stageScaleSelector);\n\n  if (!operator.origin || !operator.width || !operator.height) return null;\n\n  const x = operator.origin.x * stageScale;\n  const y = operator.origin.y * stageScale;\n\n  return (\n    <>\n      <ReactKonva.Group>\n        <ReactKonva.Rect\n          dash={[4 / stageScale, 2 / stageScale]}\n          dashOffset={-dashOffset}\n          height={operator.height}\n          scale={{ x: stageScale, y: stageScale }}\n          stroke=\"black\"\n          strokeWidth={1 / stageScale}\n          width={operator.width}\n          x={x}\n          y={y}\n        />\n        <ReactKonva.Rect\n          dash={[4 / stageScale, 2 / stageScale]}\n          dashOffset={-dashOffset}\n          height={operator.height}\n          scale={{ x: stageScale, y: stageScale }}\n          stroke=\"white\"\n          strokeWidth={1 / stageScale}\n          width={operator.width}\n          x={x}\n          y={y}\n        />\n      </ReactKonva.Group>\n    </>\n  );\n};\n","import { ColorAnnotationTool } from \"../../../../../../annotator/image/Tool\";\nimport * as ReactKonva from \"react-konva\";\nimport React, { useEffect, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { stageScaleSelector } from \"../../../../../../store/selectors\";\n\ntype ColorSelectionProps = {\n  operator: ColorAnnotationTool;\n};\n\nexport const ColorSelection = ({ operator }: ColorSelectionProps) => {\n  const [image, setImage] = useState<HTMLImageElement>();\n\n  const stageScale = useSelector(stageScaleSelector);\n\n  useEffect(() => {\n    const image = new Image();\n    image.src = operator.overlayData;\n    setImage(image);\n  }, [operator.overlayData]);\n\n  if (!operator.overlayData || !operator.offset) return null;\n\n  return (\n    <>\n      <ReactKonva.Group>\n        <ReactKonva.Image\n          image={image}\n          scale={{ x: stageScale, y: stageScale }}\n        />\n      </ReactKonva.Group>\n    </>\n  );\n};\n","import { QuickAnnotationTool } from \"../../../../../../annotator/image/Tool\";\nimport * as ReactKonva from \"react-konva\";\nimport React, { useEffect, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { stageScaleSelector } from \"../../../../../../store/selectors\";\n\ntype QuickSelectionProps = {\n  operator: QuickAnnotationTool;\n};\n\nexport const QuickSelection = ({ operator }: QuickSelectionProps) => {\n  const [image, setImage] = useState<HTMLImageElement>();\n\n  useEffect(() => {\n    if (!operator.currentMask) return;\n\n    const image = new Image();\n    image.src = operator.currentMask.toDataURL(\"image/png\", {\n      useCanvas: true,\n    });\n    setImage(image);\n  }, [operator.currentMask, operator.lastSuperpixel]);\n\n  const stageScale = useSelector(stageScaleSelector);\n\n  if (!operator.currentMask) return null;\n\n  return (\n    <>\n      <ReactKonva.Group>\n        <ReactKonva.Image\n          image={image}\n          scale={{ x: stageScale, y: stageScale }}\n        />\n      </ReactKonva.Group>\n    </>\n  );\n};\n","import * as ReactKonva from \"react-konva\";\nimport React from \"react\";\nimport { PenAnnotationTool } from \"../../../../../../annotator/image/Tool\";\nimport { useSelector } from \"react-redux\";\nimport { stageScaleSelector } from \"../../../../../../store/selectors\";\n\ntype PenSelectionProps = {\n  operator: PenAnnotationTool;\n};\n\nexport const PenSelection = ({ operator }: PenSelectionProps) => {\n  const stageScale = useSelector(stageScaleSelector);\n  return (\n    <>\n      <ReactKonva.Group>\n        <ReactKonva.Line\n          points={operator.buffer}\n          lineJoin=\"round\"\n          lineCap=\"round\"\n          scale={{ x: stageScale, y: stageScale }}\n          stroke=\"red\"\n          strokeWidth={operator.brushSize * 2}\n        />\n      </ReactKonva.Group>\n    </>\n  );\n};\n","import * as ReactKonva from \"react-konva\";\nimport React from \"react\";\nimport { useMarchingAnts } from \"../../../../../../hooks\";\nimport { useSelector } from \"react-redux\";\nimport { zoomSelectionSelector } from \"../../../../../../store/selectors\";\n\nexport const ZoomSelection = () => {\n  const dashOffset = useMarchingAnts();\n\n  const { dragging, minimum, maximum, selecting } = useSelector(\n    zoomSelectionSelector\n  );\n\n  if (!minimum || !maximum || !selecting || !dragging) return <></>;\n\n  return (\n    <>\n      <ReactKonva.Group>\n        <ReactKonva.Rect\n          dash={[4, 2]}\n          dashOffset={-dashOffset}\n          height={maximum.y - minimum.y}\n          stroke=\"black\"\n          strokeWidth={1}\n          width={maximum.x - minimum.x}\n          x={minimum.x}\n          y={minimum.y}\n        />\n        <ReactKonva.Rect\n          dash={[4, 2]}\n          dashOffset={-dashOffset}\n          height={maximum.y - minimum.y}\n          stroke=\"white\"\n          strokeWidth={1}\n          width={maximum.x - minimum.x}\n          x={minimum.x}\n          y={minimum.y}\n        />\n      </ReactKonva.Group>\n    </>\n  );\n};\n","import React from \"react\";\nimport {\n  ColorAnnotationTool,\n  EllipticalAnnotationTool,\n  LassoAnnotationTool,\n  MagneticAnnotationTool,\n  ObjectAnnotationTool,\n  PenAnnotationTool,\n  PolygonalAnnotationTool,\n  QuickAnnotationTool,\n  RectangularAnnotationTool,\n  Tool,\n} from \"../../../../../../annotator/image/Tool\";\nimport { EllipticalSelection } from \"../EllipticalSelection\";\nimport { ToolType } from \"../../../../../../types/ToolType\";\nimport { LassoSelection } from \"../LassoSelection\";\nimport { MagneticSelection } from \"../MagneticSelection\";\nimport { ObjectSelection } from \"../ObjectSelection\";\nimport { PolygonalSelection } from \"../PolygonalSelection\";\nimport { RectangularSelection } from \"../RectangularSelection\";\nimport { ColorSelection } from \"../ColorSelection/ColorSelection\";\nimport { QuickSelection } from \"../QuickSelection/QuickSelection\";\nimport { PenSelection } from \"../PenSelection\";\nimport { ZoomSelection } from \"../ZoomSelection\";\n\ntype SelectionProps = {\n  tool?: Tool;\n  toolType?: ToolType;\n};\n\nexport const Selection = ({ tool, toolType }: SelectionProps) => {\n  if (!toolType || !tool) return <></>;\n\n  switch (toolType) {\n    case ToolType.ColorAnnotation:\n      return <ColorSelection operator={tool as ColorAnnotationTool} />;\n    case ToolType.EllipticalAnnotation:\n      return (\n        <EllipticalSelection operator={tool as EllipticalAnnotationTool} />\n      );\n    case ToolType.LassoAnnotation:\n      return <LassoSelection operator={tool as LassoAnnotationTool} />;\n    case ToolType.MagneticAnnotation:\n      return <MagneticSelection operator={tool as MagneticAnnotationTool} />;\n    case ToolType.ObjectAnnotation:\n      return <ObjectSelection operator={tool as ObjectAnnotationTool} />;\n    case ToolType.PenAnnotation:\n      return <PenSelection operator={tool as PenAnnotationTool} />;\n    case ToolType.PolygonalAnnotation:\n      return <PolygonalSelection operator={tool as PolygonalAnnotationTool} />;\n    case ToolType.RectangularAnnotation:\n      return (\n        <RectangularSelection operator={tool as RectangularAnnotationTool} />\n      );\n    case ToolType.Zoom:\n      return <ZoomSelection />;\n    case ToolType.QuickAnnotation:\n      return <QuickSelection operator={tool as QuickAnnotationTool} />;\n    default:\n      return <></>;\n  }\n};\n","import React from \"react\";\nimport { Selection } from \"../Selection\";\nimport { useSelector } from \"react-redux\";\nimport {\n  annotationStateSelector,\n  toolTypeSelector,\n} from \"../../../../../store/selectors\";\nimport { AnnotationStateType } from \"../../../../../types/AnnotationStateType\";\nimport { Tool } from \"../../../../../annotator/image/Tool\";\nimport { ToolType } from \"../../../../../types/ToolType\";\n\ntype SelectingProps = {\n  tool: Tool;\n};\n\nexport const Selecting = ({ tool }: SelectingProps) => {\n  const annotationState = useSelector(annotationStateSelector);\n\n  const toolType = useSelector(toolTypeSelector);\n\n  if (\n    annotationState !== AnnotationStateType.Annotating &&\n    toolType !== ToolType.QuickAnnotation\n  )\n    return <React.Fragment />;\n\n  return <Selection tool={tool} toolType={toolType} />;\n};\n","import * as ReactKonva from \"react-konva\";\nimport React, { useEffect, useState } from \"react\";\nimport {\n  stageScaleSelector,\n  toolTypeSelector,\n} from \"../../../../../store/selectors\";\nimport { useSelector } from \"react-redux\";\nimport { ToolType } from \"../../../../../types/ToolType\";\nimport { annotationStateSelector } from \"../../../../../store/selectors/annotationStateSelector\";\nimport { AnnotationStateType } from \"../../../../../types/AnnotationStateType\";\n\ntype ColorAnnotationToolTipProps = {\n  toolTipPosition?: { x: number; y: number };\n  initialPosition?: { x: number; y: number };\n  tolerance: number;\n};\n\nexport const ColorAnnotationToolTip = ({\n  toolTipPosition,\n  initialPosition,\n  tolerance,\n}: ColorAnnotationToolTipProps) => {\n  const [text, setText] = useState<string>(\"Tolerance: 0%\");\n  const toolType = useSelector(toolTypeSelector);\n\n  const stageScale = useSelector(stageScaleSelector);\n\n  const annotationState = useSelector(annotationStateSelector);\n\n  useEffect(() => {\n    if (!toolTipPosition) return;\n    setText(`Tolerance: ${tolerance}`);\n  }, [toolTipPosition, tolerance]);\n\n  if (toolType !== ToolType.ColorAnnotation) return <></>;\n\n  if (\n    annotationState !== AnnotationStateType.Annotating ||\n    !toolTipPosition ||\n    !initialPosition\n  ) {\n    return <React.Fragment />;\n  }\n\n  return (\n    <>\n      <ReactKonva.Group>\n        <ReactKonva.Line\n          points={[\n            toolTipPosition.x,\n            toolTipPosition.y!,\n            initialPosition.x,\n            initialPosition.y,\n          ]}\n          scale={{ x: stageScale, y: stageScale }}\n          strokeWidth={1}\n          stroke=\"white\"\n        />\n        <ReactKonva.Label\n          position={{\n            x: toolTipPosition.x * stageScale,\n            y: toolTipPosition.y * stageScale,\n          }}\n          opacity={0.75}\n        >\n          <ReactKonva.Tag fill={\"black\"} />\n          <ReactKonva.Text\n            fill={\"white\"}\n            fontSize={12}\n            padding={5}\n            text={text}\n          />\n        </ReactKonva.Label>\n      </ReactKonva.Group>\n    </>\n  );\n};\n","export default __webpack_public_path__ + \"static/media/pop-up-on.b776a1ef.mp3\";","export default __webpack_public_path__ + \"static/media/pop-up-off.83c6ba5b.mp3\";","import React, { useEffect, useState } from \"react\";\nimport * as ReactKonva from \"react-konva\";\nimport { useSelector } from \"react-redux\";\nimport { scaledImageWidthSelector } from \"../../../../../store/selectors/scaledImageWidthSelector\";\nimport { scaledImageHeightSelector } from \"../../../../../store/selectors/scaledImageHeightSelector\";\nimport {\n  stageHeightSelector,\n  stageWidthSelector,\n  zoomSelectionSelector,\n  zoomToolOptionsSelector,\n} from \"../../../../../store/selectors\";\nimport { offsetSelector } from \"../../../../../store/selectors/offsetSelector\";\n\ntype LayerProps = {\n  children?: React.ReactNode;\n};\n\nexport const Layer = ({ children }: LayerProps) => {\n  const imageWidth = useSelector(scaledImageWidthSelector);\n  const imageHeight = useSelector(scaledImageHeightSelector);\n\n  const offset = useSelector(offsetSelector);\n\n  const { automaticCentering } = useSelector(zoomToolOptionsSelector);\n\n  const zoomSelection = useSelector(zoomSelectionSelector);\n\n  const stageWidth = useSelector(stageWidthSelector);\n  const stageHeight = useSelector(stageHeightSelector);\n\n  const [position, setPosition] = useState<{ x: number; y: number }>({\n    x: 0,\n    y: 0,\n  });\n\n  useEffect(() => {\n    if (!imageWidth || !imageHeight) return;\n\n    if (automaticCentering && !zoomSelection.dragging) {\n      setPosition({\n        x: (stageWidth - imageWidth) / 2,\n        y: (stageHeight - imageHeight) / 2,\n      });\n    } else {\n      setPosition({ x: stageWidth / 2, y: stageHeight / 2 });\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- zoomSelection.dragging not a dependency\n  }, [automaticCentering, stageWidth, stageHeight, imageWidth, imageHeight]);\n\n  return (\n    <>\n      <ReactKonva.Layer\n        imageSmoothingEnabled={false}\n        offset={offset}\n        position={position}\n      >\n        {children}\n      </ReactKonva.Layer>\n    </>\n  );\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nimport { Image } from \"../../types/Image\";\n\nexport const imageWidthSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}) => {\n  if (!imageViewer.images.length || !imageViewer.activeImageId) return;\n\n  const image = imageViewer.images.filter((image: Image) => {\n    return image.id === imageViewer.activeImageId;\n  })[0];\n\n  return image.shape.width;\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nimport { Image } from \"../../types/Image\";\n\nexport const imageHeightSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}) => {\n  if (!imageViewer.images.length || !imageViewer.activeImageId) return;\n\n  const image = imageViewer.images.find((image: Image) => {\n    return image.id === imageViewer.activeImageId;\n  });\n\n  if (!image) return;\n\n  return image.shape.height;\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nexport const cursorSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}): string => {\n  return imageViewer.cursor;\n};\n","import * as ReactKonva from \"react-konva\";\nimport React, { useRef, useState } from \"react\";\nimport * as _ from \"lodash\";\nimport { AnnotationType } from \"../../../../../types/AnnotationType\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { stageScaleSelector } from \"../../../../../store/selectors\";\nimport Konva from \"konva\";\nimport { selectedAnnotationSelector } from \"../../../../../store/selectors/selectedAnnotationSelector\";\nimport { decode, encode } from \"../../../../../annotator/image/rle\";\nimport * as ImageJS from \"image-js\";\nimport { selectedAnnotationsSelector } from \"../../../../../store/selectors/selectedAnnotationsSelector\";\nimport { AnnotationModeType } from \"../../../../../types/AnnotationModeType\";\nimport { unselectedAnnotationsSelector } from \"../../../../../store/selectors/unselectedAnnotationsSelector\";\nimport useSound from \"use-sound\";\nimport createAnnotationSoundEffect from \"../../../../../annotator/sounds/pop-up-on.mp3\";\nimport { soundEnabledSelector } from \"../../../../../store/selectors/soundEnabledSelector\";\nimport deleteAnnotationSoundEffect from \"../../../../../annotator/sounds/pop-up-off.mp3\";\nimport { imageWidthSelector } from \"../../../../../store/selectors/imageWidthSelector\";\nimport { imageHeightSelector } from \"../../../../../store/selectors/imageHeightSelector\";\nimport { cursorSelector } from \"../../../../../store/selectors/cursorSelector\";\nimport {\n  imageViewerSlice,\n  setSelectedAnnotations,\n} from \"../../../../../store/slices\";\nimport { activeImageIdSelector } from \"../../../../../store/selectors/activeImageIdSelector\";\nimport { AnnotationStateType } from \"../../../../../types/AnnotationStateType\";\nimport { AnnotationTool } from \"../../../../../annotator/image/Tool\";\n\ntype box = {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  rotation: number;\n};\n\ntype TransformerProps = {\n  transformPosition: ({\n    x,\n    y,\n  }: {\n    x: number;\n    y: number;\n  }) => { x: number; y: number } | undefined;\n  annotationId: string;\n  annotationTool?: AnnotationTool;\n};\n\nexport const Transformer = ({\n  transformPosition,\n  annotationId,\n  annotationTool,\n}: TransformerProps) => {\n  const unselectedAnnotations = useSelector(unselectedAnnotationsSelector);\n\n  const selectedAnnotation = useSelector(selectedAnnotationSelector);\n\n  const selectedAnnotations = useSelector(selectedAnnotationsSelector);\n\n  const transformerRef = useRef<Konva.Transformer | null>(null);\n\n  const activeImageId = useSelector(activeImageIdSelector);\n\n  const dispatch = useDispatch();\n\n  const [boundBox, setBoundBox] = useState<box | null>(null);\n\n  const [startBox, setStartBox] = useState<box>({\n    x: 0,\n    y: 0,\n    height: 0,\n    width: 0,\n    rotation: 0,\n  });\n\n  const [center, setCenter] = useState<{ x: number; y: number } | undefined>();\n\n  const stageScale = useSelector(stageScaleSelector);\n\n  const cursor = useSelector(cursorSelector);\n\n  const soundEnabled = useSelector(soundEnabledSelector);\n\n  const imageWidth = useSelector(imageWidthSelector);\n  const imageHeight = useSelector(imageHeightSelector);\n\n  const [playCreateAnnotationSoundEffect] = useSound(\n    createAnnotationSoundEffect\n  );\n\n  const [playDeleteAnnotationSoundEffect] = useSound(\n    deleteAnnotationSoundEffect\n  );\n\n  const boundingBoxFunc = (oldBox: box, newBox: box) => {\n    if (!boundBox) {\n      setStartBox(oldBox);\n    }\n\n    const relativeNewBox = getRelativeBox(newBox);\n\n    if (!imageWidth || !imageHeight || !relativeNewBox)\n      return boundBox ? boundBox : startBox;\n\n    const minimumBoxArea = 5;\n\n    if (\n      relativeNewBox.width < minimumBoxArea ||\n      relativeNewBox.height < minimumBoxArea\n    )\n      return boundBox ? boundBox : oldBox;\n\n    if (\n      Math.floor(relativeNewBox.x + relativeNewBox.width) > imageWidth ||\n      Math.floor(relativeNewBox.y + relativeNewBox.height) > imageHeight ||\n      relativeNewBox.x < 0 ||\n      relativeNewBox.y < 0\n    ) {\n      return boundBox ? boundBox : oldBox;\n    }\n\n    setBoundBox(newBox);\n    return newBox;\n  };\n\n  /*\n   * Obtain box coordinates in image space\n   */\n  const getRelativeBox = (boundBox: box) => {\n    const relativePosition = transformPosition({\n      x: boundBox.x,\n      y: boundBox.y,\n    });\n    if (!relativePosition) return;\n    return {\n      x: relativePosition.x / stageScale,\n      y: relativePosition.y / stageScale,\n      height: boundBox.height / stageScale,\n      width: boundBox.width / stageScale,\n      rotation: 0,\n    };\n  };\n\n  const getScaledCoordinate = (\n    contour: Array<number>,\n    center: { x: number; y: number },\n    scale: { x: number; y: number }\n  ) => {\n    return _.flatten(\n      _.map(_.chunk(contour, 2), (el: Array<number>) => {\n        return [\n          Math.round(center.x + scale.x * (el[0] - center.x)),\n          Math.round(center.y + scale.y * (el[1] - center.y)),\n        ];\n      })\n    );\n  };\n\n  const onTransformEnd = () => {\n    if (!selectedAnnotation) return;\n\n    if (!boundBox || !startBox) return;\n\n    if (!imageWidth || !imageHeight) return;\n\n    const relativeBoundBox = getRelativeBox(boundBox);\n    const relativeStartBox = getRelativeBox(startBox);\n\n    if (!relativeBoundBox || !relativeStartBox || !center) return;\n\n    // get necessary parameters for transformation\n    const scaleX = relativeBoundBox.width / relativeStartBox.width;\n    const scaleY = relativeBoundBox.height / relativeStartBox.height;\n\n    //extract roi and resize\n    const mask = selectedAnnotation.mask;\n    const boundingBox = selectedAnnotation.boundingBox;\n\n    const roiWidth = boundingBox[2] - boundingBox[0];\n    const roiHeight = boundingBox[3] - boundingBox[1];\n    const roiX = boundingBox[0];\n    const roiY = boundingBox[1];\n\n    const decodedData = new Uint8Array(decode(mask));\n\n    if (!roiWidth || !roiHeight) return;\n\n    const roi = new ImageJS.Image(roiWidth, roiHeight, decodedData, {\n      components: 1,\n      alpha: 0,\n    });\n\n    const resizedMaskROI = roi.resize({\n      height: Math.round(roiHeight * scaleY),\n      width: Math.round(roiWidth * scaleX),\n      preserveAspectRatio: false,\n    });\n\n    const scaledOffset = getScaledCoordinate([roiX, roiY], center, {\n      x: scaleX,\n      y: scaleY,\n    });\n\n    const resizedMask = encode(Uint8Array.from(resizedMaskROI.data));\n\n    const updatedAnnotation = {\n      ...selectedAnnotation,\n      boundingBox: [\n        scaledOffset[0],\n        scaledOffset[1],\n        scaledOffset[0] + resizedMaskROI.width,\n        scaledOffset[1] + resizedMaskROI.height,\n      ] as [number, number, number, number],\n      mask: resizedMask,\n    };\n\n    dispatch(\n      imageViewerSlice.actions.setSelectedAnnotations({\n        selectedAnnotations: [],\n        selectedAnnotation: undefined,\n      })\n    );\n\n    updateSelectedAnnotation(updatedAnnotation);\n\n    setCenter(undefined);\n    setBoundBox(null);\n  };\n\n  const updateSelectedAnnotation = (updatedAnnotation: AnnotationType) => {\n    dispatch(\n      setSelectedAnnotations({\n        selectedAnnotations: [updatedAnnotation],\n        selectedAnnotation: updatedAnnotation,\n      })\n    );\n  };\n\n  const getOppositeAnchorPosition = () => {\n    if (!transformerRef || !transformerRef.current) return { x: 0, y: 0 };\n    const activeAnchor = transformerRef.current.getActiveAnchor();\n    switch (activeAnchor) {\n      case \"bottom-right\": {\n        return transformerRef.current\n          .findOne(\".\".concat(\"top-left\"))\n          .position();\n      }\n      case \"bottom-center\": {\n        return transformerRef.current\n          .findOne(\".\".concat(\"top-center\"))\n          .position();\n      }\n      case \"bottom-left\": {\n        return transformerRef.current\n          .findOne(\".\".concat(\"top-right\"))\n          .position();\n      }\n      case \"middle-left\": {\n        return transformerRef.current\n          .findOne(\".\".concat(\"middle-right\"))\n          .position();\n      }\n      case \"top-left\": {\n        return transformerRef.current\n          .findOne(\".\".concat(\"bottom-right\"))\n          .position();\n      }\n      case \"top-center\": {\n        return transformerRef.current\n          .findOne(\".\".concat(\"bottom-center\"))\n          .position();\n      }\n      case \"top-right\": {\n        return transformerRef.current\n          .findOne(\".\".concat(\"bottom-left\"))\n          .position();\n      }\n      case \"middle-right\": {\n        return transformerRef.current\n          .findOne(\".\".concat(\"middle-left\"))\n          .position();\n      }\n      default: {\n        return { x: 0, y: 0 };\n      }\n    }\n  };\n\n  const onTransform = () => {\n    if (!center) {\n      //at the beginning of transform, find out the \"center\" coordinate used for the resizing (i.e., the coordinate that does not move during resize)\n      const oppositeAnchorPosition = getOppositeAnchorPosition();\n      const scaledOppositeAnchorPosition = {\n        x: oppositeAnchorPosition.x / stageScale,\n        y: oppositeAnchorPosition.y / stageScale,\n      };\n\n      const relativeStartBox = getRelativeBox(startBox);\n\n      if (!relativeStartBox) return;\n\n      setCenter({\n        x: scaledOppositeAnchorPosition.x + relativeStartBox.x,\n        y: scaledOppositeAnchorPosition.y + relativeStartBox.y,\n      });\n    }\n  };\n\n  const onTransformStart = () => {\n    const selected = selectedAnnotations.find((annotation: AnnotationType) => {\n      return annotation.id === annotationId;\n    });\n\n    if (!selected) return;\n\n    dispatch(\n      setSelectedAnnotations({\n        selectedAnnotations: [selected],\n        selectedAnnotation: selected,\n      })\n    );\n  };\n\n  const clearAnnotations = () => {\n    if (annotationTool) {\n      annotationTool.deselect();\n    } else {\n      dispatch(\n        imageViewerSlice.actions.setAnnotationState({\n          annotationState: AnnotationStateType.Blank,\n          annotationTool: annotationTool,\n        })\n      );\n    }\n\n    dispatch(\n      imageViewerSlice.actions.setSelectionMode({\n        selectionMode: AnnotationModeType.New,\n      })\n    );\n\n    dispatch(\n      setSelectedAnnotations({\n        selectedAnnotations: [],\n        selectedAnnotation: undefined,\n      })\n    );\n  };\n\n  const onSaveAnnotationClick = (event: Konva.KonvaEventObject<MouseEvent>) => {\n    const container = event.target.getStage()!.container();\n    container.style.cursor = cursor;\n\n    if (!activeImageId) return;\n\n    dispatch(\n      imageViewerSlice.actions.setImageInstances({\n        instances: [...unselectedAnnotations, ...selectedAnnotations],\n        imageId: activeImageId,\n      })\n    );\n\n    transformerRef.current!.detach();\n    transformerRef.current!.getLayer()?.batchDraw();\n\n    clearAnnotations();\n    if (soundEnabled) playCreateAnnotationSoundEffect();\n  };\n\n  const onClearAnnotationClick = (\n    event: Konva.KonvaEventObject<MouseEvent>\n  ) => {\n    const container = event.target.getStage()!.container();\n    container.style.cursor = cursor;\n\n    clearAnnotations();\n    if (soundEnabled) playDeleteAnnotationSoundEffect();\n  };\n\n  const onMouseEnter = (event: Konva.KonvaEventObject<MouseEvent>) => {\n    const container = event.target.getStage()!.container();\n    container.style.cursor = \"pointer\";\n  };\n\n  const onMouseLeave = (event: Konva.KonvaEventObject<MouseEvent>) => {\n    const container = event.target.getStage()!.container();\n    container.style.cursor = cursor;\n  };\n\n  let posX = 0;\n  let posY = 0;\n\n  if (selectedAnnotation && selectedAnnotations.length === 1) {\n    posX =\n      Math.max(\n        selectedAnnotation.boundingBox[0],\n        selectedAnnotation.boundingBox[2]\n      ) * stageScale;\n    posY =\n      Math.max(\n        selectedAnnotation.boundingBox[1],\n        selectedAnnotation.boundingBox[3]\n      ) * stageScale;\n  }\n\n  return (\n    <>\n      <ReactKonva.Group>\n        <ReactKonva.Transformer\n          boundBoxFunc={boundingBoxFunc}\n          onTransform={onTransform}\n          onTransformEnd={onTransformEnd}\n          onTransformStart={onTransformStart}\n          id={\"tr-\".concat(annotationId)}\n          ref={transformerRef}\n          rotateEnabled={false}\n        />\n        {selectedAnnotation && selectedAnnotations.length === 1 && (\n          <>\n            <ReactKonva.Group>\n              <ReactKonva.Label\n                position={{\n                  x: posX - 58,\n                  y: posY + 6,\n                }}\n                onClick={onSaveAnnotationClick}\n                id={\"label\"}\n                onMouseEnter={onMouseEnter}\n                onMouseLeave={onMouseLeave}\n              >\n                <ReactKonva.Tag\n                  cornerRadius={3}\n                  fill={\"darkgreen\"}\n                  lineJoin={\"round\"}\n                  shadowColor={\"black\"}\n                  shadowBlur={10}\n                  shadowOffset={{ x: 5, y: 5 }}\n                />\n                <ReactKonva.Text\n                  fill={\"white\"}\n                  fontSize={14}\n                  padding={6}\n                  text={\"Confirm\"}\n                />\n              </ReactKonva.Label>\n              <ReactKonva.Label\n                position={{\n                  x: posX - 52,\n                  y: posY + 35,\n                }}\n                onClick={onClearAnnotationClick}\n                id={\"label\"}\n                onMouseEnter={onMouseEnter}\n                onMouseLeave={onMouseLeave}\n              >\n                <ReactKonva.Tag\n                  cornerRadius={3}\n                  fill={\"darkred\"}\n                  lineJoin={\"round\"}\n                  shadowColor={\"black\"}\n                  shadowBlur={10}\n                  shadowOffset={{ x: 5, y: 5 }}\n                />\n                <ReactKonva.Text\n                  fill={\"white\"}\n                  fontSize={14}\n                  padding={6}\n                  text={\"Cancel\"}\n                />\n              </ReactKonva.Label>\n            </ReactKonva.Group>\n          </>\n        )}\n      </ReactKonva.Group>\n    </>\n  );\n};\n","import React from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { AnnotationTool } from \"../../../../../annotator/image/Tool\";\nimport { selectedAnnotationsIdsSelector } from \"../../../../../store/selectors/selectedAnnotationsIdsSelector\";\n\nimport { Transformer } from \"../Transformer/Transformer\";\n\ntype TransformersProps = {\n  transformPosition: ({\n    x,\n    y,\n  }: {\n    x: number;\n    y: number;\n  }) => { x: number; y: number } | undefined;\n  annotationTool?: AnnotationTool;\n};\n\nexport const Transformers = ({\n  transformPosition,\n  annotationTool,\n}: TransformersProps) => {\n  const selectedAnnotationsIds = useSelector(selectedAnnotationsIdsSelector);\n\n  if (!selectedAnnotationsIds) return <></>;\n\n  return (\n    <>\n      {selectedAnnotationsIds.map((annotationId, idx) => {\n        return (\n          <>\n            <React.Fragment key={annotationId}>\n              <Transformer\n                transformPosition={transformPosition}\n                annotationId={annotationId}\n                annotationTool={annotationTool}\n              />\n            </React.Fragment>\n          </>\n        );\n      })}\n    </>\n  );\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nexport const stagePositionSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}): { x: number; y: number } => {\n  return imageViewer.stagePosition;\n};\n","import React from \"react\";\nimport { ToolType } from \"../../../../../types/ToolType\";\nimport * as ReactKonva from \"react-konva\";\nimport { useSelector } from \"react-redux\";\nimport { toolTypeSelector } from \"../../../../../store/selectors\";\nimport { penSelectionBrushSizeSelector } from \"../../../../../store/selectors/penSelectionBrushSizeSelector\";\nimport { scaledImageWidthSelector } from \"../../../../../store/selectors/scaledImageWidthSelector\";\nimport { scaledImageHeightSelector } from \"../../../../../store/selectors/scaledImageHeightSelector\";\n\ntype PenAnnotationToolTipProps = {\n  currentPosition?: { x: number; y: number };\n  annotating: boolean;\n};\nexport const PenAnnotationToolTip = ({\n  annotating,\n  currentPosition,\n}: PenAnnotationToolTipProps) => {\n  const toolType = useSelector(toolTypeSelector);\n\n  const penSelectionBrushSize = useSelector(penSelectionBrushSizeSelector);\n\n  const imageWidth = useSelector(scaledImageWidthSelector);\n  const imageHeight = useSelector(scaledImageHeightSelector);\n\n  if (\n    toolType !== ToolType.PenAnnotation ||\n    annotating ||\n    !currentPosition ||\n    !imageWidth ||\n    !imageHeight\n  )\n    return <></>;\n\n  if (\n    currentPosition.x > imageWidth - penSelectionBrushSize ||\n    currentPosition.y > imageHeight - penSelectionBrushSize ||\n    currentPosition.x < 0 ||\n    currentPosition.y < 0\n  )\n    return <></>;\n\n  return (\n    <>\n      <ReactKonva.Ellipse\n        radiusX={penSelectionBrushSize}\n        radiusY={penSelectionBrushSize}\n        x={currentPosition.x}\n        y={currentPosition.y}\n        stroke=\"grey\"\n        strokewidth={1}\n        dash={[2, 2]}\n      />\n    </>\n  );\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nexport const visibleCategoriesSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}) => {\n  return imageViewer.categories\n    .filter((category) => category.visible)\n    .map((category) => {\n      return category.id;\n    });\n};\n","export const toRGBA = (color: string, alpha: number) => {\n  const r = parseInt(color.slice(1, 3), 16);\n  const g = parseInt(color.slice(3, 5), 16);\n  const b = parseInt(color.slice(5, 7), 16);\n\n  return [r, g, b];\n  // return `rgba(${r}, ${g}, ${b}, ${alpha})`;\n};\n","import React, { useEffect, useState } from \"react\";\nimport { Category } from \"../../../../../../../types/Category\";\nimport * as ReactKonva from \"react-konva\";\nimport * as _ from \"lodash\";\nimport { AnnotationType } from \"../../../../../../../types/AnnotationType\";\nimport { useSelector } from \"react-redux\";\nimport { stageScaleSelector } from \"../../../../../../../store/selectors\";\nimport { colorOverlayROI } from \"../../../../../../../image/imageHelper\";\nimport { imageWidthSelector } from \"../../../../../../../store/selectors/imageWidthSelector\";\nimport { imageHeightSelector } from \"../../../../../../../store/selectors/imageHeightSelector\";\nimport { toRGBA } from \"../../../../../../../annotator/image\";\nimport { annotatorCategoriesSelector } from \"../../../../../../../store/selectors/annotatorCategoriesSelector\";\n\ntype AnnotationProps = {\n  annotation: AnnotationType;\n};\n\nexport const Annotation = ({ annotation }: AnnotationProps) => {\n  const categories = useSelector(annotatorCategoriesSelector);\n  const stageScale = useSelector(stageScaleSelector);\n\n  const imageWidth = useSelector(imageWidthSelector);\n  const imageHeight = useSelector(imageHeightSelector);\n\n  const [imageMask, setImageMask] = useState<HTMLImageElement>();\n\n  const fill = _.find(\n    categories,\n    (category: Category) => category.id === annotation.categoryId\n  )?.color;\n\n  useEffect(() => {\n    if (!annotation.mask || !imageWidth || !imageHeight) return;\n    if (!fill) return;\n    const boxWidth = annotation.boundingBox[2] - annotation.boundingBox[0];\n    const boxHeight = annotation.boundingBox[3] - annotation.boundingBox[1];\n    if (!boxWidth || !boxHeight) return;\n    if (Math.round(boxWidth) <= 0 || Math.round(boxHeight) <= 0) return;\n    const color = toRGBA(fill, 0);\n    setImageMask(\n      colorOverlayROI(\n        annotation.mask,\n        annotation.boundingBox,\n        imageWidth,\n        imageHeight,\n        color,\n        stageScale\n      )\n    );\n  }, [\n    annotation.mask,\n    fill,\n    annotation.boundingBox,\n    imageWidth,\n    imageHeight,\n    stageScale,\n  ]);\n\n  if (!annotation) return <></>;\n\n  return (\n    <>\n      <ReactKonva.Group>\n        <ReactKonva.Image\n          id={annotation.id}\n          image={imageMask}\n          x={annotation.boundingBox[0] * stageScale}\n          y={annotation.boundingBox[1] * stageScale}\n        />\n      </ReactKonva.Group>\n    </>\n  );\n};\n","import React, { useEffect, useState } from \"react\";\nimport { AnnotationType } from \"../../../../../../types/AnnotationType\";\nimport { useSelector } from \"react-redux\";\nimport { visibleCategoriesSelector } from \"../../../../../../store/selectors/visibleCategoriesSelector\";\nimport { Annotation } from \"./Annotation\";\nimport { imageInstancesSelector } from \"../../../../../../store/selectors\";\nimport { selectedAnnotationsSelector } from \"../../../../../../store/selectors/selectedAnnotationsSelector\";\nimport { unselectedAnnotationsSelector } from \"../../../../../../store/selectors/unselectedAnnotationsSelector\";\nimport { activeImagePlaneSelector } from \"../../../../../../store/selectors/activeImagePlaneSelector\";\n\nexport const ConfirmedAnnotations = () => {\n  const annotations = useSelector(imageInstancesSelector);\n\n  const activeImagePlane = useSelector(activeImagePlaneSelector);\n\n  const unselectedAnnotations = useSelector(unselectedAnnotationsSelector);\n\n  const selectedAnnotations = useSelector(selectedAnnotationsSelector);\n\n  const visibleCategories = useSelector(visibleCategoriesSelector);\n\n  const [visibleAnnotations, setVisibleAnnotations] = useState<\n    Array<AnnotationType>\n  >([]);\n\n  useEffect(() => {\n    if (!annotations) return;\n\n    setVisibleAnnotations(\n      unselectedAnnotations.filter((annotation: AnnotationType) => {\n        return (\n          visibleCategories.includes(annotation.categoryId) &&\n          annotation.plane === activeImagePlane\n        );\n      })\n    );\n  }, [\n    activeImagePlane,\n    annotations,\n    selectedAnnotations,\n    visibleCategories,\n    unselectedAnnotations,\n  ]);\n\n  return (\n    <>\n      {visibleAnnotations.map((annotation: AnnotationType) => (\n        <Annotation annotation={annotation} key={annotation.id} />\n      ))}\n    </>\n  );\n};\n","import * as _ from \"lodash\";\nimport { Category } from \"../../../../../../types/Category\";\nimport * as ReactKonva from \"react-konva\";\nimport React, { useEffect, useState } from \"react\";\nimport { AnnotationType } from \"../../../../../../types/AnnotationType\";\nimport { useSelector } from \"react-redux\";\nimport { stageScaleSelector } from \"../../../../../../store/selectors\";\nimport { imageWidthSelector } from \"../../../../../../store/selectors/imageWidthSelector\";\nimport { imageHeightSelector } from \"../../../../../../store/selectors/imageHeightSelector\";\nimport { toRGBA } from \"../../../../../../annotator/image\";\nimport { colorOverlayROI } from \"../../../../../../image/imageHelper\";\nimport { annotatorCategoriesSelector } from \"../../../../../../store/selectors/annotatorCategoriesSelector\";\n\ntype AnnotationProps = {\n  annotation: AnnotationType;\n};\n\nexport const SelectedAnnotation = ({ annotation }: AnnotationProps) => {\n  const categories = useSelector(annotatorCategoriesSelector);\n  const stageScale = useSelector(stageScaleSelector);\n\n  const imageWidth = useSelector(imageWidthSelector);\n  const imageHeight = useSelector(imageHeightSelector);\n\n  const [imageMask, setImageMask] = useState<HTMLImageElement>();\n\n  const fill = _.find(\n    categories,\n    (category: Category) => category.id === annotation.categoryId\n  )?.color;\n\n  useEffect(() => {\n    if (!annotation.mask || !imageWidth || !imageHeight) return;\n    if (!fill) return;\n    const color = toRGBA(fill, 0);\n    const overlayMask = colorOverlayROI(\n      annotation.mask,\n      annotation.boundingBox,\n      imageWidth,\n      imageHeight,\n      color,\n      stageScale\n    );\n    if (!overlayMask) return;\n    setImageMask(overlayMask);\n  }, [\n    annotation.mask,\n    fill,\n    annotation.boundingBox,\n    imageHeight,\n    imageWidth,\n    stageScale,\n  ]);\n\n  return (\n    <>\n      {/*// @ts-ignore */}\n      <ReactKonva.Image\n        image={imageMask}\n        id={annotation.id}\n        key={annotation.id}\n        x={annotation.boundingBox[0] * stageScale}\n        y={annotation.boundingBox[1] * stageScale}\n        width={Math.round(\n          (annotation.boundingBox[2] - annotation.boundingBox[0]) * stageScale\n        )}\n        height={Math.round(\n          (annotation.boundingBox[3] - annotation.boundingBox[1]) * stageScale\n        )}\n      />\n    </>\n  );\n};\n","import React from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { selectedAnnotationSelector } from \"../../../../../../store/selectors/selectedAnnotationSelector\";\nimport { AnnotationType } from \"../../../../../../types/AnnotationType\";\nimport { selectedAnnotationsSelector } from \"../../../../../../store/selectors/selectedAnnotationsSelector\";\nimport { SelectedAnnotation } from \"../SelectedAnnotation/SelectedAnnotation\";\n\nexport const SelectedAnnotations = () => {\n  const selectedAnnotation = useSelector(selectedAnnotationSelector);\n\n  const selectedAnnotations = useSelector(selectedAnnotationsSelector);\n\n  if (!selectedAnnotations || !selectedAnnotation) return <></>;\n\n  return (\n    <>\n      {selectedAnnotations.map((annotation: AnnotationType) => {\n        return (\n          <SelectedAnnotation key={annotation.id} annotation={annotation} />\n        );\n      })}\n    </>\n  );\n};\n","import React from \"react\";\nimport { ConfirmedAnnotations } from \"./ConfirmedAnnotations\";\nimport { SelectedAnnotations } from \"./SelectedAnnotations/SelectedAnnotations\";\n\nexport const Annotations = () => {\n  return (\n    <>\n      <SelectedAnnotations />\n      <ConfirmedAnnotations />\n    </>\n  );\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nexport const pointerSelectionSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}): {\n  dragging: boolean;\n  minimum: { x: number; y: number } | undefined;\n  maximum: { x: number; y: number } | undefined;\n  selecting: boolean;\n} => {\n  return imageViewer.pointerSelection;\n};\n","import * as ReactKonva from \"react-konva\";\nimport React from \"react\";\nimport { useMarchingAnts } from \"../../../../../../hooks\";\nimport { useSelector } from \"react-redux\";\n\nimport { pointerSelectionSelector } from \"../../../../../../store/selectors/pointerSelectionSelector\";\nimport { toolTypeSelector } from \"../../../../../../store/selectors\";\nimport { ToolType } from \"../../../../../../types/ToolType\";\n\nexport const PointerSelection = () => {\n  const dashOffset = useMarchingAnts();\n\n  const toolType = useSelector(toolTypeSelector);\n\n  const { dragging, minimum, maximum, selecting } = useSelector(\n    pointerSelectionSelector\n  );\n\n  if (!minimum || !maximum || !selecting || !dragging) return <></>;\n\n  if (toolType !== ToolType.Pointer) return <></>;\n\n  return (\n    <>\n      <ReactKonva.Rect\n        dash={[4, 2]}\n        dashOffset={-dashOffset}\n        height={maximum.y - minimum.y}\n        stroke=\"white\"\n        strokeWidth={1}\n        width={maximum.x - minimum.x}\n        x={minimum.x}\n        y={minimum.y}\n      />\n    </>\n  );\n};\n","import { ImageViewer } from \"../../types/ImageViewer\";\nexport const currentIndexSelector = ({\n  imageViewer,\n}: {\n  imageViewer: ImageViewer;\n}) => {\n  return imageViewer.currentIndex;\n};\n","import { ToolType } from \"../../types/ToolType\";\nimport {\n  getAnnotationsInBox,\n  getOverlappingAnnotations,\n} from \"../../image/imageHelper\";\nimport { AnnotationType } from \"../../types/AnnotationType\";\nimport { batch, useDispatch, useSelector } from \"react-redux\";\nimport {\n  imageInstancesSelector,\n  stageScaleSelector,\n  toolTypeSelector,\n} from \"../../store/selectors\";\nimport { selectedAnnotationsSelector } from \"../../store/selectors/selectedAnnotationsSelector\";\nimport { currentIndexSelector } from \"../../store/selectors/currentIndexSelector\";\nimport { useHotkeys } from \"react-hotkeys-hook\";\nimport hotkeys from \"hotkeys-js\";\nimport { useState } from \"react\";\nimport { pointerSelectionSelector } from \"../../store/selectors/pointerSelectionSelector\";\nimport { selectedAnnotationsIdsSelector } from \"../../store/selectors/selectedAnnotationsIdsSelector\";\nimport { imageWidthSelector } from \"../../store/selectors/imageWidthSelector\";\nimport { imageHeightSelector } from \"../../store/selectors/imageHeightSelector\";\nimport {\n  imageViewerSlice,\n  setPointerSelection,\n  setSelectedAnnotations,\n  setSelectedCategoryId,\n} from \"../../store/slices\";\n\nexport const usePointer = () => {\n  const dispatch = useDispatch();\n\n  const delta = 10;\n\n  const toolType = useSelector(toolTypeSelector);\n\n  const selectedAnnotations = useSelector(selectedAnnotationsSelector);\n\n  const selectedAnnotationsIds = useSelector(selectedAnnotationsIdsSelector);\n\n  const pointerSelection = useSelector(pointerSelectionSelector);\n\n  const annotations = useSelector(imageInstancesSelector);\n\n  const stageScale = useSelector(stageScaleSelector);\n\n  const imageWidth = useSelector(imageWidthSelector);\n\n  const imageHeight = useSelector(imageHeightSelector);\n\n  let overlappingAnnotationsIds: Array<string> = [];\n\n  const currentIndex = useSelector(currentIndexSelector);\n\n  const [shift, setShift] = useState<boolean>(false);\n\n  useHotkeys(\n    \"*\",\n    (event) => {\n      if (hotkeys.shift) {\n        if (event.type === \"keyup\") {\n          setShift(false);\n        }\n      }\n    },\n    { keyup: true }\n  );\n\n  useHotkeys(\n    \"*\",\n    (event) => {\n      if (hotkeys.shift) {\n        if (event.type === \"keydown\") {\n          setShift(true);\n        }\n      }\n    },\n    { keydown: true }\n  );\n\n  const onMouseDown = (position: { x: number; y: number }) => {\n    dispatch(\n      setPointerSelection({\n        pointerSelection: {\n          ...pointerSelection,\n          dragging: false,\n          minimum: position,\n          selecting: true,\n        },\n      })\n    );\n  };\n\n  const onMouseMove = (position: { x: number; y: number }) => {\n    if (!pointerSelection.selecting) return;\n\n    if (!position || !pointerSelection.minimum) return;\n\n    dispatch(\n      setPointerSelection({\n        pointerSelection: {\n          ...pointerSelection,\n          dragging: Math.abs(position.x - pointerSelection.minimum.x) >= delta,\n          maximum: position,\n        },\n      })\n    );\n  };\n\n  const onMouseUp = (position: { x: number; y: number }) => {\n    if (!pointerSelection.selecting || !pointerSelection.minimum) return;\n\n    if (pointerSelection.dragging) {\n      if (!position) return;\n\n      // correct minimum or maximum in the case where user may have selected rectangle from right to left\n      const maximum: { x: number; y: number } = {\n        x:\n          pointerSelection.minimum.x > position.x\n            ? pointerSelection.minimum.x\n            : position.x,\n        y:\n          pointerSelection.minimum.y > position.y\n            ? pointerSelection.minimum.y\n            : position.y,\n      };\n      const minimum: { x: number; y: number } = {\n        x:\n          pointerSelection.minimum.x > position.x\n            ? position.x\n            : pointerSelection.minimum.x,\n        y:\n          pointerSelection.minimum.y > position.y\n            ? position.y\n            : pointerSelection.minimum.y,\n      };\n\n      dispatch(\n        setPointerSelection({\n          pointerSelection: {\n            ...pointerSelection,\n            minimum: minimum,\n            maximum: maximum,\n          },\n        })\n      );\n\n      if (!minimum || !annotations) return;\n\n      const scaledMinimum = {\n        x: minimum.x / stageScale,\n        y: minimum.y / stageScale,\n      };\n      const scaledMaximum = {\n        x: maximum.x / stageScale,\n        y: maximum.y / stageScale,\n      };\n\n      const annotationsInBox = getAnnotationsInBox(\n        scaledMinimum,\n        scaledMaximum,\n        annotations\n      );\n\n      if (annotationsInBox.length) {\n        if (!shift) {\n          batch(() => {\n            dispatch(\n              setSelectedAnnotations({\n                selectedAnnotations: annotationsInBox,\n                selectedAnnotation: annotationsInBox[0],\n              })\n            );\n            dispatch(\n              setSelectedCategoryId({\n                selectedCategoryId: annotationsInBox[0].categoryId,\n              })\n            );\n          });\n        } else {\n          //only include if not already selected\n          const additionalAnnotations = annotationsInBox.filter(\n            (annotation: AnnotationType) => {\n              return !selectedAnnotationsIds.includes(annotation.id);\n            }\n          );\n          dispatch(\n            setSelectedAnnotations({\n              selectedAnnotations: [\n                ...selectedAnnotations,\n                ...additionalAnnotations,\n              ],\n              selectedAnnotation: annotationsInBox[0],\n            })\n          );\n        }\n      }\n    } else {\n      onClick(position);\n    }\n\n    dispatch(\n      setPointerSelection({\n        pointerSelection: { ...pointerSelection, selecting: false },\n      })\n    );\n  };\n\n  const onClick = (position: { x: number; y: number }) => {\n    if (toolType !== ToolType.Pointer) return;\n\n    if (!position) return;\n\n    if (!annotations || !annotations.length || !imageWidth || !imageHeight)\n      return;\n\n    const scaledCurrentPosition = {\n      x: position.x / stageScale,\n      y: position.y / stageScale,\n    };\n\n    overlappingAnnotationsIds = getOverlappingAnnotations(\n      scaledCurrentPosition,\n      annotations,\n      imageWidth,\n      imageHeight\n    );\n\n    let currentAnnotation: AnnotationType | undefined;\n\n    if (overlappingAnnotationsIds.length > 1) {\n      dispatch(\n        imageViewerSlice.actions.setCurrentIndex({\n          currentIndex:\n            currentIndex + 1 === overlappingAnnotationsIds.length\n              ? 0\n              : currentIndex + 1,\n        })\n      );\n      const nextAnnotationId = overlappingAnnotationsIds[currentIndex];\n\n      currentAnnotation = annotations.find((annotation: AnnotationType) => {\n        return annotation.id === nextAnnotationId;\n      });\n    } else {\n      currentAnnotation = annotations.find((annotation: AnnotationType) => {\n        return annotation.id === overlappingAnnotationsIds[0];\n      });\n      dispatch(\n        imageViewerSlice.actions.setCurrentIndex({\n          currentIndex: 0,\n        })\n      );\n    }\n\n    if (!currentAnnotation) return;\n\n    if (!shift) {\n      batch(() => {\n        if (!currentAnnotation) return;\n        dispatch(\n          setSelectedAnnotations({\n            selectedAnnotations: [currentAnnotation],\n            selectedAnnotation: currentAnnotation,\n          })\n        );\n        dispatch(\n          setSelectedCategoryId({\n            selectedCategoryId: currentAnnotation.categoryId,\n          })\n        );\n      });\n    }\n\n    if (shift && !selectedAnnotationsIds.includes(currentAnnotation.id)) {\n      //include newly selected annotation if not already selected\n      dispatch(\n        setSelectedAnnotations({\n          selectedAnnotations: [...selectedAnnotations, currentAnnotation],\n          selectedAnnotation: currentAnnotation,\n        })\n      );\n    }\n  };\n\n  return { onMouseDown, onMouseUp, onMouseMove, onPointerClick: onClick };\n};\n","import * as ReactKonva from \"react-konva\";\nimport * as _ from \"lodash\";\nimport Konva from \"konva\";\nimport React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useReducer,\n  useRef,\n  useState,\n} from \"react\";\nimport { ToolType } from \"../../../../../types/ToolType\";\nimport {\n  imageInstancesSelector,\n  selectedCategorySelector,\n  selectionModeSelector,\n  stageHeightSelector,\n  stageScaleSelector,\n  stageWidthSelector,\n  toolTypeSelector,\n} from \"../../../../../store/selectors\";\nimport { Provider, useDispatch, useSelector, useStore } from \"react-redux\";\nimport {\n  useAnnotationTool,\n  useCursor,\n  useHandTool,\n  useZoom,\n} from \"../../../../../hooks\";\nimport { penSelectionBrushSizeSelector } from \"../../../../../store/selectors/penSelectionBrushSizeSelector\";\nimport { AnnotationModeType } from \"../../../../../types/AnnotationModeType\";\nimport { Image } from \"../Image\";\nimport { Selecting } from \"../Selecting\";\nimport { annotationStateSelector } from \"../../../../../store/selectors/annotationStateSelector\";\nimport { AnnotationStateType } from \"../../../../../types/AnnotationStateType\";\nimport {\n  ColorAnnotationTool,\n  ObjectAnnotationTool,\n  Tool,\n} from \"../../../../../annotator/image/Tool\";\nimport { ColorAnnotationToolTip } from \"../ColorAnnotationToolTip\";\nimport useSound from \"use-sound\";\nimport createAnnotationSoundEffect from \"../../../../../annotator/sounds/pop-up-on.mp3\";\nimport deleteAnnotationSoundEffect from \"../../../../../annotator/sounds/pop-up-off.mp3\";\nimport { soundEnabledSelector } from \"../../../../../store/selectors/soundEnabledSelector\";\nimport { Layer } from \"../Layer\";\nimport { ZoomSelection } from \"../Selection/ZoomSelection\";\nimport { useKeyboardShortcuts } from \"../../../../../hooks/useKeyboardShortcuts\";\nimport { selectedAnnotationSelector } from \"../../../../../store/selectors/selectedAnnotationSelector\";\nimport { selectedAnnotationsIdsSelector } from \"../../../../../store/selectors/selectedAnnotationsIdsSelector\";\nimport { Transformers } from \"../Transformers/Transformers\";\nimport { useWindowFocusHandler } from \"../../../../../hooks/useWindowFocusHandler/useWindowFocusHandler\";\nimport { stagePositionSelector } from \"../../../../../store/selectors/stagePositionSelector\";\nimport { KonvaEventObject } from \"konva/lib/Node\";\nimport { scaledImageWidthSelector } from \"../../../../../store/selectors/scaledImageWidthSelector\";\nimport { scaledImageHeightSelector } from \"../../../../../store/selectors/scaledImageHeightSelector\";\nimport { PenAnnotationToolTip } from \"../PenAnnotationToolTip/PenAnnotationToolTip\";\nimport { selectedAnnotationsSelector } from \"../../../../../store/selectors/selectedAnnotationsSelector\";\nimport { Annotations } from \"../Annotations/Annotations\";\nimport { unselectedAnnotationsSelector } from \"../../../../../store/selectors/unselectedAnnotationsSelector\";\nimport { quickSelectionBrushSizeSelector } from \"../../../../../store/selectors/quickSelectionBrushSizeSelector\";\nimport { useHotkeys } from \"react-hotkeys-hook\";\nimport { PointerSelection } from \"../Selection/PointerSelection\";\nimport { usePointer } from \"../../../../../hooks/usePointer/usePointer\";\nimport { DndProvider } from \"react-dnd\";\nimport { HTML5Backend } from \"react-dnd-html5-backend\";\nimport { cursorSelector } from \"../../../../../store/selectors/cursorSelector\";\nimport {\n  imageViewerSlice,\n  setSelectedAnnotations,\n} from \"../../../../../store/slices\";\nimport { activeImageIdSelector } from \"../../../../../store/selectors/activeImageIdSelector\";\nimport { activeImagePlaneSelector } from \"../../../../../store/selectors/activeImagePlaneSelector\";\n\nexport const Stage = () => {\n  const imageRef = useRef<Konva.Image | null>(null);\n  const stageRef = useRef<Konva.Stage>(null);\n\n  const selectingRef = useRef<Konva.Line | null>(null);\n\n  const toolType = useSelector(toolTypeSelector);\n\n  const penSelectionBrushSize = useSelector(penSelectionBrushSizeSelector);\n  const selectedAnnotationsIds = useSelector(selectedAnnotationsIdsSelector);\n  const quickSelectionBrushSize = useSelector(quickSelectionBrushSizeSelector);\n  const selectedCategory = useSelector(selectedCategorySelector);\n\n  const selectedAnnotations = useSelector(selectedAnnotationsSelector);\n  const unselectedAnnotations = useSelector(unselectedAnnotationsSelector);\n  const selectionMode = useSelector(selectionModeSelector);\n\n  const stageHeight = useSelector(stageHeightSelector);\n  const stageWidth = useSelector(stageWidthSelector);\n  const stagePosition = useSelector(stagePositionSelector);\n\n  const saveLabelRef = useRef<Konva.Label>();\n  const clearLabelRef = useRef<Konva.Label>();\n\n  const activeImageId = useSelector(activeImageIdSelector);\n  const activeImagePlane = useSelector(activeImagePlaneSelector);\n\n  const [currentPosition, setCurrentPosition] = useState<{\n    x: number;\n    y: number;\n  }>();\n\n  const scaledImageWidth = useSelector(scaledImageWidthSelector);\n  const scaledImageHeight = useSelector(scaledImageHeightSelector);\n\n  const stageScale = useSelector(stageScaleSelector);\n\n  const dispatch = useDispatch();\n\n  const {\n    deselect: onZoomDeselect,\n    onMouseUp: onZoomMouseUp,\n    onMouseMove: onZoomMouseMove,\n    onMouseDown: onZoomMouseDown,\n    onWheel: onZoomWheel,\n  } = useZoom();\n\n  const {\n    onMouseDown: onPointerMouseDown,\n    onMouseMove: onPointerMouseMove,\n    onMouseUp: onPointerMouseUp,\n  } = usePointer();\n\n  const [annotationTool] = useAnnotationTool();\n\n  const [, update] = useReducer((x) => x + 1, 0);\n\n  const annotations = useSelector(imageInstancesSelector);\n\n  const annotationState = useSelector(annotationStateSelector);\n\n  const selectedAnnotation = useSelector(selectedAnnotationSelector);\n\n  useWindowFocusHandler();\n\n  const [playCreateAnnotationSoundEffect] = useSound(\n    createAnnotationSoundEffect\n  );\n  const [playDeleteAnnotationSoundEffect] = useSound(\n    deleteAnnotationSoundEffect\n  );\n\n  const soundEnabled = useSelector(soundEnabledSelector);\n\n  const detachTransformer = (transformerId: string) => {\n    if (!stageRef || !stageRef.current) return;\n    const transformer = stageRef.current.findOne(`#${transformerId}`);\n\n    if (!transformer) return;\n\n    (transformer as Konva.Transformer).detach();\n    (transformer as Konva.Transformer).getLayer()?.batchDraw();\n  };\n\n  const deselectAllTransformers = () => {\n    if (!stageRef || !stageRef.current) return;\n\n    // const transformers = stageRef.current.find(\"Transformer\").toArray();\n    const transformers = stageRef.current.find(\"Transformer\");\n    transformers.forEach((tr: any) => {\n      (tr as Konva.Transformer).detach();\n      (tr as Konva.Transformer).getLayer()?.batchDraw();\n    });\n  };\n\n  const deselectAllAnnotations = useCallback(() => {\n    dispatch(\n      setSelectedAnnotations({\n        selectedAnnotations: [],\n        selectedAnnotation: undefined,\n      })\n    );\n  }, [dispatch]);\n\n  const deselectAnnotation = useCallback(() => {\n    if (!annotationTool) {\n      dispatch(\n        imageViewerSlice.actions.setAnnotationState({\n          annotationState: AnnotationStateType.Blank,\n          annotationTool,\n        })\n      );\n\n      return;\n    }\n\n    annotationTool.deselect();\n\n    if (!selectedAnnotation) return;\n\n    selectingRef.current = null;\n\n    const transformerId = \"tr-\".concat(selectedAnnotation.id);\n    detachTransformer(transformerId);\n  }, [annotationTool, selectedAnnotation, dispatch]);\n\n  const cursor = useSelector(cursorSelector);\n  useCursor();\n\n  useEffect(() => {\n    if (!stageRef || !stageRef.current) return;\n    stageRef.current.container().style.cursor = cursor;\n  }, [cursor]);\n\n  const onAnnotating = useMemo(() => {\n    const func = () => {\n      dispatch(\n        imageViewerSlice.actions.setAnnotationState({\n          annotationState: AnnotationStateType.Annotating,\n          annotationTool,\n        })\n      );\n    };\n    return func;\n  }, [annotationTool, dispatch]);\n\n  const onAnnotated = useMemo(() => {\n    const func = () => {\n      dispatch(\n        imageViewerSlice.actions.setAnnotationState({\n          annotationState: AnnotationStateType.Annotated,\n          annotationTool,\n        })\n      );\n\n      if (selectionMode !== AnnotationModeType.New) return;\n      annotationTool?.annotate(selectedCategory, activeImagePlane);\n    };\n    return func;\n  }, [\n    annotationTool,\n    selectedCategory,\n    activeImagePlane,\n    selectionMode,\n    dispatch,\n  ]);\n\n  const onDeselect = useMemo(() => {\n    const func = () => {\n      dispatch(\n        imageViewerSlice.actions.setAnnotationState({\n          annotationState: AnnotationStateType.Blank,\n          annotationTool,\n        })\n      );\n    };\n    return func;\n  }, [annotationTool, dispatch]);\n\n  useEffect(() => {\n    if (!annotationTool) return;\n    annotationTool.registerOnAnnotatedHandler(onAnnotated);\n    annotationTool.registerOnAnnotatingHandler(onAnnotating);\n    annotationTool.registerOnDeselectHandler(onDeselect);\n  }, [annotationTool, onAnnotated, onAnnotating, onDeselect]);\n\n  useEffect(() => {\n    if (toolType === ToolType.PenAnnotation) {\n      if (!annotationTool) return;\n      // @ts-ignore\n      annotationTool.brushSize = penSelectionBrushSize / stageScale;\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [penSelectionBrushSize]);\n\n  useEffect(() => {\n    if (toolType === ToolType.QuickAnnotation) {\n      if (!annotationTool) return;\n      //@ts-ignore\n      annotationTool.update(Math.round(quickSelectionBrushSize / stageScale));\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [quickSelectionBrushSize]);\n\n  useEffect(() => {\n    if (!stageRef || !stageRef.current) return;\n\n    _.forEach(selectedAnnotationsIds, (annotationId) => {\n      if (!stageRef || !stageRef.current) return;\n\n      const transformerId = \"tr-\".concat(annotationId);\n\n      const transformer = stageRef.current.findOne(`#${transformerId}`);\n      const line = stageRef.current.findOne(`#${annotationId}`);\n\n      if (!line) return;\n\n      if (!transformer) return;\n\n      (transformer as Konva.Transformer).nodes([line]);\n\n      const layer = (transformer as Konva.Transformer).getLayer();\n\n      if (!layer) return;\n\n      layer.batchDraw();\n\n      // Not ideal but this figures out which label is which\n      const label = stageRef.current.find(`#label`);\n      if (label.length > 1) {\n        saveLabelRef.current = label[0] as Konva.Label;\n        clearLabelRef.current = label[1] as Konva.Label;\n      }\n    });\n  }, [selectedAnnotationsIds, selectedAnnotation?.mask]);\n\n  const getRelativePointerPosition = (position: { x: number; y: number }) => {\n    if (!imageRef || !imageRef.current) return;\n\n    const transform = imageRef.current.getAbsoluteTransform().copy();\n\n    transform.invert();\n\n    return transform.point(position);\n  };\n\n  const onMouseDown = (event: KonvaEventObject<MouseEvent>) => {\n    if (\n      !event.target.getParent() ||\n      // TODO: shouldn't be using string for className here -- Nodar\n      event.target.getParent().className === \"Transformer\"\n    )\n      return;\n    memoizedOnMouseDown();\n  };\n\n  const memoizedOnMouseDown = useMemo(() => {\n    const func = () => {\n      if (toolType === ToolType.Hand || toolType === ToolType.ColorAdjustment)\n        return;\n\n      if (!stageRef || !stageRef.current) return;\n\n      const position = stageRef.current.getPointerPosition();\n\n      if (!position) return;\n\n      const relative = getRelativePointerPosition(position);\n\n      if (!relative) return;\n\n      if (saveLabelRef?.current?.getText() && clearLabelRef.current) {\n        //do not proceed with mouse down events if user has clicked on Save Annotation button\n        if (\n          (relative.x <\n            saveLabelRef.current.x() + saveLabelRef.current.width() &&\n            relative.x > saveLabelRef.current.x() &&\n            relative.y <\n              saveLabelRef.current.y() + saveLabelRef.current.height() &&\n            relative.y > saveLabelRef.current.y()) ||\n          (relative.x <\n            clearLabelRef.current.x() + clearLabelRef.current.width() &&\n            relative.x > clearLabelRef.current.x() &&\n            relative.y <\n              clearLabelRef.current.y() + clearLabelRef.current.height() &&\n            relative.y > clearLabelRef.current.y())\n        ) {\n          return;\n        }\n      }\n\n      if (toolType === ToolType.Pointer) {\n        onPointerMouseDown(relative);\n        return;\n      }\n\n      const rawImagePosition = {\n        x: relative.x / stageScale,\n        y: relative.y / stageScale,\n      };\n\n      if (toolType === ToolType.Zoom) {\n        onZoomMouseDown(relative);\n      } else {\n        if (annotationState === AnnotationStateType.Annotated) {\n          deselectAnnotation();\n        }\n\n        if (selectionMode === AnnotationModeType.New) {\n          deselectAllAnnotations();\n        }\n\n        if (!annotationTool) return;\n\n        annotationTool.onMouseDown(rawImagePosition);\n\n        update();\n      }\n    };\n    const throttled = _.throttle(func, 5);\n    return () => throttled();\n  }, [\n    annotationState,\n    annotationTool,\n    saveLabelRef,\n    selectionMode,\n    toolType,\n    deselectAllAnnotations,\n    deselectAnnotation,\n    onPointerMouseDown,\n    onZoomMouseDown,\n    stageScale,\n  ]);\n\n  const onMouseMove = useMemo(() => {\n    const func = () => {\n      if (!stageRef || !stageRef.current) return;\n\n      if (toolType === ToolType.ColorAdjustment) return;\n\n      const position = stageRef.current.getPointerPosition();\n\n      if (!position) return;\n\n      const relative = getRelativePointerPosition(position);\n\n      if (!relative || !scaledImageWidth || !scaledImageHeight) return;\n\n      if (toolType === ToolType.PenAnnotation) setCurrentPosition(relative);\n\n      // Add a little leeway around the canvas to aid drawing up to the edges\n      if (relative.x > -50 && relative.x < 0) {\n        relative.x = 0;\n      } else if (\n        relative.x > scaledImageWidth &&\n        relative.x < scaledImageWidth + 50\n      ) {\n        relative.x = scaledImageWidth;\n      }\n      if (relative.y > -50 && relative.y < 0) {\n        relative.y = 0;\n      } else if (\n        relative.y > scaledImageHeight &&\n        relative.y < scaledImageHeight + 50\n      ) {\n        relative.y = scaledImageHeight;\n      }\n\n      if (\n        relative.x > scaledImageWidth ||\n        relative.y > scaledImageHeight ||\n        relative.x < 0 ||\n        relative.y < 0\n      )\n        return;\n\n      const rawImagePosition = {\n        x: relative.x / stageScale,\n        y: relative.y / stageScale,\n      };\n\n      if (toolType === ToolType.Zoom) {\n        onZoomMouseMove(relative);\n      } else if (toolType === ToolType.Pointer) {\n        onPointerMouseMove(relative);\n      } else {\n        if (!annotationTool) return;\n\n        annotationTool.onMouseMove(rawImagePosition);\n\n        update();\n      }\n    };\n    const throttled = _.throttle(func, 5);\n    return () => throttled();\n  }, [\n    annotationTool,\n    toolType,\n    onPointerMouseMove,\n    onZoomMouseMove,\n    scaledImageHeight,\n    scaledImageWidth,\n    stageScale,\n  ]);\n\n  const onMouseUp = useMemo(() => {\n    const func = async () => {\n      if (!stageRef || !stageRef.current) return;\n\n      const position = stageRef.current.getPointerPosition();\n\n      if (!position) return;\n\n      const relative = getRelativePointerPosition(position);\n\n      if (!relative) return;\n\n      const rawImagePosition = {\n        x: relative.x / stageScale,\n        y: relative.y / stageScale,\n      };\n\n      if (toolType === ToolType.Zoom) {\n        onZoomMouseUp(relative);\n      } else if (toolType === ToolType.Pointer) {\n        onPointerMouseUp(relative);\n      } else {\n        if (!annotationTool) return;\n\n        if (!relative || !scaledImageWidth || !scaledImageHeight) return;\n\n        if (toolType === ToolType.ObjectAnnotation) {\n          await (annotationTool as ObjectAnnotationTool).onMouseUp(\n            rawImagePosition\n          );\n        }\n        annotationTool.onMouseUp(rawImagePosition);\n\n        update();\n      }\n    };\n    const throttled = _.throttle(func, 10);\n\n    return () => throttled();\n  }, [\n    annotationTool,\n    toolType,\n    onPointerMouseUp,\n    onZoomMouseUp,\n    scaledImageHeight,\n    scaledImageWidth,\n    stageScale,\n  ]);\n\n  const confirmAnnotations = () => {\n    if (\n      !annotations ||\n      !annotationTool ||\n      annotationTool.annotationState === AnnotationStateType.Annotating\n    )\n      return;\n\n    if (!activeImageId) return;\n\n    dispatch(\n      imageViewerSlice.actions.setImageInstances({\n        instances: [...unselectedAnnotations, ...selectedAnnotations],\n        imageId: activeImageId,\n      })\n    );\n\n    if (soundEnabled) playCreateAnnotationSoundEffect();\n\n    deselectAnnotation();\n\n    if (selectionMode !== AnnotationModeType.New)\n      dispatch(\n        imageViewerSlice.actions.setSelectionMode({\n          selectionMode: AnnotationModeType.New,\n        })\n      );\n\n    if (!selectedAnnotationsIds.length) return;\n\n    deselectAllAnnotations();\n    deselectAllTransformers();\n  };\n\n  useHotkeys(\n    \"enter\",\n    () => {\n      confirmAnnotations();\n    },\n    [\n      annotations,\n      annotationTool,\n      annotationTool?.annotationState,\n      dispatch,\n      selectedAnnotations,\n      unselectedAnnotations,\n      selectionMode,\n      selectedAnnotationsIds,\n    ]\n  );\n\n  useHotkeys(\n    \"enter\",\n    () => {\n      if (\n        toolType !== ToolType.PolygonalAnnotation &&\n        toolType !== ToolType.LassoAnnotation\n      )\n        return;\n\n      if (!annotationTool) return;\n\n      annotationTool.connect();\n    },\n    [toolType, annotationTool]\n  );\n\n  useHotkeys(\n    \"backspace, delete\",\n    () => {\n      dispatch(\n        imageViewerSlice.actions.deleteImageInstances({\n          ids: selectedAnnotationsIds,\n        })\n      );\n      deselectAllAnnotations();\n      deselectAllTransformers();\n\n      if (!_.isEmpty(annotations) && soundEnabled) {\n        playDeleteAnnotationSoundEffect();\n      }\n\n      deselectAnnotation();\n    },\n    [selectedAnnotationsIds, annotations]\n  );\n\n  useHotkeys(\n    \"escape\",\n    () => {\n      deselectAllAnnotations();\n      deselectAllTransformers();\n\n      if (!_.isEmpty(annotations) && soundEnabled) {\n        playDeleteAnnotationSoundEffect();\n      }\n\n      deselectAnnotation();\n\n      if (toolType !== ToolType.Zoom) return;\n      onZoomDeselect();\n    },\n    [annotations, annotationTool, toolType]\n  );\n\n  /*/\n  Detach transformers and selections when all annotations are removed\n   */\n  useEffect(() => {\n    if (!annotations) return;\n\n    if (annotations.length) return;\n\n    deselectAllTransformers();\n    deselectAllAnnotations();\n  }, [annotations?.length, annotations, deselectAllAnnotations]);\n\n  const [tool, setTool] = useState<Tool>();\n\n  useEffect(() => {\n    setTool(annotationTool);\n  }, [annotationTool, toolType]);\n\n  useKeyboardShortcuts();\n\n  const { draggable } = useHandTool();\n\n  /*\n    Konva's Stage is implemented such that its children are not connected,\n    and the store is no longer available to them, so we need to reinject\n    it to the Provider as a child of Stage.\n    See: https://github.com/konvajs/react-konva/issues/311\n    Discussion linked to above recommends use of\n    ReactReduxContext.Consumer -> Stage -> Provider pattern,\n    but that is not a publi API and may break in the future:\n    https://react-redux.js.org/using-react-redux/accessing-store#using-reactreduxcontext-directly\n    Here useStore() is utilized instead of getting the store\n    from ReactReduxContext.Consumer, which has the same result, but is safer.\n   */\n  const store = useStore();\n\n  return (\n    <ReactKonva.Stage\n      draggable={draggable}\n      height={stageHeight}\n      onMouseDown={(evt) => onMouseDown(evt)}\n      onMouseMove={onMouseMove}\n      onMouseUp={onMouseUp}\n      onWheel={onZoomWheel}\n      position={stagePosition}\n      ref={stageRef}\n      width={stageWidth}\n    >\n      <Provider store={store}>\n        <DndProvider backend={HTML5Backend}>\n          <Layer>\n            <Image ref={imageRef} />\n\n            <ZoomSelection />\n\n            <Selecting tool={tool!} />\n\n            <PenAnnotationToolTip\n              currentPosition={currentPosition}\n              annotating={annotationState === AnnotationStateType.Annotating}\n            />\n\n            <PointerSelection />\n\n            <Annotations />\n\n            <Transformers\n              transformPosition={getRelativePointerPosition}\n              annotationTool={annotationTool}\n            />\n\n            <ColorAnnotationToolTip\n              toolTipPosition={\n                (annotationTool as ColorAnnotationTool)?.toolTipPosition\n              }\n              initialPosition={\n                (annotationTool as ColorAnnotationTool)?.initialPosition\n              }\n              tolerance={(annotationTool as ColorAnnotationTool)?.tolerance}\n            />\n          </Layer>\n        </DndProvider>\n      </Provider>\n    </ReactKonva.Stage>\n  );\n};\n","import { KonvaEventObject } from \"konva/lib/Node\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { ToolType } from \"../../types/ToolType\";\nimport { ZoomModeType } from \"../../types/ZoomModeType\";\nimport {\n  stageScaleSelector,\n  toolTypeSelector,\n  zoomSelectionSelector,\n  zoomToolOptionsSelector,\n} from \"../../store/selectors\";\nimport { scaledImageWidthSelector } from \"../../store/selectors/scaledImageWidthSelector\";\nimport { setOffset, setStageScale, setZoomSelection } from \"../../store/slices\";\n\nexport const useZoom = () => {\n  const delta = 10;\n  const scaleBy = 1.25;\n\n  const dispatch = useDispatch();\n\n  const stageScale = useSelector(stageScaleSelector);\n  const toolType = useSelector(toolTypeSelector);\n  const { automaticCentering, mode } = useSelector(zoomToolOptionsSelector);\n  const zoomSelection = useSelector(zoomSelectionSelector);\n\n  const imageWidth = useSelector(scaledImageWidthSelector);\n\n  const zoomAndOffset = (\n    position: { x: number; y: number } | undefined,\n    scaleBy: number,\n    zoomIn: boolean = true\n  ) => {\n    if (!automaticCentering || zoomSelection.dragging) {\n      if (!position) return;\n      dispatch(\n        setOffset({\n          offset: {\n            x: zoomIn ? position.x * scaleBy : position.x / scaleBy,\n            y: zoomIn ? position.y * scaleBy : position.y / scaleBy,\n          },\n        })\n      );\n    }\n    dispatch(\n      setStageScale({\n        stageScale: zoomIn ? stageScale * scaleBy : stageScale / scaleBy,\n      })\n    );\n  };\n\n  const deselect = () => {\n    dispatch(\n      setZoomSelection({\n        zoomSelection: {\n          maximum: undefined,\n          minimum: undefined,\n          selecting: false,\n          dragging: false,\n        },\n      })\n    );\n  };\n\n  const onMouseDown = (position: { x: number; y: number }) => {\n    if (toolType !== ToolType.Zoom) return;\n\n    dispatch(\n      setZoomSelection({\n        zoomSelection: {\n          ...zoomSelection,\n          dragging: false,\n          minimum: position,\n          selecting: true,\n        },\n      })\n    );\n  };\n\n  const onMouseMove = (position: { x: number; y: number }) => {\n    if (mode === ZoomModeType.Out) return;\n\n    if (!zoomSelection.selecting) return;\n\n    if (!position || !zoomSelection.minimum) return;\n\n    dispatch(\n      setZoomSelection({\n        zoomSelection: {\n          ...zoomSelection,\n          dragging: Math.abs(position.x - zoomSelection.minimum.x) >= delta,\n          maximum: position,\n        },\n      })\n    );\n  };\n\n  const onMouseUp = (position: { x: number; y: number }) => {\n    if (!imageWidth) return;\n\n    if (!zoomSelection.selecting) return;\n\n    if (zoomSelection.dragging) {\n      if (!position) return;\n\n      dispatch(\n        setZoomSelection({\n          zoomSelection: { ...zoomSelection, maximum: position },\n        })\n      );\n\n      if (!zoomSelection.minimum) return;\n\n      const selectedWidth = position.x - zoomSelection.minimum.x;\n\n      zoomAndOffset(\n        {\n          x: zoomSelection.minimum.x + selectedWidth / 2,\n          y: zoomSelection.minimum.y + selectedWidth / 2,\n        },\n        imageWidth / selectedWidth / stageScale\n      );\n    } else {\n      zoomAndOffset(position, scaleBy, mode === ZoomModeType.In);\n    }\n\n    dispatch(\n      setZoomSelection({\n        zoomSelection: { ...zoomSelection, dragging: false, selecting: false },\n      })\n    );\n  };\n\n  const onWheel = (event: KonvaEventObject<WheelEvent>) => {\n    if (toolType !== ToolType.Zoom) return;\n\n    if (!imageWidth) return;\n    zoomAndOffset(\n      { x: imageWidth / 2, y: imageWidth / 2 },\n      scaleBy,\n      event.evt.deltaY < 0\n    );\n  };\n\n  return {\n    deselect,\n    onMouseDown,\n    onMouseMove,\n    onMouseUp,\n    onWheel,\n  };\n};\n","// User has switched back to the tab\nimport { useEffect } from \"react\";\nimport { imageViewerSlice } from \"../../store/slices\";\nimport { AnnotationModeType } from \"../../types/AnnotationModeType\";\nimport { useDispatch } from \"react-redux\";\n\nexport const useWindowFocusHandler = () => {\n  const dispatch = useDispatch();\n\n  const onBlur = () => {\n    dispatch(\n      imageViewerSlice.actions.setSelectionMode({\n        selectionMode: AnnotationModeType.New,\n      })\n    );\n  };\n\n  useEffect(() => {\n    // window.addEventListener('focus', onFocus);\n    window.addEventListener(\"blur\", onBlur);\n    // Specify how to clean up after this effect:\n    return () => {\n      // window.removeEventListener('focus', onFocus);\n      window.removeEventListener(\"blur\", onBlur);\n    };\n  });\n};\n","import { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { toolTypeSelector } from \"../../store/selectors\";\nimport { ToolType } from \"../../types/ToolType\";\nimport { imageViewerSlice } from \"../../store/slices\";\n\nexport const useCursor = () => {\n  const toolType = useSelector(toolTypeSelector);\n\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    switch (toolType) {\n      case ToolType.EllipticalAnnotation:\n        dispatch(imageViewerSlice.actions.setCursor({ cursor: \"crosshair\" }));\n\n        break;\n      case ToolType.PenAnnotation:\n        dispatch(imageViewerSlice.actions.setCursor({ cursor: \"default\" }));\n\n        break;\n      case ToolType.RectangularAnnotation:\n        dispatch(imageViewerSlice.actions.setCursor({ cursor: \"crosshair\" }));\n        break;\n      default:\n        dispatch(imageViewerSlice.actions.setCursor({ cursor: \"pointer\" }));\n\n        break;\n    }\n  }, [dispatch, toolType]);\n};\n","import { useDispatch, useSelector } from \"react-redux\";\n\nimport { ToolType } from \"../../types/ToolType\";\nimport { createdCategoriesSelector } from \"../../store/selectors\";\nimport { useHotkeys } from \"react-hotkeys-hook\";\nimport { setOperation, setSelectedCategoryId } from \"../../store/slices\";\n\nexport const useKeyboardShortcuts = () => {\n  const dispatch = useDispatch();\n\n  const categories = useSelector(createdCategoriesSelector);\n\n  // /*\n  // Undo operation (Ctrl+z)\n  // */\n  // useHotkeys(\"ctrl+z\", () => {\n  //   dispatch(ActionCreators.jump(-1)); //undo should be allowed only if user did an accidental delete or an accidental modification to the selected annotation\n  // });\n  //\n  // /*\n  // Undo operation (Cmd+z)\n  // */\n  // useHotkeys(\"cmd+z\", () => {\n  //   dispatch(ActionCreators.jump(-1)); //undo should be allowed only if user did an accidental delete or an accidental modification to the selected annotation\n  // });\n\n  // /*\n  //  * Cycle lasso tools (Shift + L)\n  //  */\n  // useHotkeys(\n  //   \"shift+l\",\n  //   () => {\n  //     switch (toolType) {\n  //       case ToolType.LassoAnnotation:\n  //         dispatch(setOperation({ operation: ToolType.MagneticAnnotation }));\n  //\n  //         break;\n  //       case ToolType.MagneticAnnotation:\n  //         dispatch(setOperation({ operation: ToolType.PolygonalAnnotation }));\n  //\n  //         break;\n  //       case ToolType.PolygonalAnnotation:\n  //         dispatch(setOperation({ operation: ToolType.LassoAnnotation }));\n  //\n  //         break;\n  //       default:\n  //         dispatch(setOperation({ operation: ToolType.LassoAnnotation }));\n  //\n  //         break;\n  //     }\n  //   },\n  //   [toolType]\n  // );\n\n  // /*\n  //  * Cycle marquee tools (Shift + M)\n  //  */\n  // useHotkeys(\n  //   \"shift+m\",\n  //   () => {\n  //     switch (toolType) {\n  //       case ToolType.EllipticalAnnotation:\n  //         dispatch(setOperation({ operation: ToolType.RectangularAnnotation }));\n  //\n  //         break;\n  //       case ToolType.RectangularAnnotation:\n  //         dispatch(setOperation({ operation: ToolType.EllipticalAnnotation }));\n  //\n  //         break;\n  //       default:\n  //         dispatch(setOperation({ operation: ToolType.RectangularAnnotation }));\n  //\n  //         break;\n  //     }\n  //   },\n  //   [toolType]\n  // );\n\n  // /*\n  //  * Cycle learning-based tools (Shift + W)\n  //  */\n  // useHotkeys(\n  //   \"shift+w\",\n  //   () => {\n  //     switch (toolType) {\n  //       case ToolType.ColorAnnotation:\n  //         dispatch(setOperation({ operation: ToolType.ObjectAnnotation }));\n  //\n  //         break;\n  //       case ToolType.ObjectAnnotation:\n  //         dispatch(setOperation({ operation: ToolType.QuickAnnotation }));\n  //\n  //         break;\n  //       case ToolType.QuickAnnotation:\n  //         dispatch(setOperation({ operation: ToolType.ColorAnnotation }));\n  //\n  //         break;\n  //       default:\n  //         dispatch(setOperation({ operation: ToolType.ColorAnnotation }));\n  //\n  //         break;\n  //     }\n  //   },\n  //   [toolType]\n  // );\n\n  /*\n   * Select arrange tool (V)\n   */\n  useHotkeys(\"shift+s\", () => {\n    dispatch(setOperation({ operation: ToolType.Pointer }));\n  });\n\n  /*\n   * Select category (1-9)\n   */\n  useHotkeys(\"1,2,3,4,5,6,7,8,9\", (event: KeyboardEvent) => {\n    const index = parseInt(event.key) - 1;\n\n    const selectedCategory = categories[index];\n\n    if (!selectedCategory) return;\n\n    dispatch(\n      setSelectedCategoryId({ selectedCategoryId: selectedCategory.id })\n    );\n  });\n\n  /*\n   * Select color tool (W)\n   */\n  useHotkeys(\"shift+c\", () => {\n    dispatch(setOperation({ operation: ToolType.ColorAnnotation }));\n  });\n\n  /*\n   * Select quick tool (W)\n   */\n  useHotkeys(\"shift+q\", () => {\n    dispatch(setOperation({ operation: ToolType.QuickAnnotation }));\n  });\n\n  /*\n   * Select hand tool (H)\n   */\n  useHotkeys(\"shift+h\", () => {\n    dispatch(setOperation({ operation: ToolType.Hand }));\n  });\n\n  /*\n   * Select lasso tool (L)\n   */\n  useHotkeys(\"shift+l\", () => {\n    dispatch(setOperation({ operation: ToolType.LassoAnnotation }));\n  });\n\n  /*\n   * Select polygonal tool (L)\n   */\n  useHotkeys(\"shift+p\", () => {\n    dispatch(setOperation({ operation: ToolType.PolygonalAnnotation }));\n  });\n\n  /*\n   * Select magnetic tool (M)\n   */\n  useHotkeys(\"shift+m\", () => {\n    dispatch(setOperation({ operation: ToolType.MagneticAnnotation }));\n  });\n\n  /*\n   * Select pencil tool (P)\n   */\n  useHotkeys(\"shift+d\", () => {\n    dispatch(setOperation({ operation: ToolType.PenAnnotation }));\n  });\n\n  /*\n   * Select rectangular tool (R)\n   */\n  useHotkeys(\"shift+r\", () => {\n    dispatch(setOperation({ operation: ToolType.RectangularAnnotation }));\n  });\n\n  /*\n   * Select elliptical tool (E)\n   */\n  useHotkeys(\"shift+e\", () => {\n    dispatch(setOperation({ operation: ToolType.EllipticalAnnotation }));\n  });\n\n  /*\n   * Select zoom tool (Z)\n   */\n  useHotkeys(\"shift+z\", () => {\n    dispatch(setOperation({ operation: ToolType.Zoom }));\n  });\n\n  /*\n   * Select intensity adjustment tool (Z)\n   */\n  useHotkeys(\"shift+i\", () => {\n    dispatch(setOperation({ operation: ToolType.ColorAdjustment }));\n  });\n\n  /*\n   * Key shortcuts for special selection mode\n   * */\n  // useHotkeys(\n  //   \"*\",\n  //   () => {\n  //     if (hotkeys.shift) {\n  //       if (toolType === ToolType.Pointer) return; //pointer tool has its own shift handler for multiple selections\n  //       dispatch(\n  //         applicationSlice.actions.setSelectionMode({\n  //           selectionMode: AnnotationModeType.Add,\n  //         })\n  //       );\n  //     }\n  //     if (hotkeys.alt) {\n  //       dispatch(\n  //         applicationSlice.actions.setSelectionMode({\n  //           selectionMode: AnnotationModeType.Subtract,\n  //         })\n  //       );\n  //     }\n  //   },\n  //   [toolType]\n  // );\n};\n","import { useEffect, useState } from \"react\";\nimport { ToolType } from \"../../types/ToolType\";\nimport { useSelector } from \"react-redux\";\nimport { toolTypeSelector } from \"../../store/selectors\";\n\nexport const useHandTool = () => {\n  const toolType = useSelector(toolTypeSelector);\n\n  const [draggable, setDraggable] = useState<boolean>(false);\n\n  useEffect(() => {\n    if (toolType === ToolType.Hand) {\n      setDraggable(true);\n    } else {\n      setDraggable(false);\n    }\n  }, [toolType]);\n\n  return { draggable };\n};\n","import React, { useRef } from \"react\";\nimport { Stage } from \"../Stage\";\nimport { NativeTypes } from \"react-dnd-html5-backend\";\nimport { DropTargetMonitor, useDrop } from \"react-dnd\";\nimport { useBoundingClientRect } from \"../../../../hooks/useBoundingClientRect\";\nimport { Box } from \"@mui/material\";\n\ntype ContentProps = {\n  onDrop: (item: { files: any[] }) => void;\n};\n\nexport const Content = ({ onDrop }: ContentProps) => {\n  const ref = useRef<HTMLDivElement>(null);\n\n  useBoundingClientRect(ref);\n\n  const [{ isOver }, drop] = useDrop(\n    () => ({\n      accept: [NativeTypes.FILE],\n      drop(item: { files: any[] }) {\n        if (onDrop) {\n          onDrop(item);\n        }\n      },\n      collect: (monitor: DropTargetMonitor) => ({\n        isOver: monitor.isOver(),\n        canDrop: monitor.canDrop(),\n      }),\n    }),\n    []\n  );\n\n  return (\n    <Box\n      sx={(theme) => ({\n        backgroundColor: theme.palette.background.default,\n        width: \"100%\",\n        border: isOver ? \"5px solid blue\" : \"\",\n      })}\n      ref={ref}\n    >\n      <div ref={drop}>\n        <Stage />\n      </div>\n    </Box>\n  );\n};\n","import useResizeObserver from \"@react-hook/resize-observer\";\nimport React, { useEffect, useLayoutEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport {\n  boundingClientRectSelector,\n  imageSelector,\n  stageHeightSelector,\n  stageWidthSelector,\n} from \"../../store/selectors\";\nimport {\n  setBoundingClientRect,\n  setStageScale,\n  setStageWidth,\n} from \"../../store/slices\";\n\nexport const useBoundingClientRect = (target: React.RefObject<HTMLElement>) => {\n  const dispatch = useDispatch();\n\n  const boundingClientRect = useSelector(boundingClientRectSelector);\n  const stageWidth = useSelector(stageWidthSelector);\n  const stageHeight = useSelector(stageHeightSelector);\n  const image = useSelector(imageSelector);\n\n  useLayoutEffect(() => {\n    if (!target || !target.current) return;\n\n    dispatch(\n      setBoundingClientRect({\n        boundingClientRect: target.current.getBoundingClientRect(),\n      })\n    );\n  }, [dispatch, target]);\n\n  useResizeObserver(target, (entry: ResizeObserverEntry) => {\n    dispatch(\n      setBoundingClientRect({\n        boundingClientRect: entry.contentRect as DOMRect,\n      })\n    );\n  });\n\n  useEffect(() => {\n    dispatch(setStageWidth({ stageWidth: boundingClientRect.width }));\n  }, [boundingClientRect.width, dispatch]);\n\n  useEffect(() => {\n    if (!image?.shape) return;\n\n    //FIXME #136 it seems like we are not currently getting the current stageHeight. It currently stays fixes to the initial state in the redux store.\n    if (image.shape.height / stageHeight > image.shape.width / stageWidth) {\n      dispatch(\n        setStageScale({\n          stageScale: (0.95 * stageHeight) / image.shape.height,\n        })\n      );\n    } else {\n      dispatch(\n        setStageScale({\n          stageScale: (0.95 * stageWidth) / image.shape.width,\n        })\n      );\n    }\n  }, [image?.shape, stageWidth, stageHeight, dispatch]);\n};\n","import React, { useCallback, useEffect } from \"react\";\nimport { Box, CssBaseline } from \"@mui/material\";\nimport { batch, useDispatch } from \"react-redux\";\nimport { CategoriesList } from \"../CategoriesList\";\nimport { ToolOptions } from \"../ToolOptions\";\nimport { Tools } from \"../Tools\";\nimport { Content } from \"../Content\";\nimport { ToolType } from \"../../../types/ToolType\";\nimport {\n  addImages,\n  imageViewerSlice,\n  setActiveImage,\n  setOperation,\n  setSelectedAnnotations,\n} from \"../../../store/slices\";\nimport { Image } from \"../../../types/Image\";\nimport { convertFileToImage } from \"../../../image/imageHelper\";\n\ntype ImageViewerProps = {\n  image?: Image;\n};\n\nexport const ImageViewer = ({ image }: ImageViewerProps) => {\n  const dispatch = useDispatch();\n  //\n  // useEffect(() => {\n  //   const path =\n  //     \"https://raw.githubusercontent.com/zaidalyafeai/HostedModels/master/unet-128/model.json\";\n  //\n  //   dispatch(loadLayersModelThunk({ name: \"foo\", path: path }));\n  // });\n\n  useEffect(() => {\n    if (image) {\n      dispatch(imageViewerSlice.actions.setActiveImage({ image: image.id }));\n    }\n  }, [dispatch, image]);\n\n  const onDrop = useCallback(\n    async (item) => {\n      if (item) {\n        for (let i = 0; i < item.files.length; i++) {\n          const image = await convertFileToImage(item.files[i]);\n          dispatch(addImages({ newImages: [image] }));\n\n          if (i === 0) {\n            batch(() => {\n              dispatch(\n                setActiveImage({\n                  image: image.id,\n                })\n              );\n\n              dispatch(\n                setSelectedAnnotations({\n                  selectedAnnotations: [],\n                  selectedAnnotation: undefined,\n                })\n              );\n\n              dispatch(\n                setOperation({ operation: ToolType.RectangularAnnotation })\n              );\n            });\n          }\n        }\n      }\n    },\n    [dispatch]\n  );\n\n  return (\n    <Box sx={{ display: \"flex\" }}>\n      <CssBaseline />\n\n      <CategoriesList />\n\n      <Content onDrop={onDrop} />\n\n      <ToolOptions />\n\n      <Tools />\n    </Box>\n  );\n};\n","// import { ThemeProvider } from \"@mui/material/styles\";\nimport { ImageViewer } from \"../ImageViewer\";\n// import { theme } from \"./theme\";\n\nexport const AnnotatorView = () => {\n  return (\n    // <ThemeProvider theme={theme}>\n    <ImageViewer />\n    // </ThemeProvider>\n  );\n};\n","import { createTheme } from \"@mui/material/styles\";\n\nexport const lightTheme = createTheme({\n  components: {\n    MuiListItemIcon: {\n      styleOverrides: {\n        root: {\n          minWidth: 36,\n        },\n      },\n    },\n  },\n});\n\nexport const darkTheme = createTheme({\n  components: {\n    MuiDrawer: {\n      styleOverrides: {\n        paperAnchorDockedLeft: {\n          borderRight: \"1px solid rgba(16, 16, 16)\",\n        },\n        paperAnchorDockedRight: {\n          borderLeft: \"1px solid rgba(16, 16, 16)\",\n        },\n        paper: {\n          // boxShadow: \"inset 0 0 16px #000000\",\n        },\n      },\n    },\n    MuiListItem: {\n      styleOverrides: {\n        root: {\n          \"&.Mui-selected\": {\n            backgroundColor: \"rgba(60, 61, 62)\",\n          },\n        },\n      },\n    },\n    MuiListItemIcon: {\n      styleOverrides: {\n        root: {\n          minWidth: 36,\n        },\n      },\n    },\n    MuiSlider: {\n      styleOverrides: {\n        rail: {\n          color: \"rgba(73, 73, 73)\",\n        },\n        thumb: {\n          color: \"rgba(201, 201, 201)\",\n        },\n        track: {\n          color: \"rgba(159, 159, 159)\",\n        },\n      },\n    },\n  },\n  palette: {\n    background: {\n      paper: \"rgba(40, 40, 40)\",\n      default: \"rgba(50, 50, 50)\",\n    },\n    divider: \"rgba(72, 72, 72)\",\n    text: {\n      primary: \"rgba(190, 190, 190)\",\n    },\n    mode: \"dark\",\n  },\n});\n","import React from \"react\";\n// import { BrowserRouter, Routes, Route } from \"react-router-dom\";\nimport { HashRouter, Routes, Route } from \"react-router-dom\";\nimport { ThemeProvider } from \"@mui/material/styles\";\nimport { StyledEngineProvider } from \"@mui/material/styles\";\nimport { MainView } from \"../MainView\";\nimport { AnnotatorView } from \"../annotator\";\nimport { usePreferredTheme } from \"hooks/useTheme/usePreferredTheme\";\n\nexport const Application = () => {\n  const theme = usePreferredTheme();\n\n  return (\n    <StyledEngineProvider injectFirst>\n      <ThemeProvider theme={theme}>\n        <MainView />\n        {/* <BrowserRouter> */}\n        <HashRouter>\n          <Routes>\n            <Route path=\"/\" element={<MainView />} />\n            <Route path=\"annotator\" element={<AnnotatorView />} />\n          </Routes>\n        </HashRouter>\n        {/* </BrowserRouter> */}\n      </ThemeProvider>\n    </StyledEngineProvider>\n  );\n};\n","import { useEffect, useState } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport useMediaQuery from \"@mui/material/useMediaQuery\";\nimport { ThemeMode } from \"types/ThemeMode\";\nimport { themeModeSelector } from \"store/selectors/themeModeSelector\";\nimport { setThemeMode } from \"store/slices\";\nimport { lightTheme, darkTheme } from \"theme\";\n\nexport const usePreferredTheme = () => {\n  const dispatch = useDispatch();\n\n  const prefersDarkMode = useMediaQuery(\"(prefers-color-scheme: dark)\");\n  const [theme, setTheme] = useState(prefersDarkMode ? darkTheme : lightTheme);\n\n  const themeMode = useSelector(themeModeSelector);\n\n  useEffect(() => {\n    dispatch(\n      setThemeMode({\n        mode: prefersDarkMode ? ThemeMode.Dark : ThemeMode.Light,\n      })\n    );\n  }, [prefersDarkMode, dispatch]);\n\n  useEffect(() => {\n    if (themeMode === ThemeMode.Light) {\n      setTheme(lightTheme);\n    } else {\n      setTheme(darkTheme);\n    }\n  }, [themeMode]);\n\n  return theme;\n};\n","import { combineReducers } from \"redux\";\nimport {\n  imageViewerSlice,\n  classifierSlice,\n  projectSlice,\n  applicationSlice,\n  toolOptionsSlice,\n} from \"../slices\";\n\nconst reducers = {\n  classifier: classifierSlice.reducer,\n  imageViewer: imageViewerSlice.reducer,\n  project: projectSlice.reducer,\n  settings: applicationSlice.reducer,\n  toolOptions: toolOptionsSlice.reducer,\n};\n\nexport const reducer = combineReducers(reducers);\n","import { put, select } from \"redux-saga/effects\";\nimport { imageViewerSlice } from \"../../slices\";\nimport { AnnotationTool } from \"../../../annotator/image/Tool\";\nimport { AnnotationModeType } from \"../../../types/AnnotationModeType\";\nimport { AnnotationStateType } from \"../../../types/AnnotationStateType\";\nimport { ToolType } from \"../../../types/ToolType\";\nimport { selectionModeSelector } from \"../../selectors\";\nimport { selectedCategorySelector } from \"../../selectors\";\nimport { toolTypeSelector } from \"../../selectors\";\nimport { selectedAnnotationSelector } from \"../../selectors/selectedAnnotationSelector\";\nimport { activeImagePlaneSelector } from \"../../selectors/activeImagePlaneSelector\";\n\nexport function* annotationStateChangeSaga({\n  payload: { annotationState, annotationTool },\n}: {\n  type: string;\n  payload: {\n    annotationState: AnnotationStateType;\n    annotationTool: AnnotationTool | undefined;\n  };\n}): any {\n  if (!annotationTool) return;\n\n  if (annotationState !== AnnotationStateType.Annotated) return;\n\n  const selectionMode = yield select(selectionModeSelector);\n  const activeImagePlane = yield select(activeImagePlaneSelector);\n\n  if (selectionMode === AnnotationModeType.New) {\n    const selectedCategory = yield select(selectedCategorySelector);\n\n    annotationTool.annotate(selectedCategory, activeImagePlane);\n\n    if (!annotationTool.annotation) return;\n\n    yield put(\n      imageViewerSlice.actions.setSelectedAnnotations({\n        selectedAnnotations: [annotationTool.annotation],\n        selectedAnnotation: annotationTool.annotation,\n      })\n    );\n  } else {\n    const toolType = yield select(toolTypeSelector);\n    if (toolType === ToolType.Zoom) return;\n\n    const selectedAnnotation = yield select(selectedAnnotationSelector);\n\n    if (annotationTool.annotationState !== AnnotationStateType.Annotated)\n      return;\n\n    let combinedMask, combinedBoundingBox;\n\n    if (!selectedAnnotation) return;\n\n    if (selectionMode === AnnotationModeType.Add) {\n      [combinedMask, combinedBoundingBox] = annotationTool.add(\n        selectedAnnotation.mask,\n        selectedAnnotation.boundingBox\n      );\n    } else if (selectionMode === AnnotationModeType.Subtract) {\n      [combinedMask, combinedBoundingBox] = annotationTool.subtract(\n        selectedAnnotation.mask,\n        selectedAnnotation.boundingBox\n      );\n    } else if (selectionMode === AnnotationModeType.Intersect) {\n      [combinedMask, combinedBoundingBox] = annotationTool.intersect(\n        selectedAnnotation.mask,\n        selectedAnnotation.boundingBox\n      );\n    }\n\n    annotationTool.mask = combinedMask;\n\n    annotationTool.boundingBox = combinedBoundingBox;\n\n    if (!annotationTool.boundingBox || !annotationTool.mask) return;\n\n    yield put(\n      imageViewerSlice.actions.setSelectedAnnotations({\n        selectedAnnotations: [\n          {\n            ...selectedAnnotation,\n            boundingBox: annotationTool.boundingBox,\n            mask: annotationTool.mask,\n          },\n        ],\n        selectedAnnotation: {\n          ...selectedAnnotation,\n          boundingBox: annotationTool.boundingBox,\n          mask: annotationTool.mask,\n        },\n      })\n    );\n\n    const selectedCategory = yield select(selectedCategorySelector);\n\n    annotationTool.annotate(selectedCategory, activeImagePlane);\n  }\n}\n","import { takeEvery } from \"redux-saga/effects\";\nimport { annotationStateChangeSaga } from \"./annotationStateChangeSaga\";\nimport { imageViewerSlice } from \"../../slices\";\n\nexport function* watchAnnotationStateChangeSaga() {\n  yield takeEvery(\n    imageViewerSlice.actions.setAnnotationState,\n    annotationStateChangeSaga\n  );\n}\n","import { put, select } from \"redux-saga/effects\";\nimport * as _ from \"lodash\";\nimport { imageViewerSlice } from \"../../slices\";\nimport { selectedAnnotationsIdsSelector } from \"../../selectors/selectedAnnotationsIdsSelector\";\nimport { imageInstancesSelector } from \"../../selectors/imageInstancesSelector\";\nimport { selectedAnnotationsSelector } from \"../../selectors/selectedAnnotationsSelector\";\nimport { selectedAnnotationSelector } from \"../../selectors/selectedAnnotationSelector\";\nimport { selectedCategorySelector } from \"../../selectors/selectedCategorySelector\";\nimport { AnnotationType } from \"../../../types/AnnotationType\";\n\n// eslint-disable-next-line no-empty-pattern\nexport function* selectedCategorySaga({}: {\n  type: string;\n  payload: { selectedCategoryId: string };\n}): any {\n  const selectedAnnotationsIds = yield select(selectedAnnotationsIdsSelector);\n  if (!selectedAnnotationsIds) return;\n\n  const annotations = yield select(imageInstancesSelector);\n  if (!annotations) return;\n\n  const selectedAnnotations = yield select(selectedAnnotationsSelector);\n  const selectedCategory = yield select(selectedCategorySelector);\n\n  const updatedAnnotations = _.map(\n    selectedAnnotations,\n    (annotation: AnnotationType) => {\n      return { ...annotation, categoryId: selectedCategory.id };\n    }\n  );\n\n  const selectedAnnotation = yield select(selectedAnnotationSelector);\n  if (!selectedAnnotation) return;\n\n  yield put(\n    imageViewerSlice.actions.setSelectedAnnotations({\n      selectedAnnotations: updatedAnnotations,\n      selectedAnnotation: {\n        ...selectedAnnotation,\n        categoryId: selectedCategory.id,\n      },\n    })\n  );\n}\n","import { takeEvery } from \"redux-saga/effects\";\nimport { imageViewerSlice } from \"../../slices\";\nimport { selectedCategorySaga } from \"./selectedCategorySaga\";\n\nexport function* watchSelectedCategorySaga() {\n  yield takeEvery(\n    imageViewerSlice.actions.setSelectedCategoryId,\n    selectedCategorySaga\n  );\n}\n","import * as tensorflow from \"@tensorflow/tfjs\";\nimport { CompileOptions } from \"../../../types/CompileOptions\";\nimport { LossFunction } from \"../../../types/LossFunction\";\nimport { OptimizationAlgorithm } from \"../../../types/OptimizationAlgorithm\";\nimport { Metric } from \"../../../types/Metric\";\n\nexport const compile = (\n  opened: tensorflow.LayersModel,\n  options: CompileOptions\n) => {\n  const compiled = opened;\n\n  const loss = () => {\n    switch (options.lossFunction) {\n      case LossFunction.AbsoluteDifference: {\n        return \"absoluteDifference\";\n      }\n      case LossFunction.CategoricalCrossEntropy: {\n        return \"categoricalCrossentropy\";\n      }\n      case LossFunction.CosineDistance: {\n        return \"cosineDistance\";\n      }\n      case LossFunction.Hinge: {\n        return \"hingeLoss\";\n      }\n      case LossFunction.Huber: {\n        return \"huberLoss\";\n      }\n      case LossFunction.Log: {\n        return \"logLoss\";\n      }\n      case LossFunction.MeanSquaredError: {\n        return \"meanSquaredError\";\n      }\n      case LossFunction.SigmoidCrossEntropy: {\n        return \"sigmoidCrossEntropy\";\n      }\n      default: {\n        return \"softmaxCrossEntropy\";\n      }\n    }\n  };\n\n  const metrics = () => {\n    // eslint-disable-next-line array-callback-return\n    return options.metrics.map((metric: Metric) => {\n      switch (metric) {\n        case Metric.BinaryAccuracy:\n          return \"binaryAccuracy\";\n        case Metric.BinaryCrossEntropy:\n          return \"binaryCrossentropy\";\n        case Metric.CategoricalAccuracy:\n          return \"categoricalAccuracy\";\n        case Metric.CategoricalCrossEntropy:\n          return \"categoricalCrossentropy\";\n        case Metric.CosineProximity:\n          return \"categoricalCrossentropy\";\n        case Metric.MeanAbsoluteError:\n          return \"meanAbsoluteError\";\n        case Metric.MeanAbsolutePercentageError:\n          return \"meanAbsolutePercentageError\";\n        case Metric.MeanSquaredError:\n          return \"meanSquaredError\";\n        case Metric.Precision:\n          return \"precision\";\n        case Metric.Recall:\n          return \"recall\";\n        case Metric.SparseCategoricalAccuracy:\n          return \"sparseCategoricalAccuracy\";\n      }\n    });\n  };\n\n  const optimizer = (): tensorflow.Optimizer => {\n    switch (options.optimizationAlgorithm) {\n      case OptimizationAlgorithm.Adadelta: {\n        return tensorflow.train.adadelta(options.learningRate);\n      }\n      case OptimizationAlgorithm.Adagrad: {\n        return tensorflow.train.adagrad(options.learningRate);\n      }\n      case OptimizationAlgorithm.Adam: {\n        return tensorflow.train.adam(options.learningRate);\n      }\n      case OptimizationAlgorithm.Adamax: {\n        return tensorflow.train.adamax(options.learningRate);\n      }\n      case OptimizationAlgorithm.RMSProp: {\n        return tensorflow.train.rmsprop(options.learningRate);\n      }\n      case OptimizationAlgorithm.StochasticGradientDescent: {\n        return tensorflow.train.sgd(options.learningRate);\n      }\n      default: {\n        return tensorflow.train.sgd(options.learningRate);\n      }\n    }\n  };\n\n  compiled.compile({\n    loss: loss(),\n    metrics: metrics(),\n    optimizer: optimizer(),\n  });\n\n  return compiled;\n};\n","import { History, LayersModel } from \"@tensorflow/tfjs\";\nimport { FitOptions } from \"../../../types/FitOptions\";\nimport * as tensorflow from \"@tensorflow/tfjs\";\nimport * as tfvis from \"@tensorflow/tfjs-vis\";\n\n/*\n * Fix for issue #90.\n * TL;DR: Preact pollutes the global namespace, and now we have to too.\n *\n * An unfortunately dirty solution to a nasty mix of using react alongside tfjs-vis, which in turn uses preact.\n * Preact v8 populates the global namespace with an extension of the Element type.\n * React also has an Element type, which it extends as ReactElement.\n * The two do no mix well, and cause all sorts of weird type issues whenever tfjs-vis is imported.\n * tfjs is not maintained so have not updated to v10+, and is also not likely to accept any pull requests.\n * Hence the messy solution below.\n *\n * See: https://github.com/preactjs/preact/issues/2748\n * Or see: line 129 of \"node_modules/preact/src/preact.d.ts\"\n */\ndeclare global {\n  namespace React {\n    interface ReactElement {\n      nodeName: any;\n      attributes: any;\n      children: any;\n    }\n  }\n}\n\nexport const fit = async (\n  compiled: LayersModel,\n  data: {\n    val: tensorflow.data.Dataset<{\n      xs: tensorflow.Tensor;\n      ys: tensorflow.Tensor;\n    }>;\n    train: tensorflow.data.Dataset<{\n      xs: tensorflow.Tensor;\n      ys: tensorflow.Tensor;\n    }>;\n  },\n  options: FitOptions,\n  onEpochEnd: any\n): Promise<{ fitted: LayersModel; status: History }> => {\n  const compiledMetrics = compiled.metrics as Array<string>;\n  const metrics = compiledMetrics.concat(\n    compiledMetrics.map((metric: string) => {\n      return \"val_\" + metric;\n    }),\n    \"loss\",\n    \"val_loss\"\n  );\n\n  //Visualization\n  const container = document.getElementById(\"tfvis-container\") as HTMLElement;\n  tfvis.show.modelSummary(container, compiled);\n\n  const args = {\n    callbacks: [\n      {\n        onEpochEnd: onEpochEnd,\n      },\n      tfvis.show.fitCallbacks(container, metrics, {\n        callbacks: [\"onEpochEnd\"],\n      }),\n    ],\n    epochs: options.epochs,\n    validationData: data.val.batch(options.batchSize),\n  };\n\n  const status = await compiled.fitDataset(\n    data.train.batch(options.batchSize),\n    args\n  );\n\n  return { fitted: compiled, status: status };\n};\n","import * as tensorflow from \"@tensorflow/tfjs\";\nimport { Shape } from \"../../../types/Shape\";\n\n/**\n * Creates simple convolutional neural network, for example used for mnist classification problem\n * from: https://codelabs.developers.google.com/codelabs/tfjs-training-classfication/\n *\n * @param inputShape array of number specifying the input shape [imageWidth, imageHeight, imageChannels]\n * @param numClasses shape of the output layer (i.e. number of classes to predict)\n * @returns tensorflow.sequential model\n */\nexport const createSimpleCNN = (inputShape: Shape, numClasses: number) => {\n  const imageWidth = inputShape.width;\n  const imageHeight = inputShape.height;\n  const imageChannels = inputShape.channels;\n\n  const model = tensorflow.sequential();\n\n  // In the first layer of our convolutional neural network we have\n  // to specify the input shape. Then we specify some parameters for\n  // the convolution operation that takes place in this layer.\n  model.add(\n    tensorflow.layers.conv2d({\n      inputShape: [imageWidth, imageHeight, imageChannels],\n      kernelSize: 5,\n      filters: 8,\n      strides: 1,\n      activation: \"relu\",\n      kernelInitializer: \"varianceScaling\",\n    })\n  );\n\n  // The MaxPooling layer acts as a sort of downsampling using max values\n  // in a region instead of averaging.\n  model.add(\n    tensorflow.layers.maxPooling2d({ poolSize: [2, 2], strides: [2, 2] })\n  );\n\n  // Repeat another conv2d + maxPooling stack.\n  // Note that we have more filters in the convolution.\n  model.add(\n    tensorflow.layers.conv2d({\n      kernelSize: 5,\n      filters: 16,\n      strides: 1,\n      activation: \"relu\",\n      kernelInitializer: \"varianceScaling\",\n    })\n  );\n  model.add(\n    tensorflow.layers.maxPooling2d({ poolSize: [2, 2], strides: [2, 2] })\n  );\n\n  // Now we flatten the output from the 2D filters into a 1D vector to prepare\n  // it for input into our last layer. This is common practice when feeding\n  // higher dimensional data to a final classification output layer.\n  model.add(tensorflow.layers.flatten());\n\n  // Our last layer is a dense layer which has `numClasses` output units, one for each output class\n  model.add(\n    tensorflow.layers.dense({\n      units: numClasses,\n      kernelInitializer: \"varianceScaling\",\n      activation: \"softmax\",\n    })\n  );\n\n  return model;\n};\n","import * as tensorflow from \"@tensorflow/tfjs\";\n\nexport const changeInputShape = async (\n  model: tensorflow.Sequential,\n  inputShape: number[]\n) => {\n  const newModel = tensorflow.sequential();\n  newModel.add(tensorflow.layers.inputLayer({ inputShape: inputShape }));\n  const map = tensorflow.serialization.SerializationMap.getMap().classNameMap;\n  for (let i = 1; i < model.layers.length; i++) {\n    const layer = model.layers[i];\n    const className: string = layer.getClassName();\n    const [cls, fromConfig] = map[className];\n    let cfg = layer.getConfig();\n    const newlayer = fromConfig(cls, cfg);\n    // @ts-ignore\n    newModel.add(newlayer);\n\n    // @ts-ignore\n    newlayer.setWeights(layer.getWeights());\n  }\n\n  return newModel;\n};\n","import * as tensorflow from \"@tensorflow/tfjs\";\nimport { Shape } from \"../../../types/Shape\";\nimport { changeInputShape } from \"./changeInputShape\";\n\n/**\n *\n * @param inputShape array of number specifying the input shape [imageWidth, imageHeight, imageChannels]\n * @param numClasses shape of the output layer (i.e. number of classes to predict)\n * @param freeze flag to freeze the layers in the model, i.e. not training them\n * @param useCustomTopLayer flag to use a custom top layer specific to the shape of your training\n * @returns tensorflow.sequential model\n */\nexport const createMobileNet = async (\n  input_shape: Shape,\n  numClasses: number,\n  freeze: boolean = true,\n  useCustomTopLayer: boolean = true\n) => {\n  const imageWidth = input_shape.width;\n  const imageHeight = input_shape.height;\n\n  // the number of input channels cannot be changed\n  const inputShape: number[] = [imageWidth, imageHeight, 3];\n\n  const resource =\n    \"https://storage.googleapis.com/tfjs-models/tfjs/mobilenet_v1_0.25_224/model.json\";\n\n  const mobilenet = await tensorflow.loadLayersModel(resource);\n\n  const layerName = \"conv_pw_13_relu\";\n\n  const backbone = tensorflow.sequential();\n  for (const l of mobilenet.layers) {\n    backbone.add(l);\n    if (l.name === layerName) {\n      break;\n    }\n  }\n\n  let model = backbone;\n  if (inputShape !== [224, 224, 3]) {\n    model = await changeInputShape(model, inputShape);\n  }\n\n  if (freeze) {\n    model.layers.forEach(function (l) {\n      l.trainable = false;\n    });\n  }\n\n  if (useCustomTopLayer) {\n    model.add(tensorflow.layers.globalAveragePooling2d({}));\n\n    const numfeat = model.layers[model.layers.length - 1].outputShape[1];\n    model.add(\n      tensorflow.layers.reshape({\n        targetShape: [1, 1, numfeat as number],\n      })\n    );\n\n    model.add(tensorflow.layers.dropout({ rate: 0.001 }));\n\n    model.add(\n      tensorflow.layers.conv2d({\n        filters: numClasses,\n        kernelSize: [1, 1],\n      })\n    );\n\n    model.add(\n      tensorflow.layers.reshape({\n        targetShape: [numClasses],\n      })\n    );\n\n    model.add(\n      tensorflow.layers.activation({\n        activation: \"softmax\",\n      })\n    );\n  }\n  return model;\n};\n","import { ArchitectureOptions } from \"../../../types/ArchitectureOptions\";\nimport { ModelType } from \"../../../types/ClassifierModelType\";\nimport { createSimpleCNN } from \"../models/simpleCNN\";\nimport { createMobileNet } from \"../models/mobileNet\";\n\nexport const open = async (\n  modelOptions: ArchitectureOptions,\n  classes: number\n) => {\n  switch (modelOptions.selectedModel.modelType) {\n    case ModelType.SimpleCNN: {\n      return createSimpleCNN(modelOptions.inputShape, classes);\n    }\n    case ModelType.MobileNet: {\n      return createMobileNet(modelOptions.inputShape, classes);\n    }\n    default: {\n      alert(\"Invalid model selected!\");\n    }\n  }\n};\n","import * as tensorflow from \"@tensorflow/tfjs\";\nimport * as ImageJS from \"image-js\";\nimport { Category, UNKNOWN_CATEGORY_ID } from \"../../../types/Category\";\nimport { Image } from \"../../../types/Image\";\nimport { Shape } from \"../../../types/Shape\";\nimport { RescaleOptions } from \"../../../types/RescaleOptions\";\n\nexport const decodeCategory = (categories: number) => {\n  return (item: {\n    xs: string;\n    ys: number;\n  }): { xs: string; ys: tensorflow.Tensor } => {\n    return { ...item, ys: tensorflow.oneHot(item.ys, categories) };\n  };\n};\n\nexport const decodeImage = async (\n  channels: number,\n  rescale: boolean,\n  item: {\n    xs: string; //dataURL\n    ys: tensorflow.Tensor;\n  }\n): Promise<{ xs: tensorflow.Tensor; ys: tensorflow.Tensor }> => {\n  const fetched = await tensorflow.util.fetch(item.xs);\n\n  const buffer: ArrayBuffer = await fetched.arrayBuffer();\n\n  let data: ImageJS.Image = await ImageJS.Image.load(buffer);\n\n  const canvas: HTMLCanvasElement = data.getCanvas();\n\n  let xs: tensorflow.Tensor3D = tensorflow.browser.fromPixels(canvas, channels);\n\n  if (rescale) {\n    xs = xs.div(255); //Because xs is string, values are encoded by uint8array by default\n  }\n\n  return new Promise((resolve) => {\n    return resolve({ ...item, xs: xs });\n  });\n};\n\nexport const resize = async (\n  inputShape: Shape,\n  item: {\n    xs: tensorflow.Tensor;\n    ys: tensorflow.Tensor;\n  }\n): Promise<{ xs: tensorflow.Tensor; ys: tensorflow.Tensor }> => {\n  const resized = tensorflow.image.resizeBilinear(\n    item.xs as tensorflow.Tensor3D,\n    [inputShape.height, inputShape.width]\n  );\n\n  return new Promise((resolve) => {\n    return resolve({ ...item, xs: resized });\n  });\n};\n\nexport const generator = (\n  images: Array<Image>,\n  categories: Array<Category>\n) => {\n  const count = images.length;\n\n  return function* () {\n    let index = 0;\n\n    while (index < count) {\n      const image = images[index];\n\n      // eslint-disable-next-line array-callback-return\n      const ys = categories.findIndex((category: Category) => {\n        if (category.id !== UNKNOWN_CATEGORY_ID) {\n          return category.id === image.categoryId;\n        }\n      });\n\n      yield {\n        xs: image.src,\n        ys: ys,\n      };\n\n      index++;\n    }\n  };\n};\n\nexport const preprocess = async (\n  trainImages: Array<Image>,\n  valImages: Array<Image>,\n  categories: Array<Category>,\n  inputShape: Shape,\n  rescaleOptions: RescaleOptions\n): Promise<{\n  val: tensorflow.data.Dataset<{\n    xs: tensorflow.Tensor;\n    ys: tensorflow.Tensor;\n  }>;\n  train: tensorflow.data.Dataset<{\n    xs: tensorflow.Tensor;\n    ys: tensorflow.Tensor;\n  }>;\n}> => {\n  const trainData = tensorflow.data\n    .generator(generator(trainImages, categories))\n    .map(decodeCategory(categories.length))\n    .mapAsync(\n      decodeImage.bind(null, inputShape.channels, rescaleOptions.rescale)\n    )\n    .mapAsync(resize.bind(null, inputShape))\n    .shuffle(32);\n\n  const valData = tensorflow.data\n    .generator(generator(valImages, categories))\n    .map(decodeCategory(categories.length))\n    .mapAsync(\n      decodeImage.bind(null, inputShape.channels, rescaleOptions.rescale)\n    )\n    .mapAsync(resize.bind(null, inputShape))\n    .shuffle(32);\n\n  return { val: valData, train: trainData };\n};\n","import { Project } from \"../../types/Project\";\nimport { Image } from \"../../types/Image\";\nimport { Partition } from \"../../types/Partition\";\n\nexport const trainImagesSelector = ({\n  project,\n}: {\n  project: Project;\n}): Array<Image> => {\n  return project.images.filter((image: Image) => {\n    return image.partition === Partition.Training;\n  });\n};\n","import { Project } from \"../../types/Project\";\nimport { Image } from \"../../types/Image\";\nimport { Partition } from \"../../types/Partition\";\n\nexport const valImagesSelector = ({\n  project,\n}: {\n  project: Project;\n}): Array<Image> => {\n  return project.images.filter((image: Image) => {\n    return image.partition === Partition.Validation;\n  });\n};\n","import { put, select } from \"redux-saga/effects\";\nimport { compile, fit, open, preprocess } from \"../../coroutines/classifier\";\nimport { classifierSlice } from \"../../slices\";\nimport {\n  compiledSelector,\n  compileOptionsSelector,\n  createdCategoriesCountSelector,\n  createdCategoriesSelector,\n  fitOptionsSelector,\n} from \"../../selectors\";\nimport { architectureOptionsSelector } from \"../../selectors/architectureOptionsSelector\";\nimport { rescaleOptionsSelector } from \"../../selectors/rescaleOptionsSelector\";\nimport { trainImagesSelector } from \"../../selectors/trainImagesSelector\";\nimport { valImagesSelector } from \"../../selectors/valImagesSelector\";\nimport * as tensorflow from \"@tensorflow/tfjs\";\nimport { RescaleOptions } from \"../../../types/RescaleOptions\";\nimport { ArchitectureOptions } from \"../../../types/ArchitectureOptions\";\nimport { CompileOptions } from \"../../../types/CompileOptions\";\nimport { Category } from \"../../../types/Category\";\nimport { Image } from \"../../../types/Image\";\nimport { FitOptions } from \"../../../types/FitOptions\";\nimport { ModelType } from \"../../../types/ClassifierModelType\";\n\nexport function* fitSaga(action: any): any {\n  const { onEpochEnd } = action.payload;\n\n  const architectureOptions: ArchitectureOptions = yield select(\n    architectureOptionsSelector\n  );\n  const classes: number = yield select(createdCategoriesCountSelector);\n\n  var model: tensorflow.LayersModel;\n  if (architectureOptions.selectedModel.modelType === ModelType.UserUploaded) {\n    model = yield select(compiledSelector);\n  } else {\n    model = yield open(architectureOptions, classes);\n  }\n\n  const compileOptions: CompileOptions = yield select(compileOptionsSelector);\n  const compiledModel: tensorflow.LayersModel = yield compile(\n    model,\n    compileOptions\n  );\n\n  yield put(\n    classifierSlice.actions.updateCompiled({ compiled: compiledModel })\n  );\n\n  const categories: Category[] = yield select(createdCategoriesSelector);\n  const trainImages: Image[] = yield select(trainImagesSelector);\n  const valImages: Image[] = yield select(valImagesSelector);\n  const rescaleOptions: RescaleOptions = yield select(rescaleOptionsSelector);\n\n  const data = yield preprocess(\n    trainImages,\n    valImages,\n    categories,\n    architectureOptions.inputShape,\n    rescaleOptions\n  );\n\n  yield put(classifierSlice.actions.updatePreprocessed({ data: data }));\n\n  const options: FitOptions = yield select(fitOptionsSelector);\n\n  const { fitted, status } = yield fit(\n    compiledModel,\n    data,\n    options,\n    onEpochEnd\n  );\n\n  const payload = { fitted: fitted, status: status };\n\n  yield put(classifierSlice.actions.updateFitted(payload));\n}\n","import { takeEvery } from \"redux-saga/effects\";\nimport { fitSaga } from \"./fitSaga\";\nimport { classifierSlice } from \"../../slices\";\n\nexport function* watchFitSaga(): any {\n  yield takeEvery(classifierSlice.actions.fit.type, fitSaga);\n}\n","import * as tensorflow from \"@tensorflow/tfjs\";\nimport * as ImageJS from \"image-js\";\nimport { Image } from \"../../../types/Image\";\nimport { Shape } from \"../../../types/Shape\";\nimport { RescaleOptions } from \"../../../types/RescaleOptions\";\n\nexport const decodeImage = async (\n  channels: number,\n  rescale: boolean,\n  item: {\n    xs: string; //dataURL\n    id: string;\n  }\n): Promise<{ xs: tensorflow.Tensor; id: string }> => {\n  const fetched = await tensorflow.util.fetch(item.xs);\n\n  const buffer: ArrayBuffer = await fetched.arrayBuffer();\n\n  let data: ImageJS.Image = await ImageJS.Image.load(buffer);\n\n  const canvas: HTMLCanvasElement = data.getCanvas();\n\n  let xs: tensorflow.Tensor3D = tensorflow.browser.fromPixels(canvas, channels);\n\n  if (rescale) {\n    xs = xs.div(255); //Because xs is string, values are encoded by uint8array by default\n  }\n\n  return new Promise((resolve) => {\n    return resolve({ ...item, xs: xs });\n  });\n};\n\nexport const resize = async (\n  inputShape: Shape,\n  item: {\n    xs: tensorflow.Tensor;\n    id: string;\n  }\n): Promise<{ xs: tensorflow.Tensor; id: string }> => {\n  const resized = tensorflow.image.resizeBilinear(\n    item.xs as tensorflow.Tensor3D,\n    [inputShape.height, inputShape.width]\n  );\n\n  return new Promise((resolve) => {\n    return resolve({ ...item, xs: resized });\n  });\n};\n\nexport const generator = (images: Array<Image>) => {\n  const count = images.length;\n\n  return function* () {\n    let index = 0;\n\n    while (index < count) {\n      const image = images[index];\n\n      yield {\n        xs: image.src,\n        id: image.id,\n      };\n\n      index++;\n    }\n  };\n};\n\nexport const preprocess_predict = async (\n  images: Array<Image>,\n  rescaleOptions: RescaleOptions,\n  inputShape: Shape\n): Promise<\n  tensorflow.data.Dataset<{\n    xs: tensorflow.Tensor;\n    id: string;\n  }>\n> => {\n  const data = tensorflow.data\n    .generator(generator(images))\n    .mapAsync(\n      decodeImage.bind(null, inputShape.channels, rescaleOptions.rescale)\n    )\n    .mapAsync(resize.bind(null, inputShape));\n\n  return data;\n};\n","import * as tensorflow from \"@tensorflow/tfjs\";\nimport { LayersModel } from \"@tensorflow/tfjs\";\nimport { Category } from \"../../../types/Category\";\n\nexport const predictCategories = async (\n  model: LayersModel,\n  data: tensorflow.data.Dataset<{\n    xs: tensorflow.Tensor;\n    id: string;\n  }>,\n  categories: Array<Category>\n): Promise<{ imageIds: Array<string>; categoryIds: Array<string> }> => {\n  const imageIds: Array<string> = [];\n  const categoryIds: Array<string> = [];\n\n  await data.forEachAsync((item: { xs: tensorflow.Tensor; id: string }) => {\n    const input = item.xs;\n    const y = model.predict(input.expandDims()); //gives vector of probabilities\n\n    //convert to index\n    //get corresponding categories[index] in categories array, get category ID\n    const idx = tensorflow.argMax(y as tensorflow.Tensor, 1).dataSync()[0];\n\n    imageIds.push(item.id);\n    categoryIds.push(categories[idx].id);\n  });\n\n  return { imageIds, categoryIds };\n};\n","import { Project } from \"../../types/Project\";\nimport { Image } from \"../../types/Image\";\nimport { Partition } from \"../../types/Partition\";\n\nexport const testImagesSelector = ({\n  project,\n}: {\n  project: Project;\n}): Array<Image> => {\n  return project.images.filter((image: Image) => {\n    return image.partition === Partition.Inference;\n  });\n};\n","import { put, select } from \"redux-saga/effects\";\nimport { projectSlice } from \"../../slices\";\nimport { createdCategoriesSelector } from \"../../selectors\";\nimport { rescaleOptionsSelector } from \"../../selectors/rescaleOptionsSelector\";\nimport { preprocess_predict } from \"../../coroutines/classifier/preprocess_predict\";\nimport { predictCategories } from \"../../coroutines/classifier/predictCategories\";\nimport { testImagesSelector } from \"../../selectors/testImagesSelector\";\nimport { fittedSelector } from \"../../selectors/fittedSelector\";\nimport { architectureOptionsSelector } from \"../../selectors/architectureOptionsSelector\";\nimport { Category } from \"../../../types/Category\";\n\nexport function* predictSaga(action: any): any {\n  const rescaleOptions = yield select(rescaleOptionsSelector);\n\n  let model = yield select(fittedSelector);\n\n  const architectureOptions = yield select(architectureOptionsSelector);\n\n  const categories: Category[] = yield select(createdCategoriesSelector);\n\n  const testImages = yield select(testImagesSelector);\n\n  if (!testImages.length) {\n    alert(\"No unlabled images to predict!\");\n    return;\n  }\n\n  const outputLayerSize = model.outputs[0].shape[1] as number;\n  if (outputLayerSize !== categories.length) {\n    alert(\n      \"The output shape of your model does not correspond to the number of categories!\"\n    );\n    return;\n  }\n\n  const data = yield preprocess_predict(\n    testImages,\n    rescaleOptions,\n    architectureOptions.inputShape\n  );\n\n  const { imageIds, categoryIds } = yield predictCategories(\n    model,\n    data,\n    categories\n  ); //returns an array of Image ID and an array of corresponding categories ID\n\n  yield put(\n    projectSlice.actions.updateImagesCategories({\n      ids: imageIds,\n      categoryIds: categoryIds,\n    })\n  );\n}\n","import { takeEvery } from \"redux-saga/effects\";\nimport { classifierSlice } from \"../../slices\";\nimport { predictSaga } from \"./predictSaga\";\n\nexport function* watchPredictSaga(): any {\n  yield takeEvery(classifierSlice.actions.predict.type, predictSaga);\n}\n","import { all, fork } from \"redux-saga/effects\";\nimport {\n  watchAnnotationStateChangeSaga,\n  watchSelectedCategorySaga,\n} from \"./annotator\";\nimport { watchFitSaga } from \"./classifier\";\nimport { watchPredictSaga } from \"./classifier/watchPredictSaga\";\n\nexport function* rootSaga() {\n  const classifierEffects = [fork(watchFitSaga), fork(watchPredictSaga)];\n\n  const annotaterEffects = [\n    fork(watchAnnotationStateChangeSaga),\n    fork(watchSelectedCategorySaga),\n  ];\n\n  yield all([...classifierEffects, ...annotaterEffects]);\n}\n","import { reducer } from \"../reducer\";\nimport {\n  configureStore,\n  EnhancedStore,\n  Middleware,\n  StoreEnhancer,\n} from \"@reduxjs/toolkit\";\nimport logger from \"redux-logger\";\nimport createSagaMiddleware from \"redux-saga\";\nimport { rootSaga } from \"../sagas\";\nimport * as Sentry from \"@sentry/react\";\nimport thunk from \"redux-thunk\";\n\nexport const saga = createSagaMiddleware();\n\nconst sentryReduxEnhancer = Sentry.createReduxEnhancer({});\n\nconst enhancers: StoreEnhancer[] = [sentryReduxEnhancer];\n\nconst middleware: Middleware[] = [logger, saga, thunk];\n\nconst preloadedState = {};\n\nconst options = {\n  devTools: true,\n  enhancers: enhancers,\n  middleware: middleware,\n  preloadedState: preloadedState,\n  reducer: reducer,\n};\n\nexport const productionStore: EnhancedStore = configureStore(options);\n\nsaga.run(rootSaga);\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n// import * as serviceWorker from \"./serviceWorker\";\nimport { Provider } from \"react-redux\";\nimport { DndProvider } from \"react-dnd\";\nimport { HTML5Backend } from \"react-dnd-html5-backend\";\nimport { Application } from \"./components/Application\";\nimport { productionStore } from \"store/stores\";\n\nReactDOM.render(\n  <Provider store={productionStore}>\n    <DndProvider backend={HTML5Backend}>\n      <Application />\n    </DndProvider>\n  </Provider>,\n  document.getElementById(\"root\")\n);\n\n// serviceWorker.register();\n"],"sourceRoot":""}